// CodeMirror, copyright (c) by Marijn Haverbeke and others
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.CodeMirror=e()}(this,function(){"use strict";function t(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}function e(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function i(t,i){return e(t).appendChild(i)}function n(t,e,i,n){var o=document.createElement(t);if(i&&(o.className=i),n&&(o.style.cssText=n),"string"==typeof e)o.appendChild(document.createTextNode(e));else if(e)for(var r=0;r<e.length;++r)o.appendChild(e[r]);return o}function o(t,e,i,o){var r=n(t,e,i,o);return r.setAttribute("role","presentation"),r}function r(t,e){if(3==e.nodeType&&(e=e.parentNode),t.contains)return t.contains(e);do{if(11==e.nodeType&&(e=e.host),e==t)return!0}while(e=e.parentNode)}function s(){var t;try{t=document.activeElement}catch(Gs){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function a(e,i){var n=e.className;t(i).test(n)||(e.className+=(n?" ":"")+i)}function l(e,i){for(var n=e.split(" "),o=0;o<n.length;o++)n[o]&&!t(n[o]).test(i)&&(i+=" "+n[o]);return i}function c(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function h(t,e,i){for(var n in e||(e={}),t)!t.hasOwnProperty(n)||!1===i&&e.hasOwnProperty(n)||(e[n]=t[n]);return e}function u(t,e,i,n,o){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);for(var r=n||0,s=o||0;;){var a=t.indexOf("\t",r);if(a<0||a>=e)return s+(e-r);s+=a-r,s+=i-s%i,r=a+1}}function d(t,e){for(var i=0;i<t.length;++i)if(t[i]==e)return i;return-1}function p(t,e,i){for(var n=0,o=0;;){var r=t.indexOf("\t",n);-1==r&&(r=t.length);var s=r-n;if(r==t.length||o+s>=e)return n+Math.min(s,e-o);if(o+=r-n,n=r+1,(o+=i-o%i)>=e)return n}}function f(t){for(;Js.length<=t;)Js.push(g(Js)+" ");return Js[t]}function g(t){return t[t.length-1]}function m(t,e){for(var i=[],n=0;n<t.length;n++)i[n]=e(t[n],n);return i}function v(t,e,i){for(var n=0,o=i(e);n<t.length&&i(t[n])<=o;)n++;t.splice(n,0,e)}function b(){}function y(t,e){var i;return Object.create?i=Object.create(t):(b.prototype=t,i=new b),e&&h(e,i),i}function S(t){return/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||Qs.test(t))}function k(t,e){return e?!!(e.source.indexOf("\\w")>-1&&S(t))||e.test(t):S(t)}function w(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}function _(t){return t.charCodeAt(0)>=768&&ta.test(t)}function x(t,e,i){for(;(i<0?e>0:e<t.length)&&_(t.charAt(e));)e+=i;return e}function L(t,e,i){for(var n=e>i?-1:1;;){if(e==i)return e;var o=(e+i)/2,r=n<0?Math.ceil(o):Math.floor(o);if(r==e)return t(r)?e:i;t(r)?i=r:e=r+n}}function C(t,e,i,n){if(!t)return n(e,i,"ltr",0);for(var o=!1,r=0;r<t.length;++r){var s=t[r];(s.from<i&&s.to>e||e==i&&s.to==e)&&(n(Math.max(s.from,e),Math.min(s.to,i),1==s.level?"rtl":"ltr",r),o=!0)}o||n(e,i,"ltr")}function E(t,e,i){var n;ea=null;for(var o=0;o<t.length;++o){var r=t[o];if(r.from<e&&r.to>e)return o;r.to==e&&(r.from!=r.to&&"before"==i?n=o:ea=o),r.from==e&&(r.from!=r.to&&"before"!=i?n=o:ea=o)}return null!=n?n:ea}function T(t,e){var i=t.order;return null==i&&(i=t.order=ia(t.text,e)),i}function M(t,e){return t._handlers&&t._handlers[e]||na}function A(t,e,i){if(t.removeEventListener)t.removeEventListener(e,i,!1);else if(t.detachEvent)t.detachEvent("on"+e,i);else{var n=t._handlers,o=n&&n[e];if(o){var r=d(o,i);r>-1&&(n[e]=o.slice(0,r).concat(o.slice(r+1)))}}}function I(t,e){var i=M(t,e);if(i.length)for(var n=Array.prototype.slice.call(arguments,2),o=0;o<i.length;++o)i[o].apply(null,n)}function O(t,e,i){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),I(t,i||e.type,t,e),z(e)||e.codemirrorIgnore}function R(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var i=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),n=0;n<e.length;++n)-1==d(i,e[n])&&i.push(e[n])}function D(t,e){return M(t,e).length>0}function B(t){t.prototype.on=function(t,e){oa(this,t,e)},t.prototype.off=function(t,e){A(this,t,e)}}function P(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function N(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function z(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function V(t){P(t),N(t)}function F(t){return t.target||t.srcElement}function $(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),Ds&&t.ctrlKey&&1==e&&(e=3),e}function H(t){if(null==Ws){var e=n("span","\u200b");i(t,n("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(Ws=e.offsetWidth<=1&&e.offsetHeight>2&&!(ws&&_s<8))}var o=Ws?n("span","\u200b"):n("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px");return o.setAttribute("cm-text",""),o}function U(t){if(null!=js)return js;var n=i(t,document.createTextNode("A\u062eA")),o=zs(n,0,1).getBoundingClientRect(),r=zs(n,1,2).getBoundingClientRect();return e(t),!(!o||o.left==o.right)&&(js=r.right-o.right<3)}function W(t){if(null!=ca)return ca;var e=i(t,n("span","x")),o=e.getBoundingClientRect(),r=zs(e,0,1).getBoundingClientRect();return ca=Math.abs(o.left-r.left)>1}function j(t,e){arguments.length>2&&(e.dependencies=Array.prototype.slice.call(arguments,2)),ha[t]=e}function G(t,e){ua[t]=e}function q(t){if("string"==typeof t&&ua.hasOwnProperty(t))t=ua[t];else if(t&&"string"==typeof t.name&&ua.hasOwnProperty(t.name)){var e=ua[t.name];"string"==typeof e&&(e={name:e}),(t=y(e,t)).name=e.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return q("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return q("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}function K(t,e){e=q(e);var i=ha[e.name];if(!i)return K(t,"text/plain");var n=i(t,e);if(da.hasOwnProperty(e.name)){var o=da[e.name];for(var r in o)o.hasOwnProperty(r)&&(n.hasOwnProperty(r)&&(n["_"+r]=n[r]),n[r]=o[r])}if(n.name=e.name,e.helperType&&(n.helperType=e.helperType),e.modeProps)for(var s in e.modeProps)n[s]=e.modeProps[s];return n}function X(t,e){h(e,da.hasOwnProperty(t)?da[t]:da[t]={})}function Y(t,e){if(!0===e)return e;if(t.copyState)return t.copyState(e);var i={};for(var n in e){var o=e[n];o instanceof Array&&(o=o.concat([])),i[n]=o}return i}function Z(t,e){for(var i;t.innerMode&&(i=t.innerMode(e))&&i.mode!=t;)e=i.state,t=i.mode;return i||{mode:t,state:e}}function J(t,e,i){return!t.startState||t.startState(e,i)}function Q(t,e){if((e-=t.first)<0||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var i=t;!i.lines;)for(var n=0;;++n){var o=i.children[n],r=o.chunkSize();if(e<r){i=o;break}e-=r}return i.lines[e]}function tt(t,e,i){var n=[],o=e.line;return t.iter(e.line,i.line+1,function(t){var r=t.text;o==i.line&&(r=r.slice(0,i.ch)),o==e.line&&(r=r.slice(e.ch)),n.push(r),++o}),n}function et(t,e,i){var n=[];return t.iter(e,i,function(t){n.push(t.text)}),n}function it(t,e){var i=e-t.height;if(i)for(var n=t;n;n=n.parent)n.height+=i}function nt(t){if(null==t.parent)return null;for(var e=t.parent,i=d(e.lines,t),n=e.parent;n;e=n,n=n.parent)for(var o=0;n.children[o]!=e;++o)i+=n.children[o].chunkSize();return i+e.first}function ot(t,e){var i=t.first;t:do{for(var n=0;n<t.children.length;++n){var o=t.children[n],r=o.height;if(e<r){t=o;continue t}e-=r,i+=o.chunkSize()}return i}while(!t.lines);for(var s=0;s<t.lines.length;++s){var a=t.lines[s].height;if(e<a)break;e-=a}return i+s}function rt(t,e){return e>=t.first&&e<t.first+t.size}function st(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function at(t,e,i){if(void 0===i&&(i=null),!(this instanceof at))return new at(t,e,i);this.line=t,this.ch=e,this.sticky=i}function lt(t,e){return t.line-e.line||t.ch-e.ch}function ct(t,e){return t.sticky==e.sticky&&0==lt(t,e)}function ht(t){return at(t.line,t.ch)}function ut(t,e){return lt(t,e)<0?e:t}function dt(t,e){return lt(t,e)<0?t:e}function pt(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function ft(t,e){if(e.line<t.first)return at(t.first,0);var i=t.first+t.size-1;return e.line>i?at(i,Q(t,i).text.length):gt(e,Q(t,e.line).text.length)}function gt(t,e){var i=t.ch;return null==i||i>e?at(t.line,e):i<0?at(t.line,0):t}function mt(t,e){for(var i=[],n=0;n<e.length;n++)i[n]=ft(t,e[n]);return i}function vt(t,e,i,n){var o=[t.state.modeGen],r={};Lt(t,e.text,t.doc.mode,i,function(t,e){return o.push(t,e)},r,n);for(var s=i.state,a=function(n){i.baseTokens=o;var a=t.state.overlays[n],l=1,c=0;i.state=!0,Lt(t,e.text,a.mode,i,function(t,e){for(var i=l;c<t;){var n=o[l];n>t&&o.splice(l,1,t,o[l+1],n),l+=2,c=Math.min(t,n)}if(e)if(a.opaque)o.splice(i,l-i,t,"overlay "+e),l=i+2;else for(;i<l;i+=2){var r=o[i+1];o[i+1]=(r?r+" ":"")+"overlay "+e}},r),i.state=s,i.baseTokens=null,i.baseTokenPos=1},l=0;l<t.state.overlays.length;++l)a(l);return{styles:o,classes:r.bgClass||r.textClass?r:null}}function bt(t,e,i){if(!e.styles||e.styles[0]!=t.state.modeGen){var n=yt(t,nt(e)),o=e.text.length>t.options.maxHighlightLength&&Y(t.doc.mode,n.state),r=vt(t,e,n);o&&(n.state=o),e.stateAfter=n.save(!o),e.styles=r.styles,r.classes?e.styleClasses=r.classes:e.styleClasses&&(e.styleClasses=null),i===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))}return e.styles}function yt(t,e,i){var n=t.doc,o=t.display;if(!n.mode.startState)return new ga(n,!0,e);var r=Ct(t,e,i),s=r>n.first&&Q(n,r-1).stateAfter,a=s?ga.fromSaved(n,s,r):new ga(n,J(n.mode),r);return n.iter(r,e,function(i){St(t,i.text,a);var n=a.line;i.stateAfter=n==e-1||n%5==0||n>=o.viewFrom&&n<o.viewTo?a.save():null,a.nextLine()}),i&&(n.modeFrontier=a.line),a}function St(t,e,i,n){var o=t.doc.mode,r=new pa(e,t.options.tabSize,i);for(r.start=r.pos=n||0,""==e&&kt(o,i.state);!r.eol();)wt(o,r,i.state),r.start=r.pos}function kt(t,e){if(t.blankLine)return t.blankLine(e);if(t.innerMode){var i=Z(t,e);return i.mode.blankLine?i.mode.blankLine(i.state):void 0}}function wt(t,e,i,n){for(var o=0;o<10;o++){n&&(n[0]=Z(t,i).mode);var r=t.token(e,i);if(e.pos>e.start)return r}throw new Error("Mode "+t.name+" failed to advance stream.")}function _t(t,e,i,n){var o,r,s=t.doc,a=s.mode,l=Q(s,(e=ft(s,e)).line),c=yt(t,e.line,i),h=new pa(l.text,t.options.tabSize,c);for(n&&(r=[]);(n||h.pos<e.ch)&&!h.eol();)h.start=h.pos,o=wt(a,h,c.state),n&&r.push(new ma(h,o,Y(s.mode,c.state)));return n?r:new ma(h,o,c.state)}function xt(t,e){if(t)for(;;){var i=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;t=t.slice(0,i.index)+t.slice(i.index+i[0].length);var n=i[1]?"bgClass":"textClass";null==e[n]?e[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(e[n])||(e[n]+=" "+i[2])}return t}function Lt(t,e,i,n,o,r,s){var a=i.flattenSpans;null==a&&(a=t.options.flattenSpans);var l,c=0,h=null,u=new pa(e,t.options.tabSize,n),d=t.options.addModeClass&&[null];for(""==e&&xt(kt(i,n.state),r);!u.eol();){if(u.pos>t.options.maxHighlightLength?(a=!1,s&&St(t,e,n,u.pos),u.pos=e.length,l=null):l=xt(wt(i,u,n.state,d),r),d){var p=d[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!a||h!=l){for(;c<u.start;)o(c=Math.min(u.start,c+5e3),h);h=l}u.start=u.pos}for(;c<u.pos;){var f=Math.min(u.pos,c+5e3);o(f,h),c=f}}function Ct(t,e,i){for(var n,o,r=t.doc,s=i?-1:e-(t.doc.mode.innerMode?1e3:100),a=e;a>s;--a){if(a<=r.first)return r.first;var l=Q(r,a-1),c=l.stateAfter;if(c&&(!i||a+(c instanceof fa?c.lookAhead:0)<=r.modeFrontier))return a;var h=u(l.text,null,t.options.tabSize);(null==o||n>h)&&(o=a-1,n=h)}return o}function Et(t,e){if(t.modeFrontier=Math.min(t.modeFrontier,e),!(t.highlightFrontier<e-10)){for(var i=t.first,n=e-1;n>i;n--){var o=Q(t,n).stateAfter;if(o&&(!(o instanceof fa)||n+o.lookAhead<e)){i=n+1;break}}t.highlightFrontier=Math.min(t.highlightFrontier,i)}}function Tt(){va=!0}function Mt(){ba=!0}function At(t,e,i){this.marker=t,this.from=e,this.to=i}function It(t,e){if(t)for(var i=0;i<t.length;++i){var n=t[i];if(n.marker==e)return n}}function Ot(t,e){for(var i,n=0;n<t.length;++n)t[n]!=e&&(i||(i=[])).push(t[n]);return i}function Rt(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}function Dt(t,e,i){var n;if(t)for(var o=0;o<t.length;++o){var r=t[o],s=r.marker;if(null==r.from||(s.inclusiveLeft?r.from<=e:r.from<e)||r.from==e&&"bookmark"==s.type&&(!i||!r.marker.insertLeft)){var a=null==r.to||(s.inclusiveRight?r.to>=e:r.to>e);(n||(n=[])).push(new At(s,r.from,a?null:r.to))}}return n}function Bt(t,e,i){var n;if(t)for(var o=0;o<t.length;++o){var r=t[o],s=r.marker;if(null==r.to||(s.inclusiveRight?r.to>=e:r.to>e)||r.from==e&&"bookmark"==s.type&&(!i||r.marker.insertLeft)){var a=null==r.from||(s.inclusiveLeft?r.from<=e:r.from<e);(n||(n=[])).push(new At(s,a?null:r.from-e,null==r.to?null:r.to-e))}}return n}function Pt(t,e){if(e.full)return null;var i=rt(t,e.from.line)&&Q(t,e.from.line).markedSpans,n=rt(t,e.to.line)&&Q(t,e.to.line).markedSpans;if(!i&&!n)return null;var o=e.from.ch,r=e.to.ch,s=0==lt(e.from,e.to),a=Dt(i,o,s),l=Bt(n,r,s),c=1==e.text.length,h=g(e.text).length+(c?o:0);if(a)for(var u=0;u<a.length;++u){var d=a[u];if(null==d.to){var p=It(l,d.marker);p?c&&(d.to=null==p.to?null:p.to+h):d.to=o}}if(l)for(var f=0;f<l.length;++f){var m=l[f];if(null!=m.to&&(m.to+=h),null==m.from)It(a,m.marker)||(m.from=h,c&&(a||(a=[])).push(m));else m.from+=h,c&&(a||(a=[])).push(m)}a&&(a=Nt(a)),l&&l!=a&&(l=Nt(l));var v=[a];if(!c){var b,y=e.text.length-2;if(y>0&&a)for(var S=0;S<a.length;++S)null==a[S].to&&(b||(b=[])).push(new At(a[S].marker,null,null));for(var k=0;k<y;++k)v.push(b);v.push(l)}return v}function Nt(t){for(var e=0;e<t.length;++e){var i=t[e];null!=i.from&&i.from==i.to&&!1!==i.marker.clearWhenEmpty&&t.splice(e--,1)}return t.length?t:null}function zt(t,e,i){var n=null;if(t.iter(e.line,i.line+1,function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var i=t.markedSpans[e].marker;!i.readOnly||n&&-1!=d(n,i)||(n||(n=[])).push(i)}}),!n)return null;for(var o=[{from:e,to:i}],r=0;r<n.length;++r)for(var s=n[r],a=s.find(0),l=0;l<o.length;++l){var c=o[l];if(!(lt(c.to,a.from)<0||lt(c.from,a.to)>0)){var h=[l,1],u=lt(c.from,a.from),p=lt(c.to,a.to);(u<0||!s.inclusiveLeft&&!u)&&h.push({from:c.from,to:a.from}),(p>0||!s.inclusiveRight&&!p)&&h.push({from:a.to,to:c.to}),o.splice.apply(o,h),l+=h.length-3}}return o}function Vt(t){var e=t.markedSpans;if(e){for(var i=0;i<e.length;++i)e[i].marker.detachLine(t);t.markedSpans=null}}function Ft(t,e){if(e){for(var i=0;i<e.length;++i)e[i].marker.attachLine(t);t.markedSpans=e}}function $t(t){return t.inclusiveLeft?-1:0}function Ht(t){return t.inclusiveRight?1:0}function Ut(t,e){var i=t.lines.length-e.lines.length;if(0!=i)return i;var n=t.find(),o=e.find(),r=lt(n.from,o.from)||$t(t)-$t(e);if(r)return-r;var s=lt(n.to,o.to)||Ht(t)-Ht(e);return s||e.id-t.id}function Wt(t,e){var i,n=ba&&t.markedSpans;if(n)for(var o=void 0,r=0;r<n.length;++r)(o=n[r]).marker.collapsed&&null==(e?o.from:o.to)&&(!i||Ut(i,o.marker)<0)&&(i=o.marker);return i}function jt(t){return Wt(t,!0)}function Gt(t){return Wt(t,!1)}function qt(t,e){var i,n=ba&&t.markedSpans;if(n)for(var o=0;o<n.length;++o){var r=n[o];r.marker.collapsed&&(null==r.from||r.from<e)&&(null==r.to||r.to>e)&&(!i||Ut(i,r.marker)<0)&&(i=r.marker)}return i}function Kt(t,e,i,n,o){var r=Q(t,e),s=ba&&r.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var c=l.marker.find(0),h=lt(c.from,i)||$t(l.marker)-$t(o),u=lt(c.to,n)||Ht(l.marker)-Ht(o);if(!(h>=0&&u<=0||h<=0&&u>=0)&&(h<=0&&(l.marker.inclusiveRight&&o.inclusiveLeft?lt(c.to,i)>=0:lt(c.to,i)>0)||h>=0&&(l.marker.inclusiveRight&&o.inclusiveLeft?lt(c.from,n)<=0:lt(c.from,n)<0)))return!0}}}function Xt(t){for(var e;e=jt(t);)t=e.find(-1,!0).line;return t}function Yt(t){for(var e;e=Gt(t);)t=e.find(1,!0).line;return t}function Zt(t){for(var e,i;e=Gt(t);)t=e.find(1,!0).line,(i||(i=[])).push(t);return i}function Jt(t,e){var i=Q(t,e),n=Xt(i);return i==n?e:nt(n)}function Qt(t,e){if(e>t.lastLine())return e;var i,n=Q(t,e);if(!te(t,n))return e;for(;i=Gt(n);)n=i.find(1,!0).line;return nt(n)+1}function te(t,e){var i=ba&&e.markedSpans;if(i)for(var n=void 0,o=0;o<i.length;++o)if((n=i[o]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&ee(t,e,n))return!0}}function ee(t,e,i){if(null==i.to){var n=i.marker.find(1,!0);return ee(t,n.line,It(n.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==e.text.length)return!0;for(var o=void 0,r=0;r<e.markedSpans.length;++r)if((o=e.markedSpans[r]).marker.collapsed&&!o.marker.widgetNode&&o.from==i.to&&(null==o.to||o.to!=i.from)&&(o.marker.inclusiveLeft||i.marker.inclusiveRight)&&ee(t,e,o))return!0}function ie(t){for(var e=0,i=(t=Xt(t)).parent,n=0;n<i.lines.length;++n){var o=i.lines[n];if(o==t)break;e+=o.height}for(var r=i.parent;r;r=(i=r).parent)for(var s=0;s<r.children.length;++s){var a=r.children[s];if(a==i)break;e+=a.height}return e}function ne(t){if(0==t.height)return 0;for(var e,i=t.text.length,n=t;e=jt(n);){var o=e.find(0,!0);n=o.from.line,i+=o.from.ch-o.to.ch}for(n=t;e=Gt(n);){var r=e.find(0,!0);i-=n.text.length-r.from.ch,i+=(n=r.to.line).text.length-r.to.ch}return i}function oe(t){var e=t.display,i=t.doc;e.maxLine=Q(i,i.first),e.maxLineLength=ne(e.maxLine),e.maxLineChanged=!0,i.iter(function(t){var i=ne(t);i>e.maxLineLength&&(e.maxLineLength=i,e.maxLine=t)})}function re(t,e,i,n){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),Vt(t),Ft(t,i);var o=n?n(t):1;o!=t.height&&it(t,o)}function se(t){t.parent=null,Vt(t)}function ae(t,e){if(!t||/^\s*$/.test(t))return null;var i=e.addModeClass?wa:ka;return i[t]||(i[t]=t.replace(/\S+/g,"cm-$&"))}function le(t,e){var i=o("span",null,null,xs?"padding-right: .1px":null),n={pre:o("pre",[i],"CodeMirror-line"),content:i,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};e.measure={};for(var r=0;r<=(e.rest?e.rest.length:0);r++){var s=r?e.rest[r-1]:e.line,a=void 0;n.pos=0,n.addToken=he,U(t.display.measure)&&(a=T(s,t.doc.direction))&&(n.addToken=de(n.addToken,a)),n.map=[],fe(s,n,bt(t,s,e!=t.display.externalMeasured&&nt(s))),s.styleClasses&&(s.styleClasses.bgClass&&(n.bgClass=l(s.styleClasses.bgClass,n.bgClass||"")),s.styleClasses.textClass&&(n.textClass=l(s.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(H(t.display.measure))),0==r?(e.measure.map=n.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(n.map),(e.measure.caches||(e.measure.caches=[])).push({}))}if(xs){var c=n.content.lastChild;(/\bcm-tab\b/.test(c.className)||c.querySelector&&c.querySelector(".cm-tab"))&&(n.content.className="cm-tab-wrap-hack")}return I(t,"renderLine",t,e.line,n.pre),n.pre.className&&(n.textClass=l(n.pre.className,n.textClass||"")),n}function ce(t){var e=n("span","\u2022","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e.setAttribute("aria-label",e.title),e}function he(t,e,i,o,r,s,a){if(e){var l,c=t.splitSpaces?ue(e,t.trailingSpace):e,h=t.cm.state.specialChars,u=!1;if(h.test(e)){l=document.createDocumentFragment();for(var d=0;;){h.lastIndex=d;var p=h.exec(e),g=p?p.index-d:e.length-d;if(g){var m=document.createTextNode(c.slice(d,d+g));ws&&_s<9?l.appendChild(n("span",[m])):l.appendChild(m),t.map.push(t.pos,t.pos+g,m),t.col+=g,t.pos+=g}if(!p)break;d+=g+1;var v=void 0;if("\t"==p[0]){var b=t.cm.options.tabSize,y=b-t.col%b;(v=l.appendChild(n("span",f(y),"cm-tab"))).setAttribute("role","presentation"),v.setAttribute("cm-text","\t"),t.col+=y}else"\r"==p[0]||"\n"==p[0]?((v=l.appendChild(n("span","\r"==p[0]?"\u240d":"\u2424","cm-invalidchar"))).setAttribute("cm-text",p[0]),t.col+=1):((v=t.cm.options.specialCharPlaceholder(p[0])).setAttribute("cm-text",p[0]),ws&&_s<9?l.appendChild(n("span",[v])):l.appendChild(v),t.col+=1);t.map.push(t.pos,t.pos+1,v),t.pos++}}else t.col+=e.length,l=document.createTextNode(c),t.map.push(t.pos,t.pos+e.length,l),ws&&_s<9&&(u=!0),t.pos+=e.length;if(t.trailingSpace=32==c.charCodeAt(e.length-1),i||o||r||u||s){var S=i||"";o&&(S+=o),r&&(S+=r);var k=n("span",[l],S,s);if(a)for(var w in a)a.hasOwnProperty(w)&&"style"!=w&&"class"!=w&&k.setAttribute(w,a[w]);return t.content.appendChild(k)}t.content.appendChild(l)}}function ue(t,e){if(t.length>1&&!/  /.test(t))return t;for(var i=e,n="",o=0;o<t.length;o++){var r=t.charAt(o);" "!=r||!i||o!=t.length-1&&32!=t.charCodeAt(o+1)||(r="\xa0"),n+=r,i=" "==r}return n}function de(t,e){return function(i,n,o,r,s,a,l){o=o?o+" cm-force-border":"cm-force-border";for(var c=i.pos,h=c+n.length;;){for(var u=void 0,d=0;d<e.length&&!((u=e[d]).to>c&&u.from<=c);d++);if(u.to>=h)return t(i,n,o,r,s,a,l);t(i,n.slice(0,u.to-c),o,r,null,a,l),r=null,n=n.slice(u.to-c),c=u.to}}}function pe(t,e,i,n){var o=!n&&i.widgetNode;o&&t.map.push(t.pos,t.pos+e,o),!n&&t.cm.display.input.needsContentAttribute&&(o||(o=t.content.appendChild(document.createElement("span"))),o.setAttribute("cm-marker",i.id)),o&&(t.cm.display.input.setUneditable(o),t.content.appendChild(o)),t.pos+=e,t.trailingSpace=!1}function fe(t,e,i){var n=t.markedSpans,o=t.text,r=0;if(n)for(var s,a,l,c,h,u,d,p=o.length,f=0,g=1,m="",v=0;;){if(v==f){l=c=h=a="",d=null,u=null,v=Infinity;for(var b=[],y=void 0,S=0;S<n.length;++S){var k=n[S],w=k.marker;if("bookmark"==w.type&&k.from==f&&w.widgetNode)b.push(w);else if(k.from<=f&&(null==k.to||k.to>f||w.collapsed&&k.to==f&&k.from==f)){if(null!=k.to&&k.to!=f&&v>k.to&&(v=k.to,c=""),w.className&&(l+=" "+w.className),w.css&&(a=(a?a+";":"")+w.css),w.startStyle&&k.from==f&&(h+=" "+w.startStyle),w.endStyle&&k.to==v&&(y||(y=[])).push(w.endStyle,k.to),w.title&&((d||(d={})).title=w.title),w.attributes)for(var _ in w.attributes)(d||(d={}))[_]=w.attributes[_];w.collapsed&&(!u||Ut(u.marker,w)<0)&&(u=k)}else k.from>f&&v>k.from&&(v=k.from)}if(y)for(var x=0;x<y.length;x+=2)y[x+1]==v&&(c+=" "+y[x]);if(!u||u.from==f)for(var L=0;L<b.length;++L)pe(e,0,b[L]);if(u&&(u.from||0)==f){if(pe(e,(null==u.to?p+1:u.to)-f,u.marker,null==u.from),null==u.to)return;u.to==f&&(u=!1)}}if(f>=p)break;for(var C=Math.min(p,v);;){if(m){var E=f+m.length;if(!u){var T=E>C?m.slice(0,C-f):m;e.addToken(e,T,s?s+l:l,h,f+T.length==v?c:"",a,d)}if(E>=C){m=m.slice(C-f),f=C;break}f=E,h=""}m=o.slice(r,r=i[g++]),s=ae(i[g++],e.cm.options)}}else for(var M=1;M<i.length;M+=2)e.addToken(e,o.slice(r,r=i[M]),ae(i[M+1],e.cm.options))}function ge(t,e,i){this.line=e,this.rest=Zt(e),this.size=this.rest?nt(g(this.rest))-i+1:1,this.node=this.text=null,this.hidden=te(t,e)}function me(t,e,i){for(var n,o=[],r=e;r<i;r=n){var s=new ge(t.doc,Q(t.doc,r),r);n=r+s.size,o.push(s)}return o}function ve(t){_a?_a.ops.push(t):t.ownsGroup=_a={ops:[t],delayedCallbacks:[]}}function be(t){var e=t.delayedCallbacks,i=0;do{for(;i<e.length;i++)e[i].call(null);for(var n=0;n<t.ops.length;n++){var o=t.ops[n];if(o.cursorActivityHandlers)for(;o.cursorActivityCalled<o.cursorActivityHandlers.length;)o.cursorActivityHandlers[o.cursorActivityCalled++].call(null,o.cm)}}while(i<e.length)}function ye(t,e){var i=t.ownsGroup;if(i)try{be(i)}finally{_a=null,e(i)}}function Se(t,e){var i=M(t,e);if(i.length){var n,o=Array.prototype.slice.call(arguments,2);_a?n=_a.delayedCallbacks:xa?n=xa:(n=xa=[],setTimeout(ke,0));for(var r=function(t){n.push(function(){return i[t].apply(null,o)})},s=0;s<i.length;++s)r(s)}}function ke(){var t=xa;xa=null;for(var e=0;e<t.length;++e)t[e]()}function we(t,e,i,n){for(var o=0;o<e.changes.length;o++){var r=e.changes[o];"text"==r?Ce(t,e):"gutter"==r?Te(t,e,i,n):"class"==r?Ee(t,e):"widget"==r&&Me(t,e,n)}e.changes=null}function _e(t){return t.node==t.text&&(t.node=n("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),ws&&_s<8&&(t.node.style.zIndex=2)),t.node}function xe(t,e){var i=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(i&&(i+=" CodeMirror-linebackground"),e.background)i?e.background.className=i:(e.background.parentNode.removeChild(e.background),e.background=null);else if(i){var o=_e(e);e.background=o.insertBefore(n("div",null,i),o.firstChild),t.display.input.setUneditable(e.background)}}function Le(t,e){var i=t.display.externalMeasured;return i&&i.line==e.line?(t.display.externalMeasured=null,e.measure=i.measure,i.built):le(t,e)}function Ce(t,e){var i=e.text.className,n=Le(t,e);e.text==e.node&&(e.node=n.pre),e.text.parentNode.replaceChild(n.pre,e.text),e.text=n.pre,n.bgClass!=e.bgClass||n.textClass!=e.textClass?(e.bgClass=n.bgClass,e.textClass=n.textClass,Ee(t,e)):i&&(e.text.className=i)}function Ee(t,e){xe(t,e),e.line.wrapClass?_e(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var i=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=i||""}function Te(t,e,i,o){if(e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null),e.gutterBackground&&(e.node.removeChild(e.gutterBackground),e.gutterBackground=null),e.line.gutterClass){var r=_e(e);e.gutterBackground=n("div",null,"CodeMirror-gutter-background "+e.line.gutterClass,"left: "+(t.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px; width: "+o.gutterTotalWidth+"px"),t.display.input.setUneditable(e.gutterBackground),r.insertBefore(e.gutterBackground,e.text)}var s=e.line.gutterMarkers;if(t.options.lineNumbers||s){var a=_e(e),l=e.gutter=n("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px");if(t.display.input.setUneditable(l),a.insertBefore(l,e.text),e.line.gutterClass&&(l.className+=" "+e.line.gutterClass),!t.options.lineNumbers||s&&s["CodeMirror-linenumbers"]||(e.lineNumber=l.appendChild(n("div",st(t.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+o.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),s)for(var c=0;c<t.display.gutterSpecs.length;++c){var h=t.display.gutterSpecs[c].className,u=s.hasOwnProperty(h)&&s[h];u&&l.appendChild(n("div",[u],"CodeMirror-gutter-elt","left: "+o.gutterLeft[h]+"px; width: "+o.gutterWidth[h]+"px"))}}}function Me(t,e,i){e.alignable&&(e.alignable=null);for(var n=e.node.firstChild,o=void 0;n;n=o)o=n.nextSibling,"CodeMirror-linewidget"==n.className&&e.node.removeChild(n);Ie(t,e,i)}function Ae(t,e,i,n){var o=Le(t,e);return e.text=e.node=o.pre,o.bgClass&&(e.bgClass=o.bgClass),o.textClass&&(e.textClass=o.textClass),Ee(t,e),Te(t,e,i,n),Ie(t,e,n),e.node}function Ie(t,e,i){if(Oe(t,e.line,e,i,!0),e.rest)for(var n=0;n<e.rest.length;n++)Oe(t,e.rest[n],e,i,!1)}function Oe(t,e,i,o,r){if(e.widgets)for(var s=_e(i),a=0,l=e.widgets;a<l.length;++a){var c=l[a],h=n("div",[c.node],"CodeMirror-linewidget");c.handleMouseEvents||h.setAttribute("cm-ignore-events","true"),Re(c,h,i,o),t.display.input.setUneditable(h),r&&c.above?s.insertBefore(h,i.gutter||i.text):s.appendChild(h),Se(c,"redraw")}}function Re(t,e,i,n){if(t.noHScroll){(i.alignable||(i.alignable=[])).push(e);var o=n.wrapperWidth;e.style.left=n.fixedPos+"px",t.coverGutter||(o-=n.gutterTotalWidth,e.style.paddingLeft=n.gutterTotalWidth+"px"),e.style.width=o+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-n.gutterTotalWidth+"px"))}function De(t){if(null!=t.height)return t.height;var e=t.doc.cm;if(!e)return 0;if(!r(document.body,t.node)){var o="position: relative;";t.coverGutter&&(o+="margin-left: -"+e.display.gutters.offsetWidth+"px;"),t.noHScroll&&(o+="width: "+e.display.wrapper.clientWidth+"px;"),i(e.display.measure,n("div",[t.node],null,o))}return t.height=t.node.parentNode.offsetHeight}function Be(t,e){for(var i=F(e);i!=t.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==t.sizer&&i!=t.mover)return!0}function Pe(t){return t.lineSpace.offsetTop}function Ne(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function ze(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=i(t.measure,n("pre","x","CodeMirror-line-like")),o=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,r={left:parseInt(o.paddingLeft),right:parseInt(o.paddingRight)};return isNaN(r.left)||isNaN(r.right)||(t.cachedPaddingH=r),r}function Ve(t){return qs-t.display.nativeBarWidth}function Fe(t){return t.display.scroller.clientWidth-Ve(t)-t.display.barWidth}function $e(t){return t.display.scroller.clientHeight-Ve(t)-t.display.barHeight}function He(t,e,i){var n=t.options.lineWrapping,o=n&&Fe(t);if(!e.measure.heights||n&&e.measure.width!=o){var r=e.measure.heights=[];if(n){e.measure.width=o;for(var s=e.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];Math.abs(l.bottom-c.bottom)>2&&r.push((l.bottom+c.top)/2-i.top)}}r.push(i.bottom-i.top)}}function Ue(t,e,i){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(var n=0;n<t.rest.length;n++)if(t.rest[n]==e)return{map:t.measure.maps[n],cache:t.measure.caches[n]};for(var o=0;o<t.rest.length;o++)if(nt(t.rest[o])>i)return{map:t.measure.maps[o],cache:t.measure.caches[o],before:!0}}function We(t,e){var n=nt(e=Xt(e)),o=t.display.externalMeasured=new ge(t.doc,e,n);o.lineN=n;var r=o.built=le(t,o);return o.text=r.pre,i(t.display.lineMeasure,r.pre),o}function je(t,e,i,n){return Ke(t,qe(t,e),i,n)}function Ge(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[Li(t,e)];var i=t.display.externalMeasured;return i&&e>=i.lineN&&e<i.lineN+i.size?i:void 0}function qe(t,e){var i=nt(e),n=Ge(t,i);n&&!n.text?n=null:n&&n.changes&&(we(t,n,i,Si(t)),t.curOp.forceUpdate=!0),n||(n=We(t,e));var o=Ue(n,e,i);return{line:e,view:n,rect:null,map:o.map,cache:o.cache,before:o.before,hasHeights:!1}}function Ke(t,e,i,n,o){e.before&&(i=-1);var r,s=i+(n||"");return e.cache.hasOwnProperty(s)?r=e.cache[s]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(He(t,e.view,e.rect),e.hasHeights=!0),(r=Ze(t,e,i,n)).bogus||(e.cache[s]=r)),{left:r.left,right:r.right,top:o?r.rtop:r.top,bottom:o?r.rbottom:r.bottom}}function Xe(t,e,i){for(var n,o,r,s,a,l,c=0;c<t.length;c+=3)if(a=t[c],l=t[c+1],e<a?(o=0,r=1,s="left"):e<l?r=(o=e-a)+1:(c==t.length-3||e==l&&t[c+3]>e)&&(o=(r=l-a)-1,e>=l&&(s="right")),null!=o){if(n=t[c+2],a==l&&i==(n.insertLeft?"left":"right")&&(s=i),"left"==i&&0==o)for(;c&&t[c-2]==t[c-3]&&t[c-1].insertLeft;)n=t[2+(c-=3)],s="left";if("right"==i&&o==l-a)for(;c<t.length-3&&t[c+3]==t[c+4]&&!t[c+5].insertLeft;)n=t[(c+=3)+2],s="right";break}return{node:n,start:o,end:r,collapse:s,coverStart:a,coverEnd:l}}function Ye(t,e){var i=La;if("left"==e)for(var n=0;n<t.length&&(i=t[n]).left==i.right;n++);else for(var o=t.length-1;o>=0&&(i=t[o]).left==i.right;o--);return i}function Ze(t,e,i,n){var o,r=Xe(e.map,i,n),s=r.node,a=r.start,l=r.end,c=r.collapse;if(3==s.nodeType){for(var h=0;h<4;h++){for(;a&&_(e.line.text.charAt(r.coverStart+a));)--a;for(;r.coverStart+l<r.coverEnd&&_(e.line.text.charAt(r.coverStart+l));)++l;if((o=ws&&_s<9&&0==a&&l==r.coverEnd-r.coverStart?s.parentNode.getBoundingClientRect():Ye(zs(s,a,l).getClientRects(),n)).left||o.right||0==a)break;l=a,a-=1,c="right"}ws&&_s<11&&(o=Je(t.display.measure,o))}else{var u;a>0&&(c=n="right"),o=t.options.lineWrapping&&(u=s.getClientRects()).length>1?u["right"==n?u.length-1:0]:s.getBoundingClientRect()}if(ws&&_s<9&&!a&&(!o||!o.left&&!o.right)){var d=s.parentNode.getClientRects()[0];o=d?{left:d.left,right:d.left+yi(t.display),top:d.top,bottom:d.bottom}:La}for(var p=o.top-e.rect.top,f=o.bottom-e.rect.top,g=(p+f)/2,m=e.view.measure.heights,v=0;v<m.length-1&&!(g<m[v]);v++);var b=v?m[v-1]:0,y=m[v],S={left:("right"==c?o.right:o.left)-e.rect.left,right:("left"==c?o.left:o.right)-e.rect.left,top:b,bottom:y};return o.left||o.right||(S.bogus=!0),t.options.singleCursorHeightPerLine||(S.rtop=p,S.rbottom=f),S}function Je(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!W(t))return e;var i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*i,right:e.right*i,top:e.top*n,bottom:e.bottom*n}}function Qe(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function ti(t){t.display.externalMeasure=null,e(t.display.lineMeasure);for(var i=0;i<t.display.view.length;i++)Qe(t.display.view[i])}function ei(t){ti(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function ii(){return Cs&&Os?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ni(){return Cs&&Os?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function oi(t){var e=0
;if(t.widgets)for(var i=0;i<t.widgets.length;++i)t.widgets[i].above&&(e+=De(t.widgets[i]));return e}function ri(t,e,i,n,o){if(!o){var r=oi(e);i.top+=r,i.bottom+=r}if("line"==n)return i;n||(n="local");var s=ie(e);if("local"==n?s+=Pe(t.display):s-=t.display.viewOffset,"page"==n||"window"==n){var a=t.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==n?0:ni());var l=a.left+("window"==n?0:ii());i.left+=l,i.right+=l}return i.top+=s,i.bottom+=s,i}function si(t,e,i){if("div"==i)return e;var n=e.left,o=e.top;if("page"==i)n-=ii(),o-=ni();else if("local"==i||!i){var r=t.display.sizer.getBoundingClientRect();n+=r.left,o+=r.top}var s=t.display.lineSpace.getBoundingClientRect();return{left:n-s.left,top:o-s.top}}function ai(t,e,i,n,o){return n||(n=Q(t.doc,e.line)),ri(t,n,je(t,n,e.ch,o),i)}function li(t,e,i,n,o,r){function s(e,s){var a=Ke(t,o,e,s?"right":"left",r);return s?a.left=a.right:a.right=a.left,ri(t,n,a,i)}function a(t,e,i){return s(i?t-1:t,1==l[e].level!=i)}n=n||Q(t.doc,e.line),o||(o=qe(t,n));var l=T(n,t.doc.direction),c=e.ch,h=e.sticky;if(c>=n.text.length?(c=n.text.length,h="before"):c<=0&&(c=0,h="after"),!l)return s("before"==h?c-1:c,"before"==h);var u=E(l,c,h),d=ea,p=a(c,u,"before"==h);return null!=d&&(p.other=a(c,d,"before"!=h)),p}function ci(t,e){var i=0;e=ft(t.doc,e),t.options.lineWrapping||(i=yi(t.display)*e.ch);var n=Q(t.doc,e.line),o=ie(n)+Pe(t.display);return{left:i,right:i,top:o,bottom:o+n.height}}function hi(t,e,i,n,o){var r=at(t,e,i);return r.xRel=o,n&&(r.outside=n),r}function ui(t,e,i){var n=t.doc;if((i+=t.display.viewOffset)<0)return hi(n.first,0,null,-1,-1);var o=ot(n,i),r=n.first+n.size-1;if(o>r)return hi(n.first+n.size-1,Q(n,r).text.length,null,1,1);e<0&&(e=0);for(var s=Q(n,o);;){var a=gi(t,s,o,e,i),l=qt(s,a.ch+(a.xRel>0||a.outside>0?1:0));if(!l)return a;var c=l.find(1);if(c.line==o)return c;s=Q(n,o=c.line)}}function di(t,e,i,n){n-=oi(e);var o=e.text.length,r=L(function(e){return Ke(t,i,e-1).bottom<=n},o,0);return{begin:r,end:o=L(function(e){return Ke(t,i,e).top>n},r,o)}}function pi(t,e,i,n){return i||(i=qe(t,e)),di(t,e,i,ri(t,e,Ke(t,i,n),"line").top)}function fi(t,e,i,n){return!(t.bottom<=i)&&(t.top>i||(n?t.left:t.right)>e)}function gi(t,e,i,n,o){o-=ie(e);var r=qe(t,e),s=oi(e),a=0,l=e.text.length,c=!0,h=T(e,t.doc.direction);if(h){var u=(t.options.lineWrapping?vi:mi)(t,e,i,r,h,n,o);a=(c=1!=u.level)?u.from:u.to-1,l=c?u.to:u.from-1}var d,p,f=null,g=null,m=L(function(e){var i=Ke(t,r,e);return i.top+=s,i.bottom+=s,!!fi(i,n,o,!1)&&(i.top<=o&&i.left<=n&&(f=e,g=i),!0)},a,l),v=!1;if(g){var b=n-g.left<g.right-n,y=b==c;m=f+(y?0:1),p=y?"after":"before",d=b?g.left:g.right}else{c||m!=l&&m!=a||m++,p=0==m?"after":m==e.text.length?"before":Ke(t,r,m-(c?1:0)).bottom+s<=o==c?"after":"before";var S=li(t,at(i,m,p),"line",e,r);d=S.left,v=o<S.top?-1:o>=S.bottom?1:0}return hi(i,m=x(e.text,m,1),p,v,n-d)}function mi(t,e,i,n,o,r,s){var a=L(function(a){var l=o[a],c=1!=l.level;return fi(li(t,at(i,c?l.to:l.from,c?"before":"after"),"line",e,n),r,s,!0)},0,o.length-1),l=o[a];if(a>0){var c=1!=l.level,h=li(t,at(i,c?l.from:l.to,c?"after":"before"),"line",e,n);fi(h,r,s,!0)&&h.top>s&&(l=o[a-1])}return l}function vi(t,e,i,n,o,r,s){var a=di(t,e,n,s),l=a.begin,c=a.end;/\s/.test(e.text.charAt(c-1))&&c--;for(var h=null,u=null,d=0;d<o.length;d++){var p=o[d];if(!(p.from>=c||p.to<=l)){var f=Ke(t,n,1!=p.level?Math.min(c,p.to)-1:Math.max(l,p.from)).right,g=f<r?r-f+1e9:f-r;(!h||u>g)&&(h=p,u=g)}}return h||(h=o[o.length-1]),h.from<l&&(h={from:l,to:h.to,level:h.level}),h.to>c&&(h={from:h.from,to:c,level:h.level}),h}function bi(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==Sa){Sa=n("pre",null,"CodeMirror-line-like");for(var o=0;o<49;++o)Sa.appendChild(document.createTextNode("x")),Sa.appendChild(n("br"));Sa.appendChild(document.createTextNode("x"))}i(t.measure,Sa);var r=Sa.offsetHeight/50;return r>3&&(t.cachedTextHeight=r),e(t.measure),r||1}function yi(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=n("span","xxxxxxxxxx"),o=n("pre",[e],"CodeMirror-line-like");i(t.measure,o);var r=e.getBoundingClientRect(),s=(r.right-r.left)/10;return s>2&&(t.cachedCharWidth=s),s||10}function Si(t){for(var e=t.display,i={},n={},o=e.gutters.clientLeft,r=e.gutters.firstChild,s=0;r;r=r.nextSibling,++s){var a=t.display.gutterSpecs[s].className;i[a]=r.offsetLeft+r.clientLeft+o,n[a]=r.clientWidth}return{fixedPos:ki(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:e.wrapper.clientWidth}}function ki(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function wi(t){var e=bi(t.display),i=t.options.lineWrapping,n=i&&Math.max(5,t.display.scroller.clientWidth/yi(t.display)-3);return function(o){if(te(t.doc,o))return 0;var r=0;if(o.widgets)for(var s=0;s<o.widgets.length;s++)o.widgets[s].height&&(r+=o.widgets[s].height);return i?r+(Math.ceil(o.text.length/n)||1)*e:r+e}}function _i(t){var e=t.doc,i=wi(t);e.iter(function(t){var e=i(t);e!=t.height&&it(t,e)})}function xi(t,e,i,n){var o=t.display;if(!i&&"true"==F(e).getAttribute("cm-not-content"))return null;var r,s,a=o.lineSpace.getBoundingClientRect();try{r=e.clientX-a.left,s=e.clientY-a.top}catch(e){return null}var l,c=ui(t,r,s);if(n&&1==c.xRel&&(l=Q(t.doc,c.line).text).length==c.ch){var h=u(l,l.length,t.options.tabSize)-l.length;c=at(c.line,Math.max(0,Math.round((r-ze(t.display).left)/yi(t.display))-h))}return c}function Li(t,e){if(e>=t.display.viewTo)return null;if((e-=t.display.viewFrom)<0)return null;for(var i=t.display.view,n=0;n<i.length;n++)if((e-=i[n].size)<0)return n}function Ci(t,e,i,n){null==e&&(e=t.doc.first),null==i&&(i=t.doc.first+t.doc.size),n||(n=0);var o=t.display;if(n&&i<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>e)&&(o.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=o.viewTo)ba&&Jt(t.doc,e)<o.viewTo&&Ti(t);else if(i<=o.viewFrom)ba&&Qt(t.doc,i+n)>o.viewFrom?Ti(t):(o.viewFrom+=n,o.viewTo+=n);else if(e<=o.viewFrom&&i>=o.viewTo)Ti(t);else if(e<=o.viewFrom){var r=Mi(t,i,i+n,1);r?(o.view=o.view.slice(r.index),o.viewFrom=r.lineN,o.viewTo+=n):Ti(t)}else if(i>=o.viewTo){var s=Mi(t,e,e,-1);s?(o.view=o.view.slice(0,s.index),o.viewTo=s.lineN):Ti(t)}else{var a=Mi(t,e,e,-1),l=Mi(t,i,i+n,1);a&&l?(o.view=o.view.slice(0,a.index).concat(me(t,a.lineN,l.lineN)).concat(o.view.slice(l.index)),o.viewTo+=n):Ti(t)}var c=o.externalMeasured;c&&(i<c.lineN?c.lineN+=n:e<c.lineN+c.size&&(o.externalMeasured=null))}function Ei(t,e,i){t.curOp.viewChanged=!0;var n=t.display,o=t.display.externalMeasured;if(o&&e>=o.lineN&&e<o.lineN+o.size&&(n.externalMeasured=null),!(e<n.viewFrom||e>=n.viewTo)){var r=n.view[Li(t,e)];if(null!=r.node){var s=r.changes||(r.changes=[]);-1==d(s,i)&&s.push(i)}}}function Ti(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function Mi(t,e,i,n){var o,r=Li(t,e),s=t.display.view;if(!ba||i==t.doc.first+t.doc.size)return{index:r,lineN:i};for(var a=t.display.viewFrom,l=0;l<r;l++)a+=s[l].size;if(a!=e){if(n>0){if(r==s.length-1)return null;o=a+s[r].size-e,r++}else o=a-e;e+=o,i+=o}for(;Jt(t.doc,i)!=i;){if(r==(n<0?0:s.length-1))return null;i+=n*s[r-(n<0?1:0)].size,r+=n}return{index:r,lineN:i}}function Ai(t,e,i){var n=t.display;0==n.view.length||e>=n.viewTo||i<=n.viewFrom?(n.view=me(t,e,i),n.viewFrom=e):(n.viewFrom>e?n.view=me(t,e,n.viewFrom).concat(n.view):n.viewFrom<e&&(n.view=n.view.slice(Li(t,e))),n.viewFrom=e,n.viewTo<i?n.view=n.view.concat(me(t,n.viewTo,i)):n.viewTo>i&&(n.view=n.view.slice(0,Li(t,i)))),n.viewTo=i}function Ii(t){for(var e=t.display.view,i=0,n=0;n<e.length;n++){var o=e[n];o.hidden||o.node&&!o.changes||++i}return i}function Oi(t){t.display.input.showSelection(t.display.input.prepareSelection())}function Ri(t,e){void 0===e&&(e=!0);for(var i=t.doc,n={},o=n.cursors=document.createDocumentFragment(),r=n.selection=document.createDocumentFragment(),s=0;s<i.sel.ranges.length;s++)if(e||s!=i.sel.primIndex){var a=i.sel.ranges[s];if(!(a.from().line>=t.display.viewTo||a.to().line<t.display.viewFrom)){var l=a.empty();(l||t.options.showCursorWhenSelecting)&&Di(t,a.head,o),l||Pi(t,a,r)}}return n}function Di(t,e,i){var o=li(t,e,"div",null,null,!t.options.singleCursorHeightPerLine),r=i.appendChild(n("div","\xa0","CodeMirror-cursor"));if(r.style.left=o.left+"px",r.style.top=o.top+"px",r.style.height=Math.max(0,o.bottom-o.top)*t.options.cursorHeight+"px",o.other){var s=i.appendChild(n("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"));s.style.display="",s.style.left=o.other.left+"px",s.style.top=o.other.top+"px",s.style.height=.85*(o.other.bottom-o.other.top)+"px"}}function Bi(t,e){return t.top-e.top||t.left-e.left}function Pi(t,e,i){function o(t,e,i,o){e<0&&(e=0),e=Math.round(e),o=Math.round(o),l.appendChild(n("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px;\n                             top: "+e+"px; width: "+(null==i?u-t:i)+"px;\n                             height: "+(o-e)+"px"))}function r(e,i,n){function r(i,n){return ai(t,at(e,i),"div",p,n)}function s(e,i,n){var o=pi(t,p,null,e),s="ltr"==i==("after"==n)?"left":"right";return r("after"==n?o.begin:o.end-(/\s/.test(p.text.charAt(o.end-1))?2:1),s)[s]}var l,c,p=Q(a,e),f=p.text.length,g=T(p,a.direction);return C(g,i||0,null==n?f:n,function(t,e,a,p){var m="ltr"==a,v=r(t,m?"left":"right"),b=r(e-1,m?"right":"left"),y=null==i&&0==t,S=null==n&&e==f,k=0==p,w=!g||p==g.length-1;if(b.top-v.top<=3){var _=(d?S:y)&&w,x=(d?y:S)&&k?h:(m?v:b).left,L=_?u:(m?b:v).right;o(x,v.top,L-x,v.bottom)}else{var C,E,T,M;m?(C=d&&y&&k?h:v.left,E=d?u:s(t,a,"before"),T=d?h:s(e,a,"after"),M=d&&S&&w?u:b.right):(C=d?s(t,a,"before"):h,E=!d&&y&&k?u:v.right,T=!d&&S&&w?h:b.left,M=d?s(e,a,"after"):u),o(C,v.top,E-C,v.bottom),v.bottom<b.top&&o(h,v.bottom,null,b.top),o(T,b.top,M-T,b.bottom)}(!l||Bi(v,l)<0)&&(l=v),Bi(b,l)<0&&(l=b),(!c||Bi(v,c)<0)&&(c=v),Bi(b,c)<0&&(c=b)}),{start:l,end:c}}var s=t.display,a=t.doc,l=document.createDocumentFragment(),c=ze(t.display),h=c.left,u=Math.max(s.sizerWidth,Fe(t)-s.sizer.offsetLeft)-c.right,d="ltr"==a.direction,p=e.from(),f=e.to();if(p.line==f.line)r(p.line,p.ch,f.ch);else{var g=Q(a,p.line),m=Q(a,f.line),v=Xt(g)==Xt(m),b=r(p.line,p.ch,v?g.text.length+1:null).end,y=r(f.line,v?0:null,f.ch).start;v&&(b.top<y.top-2?(o(b.right,b.top,null,b.bottom),o(h,y.top,y.left,y.bottom)):o(b.right,b.top,y.left-b.right,b.bottom)),b.bottom<y.top&&o(h,b.bottom,null,y.top)}i.appendChild(l)}function Ni(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var i=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){return e.cursorDiv.style.visibility=(i=!i)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function zi(t){t.state.focused||(t.display.input.focus(),Fi(t))}function Vi(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,$i(t))},100)}function Fi(t,e){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(I(t,"focus",t,e),t.state.focused=!0,a(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(t.display.input.reset(),xs&&setTimeout(function(){return t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),Ni(t))}function $i(t,e){t.state.delayingBlurEvent||(t.state.focused&&(I(t,"blur",t,e),t.state.focused=!1,$s(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function Hi(t){for(var e=t.display,i=e.lineDiv.offsetTop,n=0;n<e.view.length;n++){var o=e.view[n],r=t.options.lineWrapping,s=void 0,a=0;if(!o.hidden){if(ws&&_s<8){var l=o.node.offsetTop+o.node.offsetHeight;s=l-i,i=l}else{var c=o.node.getBoundingClientRect();s=c.bottom-c.top,!r&&o.text.firstChild&&(a=o.text.firstChild.getBoundingClientRect().right-c.left-1)}var h=o.line.height-s;if((h>.005||h<-.005)&&(it(o.line,s),Ui(o.line),o.rest))for(var u=0;u<o.rest.length;u++)Ui(o.rest[u]);if(a>t.display.sizerWidth){var d=Math.ceil(a/yi(t.display));d>t.display.maxLineLength&&(t.display.maxLineLength=d,t.display.maxLine=o.line,t.display.maxLineChanged=!0)}}}}function Ui(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e){var i=t.widgets[e],n=i.node.parentNode;n&&(i.height=n.offsetHeight)}}function Wi(t,e,i){var n=i&&null!=i.top?Math.max(0,i.top):t.scroller.scrollTop;n=Math.floor(n-Pe(t));var o=i&&null!=i.bottom?i.bottom:n+t.wrapper.clientHeight,r=ot(e,n),s=ot(e,o);if(i&&i.ensure){var a=i.ensure.from.line,l=i.ensure.to.line;a<r?(r=a,s=ot(e,ie(Q(e,a))+t.wrapper.clientHeight)):Math.min(l,e.lastLine())>=s&&(r=ot(e,ie(Q(e,l))-t.wrapper.clientHeight),s=l)}return{from:r,to:Math.max(s,r+1)}}function ji(t,e){if(!O(t,"scrollCursorIntoView")){var i=t.display,o=i.sizer.getBoundingClientRect(),r=null;if(e.top+o.top<0?r=!0:e.bottom+o.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!As){var s=n("div","\u200b",null,"position: absolute;\n                         top: "+(e.top-i.viewOffset-Pe(t.display))+"px;\n                         height: "+(e.bottom-e.top+Ve(t)+i.barHeight)+"px;\n                         left: "+e.left+"px; width: "+Math.max(2,e.right-e.left)+"px;");t.display.lineSpace.appendChild(s),s.scrollIntoView(r),t.display.lineSpace.removeChild(s)}}}function Gi(t,e,i,n){var o;null==n&&(n=0),t.options.lineWrapping||e!=i||(i="before"==(e=e.ch?at(e.line,"before"==e.sticky?e.ch-1:e.ch,"after"):e).sticky?at(e.line,e.ch+1,"before"):e);for(var r=0;r<5;r++){var s=!1,a=li(t,e),l=i&&i!=e?li(t,i):a,c=Ki(t,o={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-n,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+n}),h=t.doc.scrollTop,u=t.doc.scrollLeft;if(null!=c.scrollTop&&(en(t,c.scrollTop),Math.abs(t.doc.scrollTop-h)>1&&(s=!0)),null!=c.scrollLeft&&(on(t,c.scrollLeft),Math.abs(t.doc.scrollLeft-u)>1&&(s=!0)),!s)break}return o}function qi(t,e){var i=Ki(t,e);null!=i.scrollTop&&en(t,i.scrollTop),null!=i.scrollLeft&&on(t,i.scrollLeft)}function Ki(t,e){var i=t.display,n=bi(t.display);e.top<0&&(e.top=0);var o=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:i.scroller.scrollTop,r=$e(t),s={};e.bottom-e.top>r&&(e.bottom=e.top+r);var a=t.doc.height+Ne(i),l=e.top<n,c=e.bottom>a-n;if(e.top<o)s.scrollTop=l?0:e.top;else if(e.bottom>o+r){var h=Math.min(e.top,(c?a:e.bottom)-r);h!=o&&(s.scrollTop=h)}var u=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:i.scroller.scrollLeft,d=Fe(t)-(t.options.fixedGutter?i.gutters.offsetWidth:0),p=e.right-e.left>d;return p&&(e.right=e.left+d),e.left<10?s.scrollLeft=0:e.left<u?s.scrollLeft=Math.max(0,e.left-(p?0:10)):e.right>d+u-3&&(s.scrollLeft=e.right+(p?0:10)-d),s}function Xi(t,e){null!=e&&(Qi(t),t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+e)}function Yi(t){Qi(t);var e=t.getCursor();t.curOp.scrollToPos={from:e,to:e,margin:t.options.cursorScrollMargin}}function Zi(t,e,i){null==e&&null==i||Qi(t),null!=e&&(t.curOp.scrollLeft=e),null!=i&&(t.curOp.scrollTop=i)}function Ji(t,e){Qi(t),t.curOp.scrollToPos=e}function Qi(t){var e=t.curOp.scrollToPos;e&&(t.curOp.scrollToPos=null,tn(t,ci(t,e.from),ci(t,e.to),e.margin))}function tn(t,e,i,n){var o=Ki(t,{left:Math.min(e.left,i.left),top:Math.min(e.top,i.top)-n,right:Math.max(e.right,i.right),bottom:Math.max(e.bottom,i.bottom)+n});Zi(t,o.scrollLeft,o.scrollTop)}function en(t,e){Math.abs(t.doc.scrollTop-e)<2||(bs||Tn(t,{top:e}),nn(t,e,!0),bs&&Tn(t),kn(t,100))}function nn(t,e,i){e=Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,e),(t.display.scroller.scrollTop!=e||i)&&(t.doc.scrollTop=e,t.display.scrollbars.setScrollTop(e),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e))}function on(t,e,i,n){e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),(i?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)&&!n||(t.doc.scrollLeft=e,On(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbars.setScrollLeft(e))}function rn(t){var e=t.display,i=e.gutters.offsetWidth,n=Math.round(t.doc.height+Ne(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?i:0,docHeight:n,scrollHeight:n+Ve(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:i}}function sn(t,e){e||(e=rn(t));var i=t.display.barWidth,n=t.display.barHeight;an(t,e);for(var o=0;o<4&&i!=t.display.barWidth||n!=t.display.barHeight;o++)i!=t.display.barWidth&&t.options.lineWrapping&&Hi(t),an(t,rn(t)),i=t.display.barWidth,n=t.display.barHeight}function an(t,e){var i=t.display,n=i.scrollbars.update(e);i.sizer.style.paddingRight=(i.barWidth=n.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=n.bottom)+"px",i.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=n.bottom+"px",i.scrollbarFiller.style.width=n.right+"px"):i.scrollbarFiller.style.display="",n.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n.bottom+"px",i.gutterFiller.style.width=e.gutterWidth+"px"):i.gutterFiller.style.display=""}function ln(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&$s(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new Ta[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),oa(e,"mousedown",function(){t.state.focused&&setTimeout(function(){return t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,i){"horizontal"==i?on(t,e):en(t,e)},t),t.display.scrollbars.addClass&&a(t.display.wrapper,t.display.scrollbars.addClass)}function cn(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Ma},ve(t.curOp)}function hn(t){var e=t.curOp;e&&ye(e,function(t){for(var e=0;e<t.ops.length;e++)t.ops[e].cm.curOp=null;un(t)})}function un(t){for(var e=t.ops,i=0;i<e.length;i++)dn(e[i]);for(var n=0;n<e.length;n++)pn(e[n]);for(var o=0;o<e.length;o++)fn(e[o]);for(var r=0;r<e.length;r++)gn(e[r]);for(var s=0;s<e.length;s++)mn(e[s])}function dn(t){var e=t.cm,i=e.display;_n(e),t.updateMaxLine&&oe(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<i.viewFrom||t.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new Aa(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function pn(t){t.updatedDisplay=t.mustUpdate&&Cn(t.cm,t.update)}function fn(t){var e=t.cm,i=e.display;t.updatedDisplay&&Hi(e),t.barMeasure=rn(e),i.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=je(e,i.maxLine,i.maxLine.text.length).left+3,e.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+t.adjustWidthTo+Ve(e)+e.display.barWidth),t.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+t.adjustWidthTo-Fe(e))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=i.input.prepareSelection())}function gn(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&on(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1);var i=t.focus&&t.focus==s();t.preparedSelection&&e.display.input.showSelection(t.preparedSelection,i),(t.updatedDisplay||t.startHeight!=e.doc.height)&&sn(e,t.barMeasure),t.updatedDisplay&&In(e,t.barMeasure),t.selectionChanged&&Ni(e),e.state.focused&&t.updateInput&&e.display.input.reset(t.typing),i&&zi(t.cm)}function mn(t){var e=t.cm,i=e.display,n=e.doc;(t.updatedDisplay&&En(e,t.update),null==i.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(i.wheelStartX=i.wheelStartY=null),null!=t.scrollTop&&nn(e,t.scrollTop,t.forceScroll),null!=t.scrollLeft&&on(e,t.scrollLeft,!0,!0),t.scrollToPos)&&ji(e,Gi(e,ft(n,t.scrollToPos.from),ft(n,t.scrollToPos.to),t.scrollToPos.margin));var o=t.maybeHiddenMarkers,r=t.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||I(o[s],"hide");if(r)for(var a=0;a<r.length;++a)r[a].lines.length&&I(r[a],"unhide");i.wrapper.offsetHeight&&(n.scrollTop=e.display.scroller.scrollTop),t.changeObjs&&I(e,"changes",e,t.changeObjs),t.update&&t.update.finish()}function vn(t,e){if(t.curOp)return e();cn(t);try{return e()}finally{hn(t)}}function bn(t,e){return function(){if(t.curOp)return e.apply(t,arguments);cn(t);try{return e.apply(t,arguments)}finally{hn(t)}}}function yn(t){return function(){if(this.curOp)return t.apply(this,arguments);cn(this);try{return t.apply(this,arguments)}finally{hn(this)}}}function Sn(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);cn(e);try{return t.apply(this,arguments)}finally{hn(e)}}}function kn(t,e){t.doc.highlightFrontier<t.display.viewTo&&t.state.highlight.set(e,c(wn,t))}function wn(t){var e=t.doc;if(!(e.highlightFrontier>=t.display.viewTo)){var i=+new Date+t.options.workTime,n=yt(t,e.highlightFrontier),o=[];e.iter(n.line,Math.min(e.first+e.size,t.display.viewTo+500),function(r){if(n.line>=t.display.viewFrom){var s=r.styles,a=r.text.length>t.options.maxHighlightLength?Y(e.mode,n.state):null,l=vt(t,r,n,!0);a&&(n.state=a),r.styles=l.styles;var c=r.styleClasses,h=l.classes;h?r.styleClasses=h:c&&(r.styleClasses=null);for(var u=!s||s.length!=r.styles.length||c!=h&&(!c||!h||c.bgClass!=h.bgClass||c.textClass!=h.textClass),d=0;!u&&d<s.length;++d)u=s[d]!=r.styles[d];u&&o.push(n.line),r.stateAfter=n.save(),n.nextLine()}else r.text.length<=t.options.maxHighlightLength&&St(t,r.text,n),r.stateAfter=n.line%5==0?n.save():null,n.nextLine();if(+new Date>i)return kn(t,t.options.workDelay),!0}),e.highlightFrontier=n.line,e.modeFrontier=Math.max(e.modeFrontier,n.line),o.length&&vn(t,function(){for(var e=0;e<o.length;e++)Ei(t,o[e],"text")})}}function _n(t){var e=t.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=Ve(t)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=Ve(t)+"px",e.scrollbarsClipped=!0)}function xn(t){if(t.hasFocus())return null;var e=s();if(!e||!r(t.display.lineDiv,e))return null;var i={activeElt:e};if(window.getSelection){var n=window.getSelection();n.anchorNode&&n.extend&&r(t.display.lineDiv,n.anchorNode)&&(i.anchorNode=n.anchorNode,i.anchorOffset=n.anchorOffset,i.focusNode=n.focusNode,i.focusOffset=n.focusOffset)}return i}function Ln(t){if(t&&t.activeElt&&t.activeElt!=s()&&(t.activeElt.focus(),t.anchorNode&&r(document.body,t.anchorNode)&&r(document.body,t.focusNode))){var e=window.getSelection(),i=document.createRange();i.setEnd(t.anchorNode,t.anchorOffset),i.collapse(!1),e.removeAllRanges(),e.addRange(i),e.extend(t.focusNode,t.focusOffset)}}function Cn(t,i){var n=t.display,o=t.doc;if(i.editorIsHidden)return Ti(t),!1;if(!i.force&&i.visible.from>=n.viewFrom&&i.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==Ii(t))return!1;Rn(t)&&(Ti(t),i.dims=Si(t));var r=o.first+o.size,s=Math.max(i.visible.from-t.options.viewportMargin,o.first),a=Math.min(r,i.visible.to+t.options.viewportMargin);n.viewFrom<s&&s-n.viewFrom<20&&(s=Math.max(o.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(r,n.viewTo)),ba&&(s=Jt(t.doc,s),a=Qt(t.doc,a));var l=s!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=i.wrapperHeight||n.lastWrapWidth!=i.wrapperWidth;Ai(t,s,a),n.viewOffset=ie(Q(t.doc,n.viewFrom)),t.display.mover.style.top=n.viewOffset+"px";var c=Ii(t);if(!l&&0==c&&!i.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var h=xn(t);return c>4&&(n.lineDiv.style.display="none"),Mn(t,n.updateLineNumbers,i.dims),c>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,Ln(h),e(n.cursorDiv),e(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,l&&(n.lastWrapHeight=i.wrapperHeight,n.lastWrapWidth=i.wrapperWidth,kn(t,400)),n.updateLineNumbers=null,!0}function En(t,e){for(var i=e.viewport,n=!0;(n&&t.options.lineWrapping&&e.oldDisplayWidth!=Fe(t)||(i&&null!=i.top&&(i={top:Math.min(t.doc.height+Ne(t.display)-$e(t),i.top)}),e.visible=Wi(t.display,t.doc,i),!(e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)))&&Cn(t,e);n=!1){Hi(t);var o=rn(t);Oi(t),sn(t,o),In(t,o),e.force=!1}e.signal(t,"update",t),t.display.viewFrom==t.display.reportedViewFrom&&t.display.viewTo==t.display.reportedViewTo||(e.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function Tn(t,e){var i=new Aa(t,e);if(Cn(t,i)){Hi(t),En(t,i);var n=rn(t);Oi(t),sn(t,n),In(t,n),i.finish()}}function Mn(t,i,n){function o(e){var i=e.nextSibling;return xs&&Ds&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),i}for(var r=t.display,s=t.options.lineNumbers,a=r.lineDiv,l=a.firstChild,c=r.view,h=r.viewFrom,u=0;u<c.length;u++){var p=c[u];if(p.hidden);else if(p.node&&p.node.parentNode==a){for(;l!=p.node;)l=o(l);var f=s&&null!=i&&i<=h&&p.lineNumber;p.changes&&(d(p.changes,"gutter")>-1&&(f=!1),we(t,p,h,n)),f&&(e(p.lineNumber),p.lineNumber.appendChild(document.createTextNode(st(t.options,h)))),l=p.node.nextSibling}else{var g=Ae(t,p,h,n);a.insertBefore(g,l)}h+=p.size}for(;l;)l=o(l)}function An(t){var e=t.gutters.offsetWidth;t.sizer.style.marginLeft=e+"px"}function In(t,e){t.display.sizer.style.minHeight=e.docHeight+"px",t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=e.docHeight+t.display.barHeight+Ve(t)+"px"}function On(t){var e=t.display,i=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var n=ki(e)-e.scroller.scrollLeft+t.doc.scrollLeft,o=e.gutters.offsetWidth,r=n+"px",s=0;s<i.length;s++)if(!i[s].hidden){t.options.fixedGutter&&(i[s].gutter&&(i[s].gutter.style.left=r),i[s].gutterBackground&&(i[s].gutterBackground.style.left=r));var a=i[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=r}t.options.fixedGutter&&(e.gutters.style.left=n+o+"px")}}function Rn(t){if(!t.options.lineNumbers)return!1;var e=t.doc,i=st(t.options,e.first+e.size-1),o=t.display;if(i.length!=o.lineNumChars){var r=o.measure.appendChild(n("div",[n("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=r.firstChild.offsetWidth,a=r.offsetWidth-s;return o.lineGutter.style.width="",o.lineNumInnerWidth=Math.max(s,o.lineGutter.offsetWidth-a)+1,o.lineNumWidth=o.lineNumInnerWidth+a,o.lineNumChars=o.lineNumInnerWidth?i.length:-1,o.lineGutter.style.width=o.lineNumWidth+"px",An(t.display),!0}return!1}function Dn(t,e){for(var i=[],n=!1,o=0;o<t.length;o++){var r=t[o],s=null;if("string"!=typeof r&&(s=r.style,r=r.className),"CodeMirror-linenumbers"==r){if(!e)continue;n=!0}i.push({className:r,style:s})}return e&&!n&&i.push({className:"CodeMirror-linenumbers",style:null}),i}function Bn(t){var i=t.gutters,o=t.gutterSpecs;e(i),t.lineGutter=null;for(var r=0;r<o.length;++r){var s=o[r],a=s.className,l=s.style,c=i.appendChild(n("div",null,"CodeMirror-gutter "+a));l&&(c.style.cssText=l),"CodeMirror-linenumbers"==a&&(t.lineGutter=c,c.style.width=(t.lineNumWidth||1)+"px")}i.style.display=o.length?"":"none",An(t)}function Pn(t){Bn(t.display),Ci(t),On(t)}function Nn(t,e,i,r){var s=this;this.input=i,s.scrollbarFiller=n("div",null,"CodeMirror-scrollbar-filler"),s.scrollbarFiller.setAttribute("cm-not-content","true"),s.gutterFiller=n("div",null,"CodeMirror-gutter-filler"),s.gutterFiller.setAttribute("cm-not-content","true"),s.lineDiv=o("div",null,"CodeMirror-code"),s.selectionDiv=n("div",null,null,"position: relative; z-index: 1"),s.cursorDiv=n("div",null,"CodeMirror-cursors"),s.measure=n("div",null,"CodeMirror-measure"),s.lineMeasure=n("div",null,"CodeMirror-measure"),s.lineSpace=o("div",[s.measure,s.lineMeasure,s.selectionDiv,s.cursorDiv,s.lineDiv],null,"position: relative; outline: none");var a=o("div",[s.lineSpace],"CodeMirror-lines");s.mover=n("div",[a],null,"position: relative"),s.sizer=n("div",[s.mover],"CodeMirror-sizer"),s.sizerWidth=null,s.heightForcer=n("div",null,null,"position: absolute; height: "+qs+"px; width: 1px;"),s.gutters=n("div",null,"CodeMirror-gutters"),s.lineGutter=null,s.scroller=n("div",[s.sizer,s.heightForcer,s.gutters],"CodeMirror-scroll"),s.scroller.setAttribute("tabIndex","-1"),s.wrapper=n("div",[s.scrollbarFiller,s.gutterFiller,s.scroller],"CodeMirror"),ws&&_s<8&&(s.gutters.style.zIndex=-1,s.scroller.style.paddingRight=0),xs||bs&&Rs||(s.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(s.wrapper):t(s.wrapper)),s.viewFrom=s.viewTo=e.first,s.reportedViewFrom=s.reportedViewTo=e.first,s.view=[],s.renderedView=null,s.externalMeasured=null,s.viewOffset=0,s.lastWrapHeight=s.lastWrapWidth=0,s.updateLineNumbers=null,s.nativeBarWidth=s.barHeight=s.barWidth=0,s.scrollbarsClipped=!1,s.lineNumWidth=s.lineNumInnerWidth=s.lineNumChars=null,s.alignWidgets=!1,s.cachedCharWidth=s.cachedTextHeight=s.cachedPaddingH=null,s.maxLine=null,s.maxLineLength=0,s.maxLineChanged=!1,s.wheelDX=s.wheelDY=s.wheelStartX=s.wheelStartY=null,s.shift=!1,s.selForContextMenu=null,s.activeTouch=null,s.gutterSpecs=Dn(r.gutters,r.lineNumbers),Bn(s),i.init(s)}function zn(t){var e=t.wheelDeltaX,i=t.wheelDeltaY;return null==e&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(e=t.detail),null==i&&t.detail&&t.axis==t.VERTICAL_AXIS?i=t.detail:null==i&&(i=t.wheelDelta),{x:e,y:i}}function Vn(t){var e=zn(t);return e.x*=Oa,e.y*=Oa,e}function Fn(t,e){var i=zn(e),n=i.x,o=i.y,r=t.display,s=r.scroller,a=s.scrollWidth>s.clientWidth,l=s.scrollHeight>s.clientHeight;if(n&&a||o&&l){if(o&&Ds&&xs)t:for(var c=e.target,h=r.view;c!=s;c=c.parentNode)for(var u=0;u<h.length;u++)if(h[u].node==c){t.display.currentWheelTarget=c;break t}if(n&&!bs&&!Es&&null!=Oa)return o&&l&&en(t,Math.max(0,s.scrollTop+o*Oa)),on(t,Math.max(0,s.scrollLeft+n*Oa)),(!o||o&&l)&&P(e),void(r.wheelStartX=null);if(o&&null!=Oa){var d=o*Oa,p=t.doc.scrollTop,f=p+r.wrapper.clientHeight;d<0?p=Math.max(0,p+d-50):f=Math.min(t.doc.height,f+d+50),Tn(t,{top:p,bottom:f})}Ia<20&&(null==r.wheelStartX?(r.wheelStartX=s.scrollLeft,r.wheelStartY=s.scrollTop,r.wheelDX=n,r.wheelDY=o,setTimeout(function(){if(null!=r.wheelStartX){var t=s.scrollLeft-r.wheelStartX,e=s.scrollTop-r.wheelStartY,i=e&&r.wheelDY&&e/r.wheelDY||t&&r.wheelDX&&t/r.wheelDX;r.wheelStartX=r.wheelStartY=null,i&&(Oa=(Oa*Ia+i)/(Ia+1),++Ia)}},200)):(r.wheelDX+=n,r.wheelDY+=o))}}function $n(t,e,i){var n=t&&t.options.selectionsMayTouch,o=e[i];e.sort(function(t,e){return lt(t.from(),e.from())}),i=d(e,o);for(var r=1;r<e.length;r++){var s=e[r],a=e[r-1],l=lt(a.to(),s.from());if(n&&!s.empty()?l>0:l>=0){var c=dt(a.from(),s.from()),h=ut(a.to(),s.to()),u=a.empty()?s.from()==s.head:a.from()==a.head;r<=i&&--i,e.splice(--r,2,new Da(u?h:c,u?c:h))}}return new Ra(e,i)}function Hn(t,e){return new Ra([new Da(t,e||t)],0)}function Un(t){return t.text?at(t.from.line+t.text.length-1,g(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function Wn(t,e){if(lt(t,e.from)<0)return t;if(lt(t,e.to)<=0)return Un(e);var i=t.line+e.text.length-(e.to.line-e.from.line)-1,n=t.ch;return t.line==e.to.line&&(n+=Un(e).ch-e.to.ch),at(i,n)}function jn(t,e){for(var i=[],n=0;n<t.sel.ranges.length;n++){var o=t.sel.ranges[n];i.push(new Da(Wn(o.anchor,e),Wn(o.head,e)))}return $n(t.cm,i,t.sel.primIndex)}function Gn(t,e,i){return t.line==e.line?at(i.line,t.ch-e.ch+i.ch):at(i.line+(t.line-e.line),t.ch)}function qn(t,e,i){for(var n=[],o=at(t.first,0),r=o,s=0;s<e.length;s++){var a=e[s],l=Gn(a.from,o,r),c=Gn(Un(a),o,r);if(o=a.to,r=c,"around"==i){var h=t.sel.ranges[s],u=lt(h.head,h.anchor)<0;n[s]=new Da(u?c:l,u?l:c)}else n[s]=new Da(l,l)}return new Ra(n,t.sel.primIndex)}function Kn(t){t.doc.mode=K(t.options,t.doc.modeOption),Xn(t)}function Xn(t){t.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,kn(t,100),t.state.modeGen++,t.curOp&&Ci(t)}function Yn(t,e){return 0==e.from.ch&&0==e.to.ch&&""==g(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function Zn(t,e,i,n){function o(t){return i?i[t]:null}function r(t,i,o){re(t,i,o,n),Se(t,"change",t,e)}function s(t,e){for(var i=[],r=t;r<e;++r)i.push(new ya(c[r],o(r),n));return i}var a=e.from,l=e.to,c=e.text,h=Q(t,a.line),u=Q(t,l.line),d=g(c),p=o(c.length-1),f=l.line-a.line;if(e.full)t.insert(0,s(0,c.length)),
t.remove(c.length,t.size-c.length);else if(Yn(t,e)){var m=s(0,c.length-1);r(u,u.text,p),f&&t.remove(a.line,f),m.length&&t.insert(a.line,m)}else if(h==u)if(1==c.length)r(h,h.text.slice(0,a.ch)+d+h.text.slice(l.ch),p);else{var v=s(1,c.length-1);v.push(new ya(d+h.text.slice(l.ch),p,n)),r(h,h.text.slice(0,a.ch)+c[0],o(0)),t.insert(a.line+1,v)}else if(1==c.length)r(h,h.text.slice(0,a.ch)+c[0]+u.text.slice(l.ch),o(0)),t.remove(a.line+1,f);else{r(h,h.text.slice(0,a.ch)+c[0],o(0)),r(u,d+u.text.slice(l.ch),p);var b=s(1,c.length-1);f>1&&t.remove(a.line+1,f-1),t.insert(a.line+1,b)}Se(t,"change",t,e)}function Jn(t,e,i){function n(t,o,r){if(t.linked)for(var s=0;s<t.linked.length;++s){var a=t.linked[s];if(a.doc!=o){var l=r&&a.sharedHist;i&&!l||(e(a.doc,l),n(a.doc,t,l))}}}n(t,null,!0)}function Qn(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,_i(t),Kn(t),to(t),t.options.lineWrapping||oe(t),t.options.mode=e.modeOption,Ci(t)}function to(t){("rtl"==t.doc.direction?a:$s)(t.display.lineDiv,"CodeMirror-rtl")}function eo(t){vn(t,function(){to(t),Ci(t)})}function io(t){this.done=[],this.undone=[],this.undoDepth=Infinity,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function no(t,e){var i={from:ht(e.from),to:Un(e),text:tt(t,e.from,e.to)};return ho(t,i,e.from.line,e.to.line+1),Jn(t,function(t){return ho(t,i,e.from.line,e.to.line+1)},!0),i}function oo(t){for(;t.length;){if(!g(t).ranges)break;t.pop()}}function ro(t,e){return e?(oo(t.done),g(t.done)):t.done.length&&!g(t.done).ranges?g(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),g(t.done)):void 0}function so(t,e,i,n){var o=t.history;o.undone.length=0;var r,s,a=+new Date;if((o.lastOp==n||o.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&o.lastModTime>a-(t.cm?t.cm.options.historyEventDelay:500)||"*"==e.origin.charAt(0)))&&(r=ro(o,o.lastOp==n)))s=g(r.changes),0==lt(e.from,e.to)&&0==lt(e.from,s.to)?s.to=Un(e):r.changes.push(no(t,e));else{var l=g(o.done);for(l&&l.ranges||co(t.sel,o.done),r={changes:[no(t,e)],generation:o.generation},o.done.push(r);o.done.length>o.undoDepth;)o.done.shift(),o.done[0].ranges||o.done.shift()}o.done.push(i),o.generation=++o.maxGeneration,o.lastModTime=o.lastSelTime=a,o.lastOp=o.lastSelOp=n,o.lastOrigin=o.lastSelOrigin=e.origin,s||I(t,"historyAdded")}function ao(t,e,i,n){var o=e.charAt(0);return"*"==o||"+"==o&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}function lo(t,e,i,n){var o=t.history,r=n&&n.origin;i==o.lastSelOp||r&&o.lastSelOrigin==r&&(o.lastModTime==o.lastSelTime&&o.lastOrigin==r||ao(t,r,g(o.done),e))?o.done[o.done.length-1]=e:co(e,o.done),o.lastSelTime=+new Date,o.lastSelOrigin=r,o.lastSelOp=i,n&&!1!==n.clearRedo&&oo(o.undone)}function co(t,e){var i=g(e);i&&i.ranges&&i.equals(t)||e.push(t)}function ho(t,e,i,n){var o=e["spans_"+t.id],r=0;t.iter(Math.max(t.first,i),Math.min(t.first+t.size,n),function(i){i.markedSpans&&((o||(o=e["spans_"+t.id]={}))[r]=i.markedSpans),++r})}function uo(t){if(!t)return null;for(var e,i=0;i<t.length;++i)t[i].marker.explicitlyCleared?e||(e=t.slice(0,i)):e&&e.push(t[i]);return e?e.length?e:null:t}function po(t,e){var i=e["spans_"+t.id];if(!i)return null;for(var n=[],o=0;o<e.text.length;++o)n.push(uo(i[o]));return n}function fo(t,e){var i=po(t,e),n=Pt(t,e);if(!i)return n;if(!n)return i;for(var o=0;o<i.length;++o){var r=i[o],s=n[o];if(r&&s)t:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<r.length;++c)if(r[c].marker==l.marker)continue t;r.push(l)}else s&&(i[o]=s)}return i}function go(t,e,i){for(var n=[],o=0;o<t.length;++o){var r=t[o];if(r.ranges)n.push(i?Ra.prototype.deepCopy.call(r):r);else{var s=r.changes,a=[];n.push({changes:a});for(var l=0;l<s.length;++l){var c=s[l],h=void 0;if(a.push({from:c.from,to:c.to,text:c.text}),e)for(var u in c)(h=u.match(/^spans_(\d+)$/))&&d(e,Number(h[1]))>-1&&(g(a)[u]=c[u],delete c[u])}}}return n}function mo(t,e,i,n){if(n){var o=t.anchor;if(i){var r=lt(e,o)<0;r!=lt(i,o)<0?(o=e,e=i):r!=lt(e,i)<0&&(e=i)}return new Da(o,e)}return new Da(i||e,e)}function vo(t,e,i,n,o){null==o&&(o=t.cm&&(t.cm.display.shift||t.extend)),_o(t,new Ra([mo(t.sel.primary(),e,i,o)],0),n)}function bo(t,e,i){for(var n=[],o=t.cm&&(t.cm.display.shift||t.extend),r=0;r<t.sel.ranges.length;r++)n[r]=mo(t.sel.ranges[r],e[r],null,o);_o(t,$n(t.cm,n,t.sel.primIndex),i)}function yo(t,e,i,n){var o=t.sel.ranges.slice(0);o[e]=i,_o(t,$n(t.cm,o,t.sel.primIndex),n)}function So(t,e,i,n){_o(t,Hn(e,i),n)}function ko(t,e,i){var n={ranges:e.ranges,update:function(e){this.ranges=[];for(var i=0;i<e.length;i++)this.ranges[i]=new Da(ft(t,e[i].anchor),ft(t,e[i].head))},origin:i&&i.origin};return I(t,"beforeSelectionChange",t,n),t.cm&&I(t.cm,"beforeSelectionChange",t.cm,n),n.ranges!=e.ranges?$n(t.cm,n.ranges,n.ranges.length-1):e}function wo(t,e,i){var n=t.history.done,o=g(n);o&&o.ranges?(n[n.length-1]=e,xo(t,e,i)):_o(t,e,i)}function _o(t,e,i){xo(t,e,i),lo(t,t.sel,t.cm?t.cm.curOp.id:NaN,i)}function xo(t,e,i){(D(t,"beforeSelectionChange")||t.cm&&D(t.cm,"beforeSelectionChange"))&&(e=ko(t,e,i)),Lo(t,Eo(t,e,i&&i.bias||(lt(e.primary().head,t.sel.primary().head)<0?-1:1),!0)),i&&!1===i.scroll||!t.cm||Yi(t.cm)}function Lo(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,R(t.cm)),Se(t,"cursorActivity",t))}function Co(t){Lo(t,Eo(t,t.sel,null,!1))}function Eo(t,e,i,n){for(var o,r=0;r<e.ranges.length;r++){var s=e.ranges[r],a=e.ranges.length==t.sel.ranges.length&&t.sel.ranges[r],l=Mo(t,s.anchor,a&&a.anchor,i,n),c=Mo(t,s.head,a&&a.head,i,n);(o||l!=s.anchor||c!=s.head)&&(o||(o=e.ranges.slice(0,r)),o[r]=new Da(l,c))}return o?$n(t.cm,o,e.primIndex):e}function To(t,e,i,n,o){var r=Q(t,e.line);if(r.markedSpans)for(var s=0;s<r.markedSpans.length;++s){var a=r.markedSpans[s],l=a.marker,c="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,h="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==a.from||(c?a.from<=e.ch:a.from<e.ch))&&(null==a.to||(h?a.to>=e.ch:a.to>e.ch))){if(o&&(I(l,"beforeCursorEnter"),l.explicitlyCleared)){if(r.markedSpans){--s;continue}break}if(!l.atomic)continue;if(i){var u=l.find(n<0?1:-1),d=void 0;if((n<0?h:c)&&(u=Ao(t,u,-n,u&&u.line==e.line?r:null)),u&&u.line==e.line&&(d=lt(u,i))&&(n<0?d<0:d>0))return To(t,u,e,n,o)}var p=l.find(n<0?-1:1);return(n<0?c:h)&&(p=Ao(t,p,n,p.line==e.line?r:null)),p?To(t,p,e,n,o):null}}return e}function Mo(t,e,i,n,o){var r=n||1,s=To(t,e,i,r,o)||!o&&To(t,e,i,r,!0)||To(t,e,i,-r,o)||!o&&To(t,e,i,-r,!0);return s||(t.cantEdit=!0,at(t.first,0))}function Ao(t,e,i,n){return i<0&&0==e.ch?e.line>t.first?ft(t,at(e.line-1)):null:i>0&&e.ch==(n||Q(t,e.line)).text.length?e.line<t.first+t.size-1?at(e.line+1,0):null:new at(e.line,e.ch+i)}function Io(t){t.setSelection(at(t.firstLine(),0),at(t.lastLine()),Xs)}function Oo(t,e,i){var n={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return n.canceled=!0}};return i&&(n.update=function(e,i,o,r){e&&(n.from=ft(t,e)),i&&(n.to=ft(t,i)),o&&(n.text=o),r!==undefined&&(n.origin=r)}),I(t,"beforeChange",t,n),t.cm&&I(t.cm,"beforeChange",t.cm,n),n.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Ro(t,e,i){if(t.cm){if(!t.cm.curOp)return bn(t.cm,Ro)(t,e,i);if(t.cm.state.suppressEdits)return}if(!(D(t,"beforeChange")||t.cm&&D(t.cm,"beforeChange"))||(e=Oo(t,e,!0))){var n=va&&!i&&zt(t,e.from,e.to);if(n)for(var o=n.length-1;o>=0;--o)Do(t,{from:n[o].from,to:n[o].to,text:o?[""]:e.text,origin:e.origin});else Do(t,e)}}function Do(t,e){if(1!=e.text.length||""!=e.text[0]||0!=lt(e.from,e.to)){var i=jn(t,e);so(t,e,i,t.cm?t.cm.curOp.id:NaN),No(t,e,i,Pt(t,e));var n=[];Jn(t,function(t,i){i||-1!=d(n,t.history)||(Ho(t.history,e),n.push(t.history)),No(t,e,null,Pt(t,e))})}}function Bo(t,e,i){var n=t.cm&&t.cm.state.suppressEdits;if(!n||i){for(var o,r=t.history,s=t.sel,a="undo"==e?r.done:r.undone,l="undo"==e?r.undone:r.done,c=0;c<a.length&&(o=a[c],i?!o.ranges||o.equals(t.sel):o.ranges);c++);if(c!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;;){if(!(o=a.pop()).ranges){if(n)return void a.push(o);break}if(co(o,l),i&&!o.equals(t.sel))return void _o(t,o,{clearRedo:!1});s=o}var h=[];co(s,l),l.push({changes:h,generation:r.generation}),r.generation=o.generation||++r.maxGeneration;for(var u=D(t,"beforeChange")||t.cm&&D(t.cm,"beforeChange"),p=function(i){var n=o.changes[i];if(n.origin=e,u&&!Oo(t,n,!1))return a.length=0,{};h.push(no(t,n));var r=i?jn(t,n):g(a);No(t,n,r,fo(t,n)),!i&&t.cm&&t.cm.scrollIntoView({from:n.from,to:Un(n)});var s=[];Jn(t,function(t,e){e||-1!=d(s,t.history)||(Ho(t.history,n),s.push(t.history)),No(t,n,null,fo(t,n))})},f=o.changes.length-1;f>=0;--f){var m=p(f);if(m)return m.v}}}}function Po(t,e){if(0!=e&&(t.first+=e,t.sel=new Ra(m(t.sel.ranges,function(t){return new Da(at(t.anchor.line+e,t.anchor.ch),at(t.head.line+e,t.head.ch))}),t.sel.primIndex),t.cm)){Ci(t.cm,t.first,t.first-e,e);for(var i=t.cm.display,n=i.viewFrom;n<i.viewTo;n++)Ei(t.cm,n,"gutter")}}function No(t,e,i,n){if(t.cm&&!t.cm.curOp)return bn(t.cm,No)(t,e,i,n);if(e.to.line<t.first)Po(t,e.text.length-1-(e.to.line-e.from.line));else if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var o=e.text.length-1-(t.first-e.from.line);Po(t,o),e={from:at(t.first,0),to:at(e.to.line+o,e.to.ch),text:[g(e.text)],origin:e.origin}}var r=t.lastLine();e.to.line>r&&(e={from:e.from,to:at(r,Q(t,r).text.length),text:[e.text[0]],origin:e.origin}),e.removed=tt(t,e.from,e.to),i||(i=jn(t,e)),t.cm?zo(t.cm,e,n):Zn(t,e,n),xo(t,i,Xs),t.cantEdit&&Mo(t,at(t.firstLine(),0))&&(t.cantEdit=!1)}}function zo(t,e,i){var n=t.doc,o=t.display,r=e.from,s=e.to,a=!1,l=r.line;t.options.lineWrapping||(l=nt(Xt(Q(n,r.line))),n.iter(l,s.line+1,function(t){if(t==o.maxLine)return a=!0,!0})),n.sel.contains(e.from,e.to)>-1&&R(t),Zn(n,e,i,wi(t)),t.options.lineWrapping||(n.iter(l,r.line+e.text.length,function(t){var e=ne(t);e>o.maxLineLength&&(o.maxLine=t,o.maxLineLength=e,o.maxLineChanged=!0,a=!1)}),a&&(t.curOp.updateMaxLine=!0)),Et(n,r.line),kn(t,400);var c=e.text.length-(s.line-r.line)-1;e.full?Ci(t):r.line!=s.line||1!=e.text.length||Yn(t.doc,e)?Ci(t,r.line,s.line+1,c):Ei(t,r.line,"text");var h=D(t,"changes"),u=D(t,"change");if(u||h){var d={from:r,to:s,text:e.text,removed:e.removed,origin:e.origin};u&&Se(t,"change",t,d),h&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(d)}t.display.selForContextMenu=null}function Vo(t,e,i,n,o){var r;n||(n=i),lt(n,i)<0&&(i=(r=[n,i])[0],n=r[1]),"string"==typeof e&&(e=t.splitLines(e)),Ro(t,{from:i,to:n,text:e,origin:o})}function Fo(t,e,i,n){i<t.line?t.line+=n:e<t.line&&(t.line=e,t.ch=0)}function $o(t,e,i,n){for(var o=0;o<t.length;++o){var r=t[o],s=!0;if(r.ranges){r.copied||((r=t[o]=r.deepCopy()).copied=!0);for(var a=0;a<r.ranges.length;a++)Fo(r.ranges[a].anchor,e,i,n),Fo(r.ranges[a].head,e,i,n)}else{for(var l=0;l<r.changes.length;++l){var c=r.changes[l];if(i<c.from.line)c.from=at(c.from.line+n,c.from.ch),c.to=at(c.to.line+n,c.to.ch);else if(e<=c.to.line){s=!1;break}}s||(t.splice(0,o+1),o=0)}}}function Ho(t,e){var i=e.from.line,n=e.to.line,o=e.text.length-(n-i)-1;$o(t.done,i,n,o),$o(t.undone,i,n,o)}function Uo(t,e,i,n){var o=e,r=e;return"number"==typeof e?r=Q(t,pt(t,e)):o=nt(e),null==o?null:(n(r,o)&&t.cm&&Ei(t.cm,o,i),r)}function Wo(t){this.lines=t,this.parent=null;for(var e=0,i=0;i<t.length;++i)t[i].parent=this,e+=t[i].height;this.height=e}function jo(t){this.children=t;for(var e=0,i=0,n=0;n<t.length;++n){var o=t[n];e+=o.chunkSize(),i+=o.height,o.parent=this}this.size=e,this.height=i,this.parent=null}function Go(t,e,i){ie(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&Xi(t,i)}function qo(t,e,i,n){var o=new Ba(t,i,n),r=t.cm;return r&&o.noHScroll&&(r.display.alignWidgets=!0),Uo(t,e,"widget",function(e){var i=e.widgets||(e.widgets=[]);if(null==o.insertAt?i.push(o):i.splice(Math.min(i.length-1,Math.max(0,o.insertAt)),0,o),o.line=e,r&&!te(t,e)){var n=ie(e)<t.scrollTop;it(e,e.height+De(o)),n&&Xi(r,o.height),r.curOp.forceUpdate=!0}return!0}),r&&Se(r,"lineWidgetAdded",r,o,"number"==typeof e?e:nt(e)),o}function Ko(t,e,i,n,r){if(n&&n.shared)return Xo(t,e,i,n,r);if(t.cm&&!t.cm.curOp)return bn(t.cm,Ko)(t,e,i,n,r);var s=new Na(t,r),a=lt(e,i);if(n&&h(n,s,!1),a>0||0==a&&!1!==s.clearWhenEmpty)return s;if(s.replacedWith&&(s.collapsed=!0,s.widgetNode=o("span",[s.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||s.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(s.widgetNode.insertLeft=!0)),s.collapsed){if(Kt(t,e.line,e,i,s)||e.line!=i.line&&Kt(t,i.line,e,i,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");Mt()}s.addToHistory&&so(t,{from:e,to:i,origin:"markText"},t.sel,NaN);var l,c=e.line,u=t.cm;if(t.iter(c,i.line+1,function(t){u&&s.collapsed&&!u.options.lineWrapping&&Xt(t)==u.display.maxLine&&(l=!0),s.collapsed&&c!=e.line&&it(t,0),Rt(t,new At(s,c==e.line?e.ch:null,c==i.line?i.ch:null)),++c}),s.collapsed&&t.iter(e.line,i.line+1,function(e){te(t,e)&&it(e,0)}),s.clearOnEnter&&oa(s,"beforeCursorEnter",function(){return s.clear()}),s.readOnly&&(Tt(),(t.history.done.length||t.history.undone.length)&&t.clearHistory()),s.collapsed&&(s.id=++Pa,s.atomic=!0),u){if(l&&(u.curOp.updateMaxLine=!0),s.collapsed)Ci(u,e.line,i.line+1);else if(s.className||s.startStyle||s.endStyle||s.css||s.attributes||s.title)for(var d=e.line;d<=i.line;d++)Ei(u,d,"text");s.atomic&&Co(u.doc),Se(u,"markerAdded",u,s)}return s}function Xo(t,e,i,n,o){(n=h(n)).shared=!1;var r=[Ko(t,e,i,n,o)],s=r[0],a=n.widgetNode;return Jn(t,function(t){a&&(n.widgetNode=a.cloneNode(!0)),r.push(Ko(t,ft(t,e),ft(t,i),n,o));for(var l=0;l<t.linked.length;++l)if(t.linked[l].isParent)return;s=g(r)}),new za(r,s)}function Yo(t){return t.findMarks(at(t.first,0),t.clipPos(at(t.lastLine())),function(t){return t.parent})}function Zo(t,e){for(var i=0;i<e.length;i++){var n=e[i],o=n.find(),r=t.clipPos(o.from),s=t.clipPos(o.to);if(lt(r,s)){var a=Ko(t,r,s,n.primary,n.primary.type);n.markers.push(a),a.parent=n}}}function Jo(t){for(var e=function(e){var i=t[e],n=[i.primary.doc];Jn(i.primary.doc,function(t){return n.push(t)});for(var o=0;o<i.markers.length;o++){var r=i.markers[o];-1==d(n,r.doc)&&(r.parent=null,i.markers.splice(o--,1))}},i=0;i<t.length;i++)e(i)}function Qo(t){var e=this;if(ir(e),!O(e,t)&&!Be(e.display,t)){P(t),ws&&($a=+new Date);var i=xi(e,t,!0),n=t.dataTransfer.files;if(i&&!e.isReadOnly())if(n&&n.length&&window.FileReader&&window.File)for(var o=n.length,r=Array(o),s=0,a=function(t,n){if(!e.options.allowDropFileTypes||-1!=d(e.options.allowDropFileTypes,t.type)){var a=new FileReader;a.onload=bn(e,function(){var t=a.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(t)&&(t=""),r[n]=t,++s==o){var l={from:i=ft(e.doc,i),to:i,text:e.doc.splitLines(r.join(e.doc.lineSeparator())),origin:"paste"};Ro(e.doc,l),wo(e.doc,Hn(i,Un(l)))}}),a.readAsText(t)}},l=0;l<o;++l)a(n[l],l);else{if(e.state.draggingText&&e.doc.sel.contains(i)>-1)return e.state.draggingText(t),void setTimeout(function(){return e.display.input.focus()},20);try{var c=t.dataTransfer.getData("Text");if(c){var h;if(e.state.draggingText&&!e.state.draggingText.copy&&(h=e.listSelections()),xo(e.doc,Hn(i,i)),h)for(var u=0;u<h.length;++u)Vo(e.doc,"",h[u].anchor,h[u].head,"drag");e.replaceSelection(c,"around","paste"),e.display.input.focus()}}catch(t){}}}}function tr(t,e){if(ws&&(!t.state.draggingText||+new Date-$a<100))V(e);else if(!O(t,e)&&!Be(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!Ts)){var i=n("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Es&&(i.width=i.height=1,t.display.wrapper.appendChild(i),i._top=i.offsetTop),e.dataTransfer.setDragImage(i,0,0),Es&&i.parentNode.removeChild(i)}}function er(t,e){var o=xi(t,e);if(o){var r=document.createDocumentFragment();Di(t,o,r),t.display.dragCursor||(t.display.dragCursor=n("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),i(t.display.dragCursor,r)}}function ir(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function nr(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),i=[],n=0;n<e.length;n++){var o=e[n].CodeMirror;o&&i.push(o)}i.length&&i[0].operation(function(){for(var e=0;e<i.length;e++)t(i[e])})}}function or(){Ha||(rr(),Ha=!0)}function rr(){var t;oa(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,nr(sr)},100))}),oa(window,"blur",function(){return nr($i)})}function sr(t){var e=t.display;e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,e.scrollbarsClipped=!1,t.setSize()}function ar(t){var e,i,n,o,r=t.split(/-(?!$)/);t=r[r.length-1];for(var s=0;s<r.length-1;s++){var a=r[s];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))e=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);n=!0}}return e&&(t="Alt-"+t),i&&(t="Ctrl-"+t),o&&(t="Cmd-"+t),n&&(t="Shift-"+t),t}function lr(t){var e={};for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if("..."==n){delete t[i];continue}for(var o=m(i.split(" "),ar),r=0;r<o.length;r++){var s=void 0,a=void 0;r==o.length-1?(a=o.join(" "),s=n):(a=o.slice(0,r+1).join(" "),s="...");var l=e[a];if(l){if(l!=s)throw new Error("Inconsistent bindings for "+a)}else e[a]=s}delete t[i]}for(var c in e)t[c]=e[c];return t}function cr(t,e,i,n){var o=(e=pr(e)).call?e.call(t,n):e[t];if(!1===o)return"nothing";if("..."===o)return"multi";if(null!=o&&i(o))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return cr(t,e.fallthrough,i,n);for(var r=0;r<e.fallthrough.length;r++){var s=cr(t,e.fallthrough[r],i,n);if(s)return s}}}function hr(t){var e="string"==typeof t?t:Ua[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function ur(t,e,i){var n=t;return e.altKey&&"Alt"!=n&&(t="Alt-"+t),(Vs?e.metaKey:e.ctrlKey)&&"Ctrl"!=n&&(t="Ctrl-"+t),(Vs?e.ctrlKey:e.metaKey)&&"Cmd"!=n&&(t="Cmd-"+t),!i&&e.shiftKey&&"Shift"!=n&&(t="Shift-"+t),t}function dr(t,e){if(Es&&34==t.keyCode&&t.char)return!1;var i=Ua[t.keyCode];return null!=i&&!t.altGraphKey&&(3==t.keyCode&&t.code&&(i=t.code),ur(i,t,e))}function pr(t){return"string"==typeof t?qa[t]:t}function fr(t,e){for(var i=t.doc.sel.ranges,n=[],o=0;o<i.length;o++){for(var r=e(i[o]);n.length&&lt(r.from,g(n).to)<=0;){var s=n.pop();if(lt(s.from,r.from)<0){r.from=s.from;break}}n.push(r)}vn(t,function(){for(var e=n.length-1;e>=0;e--)Vo(t.doc,"",n[e].from,n[e].to,"+delete");Yi(t)})}function gr(t,e,i){var n=x(t.text,e+i,i);return n<0||n>t.text.length?null:n}function mr(t,e,i){var n=gr(t,e.ch,i);return null==n?null:new at(e.line,n,i<0?"after":"before")}function vr(t,e,i,n,o){if(t){var r=T(i,e.doc.direction);if(r){var s,a=o<0?g(r):r[0],l=o<0==(1==a.level)?"after":"before";if(a.level>0||"rtl"==e.doc.direction){var c=qe(e,i);s=o<0?i.text.length-1:0;var h=Ke(e,c,s).top;s=L(function(t){return Ke(e,c,t).top==h},o<0==(1==a.level)?a.from:a.to-1,s),"before"==l&&(s=gr(i,s,1))}else s=o<0?a.to:a.from;return new at(n,s,l)}}return new at(n,o<0?i.text.length:0,o<0?"before":"after")}function br(t,e,i,n){var o=T(e,t.doc.direction);if(!o)return mr(e,i,n);i.ch>=e.text.length?(i.ch=e.text.length,i.sticky="before"):i.ch<=0&&(i.ch=0,i.sticky="after");var r=E(o,i.ch,i.sticky),s=o[r];if("ltr"==t.doc.direction&&s.level%2==0&&(n>0?s.to>i.ch:s.from<i.ch))return mr(e,i,n);var a,l=function(t,i){return gr(e,t instanceof at?t.ch:t,i)},c=function(i){return t.options.lineWrapping?(a=a||qe(t,e),pi(t,e,a,i)):{begin:0,end:e.text.length}},h=c("before"==i.sticky?l(i,-1):i.ch);if("rtl"==t.doc.direction||1==s.level){var u=1==s.level==n<0,d=l(i,u?1:-1);if(null!=d&&(u?d<=s.to&&d<=h.end:d>=s.from&&d>=h.begin)){var p=u?"before":"after";return new at(i.line,d,p)}}var f=function(t,e,n){for(var r=function(t,e){return e?new at(i.line,l(t,1),"before"):new at(i.line,t,"after")};t>=0&&t<o.length;t+=e){var s=o[t],a=e>0==(1!=s.level),c=a?n.begin:l(n.end,-1);if(s.from<=c&&c<s.to)return r(c,a);if(c=a?s.from:l(s.to,-1),n.begin<=c&&c<n.end)return r(c,a)}},g=f(r+n,n,h);if(g)return g;var m=n>0?h.end:l(h.begin,-1);return null==m||n>0&&m==e.text.length||!(g=f(n>0?0:o.length-1,n,c(m)))?null:g}function yr(t,e){var i=Q(t.doc,e),n=Xt(i);return n!=i&&(e=nt(n)),vr(!0,t,n,e,1)}function Sr(t,e){var i=Q(t.doc,e),n=Yt(i);return n!=i&&(e=nt(n)),vr(!0,t,i,e,-1)}function kr(t,e){var i=yr(t,e.line),n=Q(t.doc,i.line),o=T(n,t.doc.direction);if(!o||0==o[0].level){var r=Math.max(0,n.text.search(/\S/)),s=e.line==i.line&&e.ch<=r&&e.ch;return at(i.line,s?0:r,i.sticky)}return i}function wr(t,e,i){if("string"==typeof e&&!(e=Ya[e]))return!1;t.display.input.ensurePolled();var n=t.display.shift,o=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),i&&(t.display.shift=!1),o=e(t)!=Ks}finally{t.display.shift=n,t.state.suppressEdits=!1}return o}function _r(t,e,i){for(var n=0;n<t.state.keyMaps.length;n++){var o=cr(e,t.state.keyMaps[n],i,t);if(o)return o}return t.options.extraKeys&&cr(e,t.options.extraKeys,i,t)||cr(e,t.options.keyMap,i,t)}function xr(t,e,i,n){var o=t.state.keySeq;if(o){if(hr(e))return"handled";if(/\'$/.test(e)?t.state.keySeq=null:Za.set(50,function(){t.state.keySeq==o&&(t.state.keySeq=null,t.display.input.reset())}),Lr(t,o+" "+e,i,n))return!0}return Lr(t,e,i,n)}function Lr(t,e,i,n){var o=_r(t,e,n);return"multi"==o&&(t.state.keySeq=e),"handled"==o&&Se(t,"keyHandled",t,e,i),"handled"!=o&&"multi"!=o||(P(i),Ni(t)),!!o}function Cr(t,e){var i=dr(e,!0);return!!i&&(e.shiftKey&&!t.state.keySeq?xr(t,"Shift-"+i,e,function(e){return wr(t,e,!0)})||xr(t,i,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return wr(t,e)}):xr(t,i,e,function(e){return wr(t,e)}))}function Er(t,e,i){return xr(t,"'"+i+"'",e,function(e){return wr(t,e,!0)})}function Tr(t){var e=this;if(e.curOp.focus=s(),!O(e,t)){ws&&_s<11&&27==t.keyCode&&(t.returnValue=!1);var i=t.keyCode;e.display.shift=16==i||t.shiftKey;var n=Cr(e,t);Es&&(Ja=n?i:null,!n&&88==i&&!la&&(Ds?t.metaKey:t.ctrlKey)&&e.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)||Mr(e)}}function Mr(t){function e(t){18!=t.keyCode&&t.altKey||($s(i,"CodeMirror-crosshair"),A(document,"keyup",e),A(document,"mouseover",e))}var i=t.display.lineDiv;a(i,"CodeMirror-crosshair"),oa(document,"keyup",e),oa(document,"mouseover",e)}function Ar(t){16==t.keyCode&&(this.doc.sel.shift=!1),O(this,t)}function Ir(t){var e=this;if(!(Be(e.display,t)||O(e,t)||t.ctrlKey&&!t.altKey||Ds&&t.metaKey)){var i=t.keyCode,n=t.charCode;if(Es&&i==Ja)return Ja=null,void P(t);if(!Es||t.which&&!(t.which<10)||!Cr(e,t)){var o=String.fromCharCode(null==n?i:n);"\b"!=o&&(Er(e,t,o)||e.display.input.onKeyPress(t))}}}function Or(t,e){var i=+new Date;return Xa&&Xa.compare(i,t,e)?(Ka=Xa=null,"triple"):Ka&&Ka.compare(i,t,e)?(Xa=new tl(i,t,e),Ka=null,"double"):(Ka=new tl(i,t,e),Xa=null,"single")}function Rr(t){var e=this,i=e.display;if(!(O(e,t)||i.activeTouch&&i.input.supportsTouch()))if(i.input.ensurePolled(),i.shift=t.shiftKey,Be(i,t))xs||(i.scroller.draggable=!1,setTimeout(function(){return i.scroller.draggable=!0},100));else if(!Hr(e,t)){var n=xi(e,t),o=$(t),r=n?Or(n,o):"single";window.focus(),1==o&&e.state.selectingText&&e.state.selectingText(t),n&&Dr(e,o,n,r,t)||(1==o?n?Pr(e,n,r,t):F(t)==i.scroller&&P(t):2==o?(n&&vo(e.doc,n),setTimeout(function(){return i.input.focus()},20)):3==o&&(Fs?e.display.input.onContextMenu(t):Vi(e)))}}function Dr(t,e,i,n,o){var r="Click";return"double"==n?r="Double"+r:"triple"==n&&(r="Triple"+r),xr(t,ur(r=(1==e?"Left":2==e?"Middle":"Right")+r,o),o,function(e){if("string"==typeof e&&(e=Ya[e]),!e)return!1;var n=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),n=e(t,i)!=Ks}finally{t.state.suppressEdits=!1}return n})}function Br(t,e,i){var n=t.getOption("configureMouse"),o=n?n(t,e,i):{};if(null==o.unit){var r=Bs?i.shiftKey&&i.metaKey:i.altKey;o.unit=r?"rectangle":"single"==e?"char":"double"==e?"word":"line"}return(null==o.extend||t.doc.extend)&&(o.extend=t.doc.extend||i.shiftKey),null==o.addNew&&(o.addNew=Ds?i.metaKey:i.ctrlKey),null==o.moveOnDrag&&(o.moveOnDrag=!(Ds?i.altKey:i.ctrlKey)),o}function Pr(t,e,i,n){ws?setTimeout(c(zi,t),0):t.curOp.focus=s();var o,r=Br(t,i,n),a=t.doc.sel;t.options.dragDrop&&ra&&!t.isReadOnly()&&"single"==i&&(o=a.contains(e))>-1&&(lt((o=a.ranges[o]).from(),e)<0||e.xRel>0)&&(lt(o.to(),e)>0||e.xRel<0)?Nr(t,n,e,r):Vr(t,n,e,r)}function Nr(t,e,i,n){var o=t.display,r=!1,s=bn(t,function(e){xs&&(o.scroller.draggable=!1),t.state.draggingText=!1,A(o.wrapper.ownerDocument,"mouseup",s),A(o.wrapper.ownerDocument,"mousemove",a),A(o.scroller,"dragstart",l),A(o.scroller,"drop",s),r||(P(e),n.addNew||vo(t.doc,i,null,null,n.extend),xs||ws&&9==_s?setTimeout(function(){o.wrapper.ownerDocument.body.focus(),o.input.focus()},20):o.input.focus())}),a=function(t){r=r||Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)>=10},l=function(){return r=!0};xs&&(o.scroller.draggable=!0),t.state.draggingText=s,s.copy=!n.moveOnDrag,o.scroller.dragDrop&&o.scroller.dragDrop(),oa(o.wrapper.ownerDocument,"mouseup",s),oa(o.wrapper.ownerDocument,"mousemove",a),oa(o.scroller,"dragstart",l),oa(o.scroller,"drop",s),Vi(t),setTimeout(function(){return o.input.focus()},20)}function zr(t,e,i){if("char"==i)return new Da(e,e);if("word"==i)return t.findWordAt(e);if("line"==i)return new Da(at(e.line,0),ft(t.doc,at(e.line+1,0)));var n=i(t,e);return new Da(n.from,n.to)}function Vr(t,e,i,n){function o(e){if(0!=lt(v,e))if(v=e,"rectangle"==n.unit){for(var o=[],r=t.options.tabSize,s=u(Q(c,i.line).text,i.ch,r),a=u(Q(c,e.line).text,e.ch,r),l=Math.min(s,a),g=Math.max(s,a),m=Math.min(i.line,e.line),b=Math.min(t.lastLine(),Math.max(i.line,e.line));m<=b;m++){var y=Q(c,m).text,S=p(y,l,r);l==g?o.push(new Da(at(m,S),at(m,S))):y.length>S&&o.push(new Da(at(m,S),at(m,p(y,g,r))))}o.length||o.push(new Da(i,i)),_o(c,$n(t,f.ranges.slice(0,d).concat(o),d),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else{var k,w=h,_=zr(t,e,n.unit),x=w.anchor;lt(_.anchor,x)>0?(k=_.head,x=dt(w.from(),_.anchor)):(k=_.anchor,x=ut(w.to(),_.head));var L=f.ranges.slice(0);L[d]=Fr(t,new Da(ft(c,x),k)),_o(c,$n(t,L,d),Ys)}}function r(e){var i=++y,a=xi(t,e,!0,"rectangle"==n.unit);if(a)if(0!=lt(a,v)){t.curOp.focus=s(),o(a);var h=Wi(l,c);(a.line>=h.to||a.line<h.from)&&setTimeout(bn(t,function(){y==i&&r(e)}),150)}else{var u=e.clientY<b.top?-20:e.clientY>b.bottom?20:0;u&&setTimeout(bn(t,function(){y==i&&(l.scroller.scrollTop+=u,r(e))}),50)}}function a(e){t.state.selectingText=!1,y=Infinity,e&&(P(e),l.input.focus()),A(l.wrapper.ownerDocument,"mousemove",S),A(l.wrapper.ownerDocument,"mouseup",k),c.history.lastSelOrigin=null}var l=t.display,c=t.doc;P(e);var h,d,f=c.sel,g=f.ranges;if(n.addNew&&!n.extend?(d=c.sel.contains(i),h=d>-1?g[d]:new Da(i,i)):(h=c.sel.primary(),d=c.sel.primIndex),"rectangle"==n.unit)n.addNew||(h=new Da(i,i)),i=xi(t,e,!0,!0),d=-1;else{var m=zr(t,i,n.unit);h=n.extend?mo(h,m.anchor,m.head,n.extend):m}n.addNew?-1==d?(d=g.length,_o(c,$n(t,g.concat([h]),d),{scroll:!1,origin:"*mouse"})):g.length>1&&g[d].empty()&&"char"==n.unit&&!n.extend?(_o(c,$n(t,g.slice(0,d).concat(g.slice(d+1)),0),{scroll:!1,origin:"*mouse"}),f=c.sel):yo(c,d,h,Ys):(d=0,_o(c,new Ra([h],0),Ys),f=c.sel);var v=i,b=l.wrapper.getBoundingClientRect(),y=0,S=bn(t,function(t){0!==t.buttons&&$(t)?r(t):a(t)}),k=bn(t,a);t.state.selectingText=k,oa(l.wrapper.ownerDocument,"mousemove",S),oa(l.wrapper.ownerDocument,"mouseup",k)}function Fr(t,e){var i=e.anchor,n=e.head,o=Q(t.doc,i.line);if(0==lt(i,n)&&i.sticky==n.sticky)return e;var r=T(o);if(!r)return e;var s=E(r,i.ch,i.sticky),a=r[s];if(a.from!=i.ch&&a.to!=i.ch)return e;var l,c=s+(a.from==i.ch==(1!=a.level)?0:1);if(0==c||c==r.length)return e;if(n.line!=i.line)l=(n.line-i.line)*("ltr"==t.doc.direction?1:-1)>0;else{var h=E(r,n.ch,n.sticky),u=h-s||(n.ch-i.ch)*(1==a.level?-1:1);l=h==c-1||h==c?u<0:u>0}var d=r[c+(l?-1:0)],p=l==(1==d.level),f=p?d.from:d.to,g=p?"after":"before";return i.ch==f&&i.sticky==g?e:new Da(new at(i.line,f,g),n)}function $r(t,e,i,n){var o,r;if(e.touches)o=e.touches[0].clientX,r=e.touches[0].clientY;else try{o=e.clientX,r=e.clientY}catch(e){return!1}if(o>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;n&&P(e);var s=t.display,a=s.lineDiv.getBoundingClientRect();if(r>a.bottom||!D(t,i))return z(e);r-=a.top-s.viewOffset;for(var l=0;l<t.display.gutterSpecs.length;++l){var c=s.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=o)return I(t,i,t,ot(t.doc,r),t.display.gutterSpecs[l].className,e),z(e)}}function Hr(t,e){return $r(t,e,"gutterClick",!0)}function Ur(t,e){Be(t.display,e)||Wr(t,e)||O(t,e,"contextmenu")||Fs||t.display.input.onContextMenu(e)}function Wr(t,e){return!!D(t,"gutterContextMenu")&&$r(t,e,"gutterContextMenu",!1)}function jr(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),ei(t)}function Gr(t){function e(e,n,o,r){t.defaults[e]=n,o&&(i[e]=r?function(t,e,i){i!=el&&o(t,e,i)}:o)}var i=t.optionHandlers;t.defineOption=e,t.Init=el,e("value","",function(t,e){return t.setValue(e)},!0),e("mode",null,function(t,e){t.doc.modeOption=e,Kn(t)},!0),e("indentUnit",2,Kn,!0),e("indentWithTabs",!1),e("smartIndent",!0),e("tabSize",4,function(t){Xn(t),ei(t),Ci(t)},!0),e("lineSeparator",null,function(t,e){if(t.doc.lineSep=e,e){var i=[],n=t.doc.first;t.doc.iter(function(t){for(var o=0;;){var r=t.text.indexOf(e,o);if(-1==r)break;o=r+e.length,i.push(at(n,r))}n++});for(var o=i.length-1;o>=0;o--)Vo(t.doc,e,i[o],at(i[o].line,i[o].ch+e.length))}}),e("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(t,e,i){t.state.specialChars=new RegExp(e.source+(e.test("\t")?"":"|\t"),"g"),i!=el&&t.refresh()}),e("specialCharPlaceholder",ce,function(t){return t.refresh()},!0),e("electricChars",!0),e("inputStyle",Rs?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),e("spellcheck",!1,function(t,e){return t.getInputField().spellcheck=e},!0),e("autocorrect",!1,function(t,e){return t.getInputField().autocorrect=e},!0),e("autocapitalize",!1,function(t,e){return t.getInputField().autocapitalize=e},!0),e("rtlMoveVisually",!Ps),e("wholeLineUpdateBefore",!0),e("theme","default",function(t){jr(t),Pn(t)},!0),e("keyMap","default",function(t,e,i){var n=pr(e),o=i!=el&&pr(i);o&&o.detach&&o.detach(t,n),n.attach&&n.attach(t,o||null)}),e("extraKeys",null),e("configureMouse",null),e("lineWrapping",!1,Kr,!0),e("gutters",[],function(t,e){t.display.gutterSpecs=Dn(e,t.options.lineNumbers),Pn(t)},!0),e("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?ki(t.display)+"px":"0",t.refresh()},!0),e("coverGutterNextToScrollbar",!1,function(t){return sn(t)},!0),e("scrollbarStyle","native",function(t){ln(t),sn(t),t.display.scrollbars.setScrollTop(t.doc.scrollTop),t.display.scrollbars.setScrollLeft(t.doc.scrollLeft)},!0),e("lineNumbers",!1,function(t,e){t.display.gutterSpecs=Dn(t.options.gutters,e),Pn(t)},!0),e("firstLineNumber",1,Pn,!0),e("lineNumberFormatter",function(t){return t},Pn,!0),e("showCursorWhenSelecting",!1,Oi,!0),e("resetSelectionOnContextMenu",!0),e("lineWiseCopyCut",!0),e("pasteLinesPerSelection",!0),e("selectionsMayTouch",!1),e("readOnly",!1,function(t,e){"nocursor"==e&&($i(t),t.display.input.blur()),t.display.input.readOnlyChanged(e)}),e("disableInput",!1,function(t,e){e||t.display.input.reset()},!0),e("dragDrop",!0,qr),e("allowDropFileTypes",null),e("cursorBlinkRate",530),e("cursorScrollMargin",0),e("cursorHeight",1,Oi,!0),e("singleCursorHeightPerLine",!0,Oi,!0),e("workTime",100),e("workDelay",100),e("flattenSpans",!0,Xn,!0),e("addModeClass",!1,Xn,!0),e("pollInterval",100),e("undoDepth",200,function(t,e){return t.doc.history.undoDepth=e}),e("historyEventDelay",1250),e("viewportMargin",10,function(t){return t.refresh()},!0),e("maxHighlightLength",1e4,Xn,!0),e("moveInputWithCursor",!0,function(t,e){e||t.display.input.resetPosition()}),e("tabindex",null,function(t,e){return t.display.input.getField().tabIndex=e||""}),e("autofocus",null),e("direction","ltr",function(t,e){return t.doc.setDirection(e)},!0),e("phrases",null)}function qr(t,e,i){if(!e!=!(i&&i!=el)){var n=t.display.dragFunctions,o=e?oa:A;o(t.display.scroller,"dragstart",n.start),o(t.display.scroller,"dragenter",n.enter),o(t.display.scroller,"dragover",n.over),o(t.display.scroller,"dragleave",n.leave),o(t.display.scroller,"drop",n.drop)}}
function Kr(t){t.options.lineWrapping?(a(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):($s(t.display.wrapper,"CodeMirror-wrap"),oe(t)),_i(t),Ci(t),ei(t),setTimeout(function(){return sn(t)},100)}function Xr(t,e){var i=this;if(!(this instanceof Xr))return new Xr(t,e);this.options=e=e?h(e):{},h(il,e,!1);var n=e.value;"string"==typeof n?n=new Fa(n,e.mode,null,e.lineSeparator,e.direction):e.mode&&(n.modeOption=e.mode),this.doc=n;var o=new Xr.inputStyles[e.inputStyle](this),r=this.display=new Nn(t,n,o,e);for(var s in r.wrapper.CodeMirror=this,jr(this),e.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),ln(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Us,keySeq:null,specialChars:null},e.autofocus&&!Rs&&r.input.focus(),ws&&_s<11&&setTimeout(function(){return i.display.input.reset(!0)},20),Yr(this),or(),cn(this),this.curOp.forceUpdate=!0,Qn(this,n),e.autofocus&&!Rs||this.hasFocus()?setTimeout(c(Fi,this),20):$i(this),nl)nl.hasOwnProperty(s)&&nl[s](this,e[s],el);Rn(this),e.finishInit&&e.finishInit(this);for(var a=0;a<ol.length;++a)ol[a](this);hn(this),xs&&e.lineWrapping&&"optimizelegibility"==getComputedStyle(r.lineDiv).textRendering&&(r.lineDiv.style.textRendering="auto")}function Yr(t){function e(){o.activeTouch&&(r=setTimeout(function(){return o.activeTouch=null},1e3),(s=o.activeTouch).end=+new Date)}function i(t){if(1!=t.touches.length)return!1;var e=t.touches[0];return e.radiusX<=1&&e.radiusY<=1}function n(t,e){if(null==e.left)return!0;var i=e.left-t.left,n=e.top-t.top;return i*i+n*n>400}var o=t.display;oa(o.scroller,"mousedown",bn(t,Rr)),oa(o.scroller,"dblclick",ws&&_s<11?bn(t,function(e){if(!O(t,e)){var i=xi(t,e);if(i&&!Hr(t,e)&&!Be(t.display,e)){P(e);var n=t.findWordAt(i);vo(t.doc,n.anchor,n.head)}}}):function(e){return O(t,e)||P(e)}),oa(o.scroller,"contextmenu",function(e){return Ur(t,e)});var r,s={end:0};oa(o.scroller,"touchstart",function(e){if(!O(t,e)&&!i(e)&&!Hr(t,e)){o.input.ensurePolled(),clearTimeout(r);var n=+new Date;o.activeTouch={start:n,moved:!1,prev:n-s.end<=300?s:null},1==e.touches.length&&(o.activeTouch.left=e.touches[0].pageX,o.activeTouch.top=e.touches[0].pageY)}}),oa(o.scroller,"touchmove",function(){o.activeTouch&&(o.activeTouch.moved=!0)}),oa(o.scroller,"touchend",function(i){var r=o.activeTouch;if(r&&!Be(o,i)&&null!=r.left&&!r.moved&&new Date-r.start<300){var s,a=t.coordsChar(o.activeTouch,"page");s=!r.prev||n(r,r.prev)?new Da(a,a):!r.prev.prev||n(r,r.prev.prev)?t.findWordAt(a):new Da(at(a.line,0),ft(t.doc,at(a.line+1,0))),t.setSelection(s.anchor,s.head),t.focus(),P(i)}e()}),oa(o.scroller,"touchcancel",e),oa(o.scroller,"scroll",function(){o.scroller.clientHeight&&(en(t,o.scroller.scrollTop),on(t,o.scroller.scrollLeft,!0),I(t,"scroll",t))}),oa(o.scroller,"mousewheel",function(e){return Fn(t,e)}),oa(o.scroller,"DOMMouseScroll",function(e){return Fn(t,e)}),oa(o.wrapper,"scroll",function(){return o.wrapper.scrollTop=o.wrapper.scrollLeft=0}),o.dragFunctions={enter:function(e){O(t,e)||V(e)},over:function(e){O(t,e)||(er(t,e),V(e))},start:function(e){return tr(t,e)},drop:bn(t,Qo),leave:function(e){O(t,e)||ir(t)}};var a=o.input.getField();oa(a,"keyup",function(e){return Ar.call(t,e)}),oa(a,"keydown",bn(t,Tr)),oa(a,"keypress",bn(t,Ir)),oa(a,"focus",function(e){return Fi(t,e)}),oa(a,"blur",function(e){return $i(t,e)})}function Zr(t,e,i,n){var o,r=t.doc;null==i&&(i="add"),"smart"==i&&(r.mode.indent?o=yt(t,e).state:i="prev");var s=t.options.tabSize,a=Q(r,e),l=u(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var c,h=a.text.match(/^\s*/)[0];if(n||/\S/.test(a.text)){if("smart"==i&&((c=r.mode.indent(o,a.text.slice(h.length),a.text))==Ks||c>150)){if(!n)return;i="prev"}}else c=0,i="not";"prev"==i?c=e>r.first?u(Q(r,e-1).text,null,s):0:"add"==i?c=l+t.options.indentUnit:"subtract"==i?c=l-t.options.indentUnit:"number"==typeof i&&(c=l+i),c=Math.max(0,c);var d="",p=0;if(t.options.indentWithTabs)for(var g=Math.floor(c/s);g;--g)p+=s,d+="\t";if(p<c&&(d+=f(c-p)),d!=h)return Vo(r,d,at(e,0),at(e,h.length),"+input"),a.stateAfter=null,!0;for(var m=0;m<r.sel.ranges.length;m++){var v=r.sel.ranges[m];if(v.head.line==e&&v.head.ch<h.length){var b=at(e,h.length);yo(r,m,new Da(b,b));break}}}function Jr(t){rl=t}function Qr(t,e,i,n,o){var r=t.doc;t.display.shift=!1,n||(n=r.sel);var s=+new Date-200,a="paste"==o||t.state.pasteIncoming>s,l=sa(e),c=null;if(a&&n.ranges.length>1)if(rl&&rl.text.join("\n")==e){if(n.ranges.length%rl.text.length==0){c=[];for(var h=0;h<rl.text.length;h++)c.push(r.splitLines(rl.text[h]))}}else l.length==n.ranges.length&&t.options.pasteLinesPerSelection&&(c=m(l,function(t){return[t]}));for(var u=t.curOp.updateInput,d=n.ranges.length-1;d>=0;d--){var p=n.ranges[d],f=p.from(),v=p.to();p.empty()&&(i&&i>0?f=at(f.line,f.ch-i):t.state.overwrite&&!a?v=at(v.line,Math.min(Q(r,v.line).text.length,v.ch+g(l).length)):a&&rl&&rl.lineWise&&rl.text.join("\n")==e&&(f=v=at(f.line,0)));var b={from:f,to:v,text:c?c[d%c.length]:l,origin:o||(a?"paste":t.state.cutIncoming>s?"cut":"+input")};Ro(t.doc,b),Se(t,"inputRead",t,b)}e&&!a&&es(t,e),Yi(t),t.curOp.updateInput<2&&(t.curOp.updateInput=u),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function ts(t,e){var i=t.clipboardData&&t.clipboardData.getData("Text");if(i)return t.preventDefault(),e.isReadOnly()||e.options.disableInput||vn(e,function(){return Qr(e,i,0,null,"paste")}),!0}function es(t,e){if(t.options.electricChars&&t.options.smartIndent)for(var i=t.doc.sel,n=i.ranges.length-1;n>=0;n--){var o=i.ranges[n];if(!(o.head.ch>100||n&&i.ranges[n-1].head.line==o.head.line)){var r=t.getModeAt(o.head),s=!1;if(r.electricChars){for(var a=0;a<r.electricChars.length;a++)if(e.indexOf(r.electricChars.charAt(a))>-1){s=Zr(t,o.head.line,"smart");break}}else r.electricInput&&r.electricInput.test(Q(t.doc,o.head.line).text.slice(0,o.head.ch))&&(s=Zr(t,o.head.line,"smart"));s&&Se(t,"electricInput",t,o.head.line)}}}function is(t){for(var e=[],i=[],n=0;n<t.doc.sel.ranges.length;n++){var o=t.doc.sel.ranges[n].head.line,r={anchor:at(o,0),head:at(o+1,0)};i.push(r),e.push(t.getRange(r.anchor,r.head))}return{text:e,ranges:i}}function ns(t,e,i,n){t.setAttribute("autocorrect",i?"":"off"),t.setAttribute("autocapitalize",n?"":"off"),t.setAttribute("spellcheck",!!e)}function os(){var t=n("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),e=n("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return xs?t.style.width="1000px":t.setAttribute("wrap","off"),Is&&(t.style.border="1px solid black"),ns(t),e}function rs(t){var e=t.optionHandlers,i=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(t,i){var n=this.options,o=n[t];n[t]==i&&"mode"!=t||(n[t]=i,e.hasOwnProperty(t)&&bn(this,e[t])(this,i,o),I(this,"optionChange",this,t))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](pr(t))},removeKeyMap:function(t){for(var e=this.state.keyMaps,i=0;i<e.length;++i)if(e[i]==t||e[i].name==t)return e.splice(i,1),!0},addOverlay:yn(function(e,i){var n=e.token?e:t.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");v(this.state.overlays,{mode:n,modeSpec:e,opaque:i&&i.opaque,priority:i&&i.priority||0},function(t){return t.priority}),this.state.modeGen++,Ci(this)}),removeOverlay:yn(function(t){for(var e=this.state.overlays,i=0;i<e.length;++i){var n=e[i].modeSpec;if(n==t||"string"==typeof t&&n.name==t)return e.splice(i,1),this.state.modeGen++,void Ci(this)}}),indentLine:yn(function(t,e,i){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),rt(this.doc,t)&&Zr(this,t,e,i)}),indentSelection:yn(function(t){for(var e=this.doc.sel.ranges,i=-1,n=0;n<e.length;n++){var o=e[n];if(o.empty())o.head.line>i&&(Zr(this,o.head.line,t,!0),i=o.head.line,n==this.doc.sel.primIndex&&Yi(this));else{var r=o.from(),s=o.to(),a=Math.max(i,r.line);i=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=a;l<i;++l)Zr(this,l,t);var c=this.doc.sel.ranges;0==r.ch&&e.length==c.length&&c[n].from().ch>0&&yo(this.doc,n,new Da(r,c[n].to()),Xs)}}}),getTokenAt:function(t,e){return _t(this,t,e)},getLineTokens:function(t,e){return _t(this,at(t),e,!0)},getTokenTypeAt:function(t){t=ft(this.doc,t);var e,i=bt(this,Q(this.doc,t.line)),n=0,o=(i.length-1)/2,r=t.ch;if(0==r)e=i[2];else for(;;){var s=n+o>>1;if((s?i[2*s-1]:0)>=r)o=s;else{if(!(i[2*s+1]<r)){e=i[2*s+2];break}n=s+1}}var a=e?e.indexOf("overlay "):-1;return a<0?e:0==a?null:e.slice(0,a-1)},getModeAt:function(e){var i=this.doc.mode;return i.innerMode?t.innerMode(i,this.getTokenAt(e).state).mode:i},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var n=[];if(!i.hasOwnProperty(e))return n;var o=i[e],r=this.getModeAt(t);if("string"==typeof r[e])o[r[e]]&&n.push(o[r[e]]);else if(r[e])for(var s=0;s<r[e].length;s++){var a=o[r[e][s]];a&&n.push(a)}else r.helperType&&o[r.helperType]?n.push(o[r.helperType]):o[r.name]&&n.push(o[r.name]);for(var l=0;l<o._global.length;l++){var c=o._global[l];c.pred(r,this)&&-1==d(n,c.val)&&n.push(c.val)}return n},getStateAfter:function(t,e){var i=this.doc;return yt(this,(t=pt(i,null==t?i.first+i.size-1:t))+1,e).state},cursorCoords:function(t,e){var i=this.doc.sel.primary();return li(this,null==t?i.head:"object"==typeof t?ft(this.doc,t):t?i.from():i.to(),e||"page")},charCoords:function(t,e){return ai(this,ft(this.doc,t),e||"page")},coordsChar:function(t,e){return ui(this,(t=si(this,t,e||"page")).left,t.top)},lineAtHeight:function(t,e){return t=si(this,{top:t,left:0},e||"page").top,ot(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e,i){var n,o=!1;if("number"==typeof t){var r=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>r&&(t=r,o=!0),n=Q(this.doc,t)}else n=t;return ri(this,n,{top:0,left:0},e||"page",i||o).top+(o?this.doc.height-ie(n):0)},defaultTextHeight:function(){return bi(this.display)},defaultCharWidth:function(){return yi(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,i,n,o){var r=this.display,s=(t=li(this,ft(this.doc,t))).bottom,a=t.left;if(e.style.position="absolute",e.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(e),r.sizer.appendChild(e),"over"==n)s=t.top;else if("above"==n||"near"==n){var l=Math.max(r.wrapper.clientHeight,this.doc.height),c=Math.max(r.sizer.clientWidth,r.lineSpace.clientWidth);("above"==n||t.bottom+e.offsetHeight>l)&&t.top>e.offsetHeight?s=t.top-e.offsetHeight:t.bottom+e.offsetHeight<=l&&(s=t.bottom),a+e.offsetWidth>c&&(a=c-e.offsetWidth)}e.style.top=s+"px",e.style.left=e.style.right="","right"==o?(a=r.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==o?a=0:"middle"==o&&(a=(r.sizer.clientWidth-e.offsetWidth)/2),e.style.left=a+"px"),i&&qi(this,{left:a,top:s,right:a+e.offsetWidth,bottom:s+e.offsetHeight})},triggerOnKeyDown:yn(Tr),triggerOnKeyPress:yn(Ir),triggerOnKeyUp:Ar,triggerOnMouseDown:yn(Rr),execCommand:function(t){if(Ya.hasOwnProperty(t))return Ya[t].call(null,this)},triggerElectric:yn(function(t){es(this,t)}),findPosH:function(t,e,i,n){var o=1;e<0&&(o=-1,e=-e);for(var r=ft(this.doc,t),s=0;s<e&&!(r=ss(this.doc,r,o,i,n)).hitSide;++s);return r},moveH:yn(function(t,e){var i=this;this.extendSelectionsBy(function(n){return i.display.shift||i.doc.extend||n.empty()?ss(i.doc,n.head,t,e,i.options.rtlMoveVisually):t<0?n.from():n.to()},Zs)}),deleteH:yn(function(t,e){var i=this.doc.sel,n=this.doc;i.somethingSelected()?n.replaceSelection("",null,"+delete"):fr(this,function(i){var o=ss(n,i.head,t,e,!1);return t<0?{from:o,to:i.head}:{from:i.head,to:o}})}),findPosV:function(t,e,i,n){var o=1,r=n;e<0&&(o=-1,e=-e);for(var s=ft(this.doc,t),a=0;a<e;++a){var l=li(this,s,"div");if(null==r?r=l.left:l.left=r,(s=as(this,l,o,i)).hitSide)break}return s},moveV:yn(function(t,e){var i=this,n=this.doc,o=[],r=!this.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(s){if(r)return t<0?s.from():s.to();var a=li(i,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),o.push(a.left);var l=as(i,a,t,e);return"page"==e&&s==n.sel.primary()&&Xi(i,ai(i,l,"div").top-a.top),l},Zs),o.length)for(var s=0;s<n.sel.ranges.length;s++)n.sel.ranges[s].goalColumn=o[s]}),findWordAt:function(t){var e=Q(this.doc,t.line).text,i=t.ch,n=t.ch;if(e){var o=this.getHelper(t,"wordChars");"before"!=t.sticky&&n!=e.length||!i?++n:--i;for(var r=e.charAt(i),s=k(r,o)?function(t){return k(t,o)}:/\s/.test(r)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!k(t)};i>0&&s(e.charAt(i-1));)--i;for(;n<e.length&&s(e.charAt(n));)++n}return new Da(at(t.line,i),at(t.line,n))},toggleOverwrite:function(t){null!=t&&t==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?a(this.display.cursorDiv,"CodeMirror-overwrite"):$s(this.display.cursorDiv,"CodeMirror-overwrite"),I(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==s()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:yn(function(t,e){Zi(this,t,e)}),getScrollInfo:function(){var t=this.display.scroller;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-Ve(this)-this.display.barHeight,width:t.scrollWidth-Ve(this)-this.display.barWidth,clientHeight:$e(this),clientWidth:Fe(this)}},scrollIntoView:yn(function(t,e){null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:at(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line?Ji(this,t):tn(this,t.from,t.to,t.margin)}),setSize:yn(function(t,e){var i=this,n=function(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t};null!=t&&(this.display.wrapper.style.width=n(t)),null!=e&&(this.display.wrapper.style.height=n(e)),this.options.lineWrapping&&ti(this);var o=this.display.viewFrom;this.doc.iter(o,this.display.viewTo,function(t){if(t.widgets)for(var e=0;e<t.widgets.length;e++)if(t.widgets[e].noHScroll){Ei(i,o,"widget");break}++o}),this.curOp.forceUpdate=!0,I(this,"refresh",this)}),operation:function(t){return vn(this,t)},startOperation:function(){return cn(this)},endOperation:function(){return hn(this)},refresh:yn(function(){var t=this.display.cachedTextHeight;Ci(this),this.curOp.forceUpdate=!0,ei(this),Zi(this,this.doc.scrollLeft,this.doc.scrollTop),An(this.display),(null==t||Math.abs(t-bi(this.display))>.5)&&_i(this),I(this,"refresh",this)}),swapDoc:yn(function(t){var e=this.doc;return e.cm=null,this.state.selectingText&&this.state.selectingText(),Qn(this,t),ei(this),this.display.input.reset(),Zi(this,t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,Se(this,"swapDoc",this,e),e}),phrase:function(t){var e=this.options.phrases;return e&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:t},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},B(t),t.registerHelper=function(e,n,o){i.hasOwnProperty(e)||(i[e]=t[e]={_global:[]}),i[e][n]=o},t.registerGlobalHelper=function(e,n,o,r){t.registerHelper(e,n,r),i[e]._global.push({pred:o,val:r})}}function ss(t,e,i,n,o){function r(){var n=e.line+i;return!(n<t.first||n>=t.first+t.size)&&(e=new at(n,e.ch,e.sticky),c=Q(t,n))}function s(n){var s;if(null==(s=o?br(t.cm,c,e,i):mr(c,e,i))){if(n||!r())return!1;e=vr(o,t.cm,c,e.line,i)}else e=s;return!0}var a=e,l=i,c=Q(t,e.line);if("char"==n)s();else if("column"==n)s(!0);else if("word"==n||"group"==n)for(var h=null,u="group"==n,d=t.cm&&t.cm.getHelper(e,"wordChars"),p=!0;!(i<0)||s(!p);p=!1){var f=c.text.charAt(e.ch)||"\n",g=k(f,d)?"w":u&&"\n"==f?"n":!u||/\s/.test(f)?null:"p";if(!u||p||g||(g="s"),h&&h!=g){i<0&&(i=1,s(),e.sticky="after");break}if(g&&(h=g),i>0&&!s(!p))break}var m=Mo(t,e,a,l,!0);return ct(a,m)&&(m.hitSide=!0),m}function as(t,e,i,n){var o,r,s=t.doc,a=e.left;if("page"==n){var l=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),c=Math.max(l-.5*bi(t.display),3);o=(i>0?e.bottom:e.top)+i*c}else"line"==n&&(o=i>0?e.bottom+3:e.top-3);for(;(r=ui(t,a,o)).outside;){if(i<0?o<=0:o>=s.height){r.hitSide=!0;break}o+=5*i}return r}function ls(t,e){var i=Ge(t,e.line);if(!i||i.hidden)return null;var n=Q(t.doc,e.line),o=Ue(i,n,e.line),r=T(n,t.doc.direction),s="left";r&&(s=E(r,e.ch)%2?"right":"left");var a=Xe(o.map,e.ch,s);return a.offset="right"==a.collapse?a.end:a.start,a}function cs(t){for(var e=t;e;e=e.parentNode)if(/CodeMirror-gutter-wrapper/.test(e.className))return!0;return!1}function hs(t,e){return e&&(t.bad=!0),t}function us(t,e,i,n,o){function r(t){return function(e){return e.id==t}}function s(){h&&(c+=u,d&&(c+=u),h=d=!1)}function a(t){t&&(s(),c+=t)}function l(e){if(1==e.nodeType){var i=e.getAttribute("cm-text");if(i)return void a(i);var c,p=e.getAttribute("cm-marker");if(p){var f=t.findMarks(at(n,0),at(o+1,0),r(+p));return void(f.length&&(c=f[0].find(0))&&a(tt(t.doc,c.from,c.to).join(u)))}if("false"==e.getAttribute("contenteditable"))return;var g=/^(pre|div|p|li|table|br)$/i.test(e.nodeName);if(!/^br$/i.test(e.nodeName)&&0==e.textContent.length)return;g&&s();for(var m=0;m<e.childNodes.length;m++)l(e.childNodes[m]);/^(pre|p)$/i.test(e.nodeName)&&(d=!0),g&&(h=!0)}else 3==e.nodeType&&a(e.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(var c="",h=!1,u=t.doc.lineSeparator(),d=!1;l(e),e!=i;)e=e.nextSibling,d=!1;return c}function ds(t,e,i){var n;if(e==t.display.lineDiv){if(!(n=t.display.lineDiv.childNodes[i]))return hs(t.clipPos(at(t.display.viewTo-1)),!0);e=null,i=0}else for(n=e;;n=n.parentNode){if(!n||n==t.display.lineDiv)return null;if(n.parentNode&&n.parentNode==t.display.lineDiv)break}for(var o=0;o<t.display.view.length;o++){var r=t.display.view[o];if(r.node==n)return ps(r,e,i)}}function ps(t,e,i){function n(e,i,n){for(var o=-1;o<(u?u.length:0);o++)for(var r=o<0?h.map:u[o],s=0;s<r.length;s+=3){var a=r[s+2];if(a==e||a==i){var l=nt(o<0?t.line:t.rest[o]),c=r[s]+n;return(n<0||a!=e)&&(c=r[s+(n?1:0)]),at(l,c)}}}var o=t.text.firstChild,s=!1;if(!e||!r(o,e))return hs(at(nt(t.line),0),!0);if(e==o&&(s=!0,e=o.childNodes[i],i=0,!e)){var a=t.rest?g(t.rest):t.line;return hs(at(nt(a),a.text.length),s)}var l=3==e.nodeType?e:null,c=e;for(l||1!=e.childNodes.length||3!=e.firstChild.nodeType||(l=e.firstChild,i&&(i=l.nodeValue.length));c.parentNode!=o;)c=c.parentNode;var h=t.measure,u=h.maps,d=n(l,c,i);if(d)return hs(d,s);for(var p=c.nextSibling,f=l?l.nodeValue.length-i:0;p;p=p.nextSibling){if(d=n(p,p.firstChild,0))return hs(at(d.line,d.ch-f),s);f+=p.textContent.length}for(var m=c.previousSibling,v=i;m;m=m.previousSibling){if(d=n(m,m.firstChild,-1))return hs(at(d.line,d.ch+v),s);v+=m.textContent.length}}function fs(t,e){function i(){t.value=l.getValue()}if((e=e?h(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus){var n=s();e.autofocus=n==t||null!=t.getAttribute("autofocus")&&n==document.body}var o;if(t.form&&(oa(t.form,"submit",i),!e.leaveSubmitMethodAlone)){var r=t.form;o=r.submit;try{var a=r.submit=function(){i(),r.submit=o,r.submit(),r.submit=a}}catch(Gs){}}e.finishInit=function(e){e.save=i,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,i(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(A(t.form,"submit",i),"function"==typeof t.form.submit&&(t.form.submit=o))}},t.style.display="none";var l=Xr(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},e);return l}function gs(t){t.off=A,t.on=oa,t.wheelEventPixels=Vn,t.Doc=Fa,t.splitLines=sa,t.countColumn=u,t.findColumn=p,t.isWordChar=S,t.Pass=Ks,t.signal=I,t.Line=ya,t.changeEnd=Un,t.scrollbarModel=Ta,t.Pos=at,t.cmpPos=lt,t.modes=ha,t.mimeModes=ua,t.resolveMode=q,t.getMode=K,t.modeExtensions=da,t.extendMode=X,t.copyState=Y,t.startState=J,t.innerMode=Z,t.commands=Ya,t.keyMap=qa,t.keyName=dr,t.isModifierKey=hr,t.lookupKey=cr,t.normalizeKeyMap=lr,t.StringStream=pa,t.SharedTextMarker=za,t.TextMarker=Na,t.LineWidget=Ba,t.e_preventDefault=P,t.e_stopPropagation=N,t.e_stop=V,t.addClass=a,t.contains=r,t.rmClass=$s,t.keyNames=Ua}var ms=navigator.userAgent,vs=navigator.platform,bs=/gecko\/\d/i.test(ms),ys=/MSIE \d/.test(ms),Ss=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ms),ks=/Edge\/(\d+)/.exec(ms),ws=ys||Ss||ks,_s=ws&&(ys?document.documentMode||6:+(ks||Ss)[1]),xs=!ks&&/WebKit\//.test(ms),Ls=xs&&/Qt\/\d+\.\d+/.test(ms),Cs=!ks&&/Chrome\//.test(ms),Es=/Opera\//.test(ms),Ts=/Apple Computer/.test(navigator.vendor),Ms=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(ms),As=/PhantomJS/.test(ms),Is=!ks&&/AppleWebKit/.test(ms)&&/Mobile\/\w+/.test(ms),Os=/Android/.test(ms),Rs=Is||Os||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(ms),Ds=Is||/Mac/.test(vs),Bs=/\bCrOS\b/.test(ms),Ps=/win/i.test(vs),Ns=Es&&ms.match(/Version\/(\d*\.\d*)/);Ns&&(Ns=Number(Ns[1])),Ns&&Ns>=15&&(Es=!1,xs=!0);var zs,Vs=Ds&&(Ls||Es&&(null==Ns||Ns<12.11)),Fs=bs||ws&&_s>=9,$s=function(e,i){var n=e.className,o=t(i).exec(n);if(o){var r=n.slice(o.index+o[0].length);e.className=n.slice(0,o.index)+(r?o[1]+r:"")}};zs=document.createRange?function(t,e,i,n){var o=document.createRange();return o.setEnd(n||t,i),o.setStart(t,e),o}:function(t,e,i){var n=document.body.createTextRange();try{n.moveToElementText(t.parentNode)}catch(Gs){return n}return n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",e),n};var Hs=function(t){t.select()};Is?Hs=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:ws&&(Hs=function(t){try{t.select()}catch(e){}});var Us=function(){this.id=null};Us.prototype.set=function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)};var Ws,js,Gs,qs=30,Ks={toString:function(){return"CodeMirror.Pass"}},Xs={scroll:!1},Ys={origin:"*mouse"},Zs={origin:"+move"},Js=[""],Qs=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,ta=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,ea=null,ia=function(){function t(t){return t<=247?i.charAt(t):1424<=t&&t<=1524?"R":1536<=t&&t<=1785?n.charAt(t-1536):1774<=t&&t<=2220?"r":8192<=t&&t<=8203?"w":8204==t?"b":"L"}function e(t,e,i){this.level=t,this.from=e,this.to=i}var i="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,s=/[LRr]/,a=/[Lb1n]/,l=/[1n]/;return function(i,n){var c="ltr"==n?"L":"R";if(0==i.length||"ltr"==n&&!o.test(i))return!1;for(var h=i.length,u=[],d=0;d<h;++d)u.push(t(i.charCodeAt(d)));for(var p=0,f=c;p<h;++p){var m=u[p];"m"==m?u[p]=f:f=m}for(var v=0,b=c;v<h;++v){var y=u[v];"1"==y&&"r"==b?u[v]="n":s.test(y)&&(b=y,"r"==y&&(u[v]="R"))}for(var S=1,k=u[0];S<h-1;++S){var w=u[S];"+"==w&&"1"==k&&"1"==u[S+1]?u[S]="1":","!=w||k!=u[S+1]||"1"!=k&&"n"!=k||(u[S]=k),k=w}for(var _=0;_<h;++_){var x=u[_];if(","==x)u[_]="N";else if("%"==x){var L=void 0;for(L=_+1;L<h&&"%"==u[L];++L);for(var C=_&&"!"==u[_-1]||L<h&&"1"==u[L]?"1":"N",E=_;E<L;++E)u[E]=C;_=L-1}}for(var T=0,M=c;T<h;++T){var A=u[T];"L"==M&&"1"==A?u[T]="L":s.test(A)&&(M=A)}for(var I=0;I<h;++I)if(r.test(u[I])){var O=void 0;for(O=I+1;O<h&&r.test(u[O]);++O);for(var R="L"==(I?u[I-1]:c),D=R==("L"==(O<h?u[O]:c))?R?"L":"R":c,B=I;B<O;++B)u[B]=D;I=O-1}for(var P,N=[],z=0;z<h;)if(a.test(u[z])){var V=z;for(++z;z<h&&a.test(u[z]);++z);N.push(new e(0,V,z))}else{var F=z,$=N.length;for(++z;z<h&&"L"!=u[z];++z);for(var H=F;H<z;)if(l.test(u[H])){F<H&&N.splice($,0,new e(1,F,H));var U=H;for(++H;H<z&&l.test(u[H]);++H);N.splice($,0,new e(2,U,H)),F=H}else++H;F<z&&N.splice($,0,new e(1,F,z))}return"ltr"==n&&(1==N[0].level&&(P=i.match(/^\s+/))&&(N[0].from=P[0].length,N.unshift(new e(0,0,P[0].length))),1==g(N).level&&(P=i.match(/\s+$/))&&(g(N).to-=P[0].length,N.push(new e(0,h-P[0].length,h)))),"rtl"==n?N.reverse():N}}(),na=[],oa=function(t,e,i){if(t.addEventListener)t.addEventListener(e,i,!1);else if(t.attachEvent)t.attachEvent("on"+e,i);else{var n=t._handlers||(t._handlers={});n[e]=(n[e]||na).concat(i)}},ra=function(){if(ws&&_s<9)return!1;var t=n("div");return"draggable"in t||"dragDrop"in t}(),sa=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,i=[],n=t.length;e<=n;){var o=t.indexOf("\n",e);-1==o&&(o=t.length);var r=t.slice(e,"\r"==t.charAt(o-1)?o-1:o),s=r.indexOf("\r");-1!=s?(i.push(r.slice(0,s)),e+=s+1):(i.push(r),e=o+1)}return i}:function(t){return t.split(/\r\n?|\n/)},aa=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(Gs){return!1}}:function(t){var e;try{e=t.ownerDocument.selection.createRange()}catch(Gs){}return!(!e||e.parentElement()!=t)&&0!=e.compareEndPoints("StartToEnd",e)},la="oncopy"in(Gs=n("div"))||(Gs.setAttribute("oncopy","return;"),"function"==typeof Gs.oncopy),ca=null,ha={},ua={},da={},pa=function(t,e,i){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=i};pa.prototype.eol=function(){return this.pos>=this.string.length},pa.prototype.sol=function(){return this.pos==this.lineStart},pa.prototype.peek=function(){return this.string.charAt(this.pos)||undefined},pa.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},pa.prototype.eat=function(t){var e=this.string.charAt(this.pos);if("string"==typeof t?e==t:e&&(t.test?t.test(e):t(e)))return++this.pos,e},pa.prototype.eatWhile=function(t){for(var e=this.pos;this.eat(t););return this.pos>e},pa.prototype.eatSpace=function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},pa.prototype.skipToEnd=function(){this.pos=this.string.length},pa.prototype.skipTo=function(t){var e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0},pa.prototype.backUp=function(t){this.pos-=t},pa.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=u(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?u(this.string,this.lineStart,this.tabSize):0)},pa.prototype.indentation=function(){return u(this.string,null,this.tabSize)-(this.lineStart?u(this.string,this.lineStart,this.tabSize):0)},pa.prototype.match=function(t,e,i){if("string"!=typeof t){var n=this.string.slice(this.pos).match(t);return n&&n.index>0?null:(n&&!1!==e&&(this.pos+=n[0].length),n)}var o=function(t){return i?t.toLowerCase():t};if(o(this.string.substr(this.pos,t.length))==o(t))return!1!==e&&(this.pos+=t.length),!0},pa.prototype.current=function(){return this.string.slice(this.start,this.pos)},pa.prototype.hideFirstChars=function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}},pa.prototype.lookAhead=function(t){var e=this.lineOracle;return e&&e.lookAhead(t)},pa.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)};var fa=function(t,e){this.state=t,this.lookAhead=e},ga=function(t,e,i,n){this.state=e,this.doc=t,this.line=i,this.maxLookAhead=n||0,this.baseTokens=null,this.baseTokenPos=1};ga.prototype.lookAhead=function(t){var e=this.doc.getLine(this.line+t);return null!=e&&t>this.maxLookAhead&&(this.maxLookAhead=t),e},ga.prototype.baseToken=function(t){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=t;)this.baseTokenPos+=2;var e=this.baseTokens[this.baseTokenPos+1];return{type:e&&e.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},ga.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},ga.fromSaved=function(t,e,i){return e instanceof fa?new ga(t,Y(t.mode,e.state),i,e.lookAhead):new ga(t,Y(t.mode,e),i)},ga.prototype.save=function(t){var e=!1!==t?Y(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new fa(e,this.maxLookAhead):e};var ma=function(t,e,i){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=e||null,this.state=i},va=!1,ba=!1,ya=function(t,e,i){this.text=t,Ft(this,e),this.height=i?i(this):1};ya.prototype.lineNo=function(){return nt(this)},B(ya);var Sa,ka={},wa={},_a=null,xa=null,La={left:0,right:0,top:0,bottom:0},Ca=function(t,e,i){this.cm=i;var o=this.vert=n("div",[n("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=n("div",[n("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");o.tabIndex=r.tabIndex=-1,t(o),t(r),oa(o,"scroll",function(){o.clientHeight&&e(o.scrollTop,"vertical")}),oa(r,"scroll",function(){r.clientWidth&&e(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,ws&&_s<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Ca.prototype.update=function(t){var e=t.scrollWidth>t.clientWidth+1,i=t.scrollHeight>t.clientHeight+1,n=t.nativeBarWidth;if(i){this.vert.style.display="block",this.vert.style.bottom=e?n+"px":"0";var o=t.viewHeight-(e?n:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+o)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(e){this.horiz.style.display="block",this.horiz.style.right=i?n+"px":"0",this.horiz.style.left=t.barLeft+"px";var r=t.viewWidth-t.barLeft-(i?n:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+r)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?n:0,bottom:e?n:0}},Ca.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Ca.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Ca.prototype.zeroWidthHack=function(){var t=Ds&&!Ms?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Us,this.disableVert=new Us},Ca.prototype.enableZeroWidthBar=function(t,e,i){function n(){var o=t.getBoundingClientRect()
;("vert"==i?document.elementFromPoint(o.right-1,(o.top+o.bottom)/2):document.elementFromPoint((o.right+o.left)/2,o.bottom-1))!=t?t.style.pointerEvents="none":e.set(1e3,n)}t.style.pointerEvents="auto",e.set(1e3,n)},Ca.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var Ea=function(){};Ea.prototype.update=function(){return{bottom:0,right:0}},Ea.prototype.setScrollLeft=function(){},Ea.prototype.setScrollTop=function(){},Ea.prototype.clear=function(){};var Ta={native:Ca,"null":Ea},Ma=0,Aa=function(t,e,i){var n=t.display;this.viewport=e,this.visible=Wi(n,t.doc,e),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=Fe(t),this.force=i,this.dims=Si(t),this.events=[]};Aa.prototype.signal=function(t,e){D(t,e)&&this.events.push(arguments)},Aa.prototype.finish=function(){for(var t=0;t<this.events.length;t++)I.apply(null,this.events[t])};var Ia=0,Oa=null;ws?Oa=-.53:bs?Oa=15:Cs?Oa=-.7:Ts&&(Oa=-1/3);var Ra=function(t,e){this.ranges=t,this.primIndex=e};Ra.prototype.primary=function(){return this.ranges[this.primIndex]},Ra.prototype.equals=function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var i=this.ranges[e],n=t.ranges[e];if(!ct(i.anchor,n.anchor)||!ct(i.head,n.head))return!1}return!0},Ra.prototype.deepCopy=function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new Da(ht(this.ranges[e].anchor),ht(this.ranges[e].head));return new Ra(t,this.primIndex)},Ra.prototype.somethingSelected=function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},Ra.prototype.contains=function(t,e){e||(e=t);for(var i=0;i<this.ranges.length;i++){var n=this.ranges[i];if(lt(e,n.from())>=0&&lt(t,n.to())<=0)return i}return-1};var Da=function(t,e){this.anchor=t,this.head=e};Da.prototype.from=function(){return dt(this.anchor,this.head)},Da.prototype.to=function(){return ut(this.anchor,this.head)},Da.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},Wo.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var i=t,n=t+e;i<n;++i){var o=this.lines[i];this.height-=o.height,se(o),Se(o,"delete")}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,i){this.height+=i,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var n=0;n<e.length;++n)e[n].parent=this},iterN:function(t,e,i){for(var n=t+e;t<n;++t)if(i(this.lines[t]))return!0}},jo.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var i=0;i<this.children.length;++i){var n=this.children[i],o=n.chunkSize();if(t<o){var r=Math.min(e,o-t),s=n.height;if(n.removeInner(t,r),this.height-=s-n.height,o==r&&(this.children.splice(i--,1),n.parent=null),0==(e-=r))break;t=0}else t-=o}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof Wo))){var a=[];this.collapse(a),this.children=[new Wo(a)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,i){this.size+=e.length,this.height+=i;for(var n=0;n<this.children.length;++n){var o=this.children[n],r=o.chunkSize();if(t<=r){if(o.insertInner(t,e,i),o.lines&&o.lines.length>50){for(var s=o.lines.length%25+25,a=s;a<o.lines.length;){var l=new Wo(o.lines.slice(a,a+=25));o.height-=l.height,this.children.splice(++n,0,l),l.parent=this}o.lines=o.lines.slice(0,s),this.maybeSpill()}break}t-=r}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=new jo(t.children.splice(t.children.length-5,5));if(t.parent){t.size-=e.size,t.height-=e.height;var i=d(t.parent.children,t);t.parent.children.splice(i+1,0,e)}else{var n=new jo(t.children);n.parent=t,t.children=[n,e],t=n}e.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,i){for(var n=0;n<this.children.length;++n){var o=this.children[n],r=o.chunkSize();if(t<r){var s=Math.min(e,r-t);if(o.iterN(t,s,i))return!0;if(0==(e-=s))break;t=0}else t-=r}}};var Ba=function(t,e,i){if(i)for(var n in i)i.hasOwnProperty(n)&&(this[n]=i[n]);this.doc=t,this.node=e};Ba.prototype.clear=function(){var t=this.doc.cm,e=this.line.widgets,i=this.line,n=nt(i);if(null!=n&&e){for(var o=0;o<e.length;++o)e[o]==this&&e.splice(o--,1);e.length||(i.widgets=null);var r=De(this);it(i,Math.max(0,i.height-r)),t&&(vn(t,function(){Go(t,i,-r),Ei(t,n,"widget")}),Se(t,"lineWidgetCleared",t,this,n))}},Ba.prototype.changed=function(){var t=this,e=this.height,i=this.doc.cm,n=this.line;this.height=null;var o=De(this)-e;o&&(te(this.doc,n)||it(n,n.height+o),i&&vn(i,function(){i.curOp.forceUpdate=!0,Go(i,n,o),Se(i,"lineWidgetChanged",i,t,nt(n))}))},B(Ba);var Pa=0,Na=function(t,e){this.lines=[],this.type=e,this.doc=t,this.id=++Pa};Na.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;if(e&&cn(t),D(this,"clear")){var i=this.find();i&&Se(this,"clear",i.from,i.to)}for(var n=null,o=null,r=0;r<this.lines.length;++r){var s=this.lines[r],a=It(s.markedSpans,this);t&&!this.collapsed?Ei(t,nt(s),"text"):t&&(null!=a.to&&(o=nt(s)),null!=a.from&&(n=nt(s))),s.markedSpans=Ot(s.markedSpans,a),null==a.from&&this.collapsed&&!te(this.doc,s)&&t&&it(s,bi(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var c=Xt(this.lines[l]),h=ne(c);h>t.display.maxLineLength&&(t.display.maxLine=c,t.display.maxLineLength=h,t.display.maxLineChanged=!0)}null!=n&&t&&this.collapsed&&Ci(t,n,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&Co(t.doc)),t&&Se(t,"markerCleared",t,this,n,o),e&&hn(t),this.parent&&this.parent.clear()}},Na.prototype.find=function(t,e){var i,n;null==t&&"bookmark"==this.type&&(t=1);for(var o=0;o<this.lines.length;++o){var r=this.lines[o],s=It(r.markedSpans,this);if(null!=s.from&&(i=at(e?r:nt(r),s.from),-1==t))return i;if(null!=s.to&&(n=at(e?r:nt(r),s.to),1==t))return n}return i&&{from:i,to:n}},Na.prototype.changed=function(){var t=this,e=this.find(-1,!0),i=this,n=this.doc.cm;e&&n&&vn(n,function(){var o=e.line,r=nt(e.line),s=Ge(n,r);if(s&&(Qe(s),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!te(i.doc,o)&&null!=i.height){var a=i.height;i.height=null;var l=De(i)-a;l&&it(o,o.height+l)}Se(n,"markerChanged",n,t)})},Na.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=d(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},Na.prototype.detachLine=function(t){if(this.lines.splice(d(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}},B(Na);var za=function(t,e){this.markers=t,this.primary=e;for(var i=0;i<t.length;++i)t[i].parent=this};za.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();Se(this,"clear")}},za.prototype.find=function(t,e){return this.primary.find(t,e)},B(za);var Va=0,Fa=function(t,e,i,n,o){if(!(this instanceof Fa))return new Fa(t,e,i,n,o);null==i&&(i=0),jo.call(this,[new Wo([new ya("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=i;var r=at(i,0);this.sel=Hn(r),this.history=new io(null),this.id=++Va,this.modeOption=e,this.lineSep=n,this.direction="rtl"==o?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),Zn(this,{from:r,to:r,text:t}),_o(this,Hn(r),Xs)};Fa.prototype=y(jo.prototype,{constructor:Fa,iter:function(t,e,i){i?this.iterN(t-this.first,e-t,i):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var i=0,n=0;n<e.length;++n)i+=e[n].height;this.insertInner(t-this.first,e,i)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=et(this,this.first,this.first+this.size);return!1===t?e:e.join(t||this.lineSeparator())},setValue:Sn(function(t){var e=at(this.first,0),i=this.first+this.size-1;Ro(this,{from:e,to:at(i,Q(this,i).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&Zi(this.cm,0,0),_o(this,Hn(e),Xs)}),replaceRange:function(t,e,i,n){Vo(this,t,e=ft(this,e),i=i?ft(this,i):e,n)},getRange:function(t,e,i){var n=tt(this,ft(this,t),ft(this,e));return!1===i?n:n.join(i||this.lineSeparator())},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){if(rt(this,t))return Q(this,t)},getLineNumber:function(t){return nt(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=Q(this,t)),Xt(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return ft(this,t)},getCursor:function(t){var e=this.sel.primary();return null==t||"head"==t?e.head:"anchor"==t?e.anchor:"end"==t||"to"==t||!1===t?e.to():e.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Sn(function(t,e,i){So(this,ft(this,"number"==typeof t?at(t,e||0):t),null,i)}),setSelection:Sn(function(t,e,i){So(this,ft(this,t),ft(this,e||t),i)}),extendSelection:Sn(function(t,e,i){vo(this,ft(this,t),e&&ft(this,e),i)}),extendSelections:Sn(function(t,e){bo(this,mt(this,t),e)}),extendSelectionsBy:Sn(function(t,e){bo(this,mt(this,m(this.sel.ranges,t)),e)}),setSelections:Sn(function(t,e,i){if(t.length){for(var n=[],o=0;o<t.length;o++)n[o]=new Da(ft(this,t[o].anchor),ft(this,t[o].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),_o(this,$n(this.cm,n,e),i)}}),addSelection:Sn(function(t,e,i){var n=this.sel.ranges.slice(0);n.push(new Da(ft(this,t),ft(this,e||t))),_o(this,$n(this.cm,n,n.length-1),i)}),getSelection:function(t){for(var e,i=this.sel.ranges,n=0;n<i.length;n++){var o=tt(this,i[n].from(),i[n].to());e=e?e.concat(o):o}return!1===t?e:e.join(t||this.lineSeparator())},getSelections:function(t){for(var e=[],i=this.sel.ranges,n=0;n<i.length;n++){var o=tt(this,i[n].from(),i[n].to());!1!==t&&(o=o.join(t||this.lineSeparator())),e[n]=o}return e},replaceSelection:function(t,e,i){for(var n=[],o=0;o<this.sel.ranges.length;o++)n[o]=t;this.replaceSelections(n,e,i||"+input")},replaceSelections:Sn(function(t,e,i){for(var n=[],o=this.sel,r=0;r<o.ranges.length;r++){var s=o.ranges[r];n[r]={from:s.from(),to:s.to(),text:this.splitLines(t[r]),origin:i}}for(var a=e&&"end"!=e&&qn(this,n,e),l=n.length-1;l>=0;l--)Ro(this,n[l]);a?wo(this,a):this.cm&&Yi(this.cm)}),undo:Sn(function(){Bo(this,"undo")}),redo:Sn(function(){Bo(this,"redo")}),undoSelection:Sn(function(){Bo(this,"undo",!0)}),redoSelection:Sn(function(){Bo(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,i=0,n=0;n<t.done.length;n++)t.done[n].ranges||++e;for(var o=0;o<t.undone.length;o++)t.undone[o].ranges||++i;return{undo:e,redo:i}},clearHistory:function(){this.history=new io(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:go(this.history.done),undone:go(this.history.undone)}},setHistory:function(t){var e=this.history=new io(this.history.maxGeneration);e.done=go(t.done.slice(0),null,!0),e.undone=go(t.undone.slice(0),null,!0)},setGutterMarker:Sn(function(t,e,i){return Uo(this,t,"gutter",function(t){var n=t.gutterMarkers||(t.gutterMarkers={});return n[e]=i,!i&&w(n)&&(t.gutterMarkers=null),!0})}),clearGutter:Sn(function(t){var e=this;this.iter(function(i){i.gutterMarkers&&i.gutterMarkers[t]&&Uo(e,i,"gutter",function(){return i.gutterMarkers[t]=null,w(i.gutterMarkers)&&(i.gutterMarkers=null),!0})})}),lineInfo:function(t){var e;if("number"==typeof t){if(!rt(this,t))return null;if(e=t,!(t=Q(this,t)))return null}else if(null==(e=nt(t)))return null;return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:Sn(function(e,i,n){return Uo(this,e,"gutter"==i?"gutter":"class",function(e){var o="text"==i?"textClass":"background"==i?"bgClass":"gutter"==i?"gutterClass":"wrapClass";if(e[o]){if(t(n).test(e[o]))return!1;e[o]+=" "+n}else e[o]=n;return!0})}),removeLineClass:Sn(function(e,i,n){return Uo(this,e,"gutter"==i?"gutter":"class",function(e){var o="text"==i?"textClass":"background"==i?"bgClass":"gutter"==i?"gutterClass":"wrapClass",r=e[o];if(!r)return!1;if(null==n)e[o]=null;else{var s=r.match(t(n));if(!s)return!1;var a=s.index+s[0].length;e[o]=r.slice(0,s.index)+(s.index&&a!=r.length?" ":"")+r.slice(a)||null}return!0})}),addLineWidget:Sn(function(t,e,i){return qo(this,t,e,i)}),removeLineWidget:function(t){t.clear()},markText:function(t,e,i){return Ko(this,ft(this,t),ft(this,e),i,i&&i.type||"range")},setBookmark:function(t,e){var i={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return Ko(this,t=ft(this,t),t,i,"bookmark")},findMarksAt:function(t){var e=[],i=Q(this,(t=ft(this,t)).line).markedSpans;if(i)for(var n=0;n<i.length;++n){var o=i[n];(null==o.from||o.from<=t.ch)&&(null==o.to||o.to>=t.ch)&&e.push(o.marker.parent||o.marker)}return e},findMarks:function(t,e,i){t=ft(this,t),e=ft(this,e);var n=[],o=t.line;return this.iter(t.line,e.line+1,function(r){var s=r.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];null!=l.to&&o==t.line&&t.ch>=l.to||null==l.from&&o!=t.line||null!=l.from&&o==e.line&&l.from>=e.ch||i&&!i(l.marker)||n.push(l.marker.parent||l.marker)}++o}),n},getAllMarks:function(){var t=[];return this.iter(function(e){var i=e.markedSpans;if(i)for(var n=0;n<i.length;++n)null!=i[n].from&&t.push(i[n].marker)}),t},posFromIndex:function(t){var e,i=this.first,n=this.lineSeparator().length;return this.iter(function(o){var r=o.text.length+n;if(r>t)return e=t,!0;t-=r,++i}),ft(this,at(i,e))},indexFromPos:function(t){var e=(t=ft(this,t)).ch;if(t.line<this.first||t.ch<0)return 0;var i=this.lineSeparator().length;return this.iter(this.first,t.line,function(t){e+=t.text.length+i}),e},copy:function(t){var e=new Fa(et(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,i=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<i&&(i=t.to);var n=new Fa(et(this,e,i),t.mode||this.modeOption,e,this.lineSep,this.direction);return t.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:t.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],Zo(n,Yo(this)),n},unlinkDoc:function(t){if(t instanceof Xr&&(t=t.doc),this.linked)for(var e=0;e<this.linked.length;++e){if(this.linked[e].doc==t){this.linked.splice(e,1),t.unlinkDoc(this),Jo(Yo(this));break}}if(t.history==this.history){var i=[t.id];Jn(t,function(t){return i.push(t.id)},!0),t.history=new io(null),t.history.done=go(this.history.done,i),t.history.undone=go(this.history.undone,i)}},iterLinkedDocs:function(t){Jn(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):sa(t)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Sn(function(t){"rtl"!=t&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter(function(t){return t.order=null}),this.cm&&eo(this.cm))})}),Fa.prototype.eachLine=Fa.prototype.iter;for(var $a=0,Ha=!1,Ua={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Wa=0;Wa<10;Wa++)Ua[Wa+48]=Ua[Wa+96]=String(Wa);for(var ja=65;ja<=90;ja++)Ua[ja]=String.fromCharCode(ja);for(var Ga=1;Ga<=12;Ga++)Ua[Ga+111]=Ua[Ga+63235]="F"+Ga;var qa={basic:{Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},pcDefault:{"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},emacsy:{"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},macDefault:{"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]}};qa["default"]=Ds?qa.macDefault:qa.pcDefault;var Ka,Xa,Ya={selectAll:Io,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),Xs)},killLine:function(t){return fr(t,function(e){if(e.empty()){var i=Q(t.doc,e.head.line).text.length;return e.head.ch==i&&e.head.line<t.lastLine()?{from:e.head,to:at(e.head.line+1,0)}:{from:e.head,to:at(e.head.line,i)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){return fr(t,function(e){return{from:at(e.from().line,0),to:ft(t.doc,at(e.to().line+1,0))}})},delLineLeft:function(t){return fr(t,function(t){return{from:at(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(t){return fr(t,function(e){var i=t.charCoords(e.head,"div").top+5;return{from:t.coordsChar({left:0,top:i},"div"),to:e.from()}})},delWrappedLineRight:function(t){return fr(t,function(e){var i=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:i},"div");return{from:e.from(),to:n}})},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(at(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(at(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return yr(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return kr(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return Sr(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){var i=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:i},"div")},Zs)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){var i=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:i},"div")},Zs)},goLineLeftSmart:function(t){return t.extendSelectionsBy(function(e){var i=t.cursorCoords(e.head,"div").top+5,n=t.coordsChar({left:0,top:i},"div");return n.ch<t.getLine(n.line).search(/\S/)?kr(t,e.head):n},Zs)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"char")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("\t")},insertSoftTab:function(t){for(var e=[],i=t.listSelections(),n=t.options.tabSize,o=0;o<i.length;o++){var r=i[o].from(),s=u(t.getLine(r.line),r.ch,n);e.push(f(n-s%n))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return vn(t,function(){for(var e=t.listSelections(),i=[],n=0;n<e.length;n++)if(e[n].empty()){var o=e[n].head,r=Q(t.doc,o.line).text;if(r)if(o.ch==r.length&&(o=new at(o.line,o.ch-1)),o.ch>0)o=new at(o.line,o.ch+1),t.replaceRange(r.charAt(o.ch-1)+r.charAt(o.ch-2),at(o.line,o.ch-2),o,"+transpose");else if(o.line>t.doc.first){var s=Q(t.doc,o.line-1).text;s&&(o=new at(o.line,1),t.replaceRange(r.charAt(0)+t.doc.lineSeparator()+s.charAt(s.length-1),at(o.line-1,s.length-1),o,"+transpose"))}i.push(new Da(o,o))}t.setSelections(i)})},newlineAndIndent:function(t){return vn(t,function(){for(var e=t.listSelections(),i=e.length-1;i>=0;i--)t.replaceRange(t.doc.lineSeparator(),e[i].anchor,e[i].head,"+input");e=t.listSelections();for(var n=0;n<e.length;n++)t.indentLine(e[n].from().line,null,!0);Yi(t)})},openLine:function(t){return t.replaceSelection("\n","start")},toggleOverwrite:function(t){return t.toggleOverwrite()}},Za=new Us,Ja=null,Qa=400,tl=function(t,e,i){this.time=t,this.pos=e,this.button=i};tl.prototype.compare=function(t,e,i){return this.time+Qa>t&&0==lt(e,this.pos)&&i==this.button};var el={toString:function(){return"CodeMirror.Init"}},il={},nl={};Xr.defaults=il,Xr.optionHandlers=nl;var ol=[];Xr.defineInitHook=function(t){return ol.push(t)};var rl=null,sl=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Us,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};sl.prototype.init=function(t){function e(t){if(!O(o,t)){if(o.somethingSelected())Jr({lineWise:!1,text:o.getSelections()}),"cut"==t.type&&o.replaceSelection("",null,"cut");else{if(!o.options.lineWiseCopyCut)return;var e=is(o);Jr({lineWise:!0,text:e.text}),"cut"==t.type&&o.operation(function(){o.setSelections(e.ranges,0,Xs),o.replaceSelection("",null,"cut")})}if(t.clipboardData){t.clipboardData.clearData();var i=rl.text.join("\n");if(t.clipboardData.setData("Text",i),t.clipboardData.getData("Text")==i)return void t.preventDefault()}var s=os(),a=s.firstChild;o.display.lineSpace.insertBefore(s,o.display.lineSpace.firstChild),a.value=rl.text.join("\n");var l=document.activeElement;Hs(a),setTimeout(function(){o.display.lineSpace.removeChild(s),l.focus(),l==r&&n.showPrimarySelection()},50)}}var i=this,n=this,o=n.cm,r=n.div=t.lineDiv;ns(r,o.options.spellcheck,o.options.autocorrect,o.options.autocapitalize),oa(r,"paste",function(t){O(o,t)||ts(t,o)||_s<=11&&setTimeout(bn(o,function(){return i.updateFromDOM()}),20)}),oa(r,"compositionstart",function(t){i.composing={data:t.data,done:!1}}),oa(r,"compositionupdate",function(t){i.composing||(i.composing={data:t.data,done:!1})}),oa(r,"compositionend",function(t){i.composing&&(t.data!=i.composing.data&&i.readFromDOMSoon(),i.composing.done=!0)}),oa(r,"touchstart",function(){return n.forceCompositionEnd()}),oa(r,"input",function(){i.composing||i.readFromDOMSoon()}),oa(r,"copy",e),oa(r,"cut",e)},sl.prototype.prepareSelection=function(){var t=Ri(this.cm,!1);return t.focus=this.cm.state.focused,t},sl.prototype.showSelection=function(t,e){t&&this.cm.display.view.length&&((t.focus||e)&&this.showPrimarySelection(),this.showMultipleSelections(t))},sl.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},sl.prototype.showPrimarySelection=function(){var t=this.getSelection(),e=this.cm,i=e.doc.sel.primary(),n=i.from(),o=i.to();if(e.display.viewTo==e.display.viewFrom||n.line>=e.display.viewTo||o.line<e.display.viewFrom)t.removeAllRanges();else{var r=ds(e,t.anchorNode,t.anchorOffset),s=ds(e,t.focusNode,t.focusOffset);if(!r||r.bad||!s||s.bad||0!=lt(dt(r,s),n)||0!=lt(ut(r,s),o)){var a=e.display.view,l=n.line>=e.display.viewFrom&&ls(e,n)||{node:a[0].measure.map[2],offset:0},c=o.line<e.display.viewTo&&ls(e,o);if(!c){var h=a[a.length-1].measure,u=h.maps?h.maps[h.maps.length-1]:h.map;c={node:u[u.length-1],offset:u[u.length-2]-u[u.length-3]}}if(l&&c){var d,p=t.rangeCount&&t.getRangeAt(0);try{d=zs(l.node,l.offset,c.offset,c.node)}catch(Gs){}d&&(!bs&&e.state.focused?(t.collapse(l.node,l.offset),d.collapsed||(t.removeAllRanges(),t.addRange(d))):(t.removeAllRanges(),t.addRange(d)),p&&null==t.anchorNode?t.addRange(p):bs&&this.startGracePeriod()),this.rememberSelection()}else t.removeAllRanges()}}},sl.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){return t.cm.curOp.selectionChanged=!0})},20)},sl.prototype.showMultipleSelections=function(t){i(this.cm.display.cursorDiv,t.cursors),i(this.cm.display.selectionDiv,t.selection)},sl.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},sl.prototype.selectionInEditor=function(){var t=this.getSelection();if(!t.rangeCount)return!1;var e=t.getRangeAt(0).commonAncestorContainer;return r(this.div,e)},sl.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},sl.prototype.blur=function(){this.div.blur()},sl.prototype.getField=function(){return this.div},sl.prototype.supportsTouch=function(){return!0},sl.prototype.receivedFocus=function(){function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))}var e=this;this.selectionInEditor()?this.pollSelection():vn(this.cm,function(){return e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,t)},sl.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},sl.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var t=this.getSelection(),e=this.cm;if(Os&&Cs&&this.cm.display.gutterSpecs.length&&cs(t.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var i=ds(e,t.anchorNode,t.anchorOffset),n=ds(e,t.focusNode,t.focusOffset);i&&n&&vn(e,function(){_o(e.doc,Hn(i,n),Xs),(i.bad||n.bad)&&(e.curOp.selectionChanged=!0)})}}},sl.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var t,e,i,n=this.cm,o=n.display,r=n.doc.sel.primary(),s=r.from(),a=r.to();if(0==s.ch&&s.line>n.firstLine()&&(s=at(s.line-1,Q(n.doc,s.line-1).length)),a.ch==Q(n.doc,a.line).text.length&&a.line<n.lastLine()&&(a=at(a.line+1,0)),s.line<o.viewFrom||a.line>o.viewTo-1)return!1;s.line==o.viewFrom||0==(t=Li(n,s.line))?(e=nt(o.view[0].line),i=o.view[0].node):(e=nt(o.view[t].line),i=o.view[t-1].node.nextSibling);var l,c,h=Li(n,a.line);if(h==o.view.length-1?(l=o.viewTo-1,c=o.lineDiv.lastChild):(l=nt(o.view[h+1].line)-1,c=o.view[h+1].node.previousSibling),!i)return!1;for(var u=n.doc.splitLines(us(n,i,c,e,l)),d=tt(n.doc,at(e,0),at(l,Q(n.doc,l).text.length));u.length>1&&d.length>1;)if(g(u)==g(d))u.pop(),d.pop(),l--;else{if(u[0]!=d[0])break;u.shift(),d.shift(),e++}for(var p=0,f=0,m=u[0],v=d[0],b=Math.min(m.length,v.length);p<b&&m.charCodeAt(p)==v.charCodeAt(p);)++p;for(var y=g(u),S=g(d),k=Math.min(y.length-(1==u.length?p:0),S.length-(1==d.length?p:0));f<k&&y.charCodeAt(y.length-f-1)==S.charCodeAt(S.length-f-1);)++f;if(1==u.length&&1==d.length&&e==s.line)for(;p&&p>s.ch&&y.charCodeAt(y.length-f-1)==S.charCodeAt(S.length-f-1);)p--,f++;u[u.length-1]=y.slice(0,y.length-f).replace(/^\u200b+/,""),u[0]=u[0].slice(p).replace(/\u200b+$/,"");var w=at(e,p),_=at(l,d.length?g(d).length-f:0);return u.length>1||u[0]||lt(w,_)?(Vo(n.doc,u,w,_,"+input"),!0):void 0},sl.prototype.ensurePolled=function(){this.forceCompositionEnd()},sl.prototype.reset=function(){this.forceCompositionEnd()},sl.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},sl.prototype.readFromDOMSoon=function(){var t=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(t.readDOMTimeout=null,t.composing){if(!t.composing.done)return;t.composing=null}t.updateFromDOM()},80))},sl.prototype.updateFromDOM=function(){var t=this;!this.cm.isReadOnly()&&this.pollContent()||vn(this.cm,function(){return Ci(t.cm)})},sl.prototype.setUneditable=function(t){t.contentEditable="false"},sl.prototype.onKeyPress=function(t){0==t.charCode||this.composing||(t.preventDefault(),this.cm.isReadOnly()||bn(this.cm,Qr)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))},sl.prototype.readOnlyChanged=function(t){this.div.contentEditable=String("nocursor"!=t)},sl.prototype.onContextMenu=function(){},sl.prototype.resetPosition=function(){},sl.prototype.needsContentAttribute=!0;var al=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new Us,this.hasSelection=!1,this.composing=null};al.prototype.init=function(t){function e(t){if(!O(o,t)){if(o.somethingSelected())Jr({lineWise:!1,text:o.getSelections()});else{if(!o.options.lineWiseCopyCut)return;var e=is(o);Jr({lineWise:!0,text:e.text}),"cut"==t.type?o.setSelections(e.ranges,null,Xs):(n.prevInput="",r.value=e.text.join("\n"),Hs(r))}"cut"==t.type&&(o.state.cutIncoming=+new Date)}}var i=this,n=this,o=this.cm;this.createField(t);var r=this.textarea;t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),Is&&(r.style.width="0px"),oa(r,"input",function(){ws&&_s>=9&&i.hasSelection&&(i.hasSelection=null),n.poll()}),oa(r,"paste",function(t){O(o,t)||ts(t,o)||(o.state.pasteIncoming=+new Date,n.fastPoll())}),oa(r,"cut",e),oa(r,"copy",e),oa(t.scroller,"paste",function(e){if(!Be(t,e)&&!O(o,e)){if(!r.dispatchEvent)return o.state.pasteIncoming=+new Date,void n.focus();var i=new Event("paste");i.clipboardData=e.clipboardData,r.dispatchEvent(i)}}),
oa(t.lineSpace,"selectstart",function(e){Be(t,e)||P(e)}),oa(r,"compositionstart",function(){var t=o.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:t,range:o.markText(t,o.getCursor("to"),{className:"CodeMirror-composing"})}}),oa(r,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},al.prototype.createField=function(){this.wrapper=os(),this.textarea=this.wrapper.firstChild},al.prototype.prepareSelection=function(){var t=this.cm,e=t.display,i=t.doc,n=Ri(t);if(t.options.moveInputWithCursor){var o=li(t,i.sel.primary().head,"div"),r=e.wrapper.getBoundingClientRect(),s=e.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,o.top+s.top-r.top)),n.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,o.left+s.left-r.left))}return n},al.prototype.showSelection=function(t){var e=this.cm.display;i(e.cursorDiv,t.cursors),i(e.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},al.prototype.reset=function(t){if(!this.contextMenuPending&&!this.composing){var e=this.cm;if(e.somethingSelected()){this.prevInput="";var i=e.getSelection();this.textarea.value=i,e.state.focused&&Hs(this.textarea),ws&&_s>=9&&(this.hasSelection=i)}else t||(this.prevInput=this.textarea.value="",ws&&_s>=9&&(this.hasSelection=null))}},al.prototype.getField=function(){return this.textarea},al.prototype.supportsTouch=function(){return!1},al.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!Rs||s()!=this.textarea))try{this.textarea.focus()}catch(Gs){}},al.prototype.blur=function(){this.textarea.blur()},al.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},al.prototype.receivedFocus=function(){this.slowPoll()},al.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},al.prototype.fastPoll=function(){function t(){i.poll()||e?(i.pollingFast=!1,i.slowPoll()):(e=!0,i.polling.set(60,t))}var e=!1,i=this;i.pollingFast=!0,i.polling.set(20,t)},al.prototype.poll=function(){var t=this,e=this.cm,i=this.textarea,n=this.prevInput;if(this.contextMenuPending||!e.state.focused||aa(i)&&!n&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var o=i.value;if(o==n&&!e.somethingSelected())return!1;if(ws&&_s>=9&&this.hasSelection===o||Ds&&/[\uf700-\uf7ff]/.test(o))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var r=o.charCodeAt(0);if(8203!=r||n||(n="\u200b"),8666==r)return this.reset(),this.cm.execCommand("undo")}for(var s=0,a=Math.min(n.length,o.length);s<a&&n.charCodeAt(s)==o.charCodeAt(s);)++s;return vn(e,function(){Qr(e,o.slice(s),n.length-s,null,t.composing?"*compose":null),o.length>1e3||o.indexOf("\n")>-1?i.value=t.prevInput="":t.prevInput=o,t.composing&&(t.composing.range.clear(),t.composing.range=e.markText(t.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},al.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},al.prototype.onKeyPress=function(){ws&&_s>=9&&(this.hasSelection=null),this.fastPoll()},al.prototype.onContextMenu=function(t){function e(){if(null!=s.selectionStart){var t=o.somethingSelected(),e="\u200b"+(t?s.value:"");s.value="\u21da",s.value=e,n.prevInput=t?"":"\u200b",s.selectionStart=1,s.selectionEnd=e.length,r.selForContextMenu=o.doc.sel}}function i(){if(n.contextMenuPending==i&&(n.contextMenuPending=!1,n.wrapper.style.cssText=u,s.style.cssText=h,ws&&_s<9&&r.scrollbars.setScrollTop(r.scroller.scrollTop=l),null!=s.selectionStart)){(!ws||ws&&_s<9)&&e();var t=0,a=function(){r.selForContextMenu==o.doc.sel&&0==s.selectionStart&&s.selectionEnd>0&&"\u200b"==n.prevInput?bn(o,Io)(o):t++<10?r.detectingSelectAll=setTimeout(a,500):(r.selForContextMenu=null,r.input.reset())};r.detectingSelectAll=setTimeout(a,200)}}var n=this,o=n.cm,r=o.display,s=n.textarea;n.contextMenuPending&&n.contextMenuPending();var a=xi(o,t),l=r.scroller.scrollTop;if(a&&!Es){o.options.resetSelectionOnContextMenu&&-1==o.doc.sel.contains(a)&&bn(o,_o)(o.doc,Hn(a),Xs);var c,h=s.style.cssText,u=n.wrapper.style.cssText,d=n.wrapper.offsetParent.getBoundingClientRect();if(n.wrapper.style.cssText="position: static",s.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(t.clientY-d.top-5)+"px; left: "+(t.clientX-d.left-5)+"px;\n      z-index: 1000; background: "+(ws?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",xs&&(c=window.scrollY),r.input.focus(),xs&&window.scrollTo(null,c),r.input.reset(),o.somethingSelected()||(s.value=n.prevInput=" "),n.contextMenuPending=i,r.selForContextMenu=o.doc.sel,clearTimeout(r.detectingSelectAll),ws&&_s>=9&&e(),Fs){V(t);var p=function(){A(window,"mouseup",p),setTimeout(i,20)};oa(window,"mouseup",p)}else setTimeout(i,50)}},al.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled="nocursor"==t},al.prototype.setUneditable=function(){},al.prototype.needsContentAttribute=!1,Gr(Xr),rs(Xr);var ll="iter insert remove copy getEditor constructor".split(" ");for(var cl in Fa.prototype)Fa.prototype.hasOwnProperty(cl)&&d(ll,cl)<0&&(Xr.prototype[cl]=function(t){return function(){return t.apply(this.doc,arguments)}}(Fa.prototype[cl]));return B(Fa),Xr.inputStyles={textarea:al,contenteditable:sl},Xr.defineMode=function(t){Xr.defaults.mode||"null"==t||(Xr.defaults.mode=t),j.apply(this,arguments)},Xr.defineMIME=G,Xr.defineMode("null",function(){return{token:function(t){return t.skipToEnd()}}}),Xr.defineMIME("text/plain","null"),Xr.defineExtension=function(t,e){Xr.prototype[t]=e},Xr.defineDocExtension=function(t,e){Fa.prototype[t]=e},Xr.fromTextArea=fs,gs(Xr),Xr.version="5.48.4",Xr}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){var e=t.search(r);return-1==e?0:e}function i(t,e,i){return/\bstring\b/.test(t.getTokenTypeAt(s(e.line,0)))&&!/^[\'\"\`]/.test(i)}function n(t,e){var i=t.getMode();return!1!==i.useInnerComments&&i.innerMode?t.getModeAt(e):i}var o={},r=/[^\s\u00a0]/,s=t.Pos;t.commands.toggleComment=function(t){t.toggleComment()},t.defineExtension("toggleComment",function(t){t||(t=o);for(var e=this,i=Infinity,n=this.listSelections(),r=null,a=n.length-1;a>=0;a--){var l=n[a].from(),c=n[a].to();l.line>=i||(c.line>=i&&(c=s(i,0)),i=l.line,null==r?e.uncomment(l,c,t)?r="un":(e.lineComment(l,c,t),r="line"):"un"==r?e.uncomment(l,c,t):e.lineComment(l,c,t))}}),t.defineExtension("lineComment",function(t,a,l){l||(l=o);var c=this,h=n(c,t),u=c.getLine(t.line);if(null!=u&&!i(c,t,u)){var d=l.lineComment||h.lineComment;if(d){var p=Math.min(0!=a.ch||a.line==t.line?a.line+1:a.line,c.lastLine()+1),f=null==l.padding?" ":l.padding,g=l.commentBlankLines||t.line==a.line;c.operation(function(){if(l.indent){for(var i=null,n=t.line;n<p;++n){var o=(a=c.getLine(n)).slice(0,e(a));(null==i||i.length>o.length)&&(i=o)}for(n=t.line;n<p;++n){var a=c.getLine(n),h=i.length;(g||r.test(a))&&(a.slice(0,h)!=i&&(h=e(a)),c.replaceRange(i+d+f,s(n,0),s(n,h)))}}else for(n=t.line;n<p;++n)(g||r.test(c.getLine(n)))&&c.replaceRange(d+f,s(n,0))})}else(l.blockCommentStart||h.blockCommentStart)&&(l.fullLines=!0,c.blockComment(t,a,l))}}),t.defineExtension("blockComment",function(t,e,i){i||(i=o);var a=this,l=n(a,t),c=i.blockCommentStart||l.blockCommentStart,h=i.blockCommentEnd||l.blockCommentEnd;if(c&&h){if(!/\bcomment\b/.test(a.getTokenTypeAt(s(t.line,0)))){var u=Math.min(e.line,a.lastLine());u!=t.line&&0==e.ch&&r.test(a.getLine(u))&&--u;var d=null==i.padding?" ":i.padding;t.line>u||a.operation(function(){if(0!=i.fullLines){var n=r.test(a.getLine(u));a.replaceRange(d+h,s(u)),a.replaceRange(c+d,s(t.line,0));var o=i.blockCommentLead||l.blockCommentLead;if(null!=o)for(var p=t.line+1;p<=u;++p)(p!=u||n)&&a.replaceRange(o+d,s(p,0))}else a.replaceRange(h,e),a.replaceRange(c,t)})}}else(i.lineComment||l.lineComment)&&0!=i.fullLines&&a.lineComment(t,e,i)}),t.defineExtension("uncomment",function(t,e,i){i||(i=o);var a,l=this,c=n(l,t),h=Math.min(0!=e.ch||e.line==t.line?e.line:e.line-1,l.lastLine()),u=Math.min(t.line,h),d=i.lineComment||c.lineComment,p=[],f=null==i.padding?" ":i.padding;t:if(d){for(var g=u;g<=h;++g){var m=l.getLine(g),v=m.indexOf(d);if(v>-1&&!/comment/.test(l.getTokenTypeAt(s(g,v+1)))&&(v=-1),-1==v&&r.test(m))break t;if(v>-1&&r.test(m.slice(0,v)))break t;p.push(m)}if(l.operation(function(){for(var t=u;t<=h;++t){var e=p[t-u],i=e.indexOf(d),n=i+d.length;i<0||(e.slice(n,n+f.length)==f&&(n+=f.length),a=!0,l.replaceRange("",s(t,i),s(t,n)))}}),a)return!0}var b=i.blockCommentStart||c.blockCommentStart,y=i.blockCommentEnd||c.blockCommentEnd;if(!b||!y)return!1;var S=i.blockCommentLead||c.blockCommentLead,k=l.getLine(u),w=k.indexOf(b);if(-1==w)return!1;var _=h==u?k:l.getLine(h),x=_.indexOf(y,h==u?w+b.length:0),L=s(u,w+1),C=s(h,x+1);if(-1==x||!/comment/.test(l.getTokenTypeAt(L))||!/comment/.test(l.getTokenTypeAt(C))||l.getRange(L,C,"\n").indexOf(y)>-1)return!1;var E=k.lastIndexOf(b,t.ch),T=-1==E?-1:k.slice(0,t.ch).indexOf(y,E+b.length);if(-1!=E&&-1!=T&&T+y.length!=t.ch)return!1;T=_.indexOf(y,e.ch);var M=_.slice(e.ch).lastIndexOf(b,T-e.ch);return E=-1==T||-1==M?-1:e.ch+M,(-1==T||-1==E||E==e.ch)&&(l.operation(function(){l.replaceRange("",s(h,x-(f&&_.slice(x-f.length,x)==f?f.length:0)),s(h,x+y.length));var t=w+b.length;if(f&&k.slice(t,t+f.length)==f&&(t+=f.length),l.replaceRange("",s(u,w),s(u,t)),S)for(var e=u+1;e<=h;++e){var i=l.getLine(e),n=i.indexOf(S);if(-1!=n&&!r.test(i.slice(0,n))){var o=n+S.length;f&&i.slice(o,o+f.length)==f&&(o+=f.length),l.replaceRange("",s(e,n),s(e,o))}}}),!0)})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){function e(e){if(e.getOption("disableInput"))return t.Pass;for(var n,o=e.listSelections(),r=[],s=0;s<o.length;s++){var a=o[s].head;if(!/\bcomment\b/.test(e.getTokenTypeAt(a)))return t.Pass;var l=e.getModeAt(a);if(n){if(n!=l)return t.Pass}else n=l;var c=null;if(n.blockCommentStart&&n.blockCommentContinue){var h,u,d=(h=e.getLine(a.line).slice(0,a.ch)).lastIndexOf(n.blockCommentEnd);if(-1!=d&&d==a.ch-n.blockCommentEnd.length);else if((u=h.lastIndexOf(n.blockCommentStart))>-1&&u>d){if(c=h.slice(0,u),/\S/.test(c)){c="";for(var p=0;p<u;++p)c+=" "}}else(u=h.indexOf(n.blockCommentContinue))>-1&&!/\S/.test(h.slice(0,u))&&(c=h.slice(0,u));null!=c&&(c+=n.blockCommentContinue)}if(null==c&&n.lineComment&&i(e))(u=(h=e.getLine(a.line)).indexOf(n.lineComment))>-1&&(c=h.slice(0,u),/\S/.test(c)?c=null:c+=n.lineComment+h.slice(u+n.lineComment.length).match(/^\s*/)[0]);if(null==c)return t.Pass;r[s]="\n"+c}e.operation(function(){for(var t=o.length-1;t>=0;t--)e.replaceRange(r[t],o[t].from(),o[t].to(),"+insert")})}function i(t){var e=t.getOption("continueComments");return!e||"object"!=typeof e||!1!==e.continueLineComment}t.defineOption("continueComments",null,function(i,n,o){if(o&&o!=t.Init&&i.removeKeyMap("continueComment"),n){var r="Enter";"string"==typeof n?r=n:"object"==typeof n&&n.key&&(r=n.key);var s={name:"continueComment"};s[r]=e,i.addKeyMap(s)}})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){function e(t){return t&&t.bracketRegex||/[(){}[\]]/}function i(t,i,o){var r=t.getLineHandle(i.line),s=i.ch-1,c=o&&o.afterCursor;null==c&&(c=/(^| )cm-fat-cursor($| )/.test(t.getWrapperElement().className));var h=e(o),u=!c&&s>=0&&h.test(r.text.charAt(s))&&l[r.text.charAt(s)]||h.test(r.text.charAt(s+1))&&l[r.text.charAt(++s)];if(!u)return null;var d=">"==u.charAt(1)?1:-1;if(o&&o.strict&&d>0!=(s==i.ch))return null;var p=t.getTokenTypeAt(a(i.line,s+1)),f=n(t,a(i.line,s+(d>0?1:0)),d,p||null,o);return null==f?null:{from:a(i.line,s),to:f&&f.pos,match:f&&f.ch==u.charAt(0),forward:d>0}}function n(t,i,n,o,r){for(var s=r&&r.maxScanLineLength||1e4,c=r&&r.maxScanLines||1e3,h=[],u=e(r),d=n>0?Math.min(i.line+c,t.lastLine()+1):Math.max(t.firstLine()-1,i.line-c),p=i.line;p!=d;p+=n){var f=t.getLine(p);if(f){var g=n>0?0:f.length-1,m=n>0?f.length:-1;if(!(f.length>s))for(p==i.line&&(g=i.ch-(n<0?1:0));g!=m;g+=n){var v=f.charAt(g);if(u.test(v)&&(o===undefined||t.getTokenTypeAt(a(p,g+1))==o)){var b=l[v];if(b&&">"==b.charAt(1)==n>0)h.push(v);else{if(!h.length)return{pos:a(p,g),ch:v};h.pop()}}}}}return p-n!=(n>0?t.lastLine():t.firstLine())&&null}function o(t,e,n){for(var o=t.state.matchBrackets.maxHighlightLineLength||1e3,r=[],l=t.listSelections(),c=0;c<l.length;c++){var h=l[c].empty()&&i(t,l[c].head,n);if(h&&t.getLine(h.from.line).length<=o){var u=h.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";r.push(t.markText(h.from,a(h.from.line,h.from.ch+1),{className:u})),h.to&&t.getLine(h.to.line).length<=o&&r.push(t.markText(h.to,a(h.to.line,h.to.ch+1),{className:u}))}}if(r.length){s&&t.state.focused&&t.focus();var d=function(){t.operation(function(){for(var t=0;t<r.length;t++)r[t].clear()})};if(!e)return d;setTimeout(d,800)}}function r(t){t.operation(function(){t.state.matchBrackets.currentlyHighlighted&&(t.state.matchBrackets.currentlyHighlighted(),t.state.matchBrackets.currentlyHighlighted=null),t.state.matchBrackets.currentlyHighlighted=o(t,!1,t.state.matchBrackets)})}var s=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),a=t.Pos,l={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};t.defineOption("matchBrackets",!1,function(e,i,n){n&&n!=t.Init&&(e.off("cursorActivity",r),e.state.matchBrackets&&e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null)),i&&(e.state.matchBrackets="object"==typeof i?i:{},e.on("cursorActivity",r))}),t.defineExtension("matchBrackets",function(){o(this,!0)}),t.defineExtension("findMatchingBracket",function(t,e,n){return(n||"boolean"==typeof e)&&(n?(n.strict=e,e=n):e=e?{strict:!0}:null),i(this,t,e)}),t.defineExtension("scanForBracket",function(t,e,i,o){return n(this,t,e,i,o)})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],t):t(CodeMirror)}(function(t){"use strict";function e(t){t.state.tagHit&&t.state.tagHit.clear(),t.state.tagOther&&t.state.tagOther.clear(),t.state.tagHit=t.state.tagOther=null}function i(i){i.state.failedTagMatch=!1,i.operation(function(){if(e(i),!i.somethingSelected()){var n=i.getCursor(),o=i.getViewport();o.from=Math.min(o.from,n.line),o.to=Math.max(n.line+1,o.to);var r=t.findMatchingTag(i,n,o);if(r){if(i.state.matchBothTags){var s="open"==r.at?r.open:r.close;s&&(i.state.tagHit=i.markText(s.from,s.to,{className:"CodeMirror-matchingtag"}))}var a="close"==r.at?r.open:r.close;a?i.state.tagOther=i.markText(a.from,a.to,{className:"CodeMirror-matchingtag"}):i.state.failedTagMatch=!0}}})}function n(t){t.state.failedTagMatch&&i(t)}t.defineOption("matchTags",!1,function(o,r,s){s&&s!=t.Init&&(o.off("cursorActivity",i),o.off("viewportChange",n),e(o)),r&&(o.state.matchBothTags="object"==typeof r&&r.bothTags,o.on("cursorActivity",i),o.on("viewportChange",n),i(o))}),t.commands.toMatchingTag=function(e){var i=t.findMatchingTag(e,e.getCursor());if(i){var n="close"==i.at?i.open:i.close;n&&e.extendSelection(n.to,n.from)}}}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){function e(e,i,n){var o,r=e.getWrapperElement();return(o=r.appendChild(document.createElement("div"))).className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof i?o.innerHTML=i:o.appendChild(i),t.addClass(r,"dialog-opened"),o}function i(t,e){t.state.currentNotificationClose&&t.state.currentNotificationClose(),t.state.currentNotificationClose=e}t.defineExtension("openDialog",function(n,o,r){function s(e){if("string"==typeof e)u.value=e;else{if(c)return;c=!0,t.rmClass(l.parentNode,"dialog-opened"),l.parentNode.removeChild(l),h.focus(),r.onClose&&r.onClose(l)}}r||(r={}),i(this,null);var a,l=e(this,n,r.bottom),c=!1,h=this,u=l.getElementsByTagName("input")[0];return u?(u.focus(),r.value&&(u.value=r.value,!1!==r.selectValueOnOpen&&u.select()),r.onInput&&t.on(u,"input",function(t){r.onInput(t,u.value,s)}),r.onKeyUp&&t.on(u,"keyup",function(t){r.onKeyUp(t,u.value,s)}),t.on(u,"keydown",function(e){r&&r.onKeyDown&&r.onKeyDown(e,u.value,s)||((27==e.keyCode||!1!==r.closeOnEnter&&13==e.keyCode)&&(u.blur(),t.e_stop(e),s()),13==e.keyCode&&o(u.value,e))}),!1!==r.closeOnBlur&&t.on(u,"blur",s)):(a=l.getElementsByTagName("button")[0])&&(t.on(a,"click",function(){s(),h.focus()}),!1!==r.closeOnBlur&&t.on(a,"blur",s),a.focus()),s}),t.defineExtension("openConfirm",function(n,o,r){function s(){c||(c=!0,t.rmClass(a.parentNode,"dialog-opened"),a.parentNode.removeChild(a),h.focus())}i(this,null);var a=e(this,n,r&&r.bottom),l=a.getElementsByTagName("button"),c=!1,h=this,u=1;l[0].focus();for(var d=0;d<l.length;++d){var p=l[d];!function(e){t.on(p,"click",function(i){t.e_preventDefault(i),s(),e&&e(h)})}(o[d]),t.on(p,"blur",function(){--u,setTimeout(function(){u<=0&&s()},200)}),t.on(p,"focus",function(){++u})}}),t.defineExtension("openNotification",function(n,o){function r(){l||(l=!0,clearTimeout(s),t.rmClass(a.parentNode,"dialog-opened"),a.parentNode.removeChild(a))}i(this,r);var s,a=e(this,n,o&&o.bottom),l=!1,c=o&&"undefined"!=typeof o.duration?o.duration:5e3;return t.on(a,"click",function(e){t.e_preventDefault(e),r()}),c&&(s=setTimeout(r,c)),r})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){function e(t,e){return"pairs"==e&&"string"==typeof t?t:"object"==typeof t&&null!=t[e]?t[e]:u[e]}function i(t){for(var e=0;e<t.length;e++){var i=t.charAt(e),o="'"+i+"'";p[o]||(p[o]=n(i))}}function n(t){return function(e){return l(e,t)}}function o(t){var e=t.state.closeBrackets;return!e||e.override?e:t.getModeAt(t.getCursor()).closeBrackets||e}function r(i){var n=o(i);if(!n||i.getOption("disableInput"))return t.Pass;for(var r=e(n,"pairs"),s=i.listSelections(),a=0;a<s.length;a++){if(!s[a].empty())return t.Pass;var l=c(i,s[a].head);if(!l||r.indexOf(l)%2!=0)return t.Pass}for(a=s.length-1;a>=0;a--){var h=s[a].head;i.replaceRange("",d(h.line,h.ch-1),d(h.line,h.ch+1),"+delete")}}function s(i){var n=o(i),r=n&&e(n,"explode");if(!r||i.getOption("disableInput"))return t.Pass;for(var s=i.listSelections(),a=0;a<s.length;a++){if(!s[a].empty())return t.Pass;var l=c(i,s[a].head);if(!l||r.indexOf(l)%2!=0)return t.Pass}i.operation(function(){var t=i.lineSeparator()||"\n";i.replaceSelection(t+t,null),i.execCommand("goCharLeft"),s=i.listSelections();for(var e=0;e<s.length;e++){var n=s[e].head.line;i.indentLine(n,null,!0),i.indentLine(n+1,null,!0)}})}function a(e){var i=t.cmpPos(e.anchor,e.head)>0;return{anchor:new d(e.anchor.line,e.anchor.ch+(i?-1:1)),head:new d(e.head.line,e.head.ch+(i?1:-1))}}function l(i,n){var r=o(i);if(!r||i.getOption("disableInput"))return t.Pass;var s=e(r,"pairs"),l=s.indexOf(n);if(-1==l)return t.Pass;for(var c,u=e(r,"closeBefore"),p=e(r,"triples"),f=s.charAt(l+1)==n,g=i.listSelections(),m=l%2==0,v=0;v<g.length;v++){var b,y=g[v],S=y.head,k=i.getRange(S,d(S.line,S.ch+1));if(m&&!y.empty())b="surround";else if(!f&&m||k!=n)if(f&&S.ch>1&&p.indexOf(n)>=0&&i.getRange(d(S.line,S.ch-2),S)==n+n){if(S.ch>2&&/\bstring/.test(i.getTokenTypeAt(d(S.line,S.ch-2))))return t.Pass;b="addFour"}else if(f){var w=0==S.ch?" ":i.getRange(d(S.line,S.ch-1),S);if(t.isWordChar(k)||w==n||t.isWordChar(w))return t.Pass;b="both"}else{if(!m||!(0===k.length||/\s/.test(k)||u.indexOf(k)>-1))return t.Pass;b="both"}else b=f&&h(i,S)?"both":p.indexOf(n)>=0&&i.getRange(S,d(S.line,S.ch+3))==n+n+n?"skipThree":"skip";if(c){if(c!=b)return t.Pass}else c=b}var _=l%2?s.charAt(l-1):n,x=l%2?n:s.charAt(l+1);i.operation(function(){if("skip"==c)i.execCommand("goCharRight");else if("skipThree"==c)for(var t=0;t<3;t++)i.execCommand("goCharRight");else if("surround"==c){var e=i.getSelections();for(t=0;t<e.length;t++)e[t]=_+e[t]+x;i.replaceSelections(e,"around"),e=i.listSelections().slice();for(t=0;t<e.length;t++)e[t]=a(e[t]);i.setSelections(e)}else"both"==c?(i.replaceSelection(_+x,null),i.triggerElectric(_+x),i.execCommand("goCharLeft")):"addFour"==c&&(i.replaceSelection(_+_+_+_,"before"),i.execCommand("goCharRight"))})}function c(t,e){var i=t.getRange(d(e.line,e.ch-1),d(e.line,e.ch+1));return 2==i.length?i:null}function h(t,e){var i=t.getTokenAt(d(e.line,e.ch+1));return/\bstring/.test(i.type)&&i.start==e.ch&&(0==e.ch||!/\bstring/.test(t.getTokenTypeAt(e)))}var u={pairs:"()[]{}''\"\"",closeBefore:")]}'\":;>",triples:"",explode:"[]{}"},d=t.Pos;t.defineOption("autoCloseBrackets",!1,function(n,o,r){r&&r!=t.Init&&(n.removeKeyMap(p),n.state.closeBrackets=null),o&&(i(e(o,"pairs")),n.state.closeBrackets=o,n.addKeyMap(p))});var p={Backspace:r,Enter:s};i(u.pairs+"`")}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],t):t(CodeMirror)}(function(t){function e(e){if(e.getOption("disableInput"))return t.Pass;for(var i=e.listSelections(),n=[],l=e.getOption("autoCloseTags"),c=0;c<i.length;c++){if(!i[c].empty())return t.Pass;var h=i[c].head,u=e.getTokenAt(h),d=t.innerMode(e.getMode(),u.state),p=d.state;if("xml"!=d.mode.name||!p.tagName)return t.Pass;var f="html"==d.mode.configuration,g="object"==typeof l&&l.dontCloseTags||f&&s,m="object"==typeof l&&l.indentTags||f&&a,v=p.tagName;u.end>h.ch&&(v=v.slice(0,v.length-u.end+h.ch));var b=v.toLowerCase();if(!v||"string"==u.type&&(u.end!=h.ch||!/[\"\']/.test(u.string.charAt(u.string.length-1))||1==u.string.length)||"tag"==u.type&&"closeTag"==p.type||u.string.indexOf("/")==u.string.length-1||g&&o(g,b)>-1||r(e,v,h,p,!0))return t.Pass;var y="object"==typeof l&&l.emptyTags;if(y&&o(y,v)>-1)n[c]={text:"/>",newPos:t.Pos(h.line,h.ch+2)};else{var S=m&&o(m,b)>-1;n[c]={indent:S,text:">"+(S?"\n\n":"")+"</"+v+">",newPos:S?t.Pos(h.line+1,0):t.Pos(h.line,h.ch+1)}}}var k="object"==typeof l&&l.dontIndentOnAutoClose;for(c=i.length-1;c>=0;c--){var w=n[c];e.replaceRange(w.text,i[c].head,i[c].anchor,"+insert");var _=e.listSelections().slice(0);_[c]={head:w.newPos,anchor:w.newPos},e.setSelections(_),!k&&w.indent&&(e.indentLine(w.newPos.line,null,!0),e.indentLine(w.newPos.line+1,null,!0))}}function i(e,i){for(var n=e.listSelections(),o=[],s=i?"/":"</",a=e.getOption("autoCloseTags"),l="object"==typeof a&&a.dontIndentOnSlash,c=0;c<n.length;c++){if(!n[c].empty())return t.Pass;var h,u=n[c].head,d=e.getTokenAt(u),p=t.innerMode(e.getMode(),d.state),f=p.state;if(i&&("string"==d.type||"<"!=d.string.charAt(0)||d.start!=u.ch-1))return t.Pass;if("xml"!=p.mode.name)if("htmlmixed"==e.getMode().name&&"javascript"==p.mode.name)h=s+"script";else{if("htmlmixed"!=e.getMode().name||"css"!=p.mode.name)return t.Pass;h=s+"style"}else{if(!f.context||!f.context.tagName||r(e,f.context.tagName,u,f))return t.Pass;h=s+f.context.tagName}">"!=e.getLine(u.line).charAt(d.end)&&(h+=">"),o[c]=h}if(e.replaceSelections(o),n=e.listSelections(),!l)for(c=0;c<n.length;c++)(c==n.length-1||n[c].head.line<n[c+1].head.line)&&e.indentLine(n[c].head.line)}function n(e){return e.getOption("disableInput")?t.Pass:i(e,!0)}function o(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;++i)if(t[i]==e)return i;return-1}function r(e,i,n,o,r){if(!t.scanForClosingTag)return!1;var s=Math.min(e.lastLine()+1,n.line+500),a=t.scanForClosingTag(e,n,null,s);if(!a||a.tag!=i)return!1;for(var l=o.context,c=r?1:0;l&&l.tagName==i;l=l.prev)++c;n=a.to;for(var h=1;h<c;h++){var u=t.scanForClosingTag(e,n,null,s);if(!u||u.tag!=i)return!1;n=u.to}return!0}t.defineOption("autoCloseTags",!1,function(i,o,r){if(r!=t.Init&&r&&i.removeKeyMap("autoCloseTags"),o){var s={name:"autoCloseTags"};("object"!=typeof o||o.whenClosing)&&(s["'/'"]=function(t){return n(t)}),("object"!=typeof o||o.whenOpening)&&(s["'>'"]=function(t){return e(t)}),i.addKeyMap(s)}});var s=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],a=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];t.commands.closeTag=function(t){return i(t)}}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../dialog/dialog"],t):t(CodeMirror)}(function(t){"use strict";function e(t,e,i,n,o){t.openDialog?t.openDialog(e,o,{value:n,selectValueOnOpen:!0}):o(prompt(i,n))}function i(t){return t.phrase("Jump to line:")+' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+t.phrase("(Use line:column or scroll% syntax)")+"</span>"}function n(t,e){var i=Number(e);return/^[-+]/.test(e)?t.getCursor().line+i:i-1}t.commands.jumpToLine=function(t){var o=t.getCursor();e(t,i(t),t.phrase("Jump to line:"),o.line+1+":"+o.ch,function(e){var i;if(e)if(i=/^\s*([\+\-]?\d+)\s*\:\s*(\d+)\s*$/.exec(e))t.setCursor(n(t,i[1]),Number(i[2]));else if(i=/^\s*([\+\-]?\d+(\.\d+)?)\%\s*/.exec(e)){var r=Math.round(t.lineCount()*Number(i[1])/100);/^[-+]/.test(i[1])&&(r=o.line+r+1),t.setCursor(r-1,o.ch)}else(i=/^\s*\:?\s*([\+\-]?\d+)\s*/.exec(e))&&t.setCursor(n(t,i[1]),o.ch)})},t.keyMap["default"]["Alt-G"]="jumpToLine"}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./matchesonscrollbar"],t):t(CodeMirror)}(function(t){"use strict";function e(t){for(var e in this.options={},u)this.options[e]=(t&&t.hasOwnProperty(e)?t:u)[e];this.overlay=this.timeout=null,this.matchesonscroll=null,this.active=!1}function i(t){var e=t.state.matchHighlighter;(e.active||t.hasFocus())&&o(t,e)}function n(t){var e=t.state.matchHighlighter;e.active||(e.active=!0,o(t,e))}function o(t,e){clearTimeout(e.timeout),e.timeout=setTimeout(function(){a(t)},e.options.delay)}function r(t,e,i,n){var o=t.state.matchHighlighter;if(t.addOverlay(o.overlay=h(e,i,n)),o.options.annotateScrollbar&&t.showMatchesOnScrollbar){var r=i?new RegExp("\\b"+e.replace(/[\\\[.+*?(){|^$]/g,"\\$&")+"\\b"):e;o.matchesonscroll=t.showMatchesOnScrollbar(r,!1,{className:"CodeMirror-selection-highlight-scrollbar"})}}function s(t){var e=t.state.matchHighlighter;e.overlay&&(t.removeOverlay(e.overlay),e.overlay=null,e.matchesonscroll&&(e.matchesonscroll.clear(),e.matchesonscroll=null))}function a(t){t.operation(function(){var e=t.state.matchHighlighter;if(s(t),t.somethingSelected()||!e.options.showToken){var i=t.getCursor("from"),n=t.getCursor("to");if(i.line==n.line&&(!e.options.wordsOnly||l(t,i,n))){var o=t.getRange(i,n);e.options.trim&&(o=o.replace(/^\s+|\s+$/g,"")),o.length>=e.options.minChars&&r(t,o,!1,e.options.style)}}else{for(var a=!0===e.options.showToken?/[\w$]/:e.options.showToken,c=t.getCursor(),h=t.getLine(c.line),u=c.ch,d=u;u&&a.test(h.charAt(u-1));)--u;for(;d<h.length&&a.test(h.charAt(d));)++d;u<d&&r(t,h.slice(u,d),a,e.options.style)}})}function l(t,e,i){if(null!==t.getRange(e,i).match(/^\w+$/)){if(e.ch>0){var n={line:e.line,ch:e.ch-1};if(null===t.getRange(n,e).match(/\W/))return!1}if(i.ch<t.getLine(e.line).length){n={line:i.line,ch:i.ch+1};if(null===t.getRange(i,n).match(/\W/))return!1}return!0}return!1}function c(t,e){return!(t.start&&e.test(t.string.charAt(t.start-1))||t.pos!=t.string.length&&e.test(t.string.charAt(t.pos)))}function h(t,e,i){return{token:function(n){if(n.match(t)&&(!e||c(n,e)))return i;n.next(),n.skipTo(t.charAt(0))||n.skipToEnd()}}}var u={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};t.defineOption("highlightSelectionMatches",!1,function(o,r,l){if(l&&l!=t.Init&&(s(o),clearTimeout(o.state.matchHighlighter.timeout),o.state.matchHighlighter=null,o.off("cursorActivity",i),o.off("focus",n)),r){var c=o.state.matchHighlighter=new e(r);o.hasFocus()?(c.active=!0,a(o)):o.on("focus",n),o.on("cursorActivity",i)}})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],t):t(CodeMirror)}(function(t){"use strict";function e(t,e){return"string"==typeof t?t=new RegExp(t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e?"gi":"g"):t.global||(t=new RegExp(t.source,t.ignoreCase?"gi":"g")),{token:function(e){t.lastIndex=e.pos;var i=t.exec(e.string);if(i&&i.index==e.pos)return e.pos+=i[0].length||1,"searching";i?e.pos=i.index:e.skipToEnd()}}}function i(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function n(t){return t.state.search||(t.state.search=new i)}function o(t){return"string"==typeof t&&t==t.toLowerCase()}function r(t,e,i){return t.getSearchCursor(e,i,{caseFold:o(e),multiline:!0})}function s(t,e,i,n,o){t.openDialog(e,n,{value:i,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){f(t)},onKeyDown:o})}function a(t,e,i,n,o){t.openDialog?t.openDialog(e,o,{value:n,selectValueOnOpen:!0}):o(prompt(i,n))}function l(t,e,i,n){t.openConfirm?t.openConfirm(e,n):confirm(i)&&n[0]()}function c(t){return t.replace(/\\([nrt\\])/g,function(t,e){return"n"==e?"\n":"r"==e?"\r":"t"==e?"\t":"\\"==e?"\\":t})}function h(t){var e=t.match(/^\/(.*)\/([a-z]*)$/);if(e)try{t=new RegExp(e[1],-1==e[2].indexOf("i")?"":"i")}catch(i){}else t=c(t);return("string"==typeof t?""==t:t.test(""))&&(t=/x^/),t}function u(t,i,n){i.queryText=n,i.query=h(n),t.removeOverlay(i.overlay,o(i.query)),i.overlay=e(i.query,o(i.query)),t.addOverlay(i.overlay),t.showMatchesOnScrollbar&&(i.annotate&&(i.annotate.clear(),i.annotate=null),i.annotate=t.showMatchesOnScrollbar(i.query,o(i.query)))}function d(e,i,o,r){var l=n(e);if(l.query)return p(e,i);var c=e.getSelection()||l.lastQuery;if(c instanceof RegExp&&"x^"==c.source&&(c=null),o&&e.openDialog){var h=null,d=function(i,n){t.e_stop(n),i&&(i!=l.queryText&&(u(e,l,i),l.posFrom=l.posTo=e.getCursor()),h&&(h.style.opacity=1),p(e,n.shiftKey,function(t,i){var n;i.line<3&&document.querySelector&&(n=e.display.wrapper.querySelector(".CodeMirror-dialog"))&&n.getBoundingClientRect().bottom-4>e.cursorCoords(i,"window").top&&((h=n).style.opacity=.4)}))};s(e,g(e),c,d,function(i,o){var r=t.keyName(i),s=e.getOption("extraKeys"),a=s&&s[r]||t.keyMap[e.getOption("keyMap")][r];"findNext"==a||"findPrev"==a||"findPersistentNext"==a||"findPersistentPrev"==a?(t.e_stop(i),u(e,n(e),o),e.execCommand(a)):"find"!=a&&"findPersistent"!=a||(t.e_stop(i),d(o,i))}),r&&c&&(u(e,l,c),p(e,i))}else a(e,g(e),"Search for:",c,function(t){t&&!l.query&&e.operation(function(){u(e,l,t),l.posFrom=l.posTo=e.getCursor(),p(e,i)})})}function p(e,i,o){e.operation(function(){var s=n(e),a=r(e,s.query,i?s.posFrom:s.posTo);(a.find(i)||(a=r(e,s.query,i?t.Pos(e.lastLine()):t.Pos(e.firstLine(),0))).find(i))&&(e.setSelection(a.from(),a.to()),e.scrollIntoView({from:a.from(),to:a.to()},20),s.posFrom=a.from(),s.posTo=a.to(),o&&o(a.from(),a.to()))})}function f(t){t.operation(function(){var e=n(t);e.lastQuery=e.query,e.query&&(e.query=e.queryText=null,t.removeOverlay(e.overlay),e.annotate&&(e.annotate.clear(),e.annotate=null))})}function g(t){return'<span class="CodeMirror-search-label">'+t.phrase("Search:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+t.phrase("(Use /re/ syntax for regexp search)")+"</span>"}function m(t){return' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+t.phrase("(Use /re/ syntax for regexp search)")+"</span>"}function v(t){return'<span class="CodeMirror-search-label">'+t.phrase("With:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>'}function b(t){return'<span class="CodeMirror-search-label">'+t.phrase("Replace?")+"</span> <button>"+t.phrase("Yes")+"</button> <button>"+t.phrase("No")+"</button> <button>"+t.phrase("All")+"</button> <button>"+t.phrase("Stop")+"</button> "}function y(t,e,i){t.operation(function(){for(var n=r(t,e);n.findNext();)if("string"!=typeof e){var o=t.getRange(n.from(),n.to()).match(e);n.replace(i.replace(/\$(\d)/g,function(t,e){return o[e]}))}else n.replace(i)})}function S(t,e){if(!t.getOption("readOnly")){var i=t.getSelection()||n(t).lastQuery,o='<span class="CodeMirror-search-label">'+(e?t.phrase("Replace all:"):t.phrase("Replace:"))+"</span>";a(t,o+m(t),o,i,function(i){i&&(i=h(i),a(t,v(t),t.phrase("Replace with:"),"",function(n){if(n=c(n),e)y(t,i,n);else{f(t);var o=r(t,i,t.getCursor("from")),s=function(){var e,c=o.from();!(e=o.findNext())&&(o=r(t,i),!(e=o.findNext())||c&&o.from().line==c.line&&o.from().ch==c.ch)||(t.setSelection(o.from(),o.to()),t.scrollIntoView({from:o.from(),to:o.to()}),l(t,b(t),t.phrase("Replace?"),[function(){a(e)},s,function(){y(t,i,n)}]))},a=function(t){o.replace("string"==typeof i?n:n.replace(/\$(\d)/g,function(e,i){return t[i]})),s()};s()}}))})}}t.commands.find=function(t){f(t),d(t)},t.commands.findPersistent=function(t){f(t),d(t,!1,!0)},t.commands.findPersistentNext=function(t){d(t,!1,!0,!0)},t.commands.findPersistentPrev=function(t){d(t,!0,!0,!0)},t.commands.findNext=d,t.commands.findPrev=function(t){d(t,!0)},t.commands.clearSearch=f,t.commands.replace=S,t.commands.replaceAll=function(t){S(t,!0)}}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){var e=t.flags;return null!=e?e:(t.ignoreCase?"i":"")+(t.global?"g":"")+(t.multiline?"m":"")}function i(t,i){for(var n=e(t),o=n,r=0;r<i.length;r++)-1==o.indexOf(i.charAt(r))&&(o+=i.charAt(r));return n==o?t:new RegExp(t.source,o)}function n(t){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(t.source)}function o(t,e,n){e=i(e,"g");for(var o=n.line,r=n.ch,s=t.lastLine();o<=s;o++,r=0){e.lastIndex=r;var a=t.getLine(o),l=e.exec(a);if(l)return{from:g(o,l.index),to:g(o,l.index+l[0].length),match:l}}}function r(t,e,r){if(!n(e))return o(t,e,r);e=i(e,"gm");for(var s,a=1,l=r.line,c=t.lastLine();l<=c;){for(var h=0;h<a&&!(l>c);h++){var u=t.getLine(l++);s=null==s?u:s+"\n"+u}a*=2,e.lastIndex=r.ch;var d=e.exec(s);if(d){var p=s.slice(0,d.index).split("\n"),f=d[0].split("\n"),m=r.line+p.length-1,v=p[p.length-1].length;return{from:g(m,v),to:g(m+f.length-1,1==f.length?v+f[0].length:f[f.length-1].length),match:d}}}}function s(t,e){for(var i,n=0;;){e.lastIndex=n;var o=e.exec(t);if(!o)return i;if((n=(i=o).index+(i[0].length||1))==t.length)return i}}function a(t,e,n){e=i(e,"g");for(var o=n.line,r=n.ch,a=t.firstLine();o>=a;o--,r=-1){var l=t.getLine(o);r>-1&&(l=l.slice(0,r));var c=s(l,e);if(c)return{from:g(o,c.index),to:g(o,c.index+c[0].length),match:c}}}function l(t,e,n){e=i(e,"gm");for(var o,r=1,a=n.line,l=t.firstLine();a>=l;){for(var c=0;c<r;c++){var h=t.getLine(a--);o=null==o?h.slice(0,n.ch):h+"\n"+o}r*=2;var u=s(o,e);if(u){var d=o.slice(0,u.index).split("\n"),p=u[0].split("\n"),f=a+d.length,m=d[d.length-1].length;return{from:g(f,m),to:g(f+p.length-1,1==p.length?m+p[0].length:p[p.length-1].length),match:u}}}}function c(t,e,i,n){if(t.length==e.length)return i;for(var o=0,r=i+Math.max(0,t.length-e.length);;){if(o==r)return o;var s=o+r>>1,a=n(t.slice(0,s)).length;if(a==i)return s;a>i?r=s:o=s+1}}function h(t,e,i,n){if(!e.length)return null;var o=n?p:f,r=o(e).split(/\r|\n\r?/);t:for(var s=i.line,a=i.ch,l=t.lastLine()+1-r.length;s<=l;s++,a=0){var h=t.getLine(s).slice(a),u=o(h);if(1==r.length){var d=u.indexOf(r[0]);if(-1==d)continue t;i=c(h,u,d,o)+a;return{from:g(s,c(h,u,d,o)+a),to:g(s,c(h,u,d+r[0].length,o)+a)}}var m=u.length-r[0].length;if(u.slice(m)==r[0]){for(var v=1;v<r.length-1;v++)if(o(t.getLine(s+v))!=r[v])continue t;var b=t.getLine(s+r.length-1),y=o(b),S=r[r.length-1];if(y.slice(0,S.length)==S)return{from:g(s,c(h,u,m,o)+a),to:g(s+r.length-1,c(b,y,S.length,o))}}}}function u(t,e,i,n){if(!e.length)return null;var o=n?p:f,r=o(e).split(/\r|\n\r?/);t:for(var s=i.line,a=i.ch,l=t.firstLine()-1+r.length;s>=l;s--,a=-1){var h=t.getLine(s);a>-1&&(h=h.slice(0,a));var u=o(h);if(1==r.length){var d=u.lastIndexOf(r[0]);if(-1==d)continue t;return{from:g(s,c(h,u,d,o)),to:g(s,c(h,u,d+r[0].length,o))}}var m=r[r.length-1];if(u.slice(0,m.length)==m){var v=1;for(i=s-r.length+1;v<r.length-1;v++)if(o(t.getLine(i+v))!=r[v])continue t;var b=t.getLine(s+1-r.length),y=o(b);if(y.slice(y.length-r[0].length)==r[0])return{from:g(s+1-r.length,c(b,y,b.length-r[0].length,o)),to:g(s,c(h,u,m.length,o))}}}}function d(t,e,n,s){var c;this.atOccurrence=!1,this.doc=t,n=n?t.clipPos(n):g(0,0),this.pos={from:n,to:n},"object"==typeof s?c=s.caseFold:(c=s,s=null),"string"==typeof e?(null==c&&(c=!1),this.matches=function(i,n){return(i?u:h)(t,e,n,c)}):(e=i(e,"gm"),s&&!1===s.multiline?this.matches=function(i,n){return(i?a:o)(t,e,n)}:this.matches=function(i,n){return(i?l:r)(t,e,n)})}var p,f,g=t.Pos;String.prototype.normalize?(p=function(t){return t.normalize("NFD").toLowerCase()},f=function(t){return t.normalize("NFD")}):(p=function(t){return t.toLowerCase()},f=function(t){return t}),d.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){for(var i=this.matches(e,this.doc.clipPos(e?this.pos.from:this.pos.to));i&&0==t.cmpPos(i.from,i.to);)e?i.from.ch?i.from=g(i.from.line,i.from.ch-1):i=i.from.line==this.doc.firstLine()?null:this.matches(e,this.doc.clipPos(g(i.from.line-1))):i.to.ch<this.doc.getLine(i.to.line).length?i.to=g(i.to.line,i.to.ch+1):i=i.to.line==this.doc.lastLine()?null:this.matches(e,g(i.to.line+1,0));if(i)return this.pos=i,this.atOccurrence=!0,this.pos.match||!0;var n=g(e?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:n,to:n},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(e,i){if(this.atOccurrence){var n=t.splitLines(e);this.doc.replaceRange(n,this.pos.from,this.pos.to,i),this.pos.to=g(this.pos.from.line+n.length-1,n[n.length-1].length+(1==n.length?this.pos.from.ch:0))}}},t.defineExtension("getSearchCursor",function(t,e,i){return new d(this.doc,t,e,i)}),t.defineDocExtension("getSearchCursor",function(t,e,i){return new d(this,t,e,i)}),t.defineExtension("selectMatches",function(e,i){for(var n=[],o=this.getSearchCursor(e,this.getCursor("from"),i);o.findNext()&&!(t.cmpPos(o.to(),this.getCursor("to"))>0);)n.push({anchor:o.from(),head:o.to()});n.length&&this.setSelections(n,0)})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){for(var e={},i=0;i<t.length;++i)e[t[i].toLowerCase()]=!0;return e}function i(t,e){for(var i,n=!1;null!=(i=t.next());){if(n&&"/"==i){e.tokenize=null;break}n="*"==i}return["comment","comment"]}t.defineMode("css",function(e,i){function n(t,e){return f=e,t}function o(t,e){var i=t.next();if(v[i]){var o=v[i](t,e);if(!1!==o)return o}return"@"==i?(t.eatWhile(/[\w\\\-]/),n("def",t.current())):"="==i||("~"==i||"|"==i)&&t.eat("=")?n(null,"compare"):'"'==i||"'"==i?(e.tokenize=r(i),e.tokenize(t,e)):"#"==i?(t.eatWhile(/[\w\\\-]/),n("atom","hash")):"!"==i?(t.match(/^\s*\w*/),n("keyword","important")):/\d/.test(i)||"."==i&&t.eat(/\d/)?(t.eatWhile(/[\w.%]/),n("number","unit")):"-"!==i?/[,+>*\/]/.test(i)?n(null,"select-op"):"."==i&&t.match(/^-?[_a-z][_a-z0-9-]*/i)?n("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(i)?n(null,i):t.match(/[\w-.]+(?=\()/)?(/^(url(-prefix)?|domain|regexp)$/.test(t.current().toLowerCase())&&(e.tokenize=s),n("variable callee","variable")):/[\w\\\-]/.test(i)?(t.eatWhile(/[\w\\\-]/),n("property","word")):n(null,null):/[\d.]/.test(t.peek())?(t.eatWhile(/[\w.%]/),n("number","unit")):t.match(/^-[\w\\\-]*/)?(t.eatWhile(/[\w\\\-]/),t.match(/^\s*:/,!1)?n("variable-2","variable-definition"):n("variable-2","variable")):t.match(/^\w+-/)?n("meta","meta"):void 0}function r(t){return function(e,i){for(var o,r=!1;null!=(o=e.next());){if(o==t&&!r){")"==t&&e.backUp(1);break}r=!r&&"\\"==o}return(o==t||!r&&")"!=t)&&(i.tokenize=null),n("string","string")}}function s(t,e){return t.next(),t.match(/\s*[\"\')]/,!1)?e.tokenize=null:e.tokenize=r(")"),n(null,"(")}function a(t,e,i){this.type=t,this.indent=e,this.prev=i}function l(t,e,i,n){return t.context=new a(i,e.indentation()+(!1===n?0:m),t.context),i}function c(t){return t.context.prev&&(t.context=t.context.prev),t.context.type}function h(t,e,i){return I[i.context.type](t,e,i)}function u(t,e,i,n){for(var o=n||1;o>0;o--)i.context=i.context.prev;return h(t,e,i)}function d(t){var e=t.current().toLowerCase();g=E.hasOwnProperty(e)?"atom":C.hasOwnProperty(e)?"keyword":"variable"}var p=i.inline;i.propertyKeywords||(i=t.resolveMode("text/css"));var f,g,m=e.indentUnit,v=i.tokenHooks,b=i.documentTypes||{},y=i.mediaTypes||{},S=i.mediaFeatures||{},k=i.mediaValueKeywords||{},w=i.propertyKeywords||{},_=i.nonStandardPropertyKeywords||{},x=i.fontProperties||{},L=i.counterDescriptors||{},C=i.colorKeywords||{},E=i.valueKeywords||{},T=i.allowNested,M=i.lineComment,A=!0===i.supportsAtComponent,I={top:function(t,e,i){if("{"==t)return l(i,e,"block");if("}"==t&&i.context.prev)return c(i);if(A&&/@component/i.test(t))return l(i,e,"atComponentBlock");if(/^@(-moz-)?document$/i.test(t))return l(i,e,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/i.test(t))return l(i,e,"atBlock");if(/^@(font-face|counter-style)/i.test(t))return i.stateArg=t,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(t))return"keyframes";if(t&&"@"==t.charAt(0))return l(i,e,"at");if("hash"==t)g="builtin";else if("word"==t)g="tag";else{if("variable-definition"==t)return"maybeprop";if("interpolation"==t)return l(i,e,"interpolation");if(":"==t)return"pseudo";if(T&&"("==t)return l(i,e,"parens")}return i.context.type},block:function(t,e,i){if("word"==t){var n=e.current().toLowerCase();return w.hasOwnProperty(n)?(g="property","maybeprop"):_.hasOwnProperty(n)?(g="string-2","maybeprop"):T?(g=e.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(g+=" error","maybeprop")}return"meta"==t?"block":T||"hash"!=t&&"qualifier"!=t?I.top(t,e,i):(g="error","block")},maybeprop:function(t,e,i){return":"==t?l(i,e,"prop"):h(t,e,i)},prop:function(t,e,i){if(";"==t)return c(i);if("{"==t&&T)return l(i,e,"propBlock");if("}"==t||"{"==t)return u(t,e,i);if("("==t)return l(i,e,"parens");if("hash"!=t||/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(e.current())){if("word"==t)d(e);else if("interpolation"==t)return l(i,e,"interpolation")}else g+=" error";return"prop"},propBlock:function(t,e,i){return"}"==t?c(i):"word"==t?(g="property","maybeprop"):i.context.type},parens:function(t,e,i){return"{"==t||"}"==t?u(t,e,i):")"==t?c(i):"("==t?l(i,e,"parens"):"interpolation"==t?l(i,e,"interpolation"):("word"==t&&d(e),"parens")},pseudo:function(t,e,i){return"meta"==t?"pseudo":"word"==t?(g="variable-3",i.context.type):h(t,e,i)},documentTypes:function(t,e,i){return"word"==t&&b.hasOwnProperty(e.current())?(g="tag",i.context.type):I.atBlock(t,e,i)},atBlock:function(t,e,i){if("("==t)return l(i,e,"atBlock_parens");if("}"==t||";"==t)return u(t,e,i);if("{"==t)return c(i)&&l(i,e,T?"block":"top");if("interpolation"==t)return l(i,e,"interpolation");if("word"==t){var n=e.current().toLowerCase();g="only"==n||"not"==n||"and"==n||"or"==n?"keyword":y.hasOwnProperty(n)?"attribute":S.hasOwnProperty(n)?"property":k.hasOwnProperty(n)?"keyword":w.hasOwnProperty(n)?"property":_.hasOwnProperty(n)?"string-2":E.hasOwnProperty(n)?"atom":C.hasOwnProperty(n)?"keyword":"error"}return i.context.type},atComponentBlock:function(t,e,i){return"}"==t?u(t,e,i):"{"==t?c(i)&&l(i,e,T?"block":"top",!1):("word"==t&&(g="error"),i.context.type)},atBlock_parens:function(t,e,i){return")"==t?c(i):"{"==t||"}"==t?u(t,e,i,2):I.atBlock(t,e,i)},restricted_atBlock_before:function(t,e,i){return"{"==t?l(i,e,"restricted_atBlock"):"word"==t&&"@counter-style"==i.stateArg?(g="variable","restricted_atBlock_before"):h(t,e,i)},restricted_atBlock:function(t,e,i){return"}"==t?(i.stateArg=null,c(i)):"word"==t?(g="@font-face"==i.stateArg&&!x.hasOwnProperty(e.current().toLowerCase())||"@counter-style"==i.stateArg&&!L.hasOwnProperty(e.current().toLowerCase())?"error":"property","maybeprop"):"restricted_atBlock"},keyframes:function(t,e,i){return"word"==t?(g="variable","keyframes"):"{"==t?l(i,e,"top"):h(t,e,i)},at:function(t,e,i){return";"==t?c(i):"{"==t||"}"==t?u(t,e,i):("word"==t?g="tag":"hash"==t&&(g="builtin"),"at")},interpolation:function(t,e,i){return"}"==t?c(i):"{"==t||";"==t?u(t,e,i):("word"==t?g="variable":"variable"!=t&&"("!=t&&")"!=t&&(g="error"),"interpolation")}};return{startState:function(t){return{tokenize:null,state:p?"block":"top",stateArg:null,context:new a(p?"block":"top",t||0,null)}},token:function(t,e){if(!e.tokenize&&t.eatSpace())return null;var i=(e.tokenize||o)(t,e);return i&&"object"==typeof i&&(f=i[1],i=i[0]),g=i,"comment"!=f&&(e.state=I[e.state](f,t,e)),g},indent:function(t,e){var i=t.context,n=e&&e.charAt(0),o=i.indent;return"prop"!=i.type||"}"!=n&&")"!=n||(i=i.prev),i.prev&&("}"!=n||"block"!=i.type&&"top"!=i.type&&"interpolation"!=i.type&&"restricted_atBlock"!=i.type?(")"!=n||"parens"!=i.type&&"atBlock_parens"!=i.type)&&("{"!=n||"at"!=i.type&&"atBlock"!=i.type)||(o=Math.max(0,i.indent-m)):o=(i=i.prev).indent),o},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:M,fold:"brace"}});var n=["domain","regexp","url","url-prefix"],o=e(n),r=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],s=e(r),a=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover"],l=e(a),c=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive"],h=e(c),u=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],d=e(u),p=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],f=e(p),g=e(["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"]),m=e(["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"]),v=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],b=e(v),y=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],S=e(y),k=n.concat(r).concat(a).concat(c).concat(u).concat(p).concat(v).concat(y);t.registerHelper("hintWords","css",k),t.defineMIME("text/css",{documentTypes:o,mediaTypes:s,mediaFeatures:l,mediaValueKeywords:h,propertyKeywords:d,nonStandardPropertyKeywords:f,fontProperties:g,counterDescriptors:m,colorKeywords:b,valueKeywords:S,tokenHooks:{"/":function(t,e){return!!t.eat("*")&&(e.tokenize=i,i(t,e))}},name:"css"}),t.defineMIME("text/x-scss",{mediaTypes:s,mediaFeatures:l,mediaValueKeywords:h,propertyKeywords:d,nonStandardPropertyKeywords:f,colorKeywords:b,valueKeywords:S,fontProperties:g,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(t,e){return t.eat("/")?(t.skipToEnd(),["comment","comment"]):t.eat("*")?(e.tokenize=i,i(t,e)):["operator","operator"]},":":function(t){return!!t.match(/\s*\{/,!1)&&[null,null]},$:function(t){return t.match(/^[\w-]+/),t.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(t){return!!t.eat("{")&&[null,"interpolation"]}},name:"css",helperType:"scss"}),t.defineMIME("text/x-less",{mediaTypes:s,mediaFeatures:l,mediaValueKeywords:h,propertyKeywords:d,nonStandardPropertyKeywords:f,colorKeywords:b,valueKeywords:S,fontProperties:g,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(t,e){return t.eat("/")?(t.skipToEnd(),["comment","comment"]):t.eat("*")?(e.tokenize=i,i(t,e)):["operator","operator"]},"@":function(t){return t.eat("{")?[null,"interpolation"]:!t.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,!1)&&(t.eatWhile(/[\w\\\-]/),t.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),t.defineMIME("text/x-gss",{documentTypes:o,mediaTypes:s,mediaFeatures:l,propertyKeywords:d,nonStandardPropertyKeywords:f,fontProperties:g,counterDescriptors:m,colorKeywords:b,valueKeywords:S,supportsAtComponent:!0,tokenHooks:{"/":function(t,e){return!!t.eat("*")&&(e.tokenize=i,i(t,e))}},name:"css",helperType:"gss"})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],t):t(CodeMirror)}(function(t){"use strict";function e(t,e,i){var n=t.current(),o=n.search(e);return o>-1?t.backUp(n.length-o):n.match(/<\/?$/)&&(t.backUp(n.length),t.match(e,!1)||t.match(n)),i}function i(t){var e=l[t];return e||(l[t]=new RegExp("\\s+"+t+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*"))}function n(t,e){var n=t.match(i(e));return n?/^\s*(.*?)\s*$/.exec(n[2])[1]:""}function o(t,e){return new RegExp((e?"^":"")+"</s*"+t+"s*>","i")}function r(t,e){for(var i in t)for(var n=e[i]||(e[i]=[]),o=t[i],r=o.length-1;r>=0;r--)n.unshift(o[r])}function s(t,e){for(var i=0;i<t.length;i++){var o=t[i];if(!o[0]||o[1].test(n(e,o[0])))return o[2]}}var a={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]},l={};t.defineMode("htmlmixed",function(i,n){function l(n,r){var a,u=c.token(n,r.htmlState),d=/\btag\b/.test(u);if(d&&!/[<>\s\/]/.test(n.current())&&(a=r.htmlState.tagName&&r.htmlState.tagName.toLowerCase())&&h.hasOwnProperty(a))r.inTag=a+" ";else if(r.inTag&&d&&/>$/.test(n.current())){var p=/^([\S]+) (.*)/.exec(r.inTag);r.inTag=null;var f=">"==n.current()&&s(h[p[1]],p[2]),g=t.getMode(i,f),m=o(p[1],!0),v=o(p[1],!1);r.token=function(t,i){return t.match(m,!1)?(i.token=l,i.localState=i.localMode=null,null):e(t,v,i.localMode.token(t,i.localState))},r.localMode=g,r.localState=t.startState(g,c.indent(r.htmlState,"",""))}else r.inTag&&(r.inTag+=n.current(),n.eol()&&(r.inTag+=" "));return u}var c=t.getMode(i,{name:"xml",htmlMode:!0,multilineTagIndentFactor:n.multilineTagIndentFactor,multilineTagIndentPastTag:n.multilineTagIndentPastTag}),h={},u=n&&n.tags,d=n&&n.scriptTypes;if(r(a,h),u&&r(u,h),d)for(var p=d.length-1;p>=0;p--)h.script.unshift(["type",d[p].matches,d[p].mode]);return{startState:function(){return{token:l,inTag:null,localMode:null,localState:null,htmlState:t.startState(c)}},copyState:function(e){var i;return e.localState&&(i=t.copyState(e.localMode,e.localState)),{token:e.token,inTag:e.inTag,localMode:e.localMode,localState:i,htmlState:t.copyState(c,e.htmlState)}},token:function(t,e){return e.token(t,e)},indent:function(e,i,n){return!e.localMode||/^\s*<\//.test(i)?c.indent(e.htmlState,i,n):e.localMode.indent?e.localMode.indent(e.localState,i,n):t.Pass},innerMode:function(t){return{state:t.localState||t.htmlState,mode:t.localMode||c}}}},"xml","javascript","css"),t.defineMIME("text/html","htmlmixed")}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.defineMode("javascript",function(e,i){function n(t){for(var e,i=!1,n=!1;null!=(e=t.next());){if(!i){if("/"==e&&!n)return;"["==e?n=!0:n&&"]"==e&&(n=!1)}i=!i&&"\\"==e}}function o(t,e,i){return Ft=t,$t=i,e}function r(t,e){var i=t.next();if('"'==i||"'"==i)return e.tokenize=s(i),e.tokenize(t,e);if("."==i&&t.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return o("number","number");if("."==i&&t.match(".."))return o("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(i))return o(i);if("="==i&&t.eat(">"))return o("=>","operator");if("0"==i&&t.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return o("number","number");if(/\d/.test(i))return t.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),o("number","number");if("/"==i)return t.eat("*")?(e.tokenize=a,a(t,e)):t.eat("/")?(t.skipToEnd(),o("comment","comment")):Vt(t,e,1)?(n(t),t.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),o("regexp","string-2")):(t.eat("="),o("operator","operator",t.current()));if("`"==i)return e.tokenize=l,l(t,e);if("#"==i)return t.skipToEnd(),o("error","error");if(Xt.test(i))return">"==i&&e.lexical&&">"==e.lexical.type||(t.eat("=")?"!"!=i&&"="!=i||t.eat("="):/[<>*+\-]/.test(i)&&(t.eat(i),">"==i&&t.eat(i))),o("operator","operator",t.current());if(qt.test(i)){t.eatWhile(qt);var r=t.current();if("."!=e.lastType){if(Kt.propertyIsEnumerable(r)){var c=Kt[r];return o(c.type,c.style,r)}if("async"==r&&t.match(/^(\s|\/\*.*?\*\/)*[\[\(\w]/,!1))return o("async","keyword",r)}return o("variable","variable",r)}}function s(t){return function(e,i){var n,s=!1;if(Wt&&"@"==e.peek()&&e.match(Yt))return i.tokenize=r,o("jsonld-keyword","meta");for(;null!=(n=e.next())&&(n!=t||s);)s=!s&&"\\"==n;return s||(i.tokenize=r),o("string","string")}}function a(t,e){for(var i,n=!1;i=t.next();){if("/"==i&&n){e.tokenize=r;break}n="*"==i}return o("comment","comment")}function l(t,e){for(var i,n=!1;null!=(i=t.next());){if(!n&&("`"==i||"$"==i&&t.eat("{"))){e.tokenize=r;break}n=!n&&"\\"==i}return o("quasi","string-2",t.current())}function c(t,e){e.fatArrowAt&&(e.fatArrowAt=null);var i=t.string.indexOf("=>",t.start);if(!(i<0)){if(Gt){var n=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(t.string.slice(t.start,i));n&&(i=n.index)}for(var o=0,r=!1,s=i-1;s>=0;--s){var a=t.string.charAt(s),l=Zt.indexOf(a);if(l>=0&&l<3){if(!o){++s;break}if(0==--o){"("==a&&(r=!0);break}}else if(l>=3&&l<6)++o;else if(qt.test(a))r=!0;else if(/["'\/`]/.test(a))for(;;--s){if(0==s)return;if(t.string.charAt(s-1)==a&&"\\"!=t.string.charAt(s-2)){s--;break}}else if(r&&!o){++s;break}}r&&!o&&(e.fatArrowAt=s)}}function h(t,e,i,n,o,r){this.indented=t,this.column=e,this.type=i,this.prev=o,this.info=r,null!=n&&(this.align=n)}function u(t,e){for(var i=t.localVars;i;i=i.next)if(i.name==e)return!0;for(var n=t.context;n;n=n.prev)for(i=n.vars;i;i=i.next)if(i.name==e)return!0}function d(t,e,i,n,o){var r=t.cc;for(Qt.state=t,Qt.stream=o,Qt.marked=null,Qt.cc=r,Qt.style=e,t.lexical.hasOwnProperty("align")||(t.lexical.align=!0);;){if((r.length?r.pop():jt?M:E)(i,n)){for(;r.length&&r[r.length-1].lex;)r.pop()();return Qt.marked?Qt.marked:"variable"==i&&u(t,n)?"variable-2":e}}}function p(){for(var t=arguments.length-1;t>=0;t--)Qt.cc.push(arguments[t])}function f(){return p.apply(null,arguments),!0}function g(t,e){for(var i=e;i;i=i.next)if(i.name==t)return!0;return!1}function m(t){var e=Qt.state;if(Qt.marked="def",e.context)if("var"==e.lexical.info&&e.context&&e.context.block){var n=v(t,e.context);if(null!=n)return void(e.context=n)}else if(!g(t,e.localVars))return void(e.localVars=new S(t,e.localVars));i.globalVars&&!g(t,e.globalVars)&&(e.globalVars=new S(t,e.globalVars))}function v(t,e){if(e){if(e.block){var i=v(t,e.prev);return i?i==e.prev?e:new y(i,e.vars,!0):null}return g(t,e.vars)?e:new y(e.prev,new S(t,e.vars),!1)}return null}function b(t){return"public"==t||"private"==t||"protected"==t||"abstract"==t||"readonly"==t}function y(t,e,i){this.prev=t,this.vars=e,this.block=i}function S(t,e){this.name=t,this.next=e}function k(){Qt.state.context=new y(Qt.state.context,Qt.state.localVars,!1),Qt.state.localVars=te}function w(){Qt.state.context=new y(Qt.state.context,Qt.state.localVars,!0),Qt.state.localVars=null}function _(){Qt.state.localVars=Qt.state.context.vars,Qt.state.context=Qt.state.context.prev}function x(t,e){var i=function(){var i=Qt.state,n=i.indented;if("stat"==i.lexical.type)n=i.lexical.indented;else for(var o=i.lexical;o&&")"==o.type&&o.align;o=o.prev)n=o.indented;i.lexical=new h(n,Qt.stream.column(),t,null,i.lexical,e)};return i.lex=!0,i}function L(){var t=Qt.state;t.lexical.prev&&(")"==t.lexical.type&&(t.indented=t.lexical.indented),t.lexical=t.lexical.prev)}function C(t){function e(i){return i==t?f():";"==t||"}"==i||")"==i||"]"==i?p():f(e)}return e}function E(t,e){return"var"==t?f(x("vardef",e),ct,C(";"),L):"keyword a"==t?f(x("form"),I,E,L):"keyword b"==t?f(x("form"),E,L):"keyword d"==t?Qt.stream.match(/^\s*$/,!1)?f():f(x("stat"),R,C(";"),L):"debugger"==t?f(C(";")):"{"==t?f(x("}"),w,Y,L,_):";"==t?f():"if"==t?("else"==Qt.state.lexical.info&&Qt.state.cc[Qt.state.cc.length-1]==L&&Qt.state.cc.pop()(),f(x("form"),I,E,L,gt)):"function"==t?f(yt):"for"==t?f(x("form"),mt,E,L):"class"==t||Gt&&"interface"==e?(Qt.marked="keyword",f(x("form","class"==t?t:e),xt,L)):"variable"==t?Gt&&"declare"==e?(Qt.marked="keyword",f(E)):Gt&&("module"==e||"enum"==e||"type"==e)&&Qt.stream.match(/^\s*\w/,!1)?(Qt.marked="keyword","enum"==e?f(Pt):"type"==e?f(kt,C("operator"),et,C(";")):f(x("form"),ht,C("{"),x("}"),Y,L,L)):Gt&&"namespace"==e?(Qt.marked="keyword",f(x("form"),M,E,L)):Gt&&"abstract"==e?(Qt.marked="keyword",f(E)):f(x("stat"),U):"switch"==t?f(x("form"),I,C("{"),x("}","switch"),w,Y,L,L,_):"case"==t?f(M,C(":")):"default"==t?f(C(":")):"catch"==t?f(x("form"),k,T,E,L,_):"export"==t?f(x("stat"),Tt,L):"import"==t?f(x("stat"),At,L):"async"==t?f(E):"@"==e?f(M,E):p(x("stat"),M,C(";"),L)}function T(t){if("("==t)return f(wt,C(")"))}function M(t,e){return O(t,e,!1)}function A(t,e){return O(t,e,!0)}function I(t){return"("!=t?p():f(x(")"),M,C(")"),L)}function O(t,e,i){if(Qt.state.fatArrowAt==Qt.stream.start){var n=i?V:z;if("("==t)return f(k,x(")"),K(wt,")"),L,C("=>"),n,_);if("variable"==t)return p(k,ht,C("=>"),n,_)}var o=i?B:D;return Jt.hasOwnProperty(t)?f(o):"function"==t?f(yt,o):"class"==t||Gt&&"interface"==e?(Qt.marked="keyword",f(x("form"),_t,L)):"keyword c"==t||"async"==t?f(i?A:M):"("==t?f(x(")"),R,C(")"),L,o):"operator"==t||"spread"==t?f(i?A:M):"["==t?f(x("]"),Bt,L,o):"{"==t?X(j,"}",null,o):"quasi"==t?p(P,o):"new"==t?f(F(i)):"import"==t?f(M):f()}function R(t){return t.match(/[;\}\)\],]/)?p():p(M)}function D(t,e){return","==t?f(M):B(t,e,!1)}function B(t,e,i){var n=0==i?D:B,o=0==i?M:A;return"=>"==t?f(k,i?V:z,_):"operator"==t?/\+\+|--/.test(e)||Gt&&"!"==e?f(n):Gt&&"<"==e&&Qt.stream.match(/^([^>]|<.*?>)*>\s*\(/,!1)?f(x(">"),K(et,">"),L,n):"?"==e?f(M,C(":"),o):f(o):"quasi"==t?p(P,n):";"!=t?"("==t?X(A,")","call",n):"."==t?f(W,n):"["==t?f(x("]"),R,C("]"),L,n):Gt&&"as"==e?(Qt.marked="keyword",f(et,n)):"regexp"==t?(Qt.state.lastType=Qt.marked="operator",Qt.stream.backUp(Qt.stream.pos-Qt.stream.start-1),f(o)):void 0:void 0}function P(t,e){return"quasi"!=t?p():"${"!=e.slice(e.length-2)?f(P):f(M,N)}function N(t){if("}"==t)return Qt.marked="string-2",Qt.state.tokenize=l,f(P)}function z(t){return c(Qt.stream,Qt.state),p("{"==t?E:M)}function V(t){return c(Qt.stream,Qt.state),p("{"==t?E:A)}function F(t){return function(e){return"."==e?f(t?H:$):"variable"==e&&Gt?f(st,t?B:D):p(t?A:M)}}function $(t,e){if("target"==e)return Qt.marked="keyword",f(D)}function H(t,e){if("target"==e)return Qt.marked="keyword",f(B)}function U(t){return":"==t?f(L,E):p(D,C(";"),L)}function W(t){if("variable"==t)return Qt.marked="property",f()}function j(t,e){if("async"==t)return Qt.marked="property",f(j);if("variable"==t||"keyword"==Qt.style){return Qt.marked="property","get"==e||"set"==e?f(G):(Gt&&Qt.state.fatArrowAt==Qt.stream.start&&(i=Qt.stream.match(/^\s*:\s*/,!1))&&(Qt.state.fatArrowAt=Qt.stream.pos+i[0].length),f(q));var i}else{if("number"==t||"string"==t)return Qt.marked=Wt?"property":Qt.style+" property",f(q);if("jsonld-keyword"==t)return f(q);if(Gt&&b(e))return Qt.marked="keyword",f(j);if("["==t)return f(M,Z,C("]"),q);if("spread"==t)return f(A,q);if("*"==e)return Qt.marked="keyword",f(j);if(":"==t)return p(q)}}function G(t){return"variable"!=t?p(q):(Qt.marked="property",f(yt))}function q(t){return":"==t?f(A):"("==t?p(yt):void 0}function K(t,e,i){function n(o,r){if(i?i.indexOf(o)>-1:","==o){var s=Qt.state.lexical;return"call"==s.info&&(s.pos=(s.pos||0)+1),f(function(i,n){return i==e||n==e?p():p(t)},n)}return o==e||r==e?f():i&&i.indexOf(";")>-1?p(t):f(C(e))}return function(i,o){return i==e||o==e?f():p(t,n)}}function X(t,e,i){for(var n=3;n<arguments.length;n++)Qt.cc.push(arguments[n]);return f(x(e,i),K(t,e),L)}function Y(t){return"}"==t?f():p(E,Y)}function Z(t,e){if(Gt){if(":"==t)return f(et);if("?"==e)return f(Z)}}function J(t,e){if(Gt&&(":"==t||"in"==e))return f(et)}function Q(t){if(Gt&&":"==t)return Qt.stream.match(/^\s*\w+\s+is\b/,!1)?f(M,tt,et):f(et)}function tt(t,e){if("is"==e)return Qt.marked="keyword",f()}function et(t,e){return"keyof"==e||"typeof"==e||"infer"==e?(Qt.marked="keyword",f("typeof"==e?A:et)):"variable"==t||"void"==e?(Qt.marked="type",f(rt)):"|"==e||"&"==e?f(et):"string"==t||"number"==t||"atom"==t?f(rt):"["==t?f(x("]"),K(et,"]",","),L,rt):"{"==t?f(x("}"),K(nt,"}",",;"),L,rt):"("==t?f(K(ot,")"),it,rt):"<"==t?f(K(et,">"),et):void 0}function it(t){if("=>"==t)return f(et)}function nt(t,e){return"variable"==t||"keyword"==Qt.style?(Qt.marked="property",f(nt)):"?"==e||"number"==t||"string"==t?f(nt):":"==t?f(et):"["==t?f(C("variable"),J,C("]"),nt):"("==t?p(St,nt):void 0}function ot(t,e){return"variable"==t&&Qt.stream.match(/^\s*[?:]/,!1)||"?"==e?f(ot):":"==t?f(et):"spread"==t?f(ot):p(et)}function rt(t,e){return"<"==e?f(x(">"),K(et,">"),L,rt):"|"==e||"."==t||"&"==e?f(et):"["==t?f(et,C("]"),rt):"extends"==e||"implements"==e?(Qt.marked="keyword",f(et)):"?"==e?f(et,C(":"),et):void 0}function st(t,e){if("<"==e)return f(x(">"),K(et,">"),L,rt)}function at(){return p(et,lt)}function lt(t,e){if("="==e)return f(et)}function ct(t,e){return"enum"==e?(Qt.marked="keyword",f(Pt)):p(ht,Z,pt,ft)}function ht(t,e){return Gt&&b(e)?(Qt.marked="keyword",f(ht)):"variable"==t?(m(e),f()):"spread"==t?f(ht):"["==t?X(dt,"]"):"{"==t?X(ut,"}"):void 0}function ut(t,e){return"variable"!=t||Qt.stream.match(/^\s*:/,!1)?("variable"==t&&(Qt.marked="property"),"spread"==t?f(ht):"}"==t?p():"["==t?f(M,C("]"),C(":"),ut):f(C(":"),ht,pt)):(m(e),f(pt))}function dt(){return p(ht,pt)}function pt(t,e){if("="==e)return f(A)}function ft(t){if(","==t)return f(ct)}function gt(t,e){if("keyword b"==t&&"else"==e)return f(x("form","else"),E,L)}function mt(t,e){return"await"==e?f(mt):"("==t?f(x(")"),vt,L):void 0}function vt(t){return"var"==t?f(ct,bt):"variable"==t?f(bt):p(bt)}function bt(t,e){return")"==t?f():";"==t?f(bt):"in"==e||"of"==e?(Qt.marked="keyword",f(M,bt)):p(M,bt)}function yt(t,e){return"*"==e?(Qt.marked="keyword",f(yt)):"variable"==t?(m(e),f(yt)):"("==t?f(k,x(")"),K(wt,")"),L,Q,E,_):Gt&&"<"==e?f(x(">"),K(at,">"),L,yt):void 0}function St(t,e){return"*"==e?(Qt.marked="keyword",f(St)):"variable"==t?(m(e),f(St)):"("==t?f(k,x(")"),K(wt,")"),L,Q,_):Gt&&"<"==e?f(x(">"),K(at,">"),L,St):void 0}function kt(t,e){return"keyword"==t||"variable"==t?(Qt.marked="type",f(kt)):"<"==e?f(x(">"),K(at,">"),L):void 0}function wt(t,e){return"@"==e&&f(M,wt),"spread"==t?f(wt):Gt&&b(e)?(Qt.marked="keyword",f(wt)):Gt&&"this"==t?f(Z,pt):p(ht,Z,pt)}function _t(t,e){return"variable"==t?xt(t,e):Lt(t,e)}function xt(t,e){if("variable"==t)return m(e),f(Lt)}function Lt(t,e){return"<"==e?f(x(">"),K(at,">"),L,Lt):"extends"==e||"implements"==e||Gt&&","==t?("implements"==e&&(Qt.marked="keyword"),f(Gt?et:M,Lt)):"{"==t?f(x("}"),Ct,L):void 0}function Ct(t,e){return"async"==t||"variable"==t&&("static"==e||"get"==e||"set"==e||Gt&&b(e))&&Qt.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(Qt.marked="keyword",f(Ct)):"variable"==t||"keyword"==Qt.style?(Qt.marked="property",f(Gt?Et:yt,Ct)):"number"==t||"string"==t?f(Gt?Et:yt,Ct):"["==t?f(M,Z,C("]"),Gt?Et:yt,Ct):"*"==e?(Qt.marked="keyword",f(Ct)):Gt&&"("==t?p(St,Ct):";"==t||","==t?f(Ct):"}"==t?f():"@"==e?f(M,Ct):void 0}function Et(t,e){if("?"==e)return f(Et);if(":"==t)return f(et,pt);if("="==e)return f(A);var i=Qt.state.lexical.prev;return p(i&&"interface"==i.info?St:yt)}function Tt(t,e){return"*"==e?(Qt.marked="keyword",f(Dt,C(";"))):"default"==e?(Qt.marked="keyword",f(M,C(";"))):"{"==t?f(K(Mt,"}"),Dt,C(";")):p(E)}function Mt(t,e){return"as"==e?(Qt.marked="keyword",f(C("variable"))):"variable"==t?p(A,Mt):void 0}function At(t){return"string"==t?f():"("==t?p(M):p(It,Ot,Dt)}function It(t,e){return"{"==t?X(It,"}"):("variable"==t&&m(e),"*"==e&&(Qt.marked="keyword"),f(Rt))}function Ot(t){if(","==t)return f(It,Ot)}function Rt(t,e){if("as"==e)return Qt.marked="keyword",f(It)}function Dt(t,e){if("from"==e)return Qt.marked="keyword",f(M)}function Bt(t){return"]"==t?f():p(K(A,"]"))}function Pt(){return p(x("form"),ht,C("{"),x("}"),K(Nt,"}"),L,L)}function Nt(){return p(ht,pt)}function zt(t,e){return"operator"==t.lastType||","==t.lastType||Xt.test(e.charAt(0))||/[,.]/.test(e.charAt(0))}function Vt(t,e,i){return e.tokenize==r&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(e.lastType)||"quasi"==e.lastType&&/\{\s*$/.test(t.string.slice(0,t.pos-(i||0)))}var Ft,$t,Ht=e.indentUnit,Ut=i.statementIndent,Wt=i.jsonld,jt=i.json||Wt,Gt=i.typescript,qt=i.wordCharacters||/[\w$\xa1-\uffff]/,Kt=function(){function t(t){return{type:t,style:"keyword"}}var e=t("keyword a"),i=t("keyword b"),n=t("keyword c"),o=t("keyword d"),r=t("operator"),s={type:"atom",style:"atom"};return{"if":t("if"),"while":e,"with":e,"else":i,"do":i,"try":i,"finally":i,"return":o,"break":o,"continue":o,"new":t("new"),"delete":n,"void":n,"throw":n,"debugger":t("debugger"),"var":t("var"),"const":t("var"),"let":t("var"),"function":t("function"),"catch":t("catch"),"for":t("for"),"switch":t("switch"),"case":t("case"),"default":t("default"),"in":r,"typeof":r,"instanceof":r,"true":s,"false":s,"null":s,undefined:s,NaN:s,Infinity:s,"this":t("this"),"class":t("class"),"super":t("atom"),yield:n,"export":t("export"),"import":t("import"),"extends":n,await:n}}(),Xt=/[+\-*&%=<>!?|~^@]/,Yt=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,Zt="([{}])",Jt={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},Qt={state:null,column:null,marked:null,cc:null},te=new S("this",new S("arguments",null));return _.lex=!0,L.lex=!0,{startState:function(t){var e={tokenize:r,lastType:"sof",cc:[],lexical:new h((t||0)-Ht,0,"block",!1),localVars:i.localVars,context:i.localVars&&new y(null,null,!1),indented:t||0};return i.globalVars&&"object"==typeof i.globalVars&&(e.globalVars=i.globalVars),e},token:function(t,e){if(t.sol()&&(e.lexical.hasOwnProperty("align")||(e.lexical.align=!1),e.indented=t.indentation(),c(t,e)),e.tokenize!=a&&t.eatSpace())return null;var i=e.tokenize(t,e);return"comment"==Ft?i:(e.lastType="operator"!=Ft||"++"!=$t&&"--"!=$t?Ft:"incdec",d(e,i,Ft,$t,t))},indent:function(e,n){if(e.tokenize==a)return t.Pass;if(e.tokenize!=r)return 0;var o,s=n&&n.charAt(0),l=e.lexical;if(!/^\s*else\b/.test(n))for(var c=e.cc.length-1;c>=0;--c){var h=e.cc[c];if(h==L)l=l.prev;else if(h!=gt)break}for(;("stat"==l.type||"form"==l.type)&&("}"==s||(o=e.cc[e.cc.length-1])&&(o==D||o==B)&&!/^[,\.=+\-*:?[\(]/.test(n));)l=l.prev;Ut&&")"==l.type&&"stat"==l.prev.type&&(l=l.prev);var u=l.type,d=s==u;return"vardef"==u?l.indented+("operator"==e.lastType||","==e.lastType?l.info.length+1:0):"form"==u&&"{"==s?l.indented:"form"==u?l.indented+Ht:"stat"==u?l.indented+(zt(e,n)?Ut||Ht:0):"switch"!=l.info||d||0==i.doubleIndentSwitch?l.align?l.column+(d?0:1):l.indented+(d?0:Ht):l.indented+(/^(?:case|default)\b/.test(n)?Ht:2*Ht)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:jt?null:"/*",blockCommentEnd:jt?null:"*/",blockCommentContinue:jt?null:" * ",lineComment:jt?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:jt?"json":"javascript",jsonldMode:Wt,jsonMode:jt,expressionAllowed:Vt,skipExpression:function(t){var e=t.cc[t.cc.length-1];e!=M&&e!=A||t.cc.pop()}}}),t.registerHelper("wordChars","javascript",/[\w$]/),t.defineMIME("text/javascript","javascript"),t.defineMIME("text/ecmascript","javascript"),t.defineMIME("application/javascript","javascript"),t.defineMIME("application/x-javascript","javascript"),t.defineMIME("application/ecmascript","javascript"),t.defineMIME("application/json",{name:"javascript",json:!0}),t.defineMIME("application/x-json",{name:"javascript",json:!0}),t.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),t.defineMIME("text/typescript",{name:"javascript",typescript:!0}),t.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){return new RegExp("^(("+t.join(")|(")+"))\\b")}function i(t){return t.scopes[t.scopes.length-1]}var n=e(["and","or","not","is"]),o=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"],r=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"];t.registerHelper("hintWords","python",o.concat(r)),t.defineMode("python",function(s,a){function l(t,e){var n=t.sol()&&"\\"!=e.lastToken;if(n&&(e.indent=t.indentation()),n&&"py"==i(e).type){var o=i(e).offset;if(t.eatSpace()){var r=t.indentation();return r>o?d(e):r<o&&f(t,e)&&"#"!=t.peek()&&(e.errorToken=!0),null}var s=c(t,e);return o>0&&f(t,e)&&(s+=" "+m),s}return c(t,e)}function c(t,e){if(t.eatSpace())return null;if(t.match(/^#.*/))return"comment";if(t.match(/^[0-9\.]/,!1)){var i=!1;if(t.match(/^[\d_]*\.\d+(e[\+\-]?\d+)?/i)&&(i=!0),t.match(/^[\d_]+\.\d*/)&&(i=!0),t.match(/^\.\d+/)&&(i=!0),i)return t.eat(/J/i),"number";var o=!1;if(t.match(/^0x[0-9a-f_]+/i)&&(o=!0),t.match(/^0b[01_]+/i)&&(o=!0),t.match(/^0o[0-7_]+/i)&&(o=!0),t.match(/^[1-9][\d_]*(e[\+\-]?[\d_]+)?/)&&(t.eat(/J/i),o=!0),t.match(/^0(?![\dx])/i)&&(o=!0),o)return t.eat(/L/i),"number"}if(t.match(L))return-1!==t.current().toLowerCase().indexOf("f")?(e.tokenize=h(t.current(),e.tokenize),e.tokenize(t,e)):(e.tokenize=u(t.current(),e.tokenize),e.tokenize(t,e));for(var r=0;r<b.length;r++)if(t.match(b[r]))return"operator";return t.match(v)?"punctuation":"."==e.lastToken&&t.match(x)?"property":t.match(C)||t.match(n)?"keyword":t.match(E)?"builtin":t.match(/^(self|cls)\b/)?"variable-2":t.match(x)?"def"==e.lastToken||"class"==e.lastToken?"def":"variable":(t.next(),m)}function h(t,e){function i(t){return function(e,o){var r=c(e,o);return"punctuation"==r&&("{"==e.current()?o.tokenize=i(t+1):"}"==e.current()&&(o.tokenize=t>1?i(t-1):n)),r}}function n(n,s){for(;!n.eol();)if(n.eatWhile(/[^'"\{\}\\]/),n.eat("\\")){if(n.next(),o&&n.eol())return r}else{if(n.match(t))return s.tokenize=e,r;if(n.match("{{"))return r;if(n.match("{",!1))return s.tokenize=i(0),n.current()?r:s.tokenize(n,s);if(n.match("}}"))return r;if(n.match("}"))return m;n.eat(/['"]/)}if(o){if(a.singleLineStringErrors)return m;s.tokenize=e}return r}for(;"rubf".indexOf(t.charAt(0).toLowerCase())>=0;)t=t.substr(1);var o=1==t.length,r="string";return n.isString=!0,n}function u(t,e){function i(i,r){for(;!i.eol();)if(i.eatWhile(/[^'"\\]/),i.eat("\\")){if(i.next(),n&&i.eol())return o}else{if(i.match(t))return r.tokenize=e,o;i.eat(/['"]/)}if(n){if(a.singleLineStringErrors)return m;r.tokenize=e}return o}for(;"rubf".indexOf(t.charAt(0).toLowerCase())>=0;)t=t.substr(1);var n=1==t.length,o="string";return i.isString=!0,i}function d(t){for(;"py"!=i(t).type;)t.scopes.pop();t.scopes.push({offset:i(t).offset+s.indentUnit,type:"py",align:null})}function p(t,e,i){var n=t.match(/^([\s\[\{\(]|#.*)*$/,!1)?null:t.column()+1;e.scopes.push({offset:e.indent+S,type:i,align:n})}function f(t,e){for(var n=t.indentation();e.scopes.length>1&&i(e).offset>n;){if("py"!=i(e).type)return!0;e.scopes.pop()}return i(e).offset!=n}function g(t,e){t.sol()&&(e.beginningOfLine=!0);var n=e.tokenize(t,e),o=t.current();if(e.beginningOfLine&&"@"==o)return t.match(x,!1)?"meta":_?"operator":m;if(/\S/.test(o)&&(e.beginningOfLine=!1),"variable"!=n&&"builtin"!=n||"meta"!=e.lastToken||(n="meta"),"pass"!=o&&"return"!=o||(e.dedent+=1),"lambda"==o&&(e.lambda=!0),":"!=o||e.lambda||"py"!=i(e).type||d(e),1==o.length&&!/string|comment/.test(n)){var r="[({".indexOf(o);if(-1!=r&&p(t,e,"])}".slice(r,r+1)),-1!=(r="])}".indexOf(o))){if(i(e).type!=o)return m;e.indent=e.scopes.pop().offset-S}}return e.dedent>0&&t.eol()&&"py"==i(e).type&&(e.scopes.length>1&&e.scopes.pop(),e.dedent-=1),n}for(var m="error",v=a.delimiters||a.singleDelimiters||/^[\(\)\[\]\{\}@,:`=;\.\\]/,b=[a.singleOperators,a.doubleOperators,a.doubleDelimiters,a.tripleDelimiters,a.operators||/^([-+*/%\/&|^]=?|[<>=]+|\/\/=?|\*\*=?|!=|[~!@]|\.\.\.)/],y=0;y<b.length;y++)b[y]||b.splice(y--,1);var S=a.hangingIndent||s.indentUnit,k=o,w=r;a.extra_keywords!=undefined&&(k=k.concat(a.extra_keywords)),a.extra_builtins!=undefined&&(w=w.concat(a.extra_builtins));var _=!(a.version&&Number(a.version)<3);if(_){var x=a.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*/;k=k.concat(["nonlocal","False","True","None","async","await"]),w=w.concat(["ascii","bytes","exec","print"]);var L=new RegExp("^(([rbuf]|(br)|(fr))?('{3}|\"{3}|['\"]))","i")}else{x=a.identifiers||/^[_A-Za-z][_A-Za-z0-9]*/;k=k.concat(["exec","print"]),w=w.concat(["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"]);L=new RegExp("^(([rubf]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var C=e(k),E=e(w);return{startState:function(t){return{tokenize:l,scopes:[{offset:t||0,type:"py",align:null}],indent:t||0,lastToken:null,lambda:!1,dedent:0}},token:function(t,e){var i=e.errorToken;i&&(e.errorToken=!1);var n=g(t,e);return n&&"comment"!=n&&(e.lastToken="keyword"==n||"punctuation"==n?t.current():n),"punctuation"==n&&(n=null),t.eol()&&e.lambda&&(e.lambda=!1),i?n+" "+m:n},indent:function(e,n){if(e.tokenize!=l)return e.tokenize.isString?t.Pass:0;var o=i(e),r=o.type==n.charAt(0);return null!=o.align?o.align-(r?1:0):o.offset-(r?S:0)},electricInput:/^\s*[\}\]\)]$/,closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"}}),t.defineMIME("text/x-python","python");var s=function(t){return t.split(" ")};t.defineMIME("text/x-cython",{name:"python",extra_keywords:s("by cdef cimport cpdef ctypedef enum except extern gil include nogil property public readonly struct union DEF IF ELIF ELSE")})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.defineMode("ruby",function(e){function i(t){for(var e={},i=0,n=t.length;i<n;++i)e[t[i]]=!0;return e}function n(t,e,i){return i.tokenize.push(t),t(e,i)}function o(t,e){if(t.sol()&&t.match("=begin")&&t.eol())return e.tokenize.push(h),"comment";if(t.eatSpace())return null;var i,o=t.next();if("`"==o||"'"==o||'"'==o)return n(l(o,"string",'"'==o||"`"==o),t,e);if("/"==o)return r(t)?n(l(o,"string-2",!0),t,e):"operator";if("%"==o){var s="string",a=!0;t.eat("s")?s="atom":t.eat(/[WQ]/)?s="string":t.eat(/[r]/)?s="string-2":t.eat(/[wxq]/)&&(s="string",a=!1);var d=t.eat(/[^\w\s=]/);return d?(g.propertyIsEnumerable(d)&&(d=g[d]),n(l(d,s,a,!0),t,e)):"operator"}if("#"==o)return t.skipToEnd(),"comment";if("<"==o&&(i=t.match(/^<([-~])[\`\"\']?([a-zA-Z_?]\w*)[\`\"\']?(?:;|$)/)))return n(c(i[2],i[1]),t,e);if("0"==o)return t.eat("x")?t.eatWhile(/[\da-fA-F]/):t.eat("b")?t.eatWhile(/[01]/):t.eatWhile(/[0-7]/),"number";if(/\d/.test(o))return t.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if("?"==o){for(;t.match(/^\\[CM]-/););return t.eat("\\")?t.eatWhile(/\w/):t.next(),"string"}if(":"==o)return t.eat("'")?n(l("'","atom",!1),t,e):t.eat('"')?n(l('"',"atom",!0),t,e):t.eat(/[\<\>]/)?(t.eat(/[\<\>]/),"atom"):t.eat(/[\+\-\*\/\&\|\:\!]/)?"atom":t.eat(/[a-zA-Z$@_\xa1-\uffff]/)?(t.eatWhile(/[\w$\xa1-\uffff]/),t.eat(/[\?\!\=]/),"atom"):"operator";if("@"==o&&t.match(/^@?[a-zA-Z_\xa1-\uffff]/))return t.eat("@"),t.eatWhile(/[\w\xa1-\uffff]/),"variable-2";if("$"==o)return t.eat(/[a-zA-Z_]/)?t.eatWhile(/[\w]/):t.eat(/\d/)?t.eat(/\d/):t.next(),"variable-3";if(/[a-zA-Z_\xa1-\uffff]/.test(o))return t.eatWhile(/[\w\xa1-\uffff]/),t.eat(/[\?\!]/),t.eat(":")?"atom":"ident";if("|"!=o||!e.varList&&"{"!=e.lastTok&&"do"!=e.lastTok){if(/[\(\)\[\]{}\\;]/.test(o))return u=o,null;if("-"==o&&t.eat(">"))return"arrow";if(/[=+\-\/*:\.^%<>~|]/.test(o)){var p=t.eatWhile(/[=+\-\/*:\.^%<>~|]/);return"."!=o||p||(u="."),"operator"}return null}return u="|",null}function r(t){for(var e,i=t.pos,n=0,o=!1,r=!1;null!=(e=t.next());)if(r)r=!1;else{if("[{(".indexOf(e)>-1)n++;else if("]})".indexOf(e)>-1){if(--n<0)break}else if("/"==e&&0==n){o=!0;break}r="\\"==e}return t.backUp(t.pos-i),o}function s(t){return t||(t=1),function(e,i){if("}"==e.peek()){if(1==t)return i.tokenize.pop(),i.tokenize[i.tokenize.length-1](e,i);i.tokenize[i.tokenize.length-1]=s(t-1)}else"{"==e.peek()&&(i.tokenize[i.tokenize.length-1]=s(t+1));return o(e,i)}}function a(){var t=!1;return function(e,i){return t?(i.tokenize.pop(),i.tokenize[i.tokenize.length-1](e,i)):(t=!0,o(e,i))}}function l(t,e,i,n){return function(o,r){var l,c=!1;for("read-quoted-paused"===r.context.type&&(r.context=r.context.prev,o.eat("}"));null!=(l=o.next());){if(l==t&&(n||!c)){r.tokenize.pop();break}if(i&&"#"==l&&!c){if(o.eat("{")){"}"==t&&(r.context={prev:r.context,type:"read-quoted-paused"}),r.tokenize.push(s());break}if(/[@\$]/.test(o.peek())){r.tokenize.push(a());break}}c=!c&&"\\"==l}return e}}function c(t,e){return function(i,n){return e&&i.eatSpace(),i.match(t)?n.tokenize.pop():i.skipToEnd(),"string"}}function h(t,e){return t.sol()&&t.match("=end")&&t.eol()&&e.tokenize.pop(),t.skipToEnd(),"comment"}var u,d=i(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload","__END__","__FILE__","__LINE__","__dir__"]),p=i(["def","class","case","for","while","until","module","then","catch","loop","proc","begin"]),f=i(["end","until"]),g={"[":"]","{":"}","(":")"},m={"]":"[","}":"{",")":"("};return{startState:function(){return{tokenize:[o],indented:0,context:{type:"top",indented:-e.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(t,e){u=null,t.sol()&&(e.indented=t.indentation());var i,n=e.tokenize[e.tokenize.length-1](t,e),o=u;if("ident"==n){var r=t.current();"keyword"==(n="."==e.lastTok?"property":d.propertyIsEnumerable(t.current())?"keyword":/^[A-Z]/.test(r)?"tag":"def"==e.lastTok||"class"==e.lastTok||e.varList?"def":"variable")&&(o=r,p.propertyIsEnumerable(r)?i="indent":f.propertyIsEnumerable(r)?i="dedent":"if"!=r&&"unless"!=r||t.column()!=t.indentation()?"do"==r&&e.context.indented<e.indented&&(i="indent"):i="indent")}return(u||n&&"comment"!=n)&&(e.lastTok=o),"|"==u&&(e.varList=!e.varList),"indent"==i||/[\(\[\{]/.test(u)?e.context={prev:e.context,type:u||n,indented:e.indented}:("dedent"==i||/[\)\]\}]/.test(u))&&e.context.prev&&(e.context=e.context.prev),t.eol()&&(e.continuedLine="\\"==u||"operator"==n),n},indent:function(i,n){if(i.tokenize[i.tokenize.length-1]!=o)return t.Pass;var r=n&&n.charAt(0),s=i.context,a=s.type==m[r]||"keyword"==s.type&&/^(?:end|until|else|elsif|when|rescue)\b/.test(n);return s.indented+(a?0:e.indentUnit)+(i.continuedLine?e.indentUnit:0)},electricInput:/^\s*(?:end|rescue|elsif|else|\})$/,lineComment:"#",fold:"indent"}}),t.defineMIME("text/x-ruby","ruby")}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.defineMode("stex",function(t,e){function i(t,e){t.cmdState.push(e)}function n(t){return t.cmdState.length>0?t.cmdState[t.cmdState.length-1]:null}function o(t){var e=t.cmdState.pop();e&&e.closeBracket()}function r(t){for(var e=t.cmdState,i=e.length-1;i>=0;i--){var n=e[i];if("DEFAULT"!=n.name)return n}return{styleIdentifier:function(){return null}}}function s(t,e,i){return function(){this.name=t,this.bracketNo=0,this.style=e,this.styles=i,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}function a(t,e){t.f=e}function l(t,e){var o;if(t.match(/^\\[a-zA-Z@]+/)){var s=t.current().slice(1);return i(e,o=new(o=u[s]||u.DEFAULT)),a(e,h),o.style}if(t.match(/^\\[$&%#{}_]/))return"tag";if(t.match(/^\\[,;!\/\\]/))return"tag";if(t.match("\\["))return a(e,function(t,e){return c(t,e,"\\]")}),"keyword";if(t.match("\\("))return a(e,function(t,e){return c(t,e,"\\)")}),"keyword";if(t.match("$$"))return a(e,function(t,e){return c(t,e,"$$")}),"keyword";if(t.match("$"))return a(e,function(t,e){return c(t,e,"$")}),"keyword";var l=t.next();return"%"==l?(t.skipToEnd(),"comment"):"}"==l||"]"==l?(o=n(e))?(o.closeBracket(l),a(e,h),"bracket"):"error":"{"==l||"["==l?(i(e,o=new(o=u.DEFAULT)),"bracket"):/\d/.test(l)?(t.eatWhile(/[\w.%]/),"atom"):(t.eatWhile(/[\w\-_]/),"begin"==(o=r(e)).name&&(o.argument=t.current()),o.styleIdentifier())}function c(t,e,i){if(t.eatSpace())return null;if(i&&t.match(i))return a(e,l),"keyword";if(t.match(/^\\[a-zA-Z@]+/))return"tag";if(t.match(/^[a-zA-Z]+/))return"variable-2";if(t.match(/^\\[$&%#{}_]/))return"tag";if(t.match(/^\\[,;!\/]/))return"tag";if(t.match(/^[\^_&]/))return"tag";if(t.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(t.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var n=t.next();return"{"==n||"}"==n||"["==n||"]"==n||"("==n||")"==n?"bracket":"%"==n?(t.skipToEnd(),"comment"):"error"}function h(t,e){var i=t.peek();return"{"==i||"["==i?(n(e).openBracket(i),t.eat(i),a(e,l),"bracket"):/[ \t\r]/.test(i)?(t.eat(i),null):(a(e,l),o(e),l(t,e))}var u={};return u.importmodule=s("importmodule","tag",["string","builtin"]),u.documentclass=s("documentclass","tag",["","atom"]),u.usepackage=s("usepackage","tag",["atom"]),u.begin=s("begin","tag",["atom"]),u.end=s("end","tag",["atom"]),u.label=s("label","tag",["atom"]),u.ref=s("ref","tag",["atom"]),u.eqref=s("eqref","tag",["atom"]),u.cite=s("cite","tag",["atom"]),u.bibitem=s("bibitem","tag",["atom"]),u.Bibitem=s("Bibitem","tag",["atom"]),u.RBibitem=s("RBibitem","tag",["atom"]),u.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:e.inMathMode?function(t,e){return c(t,e)}:l}},copyState:function(t){return{cmdState:t.cmdState.slice(),f:t.f}},token:function(t,e){return e.f(t,e)},blankLine:function(t){t.f=l,t.cmdState.length=0},lineComment:"%"}}),t.defineMIME("text/x-stex","stex"),t.defineMIME("text/x-latex","stex")}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;return e}function i(t,e,i){if(t.sol()&&(e.indented=t.indentation()),t.eatSpace())return null;var n,s=t.peek();if("/"==s){if(t.match("//"))return t.skipToEnd(),"comment";if(t.match("/*"))return e.tokenize.push(r),r(t,e)}if(t.match(k))return"builtin";if(t.match(w))return"attribute";if(t.match(g))return"number";if(t.match(m))return"number";if(t.match(v))return"number";if(t.match(b))return"number";if(t.match(S))return"property";if(p.indexOf(s)>-1)return t.next(),"operator";if(f.indexOf(s)>-1)return t.next(),t.match(".."),"punctuation";if(n=t.match(/("""|"|')/)){var a=o.bind(null,n[0]);return e.tokenize.push(a),a(t,e)}if(t.match(y)){var l=t.current();return d.hasOwnProperty(l)?"variable-2":u.hasOwnProperty(l)?"atom":c.hasOwnProperty(l)?(h.hasOwnProperty(l)&&(e.prev="define"),"keyword"):"define"==i?"def":"variable"}return t.next(),null}function n(){var t=0;return function(e,n,o){var r=i(e,n,o);if("punctuation"==r)if("("==e.current())++t;else if(")"==e.current()){if(0==t)return e.backUp(1),n.tokenize.pop(),n.tokenize[n.tokenize.length-1](e,n);--t}return r}}function o(t,e,i){for(var o,r=1==t.length,s=!1;o=e.peek();)if(s){if(e.next(),"("==o)return i.tokenize.push(n()),"string";s=!1}else{if(e.match(t))return i.tokenize.pop(),"string";e.next(),s="\\"==o}return r&&i.tokenize.pop(),"string"}function r(t,e){for(var i;t.match(/^[^/*]+/,!0),i=t.next();)"/"===i&&t.eat("*")?e.tokenize.push(r):"*"===i&&t.eat("/")&&e.tokenize.pop();return"comment"}function s(t,e,i){this.prev=t,this.align=e,this.indented=i}function a(t,e){var i=e.match(/^\s*($|\/[\/\*])/,!1)?null:e.column()+1;t.context=new s(t.context,i,t.indented)}function l(t){t.context&&(t.indented=t.context.indented,t.context=t.context.prev)}var c=e(["_","var","let","class","enum","extension","import","protocol","struct","func","typealias","associatedtype","open","public","internal","fileprivate","private","deinit","init","new","override","self","subscript","super","convenience","dynamic","final","indirect","lazy","required","static","unowned","unowned(safe)","unowned(unsafe)","weak","as","is","break","case","continue","default","else","fallthrough","for","guard","if","in","repeat","switch","where","while","defer","return","inout","mutating","nonmutating","catch","do","rethrows","throw","throws","try","didSet","get","set","willSet","assignment","associativity","infix","left","none","operator","postfix","precedence","precedencegroup","prefix","right","Any","AnyObject","Type","dynamicType","Self","Protocol","__COLUMN__","__FILE__","__FUNCTION__","__LINE__"]),h=e(["var","let","class","enum","extension","import","protocol","struct","func","typealias","associatedtype","for"]),u=e(["true","false","nil","self","super","_"]),d=e(["Array","Bool","Character","Dictionary","Double","Float","Int","Int8","Int16","Int32","Int64","Never","Optional","Set","String","UInt8","UInt16","UInt32","UInt64","Void"]),p="+-/*%=|&<>~^?!",f=":;,.(){}[]",g=/^\-?0b[01][01_]*/,m=/^\-?0o[0-7][0-7_]*/,v=/^\-?0x[\dA-Fa-f][\dA-Fa-f_]*(?:(?:\.[\dA-Fa-f][\dA-Fa-f_]*)?[Pp]\-?\d[\d_]*)?/,b=/^\-?\d[\d_]*(?:\.\d[\d_]*)?(?:[Ee]\-?\d[\d_]*)?/,y=/^\$\d+|(`?)[_A-Za-z][_A-Za-z$0-9]*\1/,S=/^\.(?:\$\d+|(`?)[_A-Za-z][_A-Za-z$0-9]*\1)/,k=/^\#[A-Za-z]+/,w=/^@(?:\$\d+|(`?)[_A-Za-z][_A-Za-z$0-9]*\1)/;t.defineMode("swift",function(t){return{startState:function(){return{prev:null,context:null,indented:0,tokenize:[]}},token:function(t,e){var n=e.prev;e.prev=null;var o=(e.tokenize[e.tokenize.length-1]||i)(t,e,n);if(o&&"comment"!=o?e.prev||(e.prev=o):e.prev=n,"punctuation"==o){var r=/[\(\[\{]|([\]\)\}])/.exec(t.current());r&&(r[1]?l:a)(e,t)}return o},indent:function(e,i){var n=e.context;if(!n)return 0;var o=/^[\]\}\)]/.test(i);return null!=n.align?n.align-(o?1:0):n.indented+(o?0:t.indentUnit)},electricInput:/^\s*[\)\}\]]$/,lineComment:"//",blockCommentStart:"/*",blockCommentEnd:"*/",fold:"brace",closeBrackets:"()[]{}''\"\"``"}}),t.defineMIME("text/x-swift","swift")}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";var e={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},i={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};t.defineMode("xml",function(n,o){function r(t,e){function i(i){return e.tokenize=i,i(t,e)}var n=t.next();return"<"==n?t.eat("!")?t.eat("[")?t.match("CDATA[")?i(l("atom","]]>")):null:t.match("--")?i(l("comment","-->")):t.match("DOCTYPE",!0,!0)?(t.eatWhile(/[\w\._\-]/),i(c(1))):null:t.eat("?")?(t.eatWhile(/[\w\._\-]/),e.tokenize=l("meta","?>"),"meta"):(w=t.eat("/")?"closeTag":"openTag",e.tokenize=s,"tag bracket"):"&"==n?(t.eat("#")?t.eat("x")?t.eatWhile(/[a-fA-F\d]/)&&t.eat(";"):t.eatWhile(/[\d]/)&&t.eat(";"):t.eatWhile(/[\w\.\-:]/)&&t.eat(";"))?"atom":"error":(t.eatWhile(/[^&<]/),null)}function s(t,e){var i=t.next();if(">"==i||"/"==i&&t.eat(">"))return e.tokenize=r,w=">"==i?"endTag":"selfcloseTag","tag bracket";if("="==i)return w="equals",null;if("<"==i){e.tokenize=r,e.state=p,e.tagName=e.tagStart=null;var n=e.tokenize(t,e);return n?n+" tag error":"tag error"}return/[\'\"]/.test(i)?(e.tokenize=a(i),e.stringStartCol=t.column(),e.tokenize(t,e)):(t.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function a(t){var e=function(e,i){for(;!e.eol();)if(e.next()==t){i.tokenize=s;break}return"string"};return e.isInAttribute=!0,e}function l(t,e){return function(i,n){for(;!i.eol();){if(i.match(e)){n.tokenize=r;break}i.next()}return t}}function c(t){return function(e,i){for(var n;null!=(n=e.next());){if("<"==n)return i.tokenize=c(t+1),i.tokenize(e,i);if(">"==n){if(1==t){i.tokenize=r;break}return i.tokenize=c(t-1),i.tokenize(e,i)}}return"meta"}}function h(t,e,i){this.prev=t.context,this.tagName=e,this.indent=t.indented,this.startOfLine=i,(L.doNotIndent.hasOwnProperty(e)||t.context&&t.context.noIndent)&&(this.noIndent=!0)}function u(t){t.context&&(t.context=t.context.prev)}function d(t,e){for(var i;;){if(!t.context)return;if(i=t.context.tagName,!L.contextGrabbers.hasOwnProperty(i)||!L.contextGrabbers[i].hasOwnProperty(e))return;u(t)}}function p(t,e,i){return"openTag"==t?(i.tagStart=e.column(),f):"closeTag"==t?g:p}function f(t,e,i){return"word"==t?(i.tagName=e.current(),_="tag",b):L.allowMissingTagName&&"endTag"==t?(_="tag bracket",b(t,e,i)):(_="error",f)}function g(t,e,i){if("word"==t){var n=e.current();return i.context&&i.context.tagName!=n&&L.implicitlyClosed.hasOwnProperty(i.context.tagName)&&u(i),i.context&&i.context.tagName==n||!1===L.matchClosing?(_="tag",m):(_="tag error",v)}return L.allowMissingTagName&&"endTag"==t?(_="tag bracket",m(t,e,i)):(_="error",v)}function m(t,e,i){return"endTag"!=t?(_="error",m):(u(i),p)}function v(t,e,i){return _="error",m(t,e,i)}function b(t,e,i){if("word"==t)return _="attribute",y;if("endTag"==t||"selfcloseTag"==t){var n=i.tagName,o=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTag"==t||L.autoSelfClosers.hasOwnProperty(n)?d(i,n):(d(i,n),i.context=new h(i,n,o==i.indented)),p}return _="error",b}function y(t,e,i){return"equals"==t?S:(L.allowMissing||(_="error"),b(t,e,i))}function S(t,e,i){return"string"==t?k:"word"==t&&L.allowUnquoted?(_="string",b):(_="error",b(t,e,i))}function k(t,e,i){return"string"==t?k:b(t,e,i)}var w,_,x=n.indentUnit,L={},C=o.htmlMode?e:i;for(var E in C)L[E]=C[E];for(var E in o)L[E]=o[E];return r.isInText=!0,{startState:function(t){var e={tokenize:r,state:p,indented:t||0,tagName:null,tagStart:null,context:null};return null!=t&&(e.baseIndent=t),e},token:function(t,e){if(!e.tagName&&t.sol()&&(e.indented=t.indentation()),t.eatSpace())return null;w=null;var i=e.tokenize(t,e);return(i||w)&&"comment"!=i&&(_=null,e.state=e.state(w||i,t,e),_&&(i="error"==_?i+" error":_)),i},indent:function(e,i,n){var o=e.context;if(e.tokenize.isInAttribute)return e.tagStart==e.indented?e.stringStartCol+1:e.indented+x;if(o&&o.noIndent)return t.Pass;if(e.tokenize!=s&&e.tokenize!=r)return n?n.match(/^(\s*)/)[0].length:0;if(e.tagName)return!1!==L.multilineTagIndentPastTag?e.tagStart+e.tagName.length+2:e.tagStart+x*(L.multilineTagIndentFactor||1);if(L.alignCDATA&&/<!\[CDATA\[/.test(i))return 0;var a=i&&/^<(\/)?([\w_:\.-]*)/.exec(i);if(a&&a[1])for(;o;){if(o.tagName==a[2]){o=o.prev;break}if(!L.implicitlyClosed.hasOwnProperty(o.tagName))break;o=o.prev}else if(a)for(;o;){var l=L.contextGrabbers[o.tagName];if(!l||!l.hasOwnProperty(a[2]))break;o=o.prev}for(;o&&o.prev&&!o.startOfLine;)o=o.prev;return o?o.indent+x:e.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:L.htmlMode?"html":"xml",helperType:L.htmlMode?"html":"xml",skipAttribute:function(t){t.state==S&&(t.state=b)}}}),t.defineMIME("text/xml","xml"),t.defineMIME("application/xml","xml"),t.mimeModes.hasOwnProperty("text/html")||t.defineMIME("text/html",{name:"xml",htmlMode:!0})}),function(t,e,i){"use strict";function n(t,i,n,o){for(var r=[],s=0;s<t.length;s++){var a=t[s];if(a){var l=tinycolor(a),c=l.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(i,a)?" sp-thumb-active":"";var h=l.toString(o.preferredFormat||"rgb"),u=m?"background-color:"+l.toRgbString():"filter:"+l.toFilter();r.push('<span title="'+h+'" data-color="'+l.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+u+';" /></span>')}else{var d="sp-clear-display";r.push(e("<div />").append(e('<span data-color="" style="background-color:transparent;" class="'+d+'"></span>').attr("title",o.noColorSelectedText)).html())}}return"<div class='sp-cf "+n+"'>"+r.join("")+"</div>"}function o(){for(var t=0;t<f.length;t++)f[t]&&f[t].hide()}function r(t,i){var n=e.extend({},p,t);return n.callbacks={move:h(n.move,i),change:h(n.change,i),show:h(n.show,i),hide:h(n.hide,i),beforeShow:h(n.beforeShow,i)},n}function s(s,l){function h(){if(W.showPaletteOnly&&(W.showPalette=!0),Dt.text(W.showPaletteOnly?W.togglePaletteMoreText:W.togglePaletteLessText),W.palette){ct=W.palette.slice(0),ht=e.isArray(ct[0])?ct:[ct],ut={};for(var t=0;t<ht.length;t++)for(var i=0;i<ht[t].length;i++){var n=tinycolor(ht[t][i]).toRgbString();ut[n]=!0}}yt.toggleClass("sp-flat",j),yt.toggleClass("sp-input-disabled",!W.showInput),yt.toggleClass("sp-alpha-enabled",W.showAlpha),yt.toggleClass("sp-clear-enabled",qt),yt.toggleClass("sp-buttons-disabled",!W.showButtons),yt.toggleClass("sp-palette-buttons-disabled",!W.togglePaletteOnly),yt.toggleClass("sp-palette-disabled",!W.showPalette),yt.toggleClass("sp-selection-palette-disabled",!W.showSelectionPalette),yt.toggleClass("sp-palette-only",W.showPaletteOnly),yt.toggleClass("sp-initial-disabled",!W.showInitial),yt.addClass(W.className).addClass(W.containerClassName),V()}function p(){function t(t){return t.data&&t.data.ignore?(O(e(t.target).closest(".sp-thumb-el").data("color")),B()):(O(e(t.target).closest(".sp-thumb-el").data("color")),B(),z(!0),W.hideAfterPaletteSelect&&(j?X.hide(R()):A())),!1}if(g&&yt.find("*:not(input)").attr("unselectable","on"),h(),Nt&&vt.after(zt).hide(),qt||Ot.hide(),j)vt.after(yt).hide();else{var i="parent"===W.appendTo?vt.parent():e(W.appendTo);1!==i.length&&(i=e("body")),i.append(yt)}S(),Vt.bind("click.spectrum touchstart.spectrum",function(t){bt||T(),t.stopPropagation(),e(t.target).is("input")||t.preventDefault()}),(vt.is(":disabled")||!0===W.disabled)&&U(),yt.click(c),Tt.change(E),Tt.bind("paste",function(){setTimeout(E,1)}),Tt.keydown(function(t){13==t.keyCode&&E()}),It.text(W.cancelText),It.addClass(W.cancelClassName),It.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),A("cancel")}),Ot.attr("title",W.clearText),Ot.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),Gt=!0,B(),j&&z(!0)}),Rt.text(W.chooseText),Rt.addClass(W.chooseClassName),Rt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),D()&&(z(!0),A())}),Dt.text(W.showPaletteOnly?W.togglePaletteMoreText:W.togglePaletteLessText),Dt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),W.showPaletteOnly=!W.showPaletteOnly,W.showPaletteOnly||j||yt.css("left","-="+(St.outerWidth(!0)+5)),h()}),u(Ct,function(t,e,i){lt=t/it,Gt=!1,i.shiftKey&&(lt=Math.round(10*lt)/10),B()},L,C),u(_t,function(t,e){rt=parseFloat(e/et),Gt=!1,W.showAlpha||(lt=1),B()},L,C),u(kt,function(t,e,i){if(i.shiftKey){if(!gt){var n=st*J,o=Q-at*Q,r=Math.abs(t-n)>Math.abs(e-o);gt=r?"x":"y"}}else gt=null;var s=!gt||"y"===gt;(!gt||"x"===gt)&&(st=parseFloat(t/J)),s&&(at=parseFloat((Q-e)/Q)),Gt=!1,W.showAlpha||(lt=1),B()},L,C),$t?(O($t),P(),Wt=Ut||tinycolor($t).format,k($t)):P(),j&&M();var n=g?"mousedown.spectrum":"mousedown.spectrum touchstart.spectrum";Mt.delegate(".sp-thumb-el",n,t),At.delegate(".sp-thumb-el:nth-child(1)",n,{ignore:!0},t)}function S(){if(q&&t.localStorage){try{var i=t.localStorage[q].split(",#");i.length>1&&(delete t.localStorage[q],e.each(i,function(t,e){k(e)}))}catch(n){}try{dt=t.localStorage[q].split(";")}catch(n){}}}function k(i){if(G){var n=tinycolor(i).toRgbString();if(!ut[n]&&-1===e.inArray(n,dt))for(dt.push(n);dt.length>pt;)dt.shift();if(q&&t.localStorage)try{t.localStorage[q]=dt.join(";")}catch(o){}}}function w(){var t=[];if(W.showPalette)for(var e=0;e<dt.length;e++){var i=tinycolor(dt[e]).toRgbString();ut[i]||t.push(dt[e])}return t.reverse().slice(0,W.maxSelectionSize)}function _(){var t=R(),i=e.map(ht,function(e,i){return n(e,t,"sp-palette-row sp-palette-row-"+i,W)});S(),dt&&i.push(n(w(),t,"sp-palette-row sp-palette-row-selection",W)),Mt.html(i.join(""))}function x(){if(W.showInitial){var t=Ht,e=R();At.html(n([t,e],e,"sp-palette-row-initial",W))}}function L(){(Q<=0||J<=0||et<=0)&&V(),yt.addClass(ft),gt=null,vt.trigger("dragstart.spectrum",[R()])}function C(){yt.removeClass(ft),vt.trigger("dragstop.spectrum",[R()])}function E(){var t=Tt.val();if(null!==t&&""!==t||!qt){var e=tinycolor(t);e.isValid()?(O(e),z(!0)):Tt.addClass("sp-validation-error")}else O(null),z(!0)}function T(){Z?A():M()}function M(){var i=e.Event("beforeShow.spectrum");Z?V():(vt.trigger(i,[R()]),!1===X.beforeShow(R())||i.isDefaultPrevented()||(o(),Z=!0,e(mt).bind("click.spectrum",A),e(t).bind("resize.spectrum",Y),zt.addClass("sp-active"),yt.removeClass("sp-hidden"),V(),P(),Ht=R(),x(),X.show(Ht),vt.trigger("show.spectrum",[Ht])))}function A(i){i&&"click"==i.type&&2==i.button||Z&&!j&&(Z=!1,e(mt).unbind("click.spectrum",A),e(t).unbind("resize.spectrum",Y),zt.removeClass("sp-active"),yt.addClass("sp-hidden"),!tinycolor.equals(R(),Ht)&&(jt&&"cancel"!==i?z(!0):I()),X.hide(R()),vt.trigger("hide.spectrum",[R()]))}function I(){O(Ht,!0)}function O(t,e){var i,n;tinycolor.equals(t,R())?P():(!t&&qt?Gt=!0:(Gt=!1,n=(i=tinycolor(t)).toHsv(),rt=n.h%360/360,st=n.s,at=n.v,lt=n.a),P(),i&&i.isValid()&&!e&&(Wt=Ut||i.getFormat()))}function R(t){return t=t||{},qt&&Gt?null:tinycolor.fromRatio({h:rt,s:st,v:at,a:Math.round(100*lt)/100},{format:t.format||Wt})}function D(){return!Tt.hasClass("sp-validation-error")}function B(){P(),X.move(R()),vt.trigger("move.spectrum",[R()])}function P(){Tt.removeClass("sp-validation-error"),N();var t=tinycolor.fromRatio({h:rt,s:1,v:1});kt.css("background-color",t.toHexString());var e=Wt;lt<1&&(0!==lt||"name"!==e)&&("hex"!==e&&"hex3"!==e&&"hex6"!==e&&"name"!==e||(e="rgb"));var i=R({format:e}),n="";if(Ft.removeClass("sp-clear-display"),Ft.css("background-color","transparent"),!i&&qt)Ft.addClass("sp-clear-display");else{var o=i.toHexString(),r=i.toRgbString();if(m||1===i.alpha?Ft.css("background-color",r):(Ft.css("background-color","transparent"),Ft.css("filter",i.toFilter())),W.showAlpha){var s=i.toRgb();s.a=0;var a=tinycolor(s).toRgbString(),l="linear-gradient(left, "+a+", "+o+")";g?Lt.css("filter",tinycolor(a).toFilter({gradientType:1},o)):(Lt.css("background","-webkit-"+l),Lt.css("background","-moz-"+l),Lt.css("background","-ms-"+l),Lt.css("background","linear-gradient(to right, "+a+", "+o+")"))}n=i.toString(e)}W.showInput&&Tt.val(n),W.showPalette&&_(),x()}function N(){var t=st,e=at;if(qt&&Gt)Et.hide(),xt.hide(),wt.hide();else{Et.show(),xt.show(),wt.show();var i=t*J,n=Q-e*Q;i=Math.max(-tt,Math.min(J-tt,i-tt)),n=Math.max(-tt,Math.min(Q-tt,n-tt)),wt.css({top:n+"px",left:i+"px"});var o=lt*it;Et.css({left:o-nt/2+"px"});var r=rt*et;xt.css({top:r-ot+"px"})}}function z(t){var e=R(),i="",n=!tinycolor.equals(e,Ht);e&&(i=e.toString(Wt),k(e)),Bt&&vt.val(i),Ht=e,t&&n&&(X.change(e),vt.trigger("change",[e]))}function V(){J=kt.width(),Q=kt.height(),tt=wt.height(),_t.width(),et=_t.height(),ot=xt.height(),it=Ct.width(),nt=Et.width(),j||(yt.css("position","absolute"),yt.offset(a(yt,Vt,W))),N(),W.showPalette&&_(),vt.trigger("reflow.spectrum")}function F(){vt.show(),Vt.unbind("click.spectrum touchstart.spectrum"),yt.remove(),zt.remove(),f[Kt.id]=null}function $(t,n){return t===i?e.extend({},W):n===i?W[t]:(W[t]=n,void h())}function H(){bt=!1,vt.attr("disabled",!1),Vt.removeClass("sp-disabled")}function U(){A(),bt=!0,vt.attr("disabled",!0),Vt.addClass("sp-disabled")}var W=r(l,s),j=W.flat,G=W.showSelectionPalette,q=W.localStorageKey,K=W.theme,X=W.callbacks,Y=d(V,10),Z=!1,J=0,Q=0,tt=0,et=0,it=0,nt=0,ot=0,rt=0,st=0,at=0,lt=1,ct=[],ht=[],ut={},dt=W.selectionPalette.slice(0),pt=W.maxSelectionSize,ft="sp-dragging",gt=null,mt=s.ownerDocument,vt=(mt.body,e(s)),bt=!1,yt=e(y,mt).addClass(K),St=yt.find(".sp-picker-container"),kt=yt.find(".sp-color"),wt=yt.find(".sp-dragger"),_t=yt.find(".sp-hue"),xt=yt.find(".sp-slider"),Lt=yt.find(".sp-alpha-inner"),Ct=yt.find(".sp-alpha"),Et=yt.find(".sp-alpha-handle"),Tt=yt.find(".sp-input"),Mt=yt.find(".sp-palette"),At=yt.find(".sp-initial"),It=yt.find(".sp-cancel"),Ot=yt.find(".sp-clear"),Rt=yt.find(".sp-choose"),Dt=yt.find(".sp-palette-toggle"),Bt=vt.is("input"),Pt=Bt&&v&&"color"===vt.attr("type"),Nt=Bt&&!j,zt=Nt?e(b).addClass(K).addClass(W.className).addClass(W.replacerClassName):e([]),Vt=Nt?zt:vt,Ft=zt.find(".sp-preview-inner"),$t=W.color||Bt&&vt.val(),Ht=!1,Ut=W.preferredFormat,Wt=Ut,jt=!W.showButtons||W.clickoutFiresChange,Gt=!$t,qt=W.allowEmpty&&!Pt;p();var Kt={show:M,hide:A,toggle:T,reflow:V,option:$,enable:H,disable:U,set:function(t){O(t),z()},get:R,destroy:F,container:yt,saveCurrentSelection:function(){k(R())}};return Kt.id=f.push(Kt)-1,Kt}function a(t,i,n){var o=0,r=t.outerWidth(),s=t.outerHeight(),a=i.outerHeight(),l=i.outerWidth(),c=t[0].ownerDocument,h=c.documentElement,u=h.clientWidth+e(c).scrollLeft(),d=h.clientHeight+e(c).scrollTop(),p=i.offset();return p.left-=r/2-l/2-n.offsetX,p.top+=a+n.offsetY,p.left-=Math.min(p.left,p.left+r>u&&u>r?Math.abs(p.left+r-u):0),p.top-=Math.min(p.top,p.top+s>d&&d>s?Math.abs(s+a-o):o),p}function l(){}function c(t){t.stopPropagation()}function h(t,e){var i=Array.prototype.slice,n=i.call(arguments,2);return function(){return t.apply(e,n.concat(i.call(arguments)))}}function u(i,n,o,r){function s(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function a(t){if(u){if(g&&document.documentMode<9&&!t.button)return c();var e=t.originalEvent.touches,o=e?e[0].pageX:t.pageX,r=e?e[0].pageY:t.pageY,a=Math.max(0,Math.min(o-d.left,f)),l=Math.max(0,Math.min(r-d.top,p));m&&s(t),n.apply(i,[a,l,t])}}function l(t){var n=t.which?3==t.which:2==t.button;t.originalEvent.touches;n||u||!1!==o.apply(i,arguments)&&(u=!0,p=e(i).height(),f=e(i).width(),d=e(i).offset(),e(h).bind(v),e(h.body).addClass("sp-dragging"),m||a(t),s(t))}function c(){u&&(e(h).unbind(v),e(h.body).removeClass("sp-dragging"),r.apply(i,arguments)),u=!1}n=n||function(){},o=o||function(){},r=r||function(){};var h=i.ownerDocument||document,u=!1,d={},p=0,f=0,m="ontouchstart"in t,v={};v.selectstart=s,v.dragstart=s,v["touchmove mousemove"]=a,v["touchend mouseup"]=c,e(i).bind("touchstart mousedown",l)}function d(t,e,i){var n;return function(){var o=this,r=arguments,s=function(){n=null,t.apply(o,r)};i&&clearTimeout(n),!i&&n||(n=setTimeout(s,e))}}var p={beforeShow:l,move:l,change:l,show:l,hide:l,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",cancelClassName:"",chooseText:"choose",chooseClassName:"",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offsetX:0,offsetY:0},f=[],g=!!/msie/i.exec(t.navigator.userAgent),m=function(){function t(t,e){return!!~(""+t).indexOf(e)}var e=document.createElement("div").style;return e.cssText="background-color:rgba(0,0,0,.5)",t(e.backgroundColor,"rgba")||t(e.backgroundColor,"hsla")}(),v=!0,b=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),y=function(){var t="";if(g)for(var e=1;e<=6;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),S="spectrum.id";e.fn.spectrum=function(t){if("string"==typeof t){var i=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var o=f[e(this).data(S)];if(o){var r=o[t];if(!r)throw new Error("Spectrum: no such method: '"+t+"'");"get"==t?i=o.get():"container"==t?i=o.container:"option"==t?i=o.option.apply(o,n):"destroy"==t?(o.destroy(),e(this).removeData(S)):r.apply(o,n)}}),i}return this.spectrum("destroy").each(function(){var i=s(this,e.extend({},t,e(this).data()));e(this).data(S,i.id)})},e.fn.spectrum.load=!0,e.fn.spectrum.loadOpts={},e.fn.spectrum.draggable=u,e.fn.spectrum.defaults=p,e.spectrum={},e.spectrum.localization={},e.spectrum.palettes={},e.fn.spectrum.processNativeColorInputs=function(){v||e("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function e(t){var e={r:0,g:0,b:0},n=1,r=!1,a=!1;return"string"==typeof t&&(t=R(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=i(t.r,t.g,t.b),r=!0,a="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=A(t.s),t.v=A(t.v),e=s(t.h,t.s,t.v),r=!0,a="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=A(t.s),t.l=A(t.l),e=o(t.h,t.s,t.l),r=!0,a="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=_(n),{ok:r,format:t.format||a,r:V(255,F(e.r,0)),g:V(255,F(e.g,0)),b:V(255,F(e.b,0)),a:n}}function i(t,e,i){return{r:255*x(t,255),g:255*x(e,255),b:255*x(i,255)}}function n(t,e,i){t=x(t,255),e=x(e,255),i=x(i,255);var n,o,r=F(t,e,i),s=V(t,e,i),a=(r+s)/2;if(r==s)n=o=0;else{var l=r-s;switch(o=a>.5?l/(2-r-s):l/(r+s),r){case t:n=(e-i)/l+(e<i?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s:o,l:a}}function o(t,e,i){function n(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}var o,r,s;if(t=x(t,360),e=x(e,100),i=x(i,100),0===e)o=r=s=i;else{var a=i<.5?i*(1+e):i+e-i*e,l=2*i-a;o=n(l,a,t+1/3),r=n(l,a,t),s=n(l,a,t-1/3)}return{r:255*o,g:255*r,b:255*s}}function r(t,e,i){t=x(t,255),e=x(e,255),i=x(i,255);var n,o,r=F(t,e,i),s=V(t,e,i),a=r,l=r-s;if(o=0===r?0:l/r,r==s)n=0;else{switch(r){case t:n=(e-i)/l+(e<i?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s:o,v:a}}function s(t,e,i){t=6*x(t,360),e=x(e,100),i=x(i,100);var n=N.floor(t),o=t-n,r=i*(1-e),s=i*(1-o*e),a=i*(1-(1-o)*e),l=n%6;return{r:255*[i,s,r,r,a,i][l],g:255*[a,i,i,s,r,r][l],b:255*[r,r,a,i,i,s][l]}}function a(t,e,i,n){var o=[M(z(t).toString(16)),M(z(e).toString(16)),M(z(i).toString(16))];return n&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function l(t,e,i,n){return[M(I(n)),M(z(t).toString(16)),M(z(e).toString(16)),M(z(i).toString(16))].join("")}function c(t,e){e=0===e?0:e||10;var i=H(t).toHsl();return i.s-=e/100,i.s=L(i.s),H(i)}function h(t,e){e=0===e?0:e||10;var i=H(t).toHsl();return i.s+=e/100,i.s=L(i.s),H(i)}function u(t){return H(t).desaturate(100)}function d(t,e){e=0===e?0:e||10;var i=H(t).toHsl();return i.l+=e/100,i.l=L(i.l),H(i)}function p(t,e){e=0===e?0:e||10;var i=H(t).toRgb();return i.r=F(0,V(255,i.r-z(-e/100*255))),i.g=F(0,V(255,i.g-z(-e/100*255))),i.b=F(0,V(255,i.b-z(-e/100*255))),H(i)}function f(t,e){e=0===e?0:e||10;var i=H(t).toHsl();return i.l-=e/100,i.l=L(i.l),H(i)}function g(t,e){var i=H(t).toHsl(),n=(z(i.h)+e)%360;return i.h=n<0?360+n:n,H(i)}function m(t){var e=H(t).toHsl();return e.h=(e.h+180)%360,H(e)}function v(t){var e=H(t).toHsl(),i=e.h;return[H(t),H({h:(i+120)%360,s:e.s,l:e.l}),H({h:(i+240)%360,s:e.s,l:e.l})]}function b(t){var e=H(t).toHsl(),i=e.h;return[H(t),H({h:(i+90)%360,s:e.s,l:e.l}),H({h:(i+180)%360,s:e.s,l:e.l}),H({h:(i+270)%360,s:e.s,l:e.l})]}function y(t){var e=H(t).toHsl(),i=e.h;return[H(t),H({h:(i+72)%360,s:e.s,l:e.l}),H({h:(i+216)%360,s:e.s,l:e.l})]}function S(t,e,i){e=e||6,i=i||30;var n=H(t).toHsl(),o=360/i,r=[H(t)];for(n.h=(n.h-(o*e>>1)+720)%360;--e;)n.h=(n.h+o)%360,r.push(H(n));return r}function k(t,e){e=e||6;for(var i=H(t).toHsv(),n=i.h,o=i.s,r=i.v,s=[],a=1/e;e--;)s.push(H({h:n,s:o,v:r})),r=(r+a)%1;return s}function w(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[t[i]]=i);return e}function _(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function x(t,e){E(t)&&(t="100%");var i=T(t);return t=V(e,F(0,parseFloat(t))),i&&(t=parseInt(t*e,10)/100),N.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function L(t){return V(1,F(0,t))}function C(t){return parseInt(t,16)}function E(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function T(t){return"string"==typeof t&&-1!=t.indexOf("%")}function M(t){return 1==t.length?"0"+t:""+t}function A(t){return t<=1&&(t=100*t+"%"),t}function I(t){return Math.round(255*parseFloat(t)).toString(16)}function O(t){return C(t)/255}function R(t){t=t.replace(D,"").replace(B,"").toLowerCase();var e,i=!1;if(G[t])t=G[t],i=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=K.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=K.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=K.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=K.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=K.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=K.hex8.exec(t))?{a:O(e[1]),r:C(e[2]),g:C(e[3]),b:C(e[4]),format:i?"name":"hex8"}:(e=K.hex6.exec(t))?{r:C(e[1]),g:C(e[2]),b:C(e[3]),format:i?"name":"hex"}:!!(e=K.hex3.exec(t))&&{r:C(e[1]+""+e[1]),g:C(e[2]+""+e[2]),b:C(e[3]+""+e[3]),format:i?"name":"hex"}}var D=/^[\s,#]+/,B=/\s+$/,P=0,N=Math,z=N.round,V=N.min,F=N.max,$=N.random,H=function X(t,i){if(i=i||{},(t=t||"")instanceof X)return t;if(!(this instanceof X))return new X(t,i);var n=e(t);this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=z(100*this._a)/100,this._format=i.format||n.format,this._gradientType=i.gradientType,this._r<1&&(this._r=z(this._r)),this._g<1&&(this._g=z(this._g)),this._b<1&&(this._b=z(this._b)),this._ok=n.ok,this._tc_id=P++};H.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=_(t),this._roundA=z(100*this._a)/100,this},toHsv:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=r(this._r,this._g,this._b),e=z(360*t.h),i=z(100*t.s),n=z(100*t.v);return 1==this._a?"hsv("+e+", "+i+"%, "+n+"%)":"hsva("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=n(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=n(this._r,this._g,this._b),e=z(360*t.h),i=z(100*t.s),o=z(100*t.l);return 1==this._a?"hsl("+e+", "+i+"%, "+o+"%)":"hsla("+e+", "+i+"%, "+o+"%, "+this._roundA+")"},toHex:function(t){return a(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return l(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:z(this._r),g:z(this._g),b:z(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+z(this._r)+", "+z(this._g)+", "+z(this._b)+")":"rgba("+z(this._r)+", "+z(this._g)+", "+z(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:z(100*x(this._r,255))+"%",g:z(100*x(this._g,255))+"%",b:z(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+z(100*x(this._r,255))+"%, "+z(100*x(this._g,255))+"%, "+z(100*x(this._b,255))+"%)":"rgba("+z(100*x(this._r,255))+"%, "+z(100*x(this._g,255))+"%, "+z(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(q[a(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+l(this._r,this._g,this._b,this._a),i=e,n=this._gradientType?"GradientType = 1, ":"";t&&(i=H(t).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+i+")"},toString:function(t){var e=!!t;t=t||this._format;var i=!1,n=this._a<1&&this._a>=0;return e||!n||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"name"!==t?("rgb"===t&&(i=this.toRgbString()),"prgb"===t&&(i=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(i=this.toHexString()),"hex3"===t&&(i=this.toHexString(!0)),"hex8"===t&&(i=this.toHex8String()),"name"===t&&(i=this.toName()),"hsl"===t&&(i=this.toHslString()),"hsv"===t&&(i=this.toHsvString()),i||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(t,e){var i=t.apply(null,[this].concat([].slice.call(e)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(d,arguments)},brighten:function(){return this._applyModification(p,arguments)},darken:function(){return this._applyModification(f,arguments)},desaturate:function(){return this._applyModification(c,arguments)},saturate:function(){return this._applyModification(h,arguments)},greyscale:function(){return this._applyModification(u,arguments)},spin:function(){return this._applyModification(g,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(S,arguments)},complement:function(){return this._applyCombination(m,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(y,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(b,arguments)}},H.fromRatio=function(t,e){if("object"==typeof t){var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]="a"===n?t[n]:A(t[n]));t=i}return H(t,e)},H.equals=function(t,e){return!(!t||!e)&&H(t).toRgbString()==H(e).toRgbString()},H.random=function(){return H.fromRatio({r:$(),g:$(),b:$()})},H.mix=function(t,e,i){i=0===i?0:i||50;var n,o=H(t).toRgb(),r=H(e).toRgb(),s=i/100,a=2*s-1,l=r.a-o.a,c=1-(n=((n=a*l==-1?a:(a+l)/(1+a*l))+1)/2),h={r:r.r*n+o.r*c,g:r.g*n+o.g*c,b:r.b*n+o.b*c,a:r.a*s+o.a*(1-s)};return H(h)},H.readability=function(t,e){var i=H(t),n=H(e),o=i.toRgb(),r=n.toRgb(),s=i.getBrightness(),a=n.getBrightness(),l=Math.max(o.r,r.r)-Math.min(o.r,r.r)+Math.max(o.g,r.g)-Math.min(o.g,r.g)+Math.max(o.b,r.b)-Math.min(o.b,r.b);return{brightness:Math.abs(s-a),color:l}},H.isReadable=function(t,e){var i=H.readability(t,e);return i.brightness>125&&i.color>500},H.mostReadable=function(t,e){for(var i=null,n=0,o=!1,r=0;r<e.length;r++){var s=H.readability(t,e[r]),a=s.brightness>125&&s.color>500,l=s.brightness/125*3+s.color/500;(a&&!o||a&&o&&l>n||!a&&!o&&l>n)&&(o=a,n=l,i=H(e[r]))}return i};var U,W,j,G=H.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},q=H.hexNames=w(G),K=(W="[\\s|\\(]+("+(U="(?:"+"[-\\+]?\\d*\\.\\d+%?"+")|(?:"+"[-\\+]?\\d+%?"+")")+")[,|\\s]+("+U+")[,|\\s]+("+U+")\\s*\\)?",
j="[\\s|\\(]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")\\s*\\)?",{rgb:new RegExp("rgb"+W),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+W),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+W),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});t.tinycolor=H}(),e(function(){e.fn.spectrum.load&&e.fn.spectrum.processNativeColorInputs()})}(window,jQuery),
/*!
 * skriv.js 0.1.0 (2014-09-09, 10:35)
 * http://lab.hakim.se/skriv
 * MIT licensed
 *
 * Copyright (C) 2013 Hakim El Hattab, http://hakim.se
 */
function(){var t=!1,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(i){function n(){!t&&this.init&&this.init.apply(this,arguments)}var o=this.prototype;t=!0;var r=new this;for(var s in t=!1,i)r[s]="function"==typeof i[s]&&"function"==typeof o[s]&&e.test(i[s])?function(t,e){return function(){var i=this._super;this._super=o[t];var n=e.apply(this,arguments);return this._super=i,n}}(s,i[s]):i[s];return n.prototype=r,n.constructor=n,n.extend=arguments.callee,n}}(),
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
"undefined"==typeof document||"classList"in document.createElement("a")||function(t){var e="classList",i="prototype",n=(t.HTMLElement||t.Element)[i],o=Object,r=String[i].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[i].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},a=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},l=function(t,e){if(""===e)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(t,e)},c=function(t){for(var e=r.call(t.className),i=e?e.split(/\s+/):[],n=0,o=i.length;n<o;n++)this.push(i[n]);this._updateClassName=function(){t.className=this.toString()}},h=c[i]=[],u=function(){return new c(this)};if(a[i]=Error[i],h.item=function(t){return this[t]||null},h.contains=function(t){return-1!==l(this,t+="")},h.add=function(t){-1===l(this,t+="")&&(this.push(t),this._updateClassName())},h.remove=function(t){var e=l(this,t+="");-1!==e&&(this.splice(e,1),this._updateClassName())},h.toggle=function(t){-1===l(this,t+="")?this.add(t):this.remove(t)},h.toString=function(){return this.join(" ")},o.defineProperty){var d={get:u,enumerable:!0,configurable:!0};try{o.defineProperty(n,e,d)}catch(p){-2146823252===p.number&&(d.enumerable=!1,o.defineProperty(n,e,d))}}else o[i].__defineGetter__&&n.__defineGetter__(e,u)}(self);
/*!
 * WYSIWYG editor.
 */
var skriv={actions:{},create:function(t,e){function i(){k=k.bind(this),v=v.bind(this),b=b.bind(this),y=y.bind(this),S=S.bind(this),w=w.bind(this),n(),o(),s(),C.classList.add("loaded"),C.classList.add("disabled"),C.addEventListener("click",k,!1)}function n(){var t=document.createElement("div");t.setAttribute("contenteditable",!0),t.style.className="skriv-enabler",t.style.position="absolute",t.style.display="none",t.style.width="0px",t.style.height="0px",document.body.appendChild(t)}function o(t){L=skriv.util.extend(L,t),r(),L.autoBind?x=setInterval(s,500):clearInterval(x)}function r(){[].slice.call(C.querySelectorAll("li")).forEach(function(t){if(0===t.childNodes.length){t.parentNode.removeChild(t);var e,i={};if(Array.prototype.slice.call(t.attributes).forEach(function(t){/^data\-/gi.test(t.name)&&(i[t.name.replace(/^data\-/gi,"")]=t.value)}),i.tags="string"==typeof i.tags?i.tags.split(","):[],i.keys="string"==typeof i.keys?i.keys.split(","):[],"string"==typeof i.model&&/\./g.test(i.model)){for(var n=window,o=i.model.split(".");o.length;)n=n[o.shift()];i.model=n}if(i.command)(e=new skriv.actions.command(M,i)).appendTo(C),E.push(e);else if(i.model)(e=new i.model(M,i)).appendTo(C),E.push(e);else if("divider"===i.id){var r=document.createElement("div");r.className="divider",C.appendChild(r),i.name&&r.classList.add(i.name)}else console&&"function"==typeof console.warn&&console.warn('Action of type "'+i.id+'" could not be created.')}}.bind(this))}function s(t){(t?[t]:Array.prototype.slice.call(document.querySelectorAll("[contenteditable]"))).forEach(function(t){t.addEventListener("focus",v,!1),t.addEventListener("blur",b,!1),t.addEventListener("mouseup",y,!1),t.addEventListener("keyup",S,!1)})}function a(t){(t?[t]:Array.prototype.slice.call(document.querySelectorAll("[contenteditable]"))).forEach(function(t){t.removeEventListener("focus",v,!1),t.removeEventListener("blur",b,!1),t.removeEventListener("mouseup",y,!1),t.removeEventListener("keyup",S,!1)})}function l(t){t.appendChild(C)}function c(){C.classList.remove("disabled")}function h(t){if(void 0===t&&(t=skriv.util.getSelectedElement()),t){for(var e=[],i=t;i;)e.push(i.nodeName.toLowerCase()),i=i.parentNode;E.forEach(function(i){i.updateSelection(t,e)})}else E.forEach(function(t){t.deselect()})}function u(t,e){T.dispatch(t,e)}function d(){E.forEach(function(t){"function"==typeof t.isOpen&&t.isOpen()&&t.close()})}function p(t){_=t}function f(){return _}function g(t){var e=null;return E.forEach(function(i){i.id===t&&(e=i)}),e}function m(){var t;return E.forEach(function(e){"function"==typeof e.isOpen&&e.isOpen()&&(t=e)}),t}function v(t){_=t.target,c(),document.addEventListener("keydown",w,!1)}function b(){h(null),document.removeEventListener("keydown",w,!1)}function y(){h()}function S(){h()}function k(){h()}function w(t){E.forEach(function(e){(t.metaKey||t.ctrlKey)&&e.updateKeyDown(t.keyCode)&&t.preventDefault()})}if("object"!=typeof t)throw"A container element must be specified.";var _,x,L=skriv.util.extend({autoBind:!1},e),C=t,E=[],T=new skriv.Signal,M={configure:o,appendTo:l,notify:u,bind:s,unbind:a,closeActions:d,setEditor:p,getEditor:f,getAction:g,getOpenAction:m,notified:T};return i(),M}};skriv.util={expressions:{IS_YOUTUBE_URL:/(?:www\.)?youtu(?:be\.com\/watch\?(?:.*?&(?:amp;)?)?v=|\.be\/)([\w\-]+)(?:&(?:amp;)?[\w\?=]*)?/gi,IS_VIMEO_URL:/(www\.)?vimeo\.com\/(\w*\/)*(([a-z]{0,2}-)?\d+)/gi,YOUTUBE_VIDEO_ID:/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,VIMEO_VIDEO_ID:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/},getYouTubeID:function(t){if(skriv.util.expressions.IS_YOUTUBE_URL.test(t)){var e=t.match(skriv.util.expressions.YOUTUBE_VIDEO_ID);if(e&&e.length>2)return e[2]}},getVimeoID:function(t){if(skriv.util.expressions.IS_VIMEO_URL.test(t)){var e=t.match(skriv.util.expressions.VIMEO_VIDEO_ID);if(e&&e.length>4)return e[5]}},extend:function(t,e){for(var i in e)t[i]=e[i];return t},wrap:function(t,e){e&&t&&(t.parentNode.appendChild(e),e.appendChild(t))},wrapInner:function(t,e){e&&t&&(e.innerHTML=t.innerText||t.textContent,t.innerHTML="",t.appendChild(e))},unwrap:function(t){if(t&&t.childNodes.length&&t.parentNode){for(;t.childNodes.length;)t.parentNode.insertBefore(t.childNodes[0],t);t.parentNode.removeChild(t)}},execCommand:function(t,e,i){try{document.execCommand(t,!1,i)}catch(n){}},placeCaretAtEnd:function(t){if(t.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);var i=window.getSelection();i.removeAllRanges(),i.addRange(e)}else if("undefined"!=typeof document.body.createTextRange){var n=document.body.createTextRange();n.moveToElementText(t),n.collapse(!1),n.select()}},selectText:function(t){var e,i;document.body.createTextRange?((e=document.body.createTextRange()).moveToElementText(t),e.select()):window.getSelection&&(i=window.getSelection(),(e=document.createRange()).selectNodeContents(t),i.removeAllRanges(),i.addRange(e))},getSelectedElement:function(){var t=window.getSelection();return t&&t.anchorNode?t.anchorNode.parentNode:null},getSelectedHTML:function(){if(document.selection&&document.selection.createRange)return document.selection.createRange().htmlText;if(window.getSelection){var t=window.getSelection();if(t.rangeCount>0){var e=t.getRangeAt(0).cloneContents(),i=document.createElement("div");return i.appendChild(e),i.innerHTML}return""}return""},getParentOfType:function(t,e){for(var i=null;t&&t.parentNode;)t.nodeName.toLowerCase()===e.toLowerCase()&&(i=t),t=t.parentNode;return i}},skriv.Signal=function(){this.listeners=[]},skriv.Signal.prototype.add=function(t){this.listeners.push(t)},skriv.Signal.prototype.remove=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},skriv.Signal.prototype.dispatch=function(){var t=Array.prototype.slice.call(arguments);this.listeners.forEach(function(e){e.apply(null,t)})},skriv.actions.abstract=Class.extend({init:function(t,e){this.core=t,this.config=e||{},this.id=this.config.id,this.tags=this.config.tags||[],this.keys=this.config.keys||[],this.clicked=new skriv.Signal,this.build(),this.bind()},build:function(){this.domElement=document.createElement("div"),this.domElement.classList.add("action"),this.domElement.classList.add(this.id),this.config.name&&this.domElement.classList.add(this.config.name),this.buttonElement=document.createElement("button"),this.domElement.appendChild(this.buttonElement),this.iconElement=document.createElement("span"),this.iconElement.className="icon "+this.id,this.buttonElement.appendChild(this.iconElement)},bind:function(){this.buttonElement.addEventListener("mousedown",this.onMouseDown.bind(this)),this.buttonElement.addEventListener("click",this.onClick.bind(this))},trigger:function(){},appendTo:function(t){t.appendChild(this.domElement)},hasTag:function(t){var e=!1,i=this.tags;return"string"==typeof t&&(t=[t]),t.forEach(function(t){i.forEach(function(i){t===i&&(e=!0)})}),e},select:function(){this.domElement.classList.add("selected")},deselect:function(){this.domElement.classList.remove("selected")},updateSelection:function(t,e){this.hasTag(e)?this.select():this.deselect()},updateKeyDown:function(t){for(var e=0,i=this.keys.length;e<i;e++)if(parseInt(this.keys[e],10)===t)return"function"==typeof this.open?this.open():this.trigger(),!0;return!1},onMouseDown:function(t){t.preventDefault()},onClick:function(){this.clicked.dispatch()}}),skriv.actions.command=skriv.actions.abstract.extend({init:function(t,e){this._super(t,e),this.command=e.command},trigger:function(){skriv.util.execCommand(this.command,!1)},onClick:function(t){this._super(t),this.trigger()}}),skriv.actions.popout=skriv.actions.abstract.extend({init:function(t,e){this._super(t,e),this.onDocumentMouseDown=this.onDocumentMouseDown.bind(this)},build:function(){this._super(),this.panelElement=document.createElement("div"),this.panelElement.classList.add("panel"),this.domElement.appendChild(this.panelElement)},bind:function(){this._super(),this.domElement.addEventListener("mousedown",this.onMouseDown.bind(this),!1),this.domElement.addEventListener("mouseover",this.onMouseOver.bind(this),!1),this.domElement.addEventListener("mouseout",this.onMouseOut.bind(this),!1)},open:function(){this.isOpen()||(this.domElement.classList.add("open"),document.addEventListener("mousedown",this.onDocumentMouseDown,!1),this.layout())},close:function(){this.isOpen()&&(this.domElement.classList.remove("open"),document.removeEventListener("mousedown",this.onDocumentMouseDown,!1))},toggle:function(){this.isOpen()?this.close():this.open()},isOpen:function(){return this.domElement.classList.contains("open")},layout:function(){var t=this.panelElement.offsetWidth,e=this.buttonElement.offsetWidth,i=this.buttonElement.offsetHeight;this.panelElement.style.left=(e-t)/2+"px",this.panelElement.style.top=i+"px"},onClick:function(t){this._super(t),this.toggle()},onDocumentMouseDown:function(t){for(var e=t.target,i=!1;e;)e===this.domElement&&(i=!0),e=e.parentNode;i||this.close()},onMouseDown:function(t){t.preventDefault()},onMouseOver:function(){this.config.openOnHover&&this.open()},onMouseOut:function(){this.config.openOnHover&&this.close()}}),skriv.actions.dropdown=skriv.actions.popout.extend({init:function(t,e){this.options=this.options||[],this._super(t,e),this.options&&this.options.length>0&&this.setValue(this.options[0].value)},build:function(){this._super(),this.domElement.style.width="100px",this.panelElement.style.width="140px",this.dropdownElement=document.createElement("ul"),this.panelElement.appendChild(this.dropdownElement),this.panelElement.classList.add("dropdown"),this.options.forEach(this.addOption.bind(this))},addOption:function(t){var e=document.createElement("li");e.setAttribute("data-value",t.value),e.textContent=t.name,this.bindOption(e,t),this.dropdownElement.appendChild(e)},bindOption:function(t,e){t.addEventListener("click",function(t){this.setValue(t),this.close()}.bind(this,e.value),!1)},populate:function(t){this.dropdownElement.innerHTML="",this.options=t,this.options.forEach(this.addOption.bind(this))},cancel:function(){},setValue:function(t,e){this.hasValue(t)&&(this.selectedElement=this.dropdownElement.querySelector('[data-value="'+t+'"]'),this.config.leaveHeader||(this.buttonElement.textContent=this.selectedElement.textContent),e||this.trigger())},getValue:function(){return this.selectedElement?this.selectedElement.getAttribute("data-value"):null},hasValue:function(t){return!!this.dropdownElement.querySelector('[data-value="'+t+'"]')}}),skriv.actions.align=skriv.actions.dropdown.extend({init:function(t,e){e.openOnHover=!0,this.options=[{name:"Left",value:"justifyleft"},{name:"Center",value:"justifycenter"},{name:"Right",value:"justifyright"},{name:"Justify",value:"justifyfull"}],this._super(t,e)},build:function(){this._super(),this.domElement.style.width="50px",this.panelElement.style.width="152px",this.panelElement.classList.add("single-row")},addOption:function(t){var e=document.createElement("li");e.setAttribute("data-value",t.value),this.bindOption(e,t);var i=document.createElement("div");i.className="icon "+t.value,e.appendChild(i),this.dropdownElement.appendChild(e)},trigger:function(){var t=this.getValue();skriv.util.execCommand(t,!1)},setValue:function(t,e){this.hasValue(t)&&(this.selectedElement=this.dropdownElement.querySelector('[data-value="'+t+'"]'),e||this.trigger())}}),skriv.actions.link=skriv.actions.popout.extend({init:function(t,e){this._super(t,e)},build:function(){this._super(),this.domElement.classList.add(this.id),this.linkInput=document.createElement("input"),this.linkInput.setAttribute("type","text"),this.linkInput.setAttribute("placeholder","http://"),this.panelElement.appendChild(this.linkInput),this.confirmButton=document.createElement("button"),this.confirmButton.classList.add("confirm-button"),this.confirmButton.innerHTML="OK",this.panelElement.appendChild(this.confirmButton),this.cancelButton=document.createElement("button"),this.cancelButton.classList.add("cancel-button"),this.cancelButton.innerHTML="Cancel",this.panelElement.appendChild(this.cancelButton),this.panelElement.style.width="340px"},bind:function(){this._super(),this.confirmButton.addEventListener("click",this.onConfirmClicked.bind(this),!1),this.cancelButton.addEventListener("click",this.onCancelClicked.bind(this),!1),this.linkInput.addEventListener("keydown",this.onKeyDown.bind(this),!1)},trigger:function(){this.linkElement&&(this.linkElement.setAttribute("href",this.linkInput.value),this.linkElement=null)},open:function(){var t=skriv.util.getParentOfType(skriv.util.getSelectedElement(),"a");t||skriv.util.getSelectedHTML().length?(this._super(),this.linkInput.value="",t?(this.linkElement=t,this.linkInput.value=this.linkElement.getAttribute("href")):(skriv.util.execCommand("createLink",!1,skriv.actions.link.PLACEHOLDER),this.linkElement=document.querySelector('a[href="'+skriv.actions.link.PLACEHOLDER+'"]')),this.linkInput.focus(),this.linkInput.select()):this.core.notify("Please select some text first")},close:function(){this._super(),this.linkElement&&this.linkElement.getAttribute("href")===skriv.actions.link.PLACEHOLDER&&skriv.util.unwrap(this.linkElement)},onClick:function(t){this._super(t)},onConfirmClicked:function(){""===this.linkInput.value?this.close():(this.trigger(),this.close())},onCancelClicked:function(){this.close()},onKeyDown:function(t){13===t.keyCode&&this.onConfirmClicked(t)}}),skriv.actions.link.PLACEHOLDER="javascript:link",skriv.actions.unlink=skriv.actions.abstract.extend({init:function(t,e){this._super(t,e)},trigger:function(){var t=skriv.util.getParentOfType(skriv.util.getSelectedElement(),"a");t&&0===skriv.util.getSelectedHTML().length?skriv.util.unwrap(t):skriv.util.execCommand("unlink",!1)},onClick:function(t){this._super(t),this.trigger()}}),skriv.actions.image=skriv.actions.popout.extend({init:function(t,e){this._super(t,e),this.changeTab("upload")},build:function(){this._super(),this.domElement.classList.add(this.id),this.panelElement.classList.add("tabbed"),this.tabBar=document.createElement("div"),this.tabBar.className="tab-bar",this.panelElement.appendChild(this.tabBar),this.uploadTab=document.createElement("button"),this.uploadTab.setAttribute("data-value","upload"),this.uploadTab.textContent="Upload",this.tabBar.appendChild(this.uploadTab),this.linkTab=document.createElement("button"),this.linkTab.setAttribute("data-value","link"),this.linkTab.textContent="URL",this.tabBar.appendChild(this.linkTab),this.linkSection=document.createElement("div"),this.linkSection.className="tab-contents link-section",this.panelElement.appendChild(this.linkSection),this.linkInput=document.createElement("input"),this.linkInput.setAttribute("type","text"),this.linkInput.setAttribute("placeholder","Image, YouTube or Vimeo URL..."),this.linkSection.appendChild(this.linkInput),this.confirmButton=document.createElement("button"),this.confirmButton.className="confirm-button",this.confirmButton.innerHTML="OK",this.linkSection.appendChild(this.confirmButton),this.cancelButton=document.createElement("button"),this.cancelButton.className="cancel-button",this.cancelButton.innerHTML="Cancel",this.linkSection.appendChild(this.cancelButton),this.clearElement=document.createElement("div"),this.clearElement.classList.add("clear"),this.linkSection.appendChild(this.clearElement),this.uploadSection=document.createElement("div"),this.uploadSection.className="tab-contents upload-section",this.panelElement.appendChild(this.uploadSection),this.formElement=document.createElement("div"),this.formElement.className="file-form",this.uploadSection.appendChild(this.formElement),this.fileInput=document.createElement("input"),this.fileInput.setAttribute("type","file"),this.formElement.appendChild(this.fileInput),this.browseWrapper=document.createElement("div"),this.browseWrapper.className="browse",this.formElement.appendChild(this.browseWrapper),this.browseOutput=document.createElement("input"),this.browseOutput.setAttribute("type","text"),this.browseOutput.setAttribute("readonly","readonly"),this.browseOutput.setAttribute("disabled","disabled"),this.browseOutput.setAttribute("placeholder","Select image file..."),this.browseOutput.className="browse-output",this.browseWrapper.appendChild(this.browseOutput),this.browseButton=document.createElement("button"),this.browseButton.className="browse-button confirm-button",this.browseButton.textContent="Browse",this.browseWrapper.appendChild(this.browseButton),this.browseClear=document.createElement("div"),this.browseClear.className="clear",this.formElement.appendChild(this.browseClear),this.progressBar=document.createElement("div"),this.progressBar.className="progress",this.formElement.appendChild(this.progressBar),this.progressBarInner=document.createElement("div"),this.progressBarInner.className="inner",this.progressBar.appendChild(this.progressBarInner),this.panelElement.style.width="340px"},bind:function(){this._super(),this.browseButton.addEventListener("click",this.onBrowseClicked.bind(this),!1),this.confirmButton.addEventListener("click",this.onConfirmClicked.bind(this),!1),this.cancelButton.addEventListener("click",this.onCancelClicked.bind(this),!1),this.linkInput.addEventListener("keydown",this.onKeyDown.bind(this),!1),this.linkTab.addEventListener("click",this.onTabClicked.bind(this),!1),this.uploadTab.addEventListener("click",this.onTabClicked.bind(this),!1),this.fileInput.addEventListener("change",this.onFileInputChange.bind(this),!1)},trigger:function(t){if(this.imageElement){if("link"===this.currentTab){t=this.linkInput.value;var e=skriv.util.getYouTubeID(t),i=skriv.util.getVimeoID(t),n=['<iframe width="720" height="405" src="','" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'];e?this.imageElement.outerHTML=n.join("https://youtube.com/embed/"+e):i?this.imageElement.outerHTML=n.join("https://player.vimeo.com/video/"+i):(this.imageElement.setAttribute("src",this.linkInput.value),this.imageElement.style.display="",this.imageElement.removeAttribute("width"),this.imageElement.removeAttribute("height"))}else t&&(this.imageElement.setAttribute("src",t),this.imageElement.style.display="",this.imageElement.removeAttribute("width"),this.imageElement.removeAttribute("height"));this.imageElement=null}},changeTab:function(t){this.currentTab=t,"link"===t?(this.uploadTab.classList.remove("selected"),this.uploadSection.classList.remove("visible"),this.linkTab.classList.add("selected"),this.linkSection.classList.add("visible"),this.linkInput.focus()):(this.linkTab.classList.remove("selected"),this.linkSection.classList.remove("visible"),this.uploadTab.classList.add("selected"),this.uploadSection.classList.add("visible"))},open:function(){this._super(),this.linkInput.value="",this.fileInput.value="",this.browseOutput.value="",this.panelElement.classList.remove("busy"),skriv.util.execCommand("insertImage",!1,skriv.actions.image.PLACEHOLDER),this.imageElement=document.querySelector('img[src="'+skriv.actions.image.PLACEHOLDER+'"]'),!this.imageElement&&this.core.getEditor()&&(this.imageElement=document.createElement("img"),this.imageElement.setAttribute("src",skriv.actions.image.PLACEHOLDER),this.core.getEditor().appendChild(this.imageElement)),this.imageElement?this.imageElement.style.display="none":(this.core.notify("Please focus the editor first"),this.close())},close:function(){this._super(),this.imageElement&&this.imageElement.parentNode&&this.imageElement.getAttribute("src")===skriv.actions.image.PLACEHOLDER&&(this.imageElement.parentNode.removeChild(this.imageElement),this.imageElement=null)},uploadFile:function(){var t=this.fileInput.files[0];if(t&&t.type.match(/image.*/))if("number"==typeof t.size&&t.size/1024>this.config.maxsize)this.core.notify("No more than "+Math.round(this.config.maxsize/1024)+"mb please","negative");else{this.panelElement.classList.add("busy"),this.setProgress(0),this.browseOutput.value=t.name;var e=new FormData;e.append("file",t),e.append("type","Image");var i=document.querySelector('meta[name="csrf-token"]');i&&e.append("authenticity_token",i.getAttribute("content"));var n=new XMLHttpRequest;n.open("POST",this.config.endpoint),n.onload=function(){try{var t=JSON.parse(n.responseText)}catch(e){return this.onFileUploadError()}this.onFileUploadSuccess(t)}.bind(this),n.onerror=this.onFileUploadError.bind(this),n.upload.onprogress=function(t){this.setProgress(t.loaded/t.total*100)}.bind(this),n.send(e)}else this.core.notify("Only image files, please")},setProgress:function(t){this.progressBarInner.style.width=t+"%"},onFileUploadError:function(t){this.close(),this.core.notify(t||"Failed to upload image","negative")},onFileUploadSuccess:function(t){this.trigger(t.url),this.close()},onFileInputChange:function(){this.uploadFile()},onBrowseClicked:function(){this.fileInput.click()},onTabClicked:function(t){var e=t.target.getAttribute("data-value");e&&this.changeTab(e)},onConfirmClicked:function(){""===this.linkInput.value?this.close():(this.trigger(),this.close())},onCancelClicked:function(){this.close()},onClick:function(t){this._super(t)},onKeyDown:function(t){13===t.keyCode&&this.onConfirmClicked(t)},onMouseDown:function(){}}),skriv.actions.image.PLACEHOLDER="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",skriv.actions.foregroundColor=skriv.actions.abstract.extend({init:function(t,e){this._super(t,e),this.colorpickerOpen=!1},build:function(){this._super(),this.domElement.classList.add(this.id),$(this.buttonElement).spectrum({color:"#ECC",showInput:!0,className:"skriv-colorpicker",showAlpha:!!this.config.alpha,showInitial:!0,showPalette:!0,showSelectionPalette:!0,maxPaletteSize:10,preferredFormat:"hex",localStorageKey:"skriv-colors",cancelText:"Cancel",cancelClassName:"skriv-cancel-button",chooseText:"Confirm",chooseClassName:"skriv-confirm-button",offsetY:16,show:function(){this.colorpickerOpen=!0}.bind(this),hide:function(){this.colorpickerOpen=!1}.bind(this),move:function(t){this.currentColor=this.config.alpha?t.toRgbString():t.toHexString()}.bind(this),change:function(t){this.currentColor=this.config.alpha?t.toRgbString():t.toHexString(),this.trigger()}.bind(this),palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)","transparent"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]]})},bind:function(){this._super()},trigger:function(){skriv.util.execCommand("forecolor",!1,this.currentColor)},open:function(){this.colorpickerOpen=!0,$(this.buttonElement).spectrum("show")},close:function(){this.colorpickerOpen=!1,$(this.buttonElement).spectrum("hide")},isOpen:function(){return this.colorpickerOpen},onClick:function(t){this._super(t)}}),skriv.actions.backgroundColor=skriv.actions.foregroundColor.extend({init:function(t,e){e.alpha=!0,this._super(t,e)},trigger:function(){skriv.util.execCommand("backcolor",!1,this.currentColor)},open:function(){this._super()}}),skriv.actions.fontFamily=skriv.actions.dropdown.extend({init:function(t,e){e.openOnHover=!0,this.options=[{name:"Arial",value:"arial"},{name:"Courier New",value:"courier new"},{name:"Georgia",value:"georgia"},{name:"Helvetica",value:"helvetica"},{name:"Impact",value:"impact"},{name:"Lato",value:"Lato"},{name:"League Gothic",value:"League Gothic"},{name:"Times",value:"times new roman"},{name:"Monospace",value:"monospace"},{name:"Trebuchet",value:"trebuchet ms"},{name:"Verdana",value:"verdana"}],this._super(t,e),[].slice.call(this.dropdownElement.querySelectorAll("li")).forEach(function(t){t.style.fontFamily=t.getAttribute("data-value")})},trigger:function(){skriv.util.execCommand("fontName",!1,this.getValue())},updateSelection:function(t){t&&"function"==typeof window.getComputedStyle&&this.setValue(window.getComputedStyle(t).getPropertyValue("font-family").replace(/(,.*)|\'|\"/g,""),!0)},setValue:function(t,e){this._super(t,e),this.selectedElement&&(this.buttonElement.style.fontFamily=this.getValue())}}),skriv.actions.fontFormat=skriv.actions.dropdown.extend({init:function(t,e){e.openOnHover=!0,this.options=[{name:"Paragraph",value:"p"},{name:"Pre",value:"pre"},{name:"Code",value:"code"},{name:"Quote",value:"blockquote"},{name:"Heading 1",value:"h1"},{name:"Heading 2",value:"h2"},{name:"Heading 3",value:"h3"}],this._super(t,e)},trigger:function(){if("code"===this.getValue()){var t=skriv.util.getParentOfType(skriv.util.getSelectedElement(),"pre"),e=skriv.util.getParentOfType(skriv.util.getSelectedElement(),"code");if(e&&t)skriv.util.unwrap(e),skriv.util.unwrap(t);else{var i=document.getSelection();if(document.execCommand("insertHTML",!1,"<pre><code>"+i+" </code></pre>"),i.anchorNode&&"function"==typeof i.anchorNode.querySelector){var n=i.anchorNode.querySelector("pre code");n&&n.focus()}}}else skriv.util.execCommand("formatBlock",!1,this.getValue())},updateSelection:function(t){if(t)for(var e=t;e;)this.hasValue(e.nodeName.toLowerCase())?(this.setValue(e.nodeName.toLowerCase(),!0),e=null):e=e.parentNode}}),skriv.actions.fontSize=skriv.actions.dropdown.extend({init:function(t,e){e.openOnHover=!0,e.leaveHeader=!0,this.options=[{name:"18px",value:"1"},{name:"24px",value:"2"},{name:"32px",value:"3"},{name:"42px",value:"4"},{name:"54px",value:"5"},{name:"72px",value:"6"},{name:"112px",value:"7"}],this._super(t,e)},build:function(){this._super(),this.domElement.style.width="60px",this.panelElement.style.width="80px",this.buttonElement.textContent="Size"},trigger:function(){this.getValue();skriv.util.execCommand("fontSize",!1,this.getValue()),setTimeout(function(){var t=this.core.getEditor();t&&this.options.forEach(function(e){for(var i=t.querySelectorAll('font[size="'+e.value+'"]'),n=0,o=i.length;n<o;n++)i[n].removeAttribute("size"),i[n].style.fontSize=e.name})}.bind(this),1)}}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).less=t()}}(function(){return function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return o(i||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e){var i=t("./utils").addDataAttr,n=t("./browser");e.exports=function(t,e){i(e,n.currentScript(t)),void 0===e.isFileProtocol&&(e.isFileProtocol=/^(file|(chrome|safari)(-extension)?|resource|qrc|app):/.test(t.location.protocol)),e.async=e.async||!1,e.fileAsync=e.fileAsync||!1,e.poll=e.poll||(e.isFileProtocol?1e3:1500),e.env=e.env||("127.0.0.1"==t.location.hostname||"0.0.0.0"==t.location.hostname||"localhost"==t.location.hostname||t.location.port&&t.location.port.length>0||e.isFileProtocol?"development":"production");var o=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(t.location.hash);o&&(e.dumpLineNumbers=o[1]),void 0===e.useFileCache&&(e.useFileCache=!0),void 0===e.onReady&&(e.onReady=!0),e.relativeUrls&&(e.rewriteUrls="all")}},{"./browser":3,"./utils":11}],2:[function(t,e){function i(t){t.filename&&console.warn(t),n.async||r.removeChild(s)}t("promise/polyfill");var n=t("../less/default-options")();if(window.less)for(key in window.less)window.less.hasOwnProperty(key)&&(n[key]=window.less[key]);t("./add-default-options")(window,n),n.plugins=n.plugins||[],window.LESS_PLUGINS&&(n.plugins=n.plugins.concat(window.LESS_PLUGINS));var o,r,s,a=e.exports=t("./index")(window,n);window.less=a,n.onReady&&(/!watch/.test(window.location.hash)&&a.watch(),n.async||(o="body { display: none !important }",r=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("style")).type="text/css",s.styleSheet?s.styleSheet.cssText=o:s.appendChild(document.createTextNode(o)),r.appendChild(s)),a.registerStylesheetsImmediately(),a.pageLoadFinished=a.refresh("development"===a.env).then(i,i))},{"../less/default-options":17,"./add-default-options":1,"./index":8,"promise/polyfill":107}],3:[function(t,e){var i=t("./utils");e.exports={createCSS:function(t,e,n){var o=n.href||"",r="less:"+(n.title||i.extractId(o)),s=t.getElementById(r),a=!1,l=t.createElement("style");l.setAttribute("type","text/css"),n.media&&l.setAttribute("media",n.media),l.id=r,l.styleSheet||(l.appendChild(t.createTextNode(e)),a=null!==s&&s.childNodes.length>0&&l.childNodes.length>0&&s.firstChild.nodeValue===l.firstChild.nodeValue);var c=t.getElementsByTagName("head")[0];if(null===s||!1===a){var h=n&&n.nextSibling||null;h?h.parentNode.insertBefore(l,h):c.appendChild(l)}if(s&&!1===a&&s.parentNode.removeChild(s),l.styleSheet)try{l.styleSheet.cssText=e}catch(u){throw new Error("Couldn't reassign styleSheet.cssText.")}},currentScript:function(t){var e=t.document;return e.currentScript||function(){var t=e.getElementsByTagName("script");return t[t.length-1]}()}}},{"./utils":11}],4:[function(t,e){e.exports=function(t,e,i){var n=null;if("development"!==e.env)try{n="undefined"==typeof t.localStorage?null:t.localStorage}catch(o){}return{setCSS:function(t,e,o,r){if(n){i.info("saving "+t+" to cache.");try{n.setItem(t,r),n.setItem(t+":timestamp",e),o&&n.setItem(t+":vars",JSON.stringify(o))}catch(s){i.error('failed to save "'+t+'" to local storage for caching.')}}},getCSS:function(t,e,i){var o=n&&n.getItem(t),r=n&&n.getItem(t+":timestamp"),s=n&&n.getItem(t+":vars");if(i=i||{},s=s||"{}",r&&e.lastModified&&new Date(e.lastModified).valueOf()===new Date(r).valueOf()&&JSON.stringify(i)===s)return o}}}},{}],5:[function(t,e){var i=t("./utils"),n=t("./browser");e.exports=function(t,e,o){function r(e,r){var s,a,l="less-error-message:"+i.extractId(r||""),c='<li><label>{line}</label><pre class="{class}">{content}</pre></li>',h=t.document.createElement("div"),u=[],d=e.filename||r,p=d.match(/([^\/]+(\?.*)?)$/)[1];h.id=l,h.className="less-error-message",a="<h3>"+(e.type||"Syntax")+"Error: "+(e.message||"There is an error in your .less file")+'</h3><p>in <a href="'+d+'">'+p+"</a> ";var f=function(t,e,i){void 0!==t.extract[e]&&u.push(c.replace(/\{line\}/,(parseInt(t.line,10)||0)+(e-1)).replace(/\{class\}/,i).replace(/\{content\}/,t.extract[e]))};e.line&&(f(e,0,""),f(e,1,"line"),f(e,2,""),a+="on line "+e.line+", column "+(e.column+1)+":</p><ul>"+u.join("")+"</ul>"),e.stack&&(e.extract||o.logLevel>=4)&&(a+="<br/>Stack Trace</br />"+e.stack.split("\n").slice(1).join("<br/>")),h.innerHTML=a,n.createCSS(t.document,[".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),
h.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"===o.env&&(s=setInterval(function(){var e=t.document,i=e.body;i&&(e.getElementById(l)?i.replaceChild(h,e.getElementById(l)):i.insertBefore(h,i.firstChild),clearInterval(s))},10))}function s(e){var n=t.document.getElementById("less-error-message:"+i.extractId(e));n&&n.parentNode.removeChild(n)}function a(){}function l(t){o.errorReporting&&"html"!==o.errorReporting?"console"===o.errorReporting?a(t):"function"==typeof o.errorReporting&&o.errorReporting("remove",t):s(t)}function c(t,i){var n="{line} {content}",r=t.filename||i,s=[],a=(t.type||"Syntax")+"Error: "+(t.message||"There is an error in your .less file")+" in "+r,l=function(t,e,i){void 0!==t.extract[e]&&s.push(n.replace(/\{line\}/,(parseInt(t.line,10)||0)+(e-1)).replace(/\{class\}/,i).replace(/\{content\}/,t.extract[e]))};t.line&&(l(t,0,""),l(t,1,"line"),l(t,2,""),a+=" on line "+t.line+", column "+(t.column+1)+":\n"+s.join("\n")),t.stack&&(t.extract||o.logLevel>=4)&&(a+="\nStack Trace\n"+t.stack),e.logger.error(a)}function h(t,e){o.errorReporting&&"html"!==o.errorReporting?"console"===o.errorReporting?c(t,e):"function"==typeof o.errorReporting&&o.errorReporting("add",t,e):r(t,e)}return{add:h,remove:l}}},{"./browser":3,"./utils":11}],6:[function(t,e){e.exports=function(e,i){var n=t("../less/environment/abstract-file-manager.js"),o={},r=function(){};return r.prototype=new n,r.prototype.alwaysMakePathsAbsolute=function(){return!0},r.prototype.join=function(t,e){return t?this.extractUrlParts(e,t).path:e},r.prototype.doXHR=function(t,n,o,r){function s(e,i,n){e.status>=200&&e.status<300?i(e.responseText,e.getResponseHeader("Last-Modified")):"function"==typeof n&&n(e.status,t)}var a=new XMLHttpRequest,l=!e.isFileProtocol||e.fileAsync;"function"==typeof a.overrideMimeType&&a.overrideMimeType("text/css"),i.debug("XHR: Getting '"+t+"'"),a.open("GET",t,l),a.setRequestHeader("Accept",n||"text/x-less, text/css; q=0.9, */*; q=0.5"),a.send(null),e.isFileProtocol&&!e.fileAsync?0===a.status||a.status>=200&&a.status<300?o(a.responseText):r(a.status,t):l?a.onreadystatechange=function(){4==a.readyState&&s(a,o,r)}:s(a,o,r)},r.prototype.supports=function(){return!0},r.prototype.clearFileCache=function(){o={}},r.prototype.loadFile=function(t,e,i){e&&!this.isPathAbsolute(t)&&(t=e+t),t=i.ext?this.tryAppendExtension(t,i.ext):t,i=i||{};var n=this.extractUrlParts(t,window.location.href),r=n.url,s=this;return new Promise(function(t,e){if(i.useFileCache&&o[r])try{var a=o[r];return t({contents:a,filename:r,webInfo:{lastModified:new Date}})}catch(n){return e({filename:r,message:"Error loading file "+r+" error was "+n.message})}s.doXHR(r,i.mime,function(e,i){o[r]=e,t({contents:e,filename:r,webInfo:{lastModified:i}})},function(t,i){e({type:"File",message:"'"+i+"' wasn't found ("+t+")",href:r})})})},r}},{"../less/environment/abstract-file-manager.js":18}],7:[function(t,e){e.exports=function(){function e(){throw{type:"Runtime",message:"Image size functions are not supported in browser version of less"}}var i={"image-size":function(t){return e(this,t),-1},"image-width":function(t){return e(this,t),-1},"image-height":function(t){return e(this,t),-1}};t("./../less/functions/function-registry").addMultiple(i)}},{"./../less/functions/function-registry":27}],8:[function(t,e){var i=t("./utils").addDataAttr,n=t("./browser");e.exports=function(e,o){function r(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function s(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){var n=i.concat(Array.prototype.slice.call(arguments,0));return t.apply(e,n)}}function a(t){for(var e,i=u.getElementsByTagName("style"),n=0;n<i.length;n++)if((e=i[n]).type.match(b)){var a=r(o);a.modifyVars=t;var l=e.innerHTML||"";a.filename=u.location.href.replace(/#.*$/,""),d.render(l,a,s(function(t,e,i){e?m.add(e,"inline"):(t.type="text/css",t.styleSheet?t.styleSheet.cssText=i.css:t.innerHTML=i.css)},null,e))}}function l(t,e,n,s,a){function l(i){var o=i.contents,r=i.filename,a=i.webInfo,l={currentDirectory:g.getPath(r),filename:r,rootFilename:r,rewriteUrls:c.rewriteUrls};if(l.entryPath=l.currentDirectory,l.rootpath=c.rootpath||l.currentDirectory,a){a.remaining=s;var h=v.getCSS(r,a,c.modifyVars);if(!n&&h)return a.local=!0,void e(null,h,o,t,a,r)}m.remove(r),c.rootFileInfo=l,d.render(o,c,function(i,n){i?(i.href=r,e(i)):(v.setCSS(t.href,a.lastModified,c.modifyVars,n.css),e(null,n.css,o,t,a,r))})}var c=r(o);i(c,t),c.mime=t.type,a&&(c.modifyVars=a),g.loadFile(t.href,null,c,p).then(function(t){l(t)})["catch"](function(t){console.log(t),e(t)})}function c(t,e,i){for(var n=0;n<d.sheets.length;n++)l(d.sheets[n],t,e,d.sheets.length-(n+1),i)}function h(){"development"===d.env&&(d.watchTimer=setInterval(function(){d.watchMode&&(g.clearFileCache(),c(function(t,i,o,r){t?m.add(t,t.href||r.href):i&&n.createCSS(e.document,i,r)}))},o.poll))}var u=e.document,d=t("../less")();d.options=o;var p=d.environment,f=t("./file-manager")(o,d.logger),g=new f;p.addFileManager(g),d.FileManager=f,d.PluginLoader=t("./plugin-loader"),t("./log-listener")(d,o);var m=t("./error-reporting")(e,d,o),v=d.cache=o.cache||t("./cache")(e,o,d.logger);t("./image-size")(d.environment),o.functions&&d.functions.functionRegistry.addMultiple(o.functions);var b=/^text\/(x-)?less$/;return d.watch=function(){return d.watchMode||(d.env="development",h()),this.watchMode=!0,!0},d.unwatch=function(){return clearInterval(d.watchTimer),this.watchMode=!1,!1},d.registerStylesheetsImmediately=function(){var t=u.getElementsByTagName("link");d.sheets=[];for(var e=0;e<t.length;e++)("stylesheet/less"===t[e].rel||t[e].rel.match(/stylesheet/)&&t[e].type.match(b))&&d.sheets.push(t[e])},d.registerStylesheets=function(){return new Promise(function(t){d.registerStylesheetsImmediately(),t()})},d.modifyVars=function(t){return d.refresh(!0,t,!1)},d.refresh=function(t,i,o){return(t||o)&&!1!==o&&g.clearFileCache(),new Promise(function(o,r){var s,l,h,u;s=l=new Date,0===(u=d.sheets.length)?(l=new Date,h=l-s,d.logger.info("Less has finished and no sheets were loaded."),o({startTime:s,endTime:l,totalMilliseconds:h,sheets:d.sheets.length})):c(function(t,i,a,c,p){return t?(m.add(t,t.href||c.href),void r(t)):(d.logger.info(p.local?"Loading "+c.href+" from cache.":"Rendered "+c.href+" successfully."),n.createCSS(e.document,i,c),d.logger.info("CSS for "+c.href+" generated in "+(new Date-l)+"ms"),0===--u&&(h=new Date-s,d.logger.info("Less has finished. CSS generated in "+h+"ms"),o({startTime:s,endTime:l,totalMilliseconds:h,sheets:d.sheets.length})),void(l=new Date))},t,i),a(i)})},d.refreshStyles=a,d}},{"../less":37,"./browser":3,"./cache":4,"./error-reporting":5,"./file-manager":6,"./image-size":7,"./log-listener":9,"./plugin-loader":10,"./utils":11}],9:[function(t,e){e.exports=function(t,e){var i=4,n=3,o=2,r=1;e.logLevel="undefined"!=typeof e.logLevel?e.logLevel:"development"===e.env?n:r,e.loggers||(e.loggers=[{debug:function(t){e.logLevel>=i&&console.log(t)},info:function(t){e.logLevel>=n&&console.log(t)},warn:function(t){e.logLevel>=o&&console.warn(t)},error:function(t){e.logLevel>=r&&console.error(t)}}]);for(var s=0;s<e.loggers.length;s++)t.logger.addListener(e.loggers[s])}},{}],10:[function(t,e){var i=t("../less/environment/abstract-plugin-loader.js"),n=function(t){this.less=t};n.prototype=new i,n.prototype.loadPlugin=function(t,e,i,n,o){return new Promise(function(r,s){o.loadFile(t,e,i,n).then(r)["catch"](s)})},e.exports=n},{"../less/environment/abstract-plugin-loader.js":19}],11:[function(t,e){e.exports={extractId:function(t){return t.replace(/^[a-z-]+:\/+?[^\/]+/,"").replace(/[\?\&]livereload=\w+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")},addDataAttr:function(t,e){for(var i in e.dataset)if(e.dataset.hasOwnProperty(i))if("env"===i||"dumpLineNumbers"===i||"rootpath"===i||"errorReporting"===i)t[i]=e.dataset[i];else try{t[i]=JSON.parse(e.dataset[i])}catch(n){}}}},{}],12:[function(t,e){e.exports={Math:{ALWAYS:0,PARENS_DIVISION:1,PARENS:2,STRICT_LEGACY:3},RewriteUrls:{OFF:0,LOCAL:1,ALL:2}}},{}],13:[function(t,e){function i(t){return!/^(?:[a-z-]+:|\/|#)/i.test(t)}function n(t){return"."===t.charAt(0)}var o={};e.exports=o;var r=t("./constants"),s=function(t,e,i){if(t)for(var n=0;n<i.length;n++)t.hasOwnProperty(i[n])&&(e[i[n]]=t[i[n]])},a=["paths","rewriteUrls","rootpath","strictImports","insecure","dumpLineNumbers","compress","syncImport","chunkInput","mime","useFileCache","processImports","pluginManager"];o.Parse=function(t){s(t,this,a),"string"==typeof this.paths&&(this.paths=[this.paths])};var l=["paths","compress","ieCompat","math","strictUnits","sourceMap","importMultiple","urlArgs","javascriptEnabled","pluginManager","importantScope","rewriteUrls"];o.Eval=function(t,e){s(t,this,l),"string"==typeof this.paths&&(this.paths=[this.paths]),this.frames=e||[],this.importantScope=this.importantScope||[]},o.Eval.prototype.enterCalc=function(){this.calcStack||(this.calcStack=[]),this.calcStack.push(!0),this.inCalc=!0},o.Eval.prototype.exitCalc=function(){this.calcStack.pop(),this.calcStack||(this.inCalc=!1)},o.Eval.prototype.inParenthesis=function(){this.parensStack||(this.parensStack=[]),this.parensStack.push(!0)},o.Eval.prototype.outOfParenthesis=function(){this.parensStack.pop()},o.Eval.prototype.inCalc=!1,o.Eval.prototype.mathOn=!0,o.Eval.prototype.isMathOn=function(t){return!!this.mathOn&&!!("/"!==t||this.math===r.Math.ALWAYS||this.parensStack&&this.parensStack.length)&&(!(this.math>r.Math.PARENS_DIVISION)||this.parensStack&&this.parensStack.length)},o.Eval.prototype.pathRequiresRewrite=function(t){return(this.rewriteUrls===r.RewriteUrls.LOCAL?n:i)(t)},o.Eval.prototype.rewritePath=function(t,e){var o;return e=e||"",o=this.normalizePath(e+t),n(t)&&i(e)&&!1===n(o)&&(o="./"+o),o},o.Eval.prototype.normalizePath=function(t){var e,i=t.split("/").reverse();for(t=[];0!==i.length;)switch(e=i.pop()){case".":break;case"..":0===t.length||".."===t[t.length-1]?t.push(e):t.pop();break;default:t.push(e)}return t.join("/")}},{"./constants":12}],14:[function(t,e){e.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],15:[function(t,e){e.exports={colors:t("./colors"),unitConversions:t("./unit-conversions")}},{"./colors":14,"./unit-conversions":16}],16:[function(t,e){e.exports={length:{m:1,cm:.01,mm:.001,"in":.0254,px:.0254/96,pt:.0254/72,pc:.0254/72*12},duration:{s:1,ms:.001},angle:{rad:1/(2*Math.PI),deg:1/360,grad:.0025,turn:1}}},{}],17:[function(t,e){e.exports=function(){return{javascriptEnabled:!1,depends:!1,compress:!1,lint:!1,paths:[],color:!0,strictImports:!1,insecure:!1,rootpath:"",rewriteUrls:!1,ieCompat:!1,math:0,strictUnits:!1,globalVars:null,modifyVars:null,urlArgs:""}}},{}],18:[function(t,e){var i=function(){};i.prototype.getPath=function(t){var e=t.lastIndexOf("?");return e>0&&(t=t.slice(0,e)),(e=t.lastIndexOf("/"))<0&&(e=t.lastIndexOf("\\")),e<0?"":t.slice(0,e+1)},i.prototype.tryAppendExtension=function(t,e){return/(\.[a-z]*$)|([\?;].*)$/.test(t)?t:t+e},i.prototype.tryAppendLessExtension=function(t){return this.tryAppendExtension(t,".less")},i.prototype.supportsSync=function(){return!1},i.prototype.alwaysMakePathsAbsolute=function(){return!1},i.prototype.isPathAbsolute=function(t){return/^(?:[a-z-]+:|\/|\\|#)/i.test(t)},i.prototype.join=function(t,e){return t?t+e:e},i.prototype.pathDiff=function(t,e){var i,n,o,r,s=this.extractUrlParts(t),a=this.extractUrlParts(e),l="";if(s.hostPart!==a.hostPart)return"";for(n=Math.max(a.directories.length,s.directories.length),i=0;i<n&&a.directories[i]===s.directories[i];i++);for(r=a.directories.slice(i),o=s.directories.slice(i),i=0;i<r.length-1;i++)l+="../";for(i=0;i<o.length-1;i++)l+=o[i]+"/";return l},i.prototype.extractUrlParts=function(t,e){var i,n,o=/^((?:[a-z-]+:)?\/{2}(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/i,r=t.match(o),s={},a=[],l=[];if(!r)throw new Error("Could not parse sheet href - '"+t+"'");if(e&&(!r[1]||r[2])){if(!(n=e.match(o)))throw new Error("Could not parse page url - '"+e+"'");r[1]=r[1]||n[1]||"",r[2]||(r[3]=n[3]+r[3])}if(r[3])for(a=r[3].replace(/\\/g,"/").split("/"),i=0;i<a.length;i++)".."===a[i]?l.pop():"."!==a[i]&&l.push(a[i]);return s.hostPart=r[1],s.directories=l,s.rawPath=(r[1]||"")+a.join("/"),s.path=(r[1]||"")+l.join("/"),s.filename=r[4],s.fileUrl=s.path+(r[4]||""),s.url=s.fileUrl+(r[5]||""),s},e.exports=i},{}],19:[function(t,e){var i=t("../functions/function-registry"),n=t("../less-error"),o=function(){this.require=function(){return null}};o.prototype.evalPlugin=function(t,e,o,r,s){var a,l,c,h,u,d;h=e.pluginManager,s&&(u="string"==typeof s?s:s.filename);var p=(new this.less.FileManager).extractUrlParts(u).filename;if(u&&(l=h.get(u))){if(d=this.trySetOptions(l,u,p,r))return d;try{l.use&&l.use.call(this.context,l)}catch(g){return g.message=g.message||"Error during @plugin call",new n(g,o,u)}return l}c={exports:{},pluginManager:h,fileInfo:s},a=i.create();var f=function(t){l=t};try{new Function("module","require","registerPlugin","functions","tree","less","fileInfo",t)(c,this.require(u),f,a,this.less.tree,this.less,s)}catch(g){return new n(g,o,u)}if(l||(l=c.exports),(l=this.validatePlugin(l,u,p))instanceof n)return l;if(!l)return new n({message:"Not a valid plugin"},o,u);if(l.imports=o,l.filename=u,(!l.minVersion||this.compareVersion("3.0.0",l.minVersion)<0)&&(d=this.trySetOptions(l,u,p,r)))return d;if(h.addPlugin(l,s.filename,a),l.functions=a.getLocalFunctions(),d=this.trySetOptions(l,u,p,r))return d;try{l.use&&l.use.call(this.context,l)}catch(g){return g.message=g.message||"Error during @plugin call",new n(g,o,u)}return l},o.prototype.trySetOptions=function(t,e,i,r){if(r&&!t.setOptions)return new n({message:"Options have been provided but the plugin "+i+" does not support any options."});try{t.setOptions&&t.setOptions(r)}catch(o){return new n(o)}},o.prototype.validatePlugin=function(t,e,i){return t?("function"==typeof t&&(t=new t),t.minVersion&&this.compareVersion(t.minVersion,this.less.version)<0?new n({message:"Plugin "+i+" requires version "+this.versionToString(t.minVersion)}):t):null},o.prototype.compareVersion=function(t,e){"string"==typeof t&&(t=t.match(/^(\d+)\.?(\d+)?\.?(\d+)?/)).shift();for(var i=0;i<t.length;i++)if(t[i]!==e[i])return parseInt(t[i])>parseInt(e[i])?-1:1;return 0},o.prototype.versionToString=function(t){for(var e="",i=0;i<t.length;i++)e+=(e?".":"")+t[i];return e},o.prototype.printUsage=function(t){for(var e=0;e<t.length;e++){var i=t[e];i.printUsage&&i.printUsage()}},e.exports=o},{"../functions/function-registry":27,"../less-error":38}],20:[function(t,e){var i=t("../logger"),n=function(t,e){this.fileManagers=e||[],t=t||{};for(var i=["encodeBase64","mimeLookup","charsetLookup","getSourceMapGenerator"],n=[],o=n.concat(i),r=0;r<o.length;r++){var s=o[r],a=t[s];a?this[s]=a.bind(t):r<n.length&&this.warn("missing required function in environment - "+s)}};n.prototype.getFileManager=function(t,e,n,o,r){t||i.warn("getFileManager called with no filename.. Please report this issue. continuing."),null==e&&i.warn("getFileManager called with null directory.. Please report this issue. continuing.");var s=this.fileManagers;n.pluginManager&&(s=[].concat(s).concat(n.pluginManager.getFileManagers()));for(var a=s.length-1;a>=0;a--){var l=s[a];if(l[r?"supportsSync":"supports"](t,e,n,o))return l}return null},n.prototype.addFileManager=function(t){this.fileManagers.push(t)},n.prototype.clearFileManagers=function(){this.fileManagers=[]},e.exports=n},{"../logger":39}],21:[function(t){var e=t("./function-registry"),i=t("../tree/anonymous"),n=t("../tree/keyword");e.addMultiple({boolean:function(t){return t?n.True:n.False},"if":function(t,e,n){return t?e:n||new i}})},{"../tree/anonymous":50,"../tree/keyword":70,"./function-registry":27}],22:[function(t){function e(t,e,n){var o,r,s,a,l=e.alpha,c=n.alpha,h=[];s=c+l*(1-c);for(var u=0;u<3;u++)a=t(o=e.rgb[u]/255,r=n.rgb[u]/255),s&&(a=(c*r+l*(o-c*(o+r-a)))/s),h[u]=255*a;return new i(h,s)}var i=t("../tree/color"),n=t("./function-registry"),o={multiply:function(t,e){return t*e},screen:function(t,e){return t+e-t*e},overlay:function(t,e){return(t*=2)<=1?o.multiply(t,e):o.screen(t-1,e)},softlight:function(t,e){var i=1,n=t;return e>.5&&(n=1,i=t>.25?Math.sqrt(t):((16*t-12)*t+4)*t),t-(1-2*e)*n*(i-t)},hardlight:function(t,e){return o.overlay(e,t)},difference:function(t,e){return Math.abs(t-e)},exclusion:function(t,e){return t+e-2*t*e},average:function(t,e){return(t+e)/2},negation:function(t,e){return 1-Math.abs(t+e-1)}};for(var r in o)o.hasOwnProperty(r)&&(e[r]=e.bind(null,o[r]));n.addMultiple(e)},{"../tree/color":55,"./function-registry":27}],23:[function(t){function e(t){return Math.min(1,Math.max(0,t))}function i(t,e){var i=r.hsla(e.h,e.s,e.l,e.a);if(i)return i.value=t.value&&/^(rgb|hsl)/.test(t.value)?t.value:"rgb",i}function n(t){if(t instanceof s)return parseFloat(t.unit.is("%")?t.value/100:t.value);if("number"==typeof t)return t;throw{type:"Argument",message:"color functions take numbers as parameters"}}function o(t,e){return t instanceof s&&t.unit.is("%")?parseFloat(t.value*e/100):n(t)}var r,s=t("../tree/dimension"),a=t("../tree/color"),l=t("../tree/quoted"),c=t("../tree/anonymous"),h=t("./function-registry");r={rgb:function(t,e,i){var n=r.rgba(t,e,i,1);if(n)return n.value="rgb",n},rgba:function(t,e,i,s){try{if(t instanceof a)return s=e?n(e):t.alpha,new a(t.rgb,s,"rgba");var l=[t,e,i].map(function(t){return o(t,255)});return s=n(s),new a(l,s,"rgba")}catch(r){}},hsl:function(t,e,i){var n=r.hsla(t,e,i,1);if(n)return n.value="hsl",n},hsla:function(t,i,o,r){function s(t){return 6*(t=t<0?t+1:t>1?t-1:t)<1?l+(h-l)*t*6:2*t<1?h:3*t<2?l+(h-l)*(2/3-t)*6:l}try{if(t instanceof a)return r=i?n(i):t.alpha,new a(t.rgb,r,"hsla");var l,h;t=n(t)%360/360,i=e(n(i)),o=e(n(o)),r=e(n(r)),l=2*o-(h=o<=.5?o*(i+1):o+i-o*i);var u=[255*s(t+1/3),255*s(t),255*s(t-1/3)];return r=n(r),new a(u,r,"hsla")}catch(c){}},hsv:function(t,e,i){return r.hsva(t,e,i,1)},hsva:function(t,e,i,o){var s,a;t=n(t)%360/360*360,e=n(e),i=n(i),o=n(o);var l=[i,i*(1-e),i*(1-(a=t/60-(s=Math.floor(t/60%6)))*e),i*(1-(1-a)*e)],c=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return r.rgba(255*l[c[s][0]],255*l[c[s][1]],255*l[c[s][2]],o)},hue:function(t){return new s(t.toHSL().h)},saturation:function(t){return new s(100*t.toHSL().s,"%")},lightness:function(t){return new s(100*t.toHSL().l,"%")},hsvhue:function(t){return new s(t.toHSV().h)},hsvsaturation:function(t){return new s(100*t.toHSV().s,"%")},hsvvalue:function(t){return new s(100*t.toHSV().v,"%")},red:function(t){return new s(t.rgb[0])},green:function(t){return new s(t.rgb[1])},blue:function(t){return new s(t.rgb[2])},alpha:function(t){return new s(t.toHSL().a)},luma:function(t){return new s(t.luma()*t.alpha*100,"%")},luminance:function(t){var e=.2126*t.rgb[0]/255+.7152*t.rgb[1]/255+.0722*t.rgb[2]/255;return new s(e*t.alpha*100,"%")},saturate:function(t,n,o){if(!t.rgb)return null;var r=t.toHSL();return r.s+=void 0!==o&&"relative"===o.value?r.s*n.value/100:n.value/100,r.s=e(r.s),i(t,r)},desaturate:function(t,n,o){var r=t.toHSL();return r.s-=void 0!==o&&"relative"===o.value?r.s*n.value/100:n.value/100,r.s=e(r.s),i(t,r)},lighten:function(t,n,o){var r=t.toHSL();return r.l+=void 0!==o&&"relative"===o.value?r.l*n.value/100:n.value/100,r.l=e(r.l),i(t,r)},darken:function(t,n,o){var r=t.toHSL();return r.l-=void 0!==o&&"relative"===o.value?r.l*n.value/100:n.value/100,r.l=e(r.l),i(t,r)},fadein:function(t,n,o){var r=t.toHSL();return r.a+=void 0!==o&&"relative"===o.value?r.a*n.value/100:n.value/100,r.a=e(r.a),i(t,r)},fadeout:function(t,n,o){var r=t.toHSL();return r.a-=void 0!==o&&"relative"===o.value?r.a*n.value/100:n.value/100,r.a=e(r.a),i(t,r)},fade:function(t,n){var o=t.toHSL();return o.a=n.value/100,o.a=e(o.a),i(t,o)},spin:function(t,e){var n=t.toHSL(),o=(n.h+e.value)%360;return n.h=o<0?360+o:o,i(t,n)},mix:function(t,e,i){t.toHSL&&e.toHSL||(console.log(e.type),console.dir(e)),i||(i=new s(50));var n=i.value/100,o=2*n-1,r=t.toHSL().a-e.toHSL().a,l=((o*r==-1?o:(o+r)/(1+o*r))+1)/2,c=1-l,h=[t.rgb[0]*l+e.rgb[0]*c,t.rgb[1]*l+e.rgb[1]*c,t.rgb[2]*l+e.rgb[2]*c],u=t.alpha*n+e.alpha*(1-n);return new a(h,u)},greyscale:function(t){return r.desaturate(t,new s(100))},contrast:function(t,e,i,o){if(!t.rgb)return null;if(void 0===i&&(i=r.rgba(255,255,255,1)),void 0===e&&(e=r.rgba(0,0,0,1)),e.luma()>i.luma()){var s=i;i=e,e=s}return o=void 0===o?.43:n(o),t.luma()<o?i:e},argb:function(t){return new c(t.toARGB())},color:function(t){if(t instanceof l&&/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})$/i.test(t.value)){var e=t.value.slice(1);return new a(e,void 0,"#"+e)}if(t instanceof a||(t=a.fromKeyword(t.value)))return t.value=void 0,t;throw{type:"Argument",message:"argument must be a color keyword or 3|4|6|8 digit hex e.g. #FFF"}},tint:function(t,e){return r.mix(r.rgb(255,255,255),t,e)},shade:function(t,e){return r.mix(r.rgb(0,0,0),t,e)}},h.addMultiple(r)},{"../tree/anonymous":50,"../tree/color":55,"../tree/dimension":62,"../tree/quoted":80,"./function-registry":27}],24:[function(t,e){e.exports=function(e){var i=t("../tree/quoted"),n=t("../tree/url"),o=t("../utils"),r=t("./function-registry"),s=function(t,e){return new n(e,t.index,t.currentFileInfo).eval(t.context)},a=t("../logger");r.add("data-uri",function(t,r){r||(r=t,t=null);var l=t&&t.value,c=r.value,h=this.currentFileInfo,u=h.rewriteUrls?h.currentDirectory:h.entryPath,d=c.indexOf("#"),p="";-1!==d&&(p=c.slice(d),c=c.slice(0,d));var f=o.clone(this.context);f.rawBuffer=!0;var g=e.getFileManager(c,u,f,e,!0);if(!g)return s(this,r);var m=!1;if(t)m=/;base64$/.test(l);else{if("image/svg+xml"===(l=e.mimeLookup(c)))m=!1;else{var v=e.charsetLookup(l);m=["US-ASCII","UTF-8"].indexOf(v)<0}m&&(l+=";base64")}var b=g.loadFileSync(c,u,f,e);if(!b.contents)return a.warn("Skipped data-uri embedding of "+c+" because file not found"),s(this,r||t);var y=b.contents;if(m&&!e.encodeBase64)return s(this,r);var S="data:"+l+","+(y=m?e.encodeBase64(y):encodeURIComponent(y))+p,k=32768;return S.length>=k&&!1!==this.context.ieCompat?(a.warn("Skipped data-uri embedding of "+c+" because its size ("+S.length+" characters) exceeds IE8-safe "+k+" characters!"),s(this,r||t)):new n(new i('"'+S+'"',S,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../logger":39,"../tree/quoted":80,"../tree/url":85,"../utils":89,"./function-registry":27}],25:[function(t,e){var i=t("../tree/keyword"),n={eval:function(){var t=this.value_,e=this.error_;if(e)throw e;if(null!=t)return t?i.True:i.False},value:function(t){this.value_=t},error:function(t){this.error_=t},reset:function(){this.value_=this.error_=null}};t("./function-registry").add("default",n.eval.bind(n)),e.exports=n},{"../tree/keyword":70,"./function-registry":27}],26:[function(t,e){var i=t("../tree/expression"),n=function(t,e,i,n){this.name=t.toLowerCase(),this.index=i,this.context=e,this.currentFileInfo=n,this.func=e.frames[0].functionRegistry.get(this.name)};n.prototype.isValid=function(){return Boolean(this.func)},n.prototype.call=function(t){return Array.isArray(t)&&(t=t.filter(function(t){return"Comment"!==t.type}).map(function(t){if("Expression"===t.type){var e=t.value.filter(function(t){return"Comment"!==t.type});return 1===e.length?e[0]:new i(e)}return t})),this.func.apply(this,t)},e.exports=n},{"../tree/expression":64}],27:[function(t,e){function i(t){return{_data:{},add:function(t,e){t=t.toLowerCase(),this._data.hasOwnProperty(t),this._data[t]=e},addMultiple:function(t){Object.keys(t).forEach(function(e){this.add(e,t[e])}.bind(this))},get:function(e){return this._data[e]||t&&t.get(e)},getLocalFunctions:function(){return this._data},inherit:function(){return i(this)},create:function(t){return i(t)}}}e.exports=i(null)},{}],28:[function(t,e){e.exports=function(e){var i={functionRegistry:t("./function-registry"),functionCaller:t("./function-caller")};return t("./boolean"),t("./default"),t("./color"),t("./color-blending"),t("./data-uri")(e),t("./list"),t("./math"),t("./number"),t("./string"),t("./svg")(e),t("./types"),i}},{"./boolean":21,"./color":23,"./color-blending":22,"./data-uri":24,"./default":25,"./function-caller":26,"./function-registry":27,"./list":29,"./math":31,"./number":32,"./string":33,"./svg":34,"./types":35}],29:[function(t){var e=t("../tree/dimension"),i=t("../tree/declaration"),n=t("../tree/ruleset"),o=t("../tree/selector"),r=t("../tree/element"),s=t("./function-registry"),a=function(t){return Array.isArray(t.value)?t.value:Array(t)};s.addMultiple({_SELF:function(t){return t},extract:function(t,e){return e=e.value-1,a(t)[e]},length:function(t){return new e(a(t).length)},each:function(t,s){var a,l,c=0,h=[];l=t.value?Array.isArray(t.value)?t.value:[t.value]:t.ruleset?t.ruleset.rules:Array.isArray(t)?t:[t];var u="@value",d="@key",p="@index";return s.params?(u=s.params[0]&&s.params[0].name,d=s.params[1]&&s.params[1].name,p=s.params[2]&&s.params[2].name,s=s.rules):s=s.ruleset,l.forEach(function(t){var l,f;c+=1,t instanceof i?(l="string"==typeof t.name?t.name:t.name[0].value,f=t.value):(l=new e(c),f=t),a=s.rules.slice(0),u&&a.push(new i(u,f,!1,!1,this.index,this.currentFileInfo)),p&&a.push(new i(p,new e(c),!1,!1,this.index,this.currentFileInfo)),d&&a.push(new i(d,l,!1,!1,this.index,this.currentFileInfo)),h.push(new n([new o([new r("","&")])],a,s.strictImports,s.visibilityInfo()))}),new n([new o([new r("","&")])],h,s.strictImports,s.visibilityInfo()).eval(this.context)}})},{"../tree/declaration":60,"../tree/dimension":62,"../tree/element":63,"../tree/ruleset":81,"../tree/selector":82,"./function-registry":27}],30:[function(t,e){var i=t("../tree/dimension"),n=function(){};n._math=function(t,e,n){if(!(n instanceof i))throw{type:"Argument",message:"argument must be a number"};return null==e?e=n.unit:n=n.unify(),new i(t(parseFloat(n.value)),e)},e.exports=n},{"../tree/dimension":62}],31:[function(t){var e=t("./function-registry"),i=t("./math-helper.js"),n={ceil:null,floor:null,sqrt:null,abs:null,tan:"",sin:"",cos:"",atan:"rad",asin:"rad",acos:"rad"};for(var o in n)n.hasOwnProperty(o)&&(n[o]=i._math.bind(null,Math[o],n[o]));n.round=function(t,e){var n=void 0===e?0:e.value;return i._math(function(t){return t.toFixed(n)},null,t)},e.addMultiple(n)},{"./function-registry":27,"./math-helper.js":30}],32:[function(t){var e=t("../tree/dimension"),i=t("../tree/anonymous"),n=t("./function-registry"),o=t("./math-helper.js"),r=function(t,n){switch((n=Array.prototype.slice.call(n)).length){case 0:throw{type:"Argument",message:"one or more arguments required"}}var o,r,s,a,l,c,h,u,d=[],p={};for(o=0;o<n.length;o++)if((s=n[o])instanceof e)if(h=""!==(c=""===(a=""===s.unit.toString()&&void 0!==u?new e(s.value,u).unify():s.unify()).unit.toString()&&void 0!==h?h:a.unit.toString())&&void 0===h||""!==c&&""===d[0].unify().unit.toString()?c:h,u=""!==c&&void 0===u?s.unit.toString():u,void 0!==(r=void 0!==p[""]&&""!==c&&c===h?p[""]:p[c]))l=""===d[r].unit.toString()&&void 0!==u?new e(d[r].value,u).unify():d[r].unify(),(t&&a.value<l.value||!t&&a.value>l.value)&&(d[r]=s);else{if(void 0!==h&&c!==h)throw{type:"Argument",message:"incompatible types"};p[c]=d.length,d.push(s)}else Array.isArray(n[o].value)&&Array.prototype.push.apply(n,Array.prototype.slice.call(n[o].value));return 1==d.length?d[0]:(n=d.map(function(t){return t.toCSS(this.context)}).join(this.context.compress?",":", "),new i((t?"min":"max")+"("+n+")"))};n.addMultiple({min:function(){return r(!0,arguments)},max:function(){return r(!1,arguments)},convert:function(t,e){return t.convertTo(e.value)},pi:function(){return new e(Math.PI)},mod:function(t,i){return new e(t.value%i.value,t.unit)},pow:function(t,i){if("number"==typeof t&&"number"==typeof i)t=new e(t),i=new e(i);else if(!(t instanceof e&&i instanceof e))throw{type:"Argument",message:"arguments must be numbers"};return new e(Math.pow(t.value,i.value),t.unit)},percentage:function(t){return o._math(function(t){return 100*t},"%",t)}})},{"../tree/anonymous":50,"../tree/dimension":62,"./function-registry":27,"./math-helper.js":30}],33:[function(t){var e=t("../tree/quoted"),i=t("../tree/anonymous"),n=t("../tree/javascript");t("./function-registry").addMultiple({e:function(t){return new i(t instanceof n?t.evaluated:t.value)},escape:function(t){return new i(encodeURI(t.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},replace:function(t,i,n,o){var r=t.value;return n="Quoted"===n.type?n.value:n.toCSS(),r=r.replace(new RegExp(i.value,o?o.value:""),n),new e(t.quote||"",r,t.escaped)},"%":function(t){for(var i=Array.prototype.slice.call(arguments,1),n=t.value,o=0;o<i.length;o++)n=n.replace(/%[sda]/i,function(t){var e="Quoted"===i[o].type&&t.match(/s/i)?i[o].value:i[o].toCSS();return t.match(/[A-Z]$/)?encodeURIComponent(e):e});return n=n.replace(/%%/g,"%"),new e(t.quote||"",n,t.escaped)}})},{"../tree/anonymous":50,"../tree/javascript":68,"../tree/quoted":80,"./function-registry":27}],34:[function(t,e){e.exports=function(){var e=t("../tree/dimension"),i=t("../tree/color"),n=t("../tree/expression"),o=t("../tree/quoted"),r=t("../tree/url");t("./function-registry").add("svg-gradient",function(t){function s(){throw{type:"Argument",message:"svg-gradient expects direction, start_color [start_position], [color position,]..., end_color [end_position] or direction, color list"}}var a,l,c,h,u,d,p,f,g="linear",m='x="0" y="0" width="1" height="1"',v={compress:!1},b=t.toCSS(v);switch(2==arguments.length?(arguments[1].value.length<2&&s(),a=arguments[1].value):arguments.length<3?s():a=Array.prototype.slice.call(arguments,1),b){case"to bottom":l='x1="0%" y1="0%" x2="0%" y2="100%"';break;case"to right":
l='x1="0%" y1="0%" x2="100%" y2="0%"';break;case"to bottom right":l='x1="0%" y1="0%" x2="100%" y2="100%"';break;case"to top right":l='x1="0%" y1="100%" x2="100%" y2="0%"';break;case"ellipse":case"ellipse at center":g="radial",l='cx="50%" cy="50%" r="75%"',m='x="-50" y="-50" width="101" height="101"';break;default:throw{type:"Argument",message:"svg-gradient direction must be 'to bottom', 'to right', 'to bottom right', 'to top right' or 'ellipse at center'"}}for(c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1 1"><'+g+'Gradient id="g" '+l+">",h=0;h<a.length;h+=1)a[h]instanceof n?(u=a[h].value[0],d=a[h].value[1]):(u=a[h],d=void 0),u instanceof i&&((0===h||h+1===a.length)&&void 0===d||d instanceof e)||s(),p=d?d.toCSS(v):0===h?"0%":"100%",f=u.alpha,c+='<stop offset="'+p+'" stop-color="'+u.toRGB()+'"'+(f<1?' stop-opacity="'+f+'"':"")+"/>";return c+="</"+g+"Gradient><rect "+m+' fill="url(#g)" /></svg>',c=encodeURIComponent(c),new r(new o("'"+(c="data:image/svg+xml,"+c)+"'",c,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../tree/color":55,"../tree/dimension":62,"../tree/expression":64,"../tree/quoted":80,"../tree/url":85,"./function-registry":27}],35:[function(t){var e=t("../tree/keyword"),i=t("../tree/detached-ruleset"),n=t("../tree/dimension"),o=t("../tree/color"),r=t("../tree/quoted"),s=t("../tree/anonymous"),a=t("../tree/url"),l=t("../tree/operation"),c=t("./function-registry"),h=function(t,i){return t instanceof i?e.True:e.False},u=function(t,i){if(void 0===i)throw{type:"Argument",message:"missing the required second argument to isunit."};if("string"!=typeof(i="string"==typeof i.value?i.value:i))throw{type:"Argument",message:"Second argument to isunit should be a unit or a string."};return t instanceof n&&t.unit.is(i)?e.True:e.False};c.addMultiple({isruleset:function(t){return h(t,i)},iscolor:function(t){return h(t,o)},isnumber:function(t){return h(t,n)},isstring:function(t){return h(t,r)},iskeyword:function(t){return h(t,e)},isurl:function(t){return h(t,a)},ispixel:function(t){return u(t,"px")},ispercentage:function(t){return u(t,"%")},isem:function(t){return u(t,"em")},isunit:u,unit:function(t,i){if(!(t instanceof n))throw{type:"Argument",message:"the first argument to unit must be a number"+(t instanceof l?". Have you forgotten parenthesis?":"")};return i=i?i instanceof e?i.value:i.toCSS():"",new n(t.value,i)},"get-unit":function(t){return new s(t.unit)}})},{"../tree/anonymous":50,"../tree/color":55,"../tree/detached-ruleset":61,"../tree/dimension":62,"../tree/keyword":70,"../tree/operation":77,"../tree/quoted":80,"../tree/url":85,"./function-registry":27}],36:[function(t,e){var i=t("./contexts"),n=t("./parser/parser"),o=t("./less-error"),r=t("./utils"),s=("undefined"==typeof Promise?t("promise"):Promise,t("./logger"));e.exports=function(t){var e=function(t,e,i){this.less=t,this.rootFilename=i.filename,this.paths=e.paths||[],this.contents={},this.contentsIgnoredChars={},this.mime=e.mime,this.error=null,this.context=e,this.queue=[],this.files={}};return e.prototype.push=function(e,a,l,c,h){var u=this,d=this.context.pluginManager.Loader;this.queue.push(e);var p=function(t,i,n){u.queue.splice(u.queue.indexOf(e),1);var o=n===u.rootFilename;c.optional&&t?(h(null,{rules:[]},!1,null),s.info("The file "+n+" was skipped because it was not found and the import was marked optional.")):(u.files[n]||c.inline||(u.files[n]={root:i,options:c}),t&&!u.error&&(u.error=t),h(t,i,o,n))},f={rewriteUrls:this.context.rewriteUrls,entryPath:l.entryPath,rootpath:l.rootpath,rootFilename:l.rootFilename},g=t.getFileManager(e,l.currentDirectory,this.context,t);if(g){var m,v=function(t){var e,r=t.filename,s=t.contents.replace(/^\uFEFF/,"");f.currentDirectory=g.getPath(r),f.rewriteUrls&&(f.rootpath=g.join(u.context.rootpath||"",g.pathDiff(f.currentDirectory,f.entryPath)),!g.isPathAbsolute(f.rootpath)&&g.alwaysMakePathsAbsolute()&&(f.rootpath=g.join(f.entryPath,f.rootpath))),f.filename=r;var a=new i.Parse(u.context);a.processImports=!1,u.contents[r]=s,(l.reference||c.reference)&&(f.reference=!0),c.isPlugin?(e=d.evalPlugin(s,a,u,c.pluginArgs,f))instanceof o?p(e,null,r):p(null,e,r):c.inline?p(null,s,r):!u.files[r]||u.files[r].options.multiple||c.multiple?new n(a,u,f).parse(s,function(t,e){p(t,e,r)}):p(null,u.files[r].root,r)},b=r.clone(this.context);a&&(b.ext=c.isPlugin?".js":".less"),(m=c.isPlugin?d.loadPlugin(e,l.currentDirectory,b,t,g):g.loadFile(e,l.currentDirectory,b,t,function(t,e){t?p(t):v(e)}))&&m.then(v,p)}else p({message:"Could not find a file-manager for "+e})},e}},{"./contexts":13,"./less-error":38,"./logger":39,"./parser/parser":44,"./utils":89,promise:void 0}],37:[function(t,e){e.exports=function(e,i){var n,o,r,s,a,l,c={version:[3,8,1],data:t("./data"),tree:t("./tree"),Environment:a=t("./environment/environment"),AbstractFileManager:t("./environment/abstract-file-manager"),AbstractPluginLoader:t("./environment/abstract-plugin-loader"),environment:e=new a(e,i),visitors:t("./visitors"),Parser:t("./parser/parser"),functions:t("./functions")(e),contexts:t("./contexts"),SourceMapOutput:n=t("./source-map-output")(e),SourceMapBuilder:o=t("./source-map-builder")(n,e),ParseTree:r=t("./parse-tree")(o),ImportManager:s=t("./import-manager")(e),render:t("./render")(e,r,s),parse:t("./parse")(e,r,s),LessError:t("./less-error"),transformTree:t("./transform-tree"),utils:t("./utils"),PluginManager:t("./plugin-manager"),logger:t("./logger")},h=function(t){return function(){var e=Object.create(t.prototype);return t.apply(e,Array.prototype.slice.call(arguments,0)),e}},u=Object.create(c);for(var d in c.tree)if("function"==typeof(l=c.tree[d]))u[d.toLowerCase()]=h(l);else for(var p in u[d]=Object.create(null),l)u[d][p.toLowerCase()]=h(l[p]);return u}},{"./contexts":13,"./data":15,"./environment/abstract-file-manager":18,"./environment/abstract-plugin-loader":19,"./environment/environment":20,"./functions":28,"./import-manager":36,"./less-error":38,"./logger":39,"./parse":41,"./parse-tree":40,"./parser/parser":44,"./plugin-manager":45,"./render":46,"./source-map-builder":47,"./source-map-output":48,"./transform-tree":49,"./tree":67,"./utils":89,"./visitors":93}],38:[function(t,e){var i=t("./utils"),n=e.exports=function(t,e,n){Error.call(this);var o=t.filename||n;if(this.message=t.message,this.stack=t.stack,e&&o){var r=e.contents[o],s=i.getLocation(t.index,r),a=s.line,l=s.column,c=t.call&&i.getLocation(t.call,r).line,h=r?r.split("\n"):"";if(this.type=t.type||"Syntax",this.filename=o,this.index=t.index,this.line="number"==typeof a?a+1:null,this.column=l,!this.line&&this.stack){var u=this.stack.match(/(<anonymous>|Function):(\d+):(\d+)/);u&&(u[2]&&(this.line=parseInt(u[2])-2),u[3]&&(this.column=parseInt(u[3])))}this.callLine=c+1,this.callExtract=h[c],this.extract=[h[this.line-2],h[this.line-1],h[this.line]]}};if("undefined"==typeof Object.create){var o=function(){};o.prototype=Error.prototype,n.prototype=new o}else n.prototype=Object.create(Error.prototype);n.prototype.constructor=n,n.prototype.toString=function(t){t=t||{};var e="",i=this.extract||[],n=[],o=function(t){return t};if(t.stylize){var r=typeof t.stylize;if("function"!==r)throw Error("options.stylize should be a function, got a "+r+"!");o=t.stylize}if(null!==this.line){if("string"==typeof i[0]&&n.push(o(this.line-1+" "+i[0],"grey")),"string"==typeof i[1]){var s=this.line+" ";i[1]&&(s+=i[1].slice(0,this.column)+o(o(o(i[1].substr(this.column,1),"bold")+i[1].slice(this.column+1),"red"),"inverse")),n.push(s)}"string"==typeof i[2]&&n.push(o(this.line+1+" "+i[2],"grey")),n=n.join("\n")+o("","reset")+"\n"}return e+=o(this.type+"Error: "+this.message,"red"),this.filename&&(e+=o(" in ","red")+this.filename),this.line&&(e+=o(" on line "+this.line+", column "+(this.column+1)+":","grey")),e+="\n"+n,this.callLine&&(e+=o("from ","red")+(this.filename||"")+"/n",e+=o(this.callLine,"grey")+" "+this.callExtract+"/n"),e}},{"./utils":89}],39:[function(t,e){e.exports={error:function(t){this._fireEvent("error",t)},warn:function(t){this._fireEvent("warn",t)},info:function(t){this._fireEvent("info",t)},debug:function(t){this._fireEvent("debug",t)},addListener:function(t){this._listeners.push(t)},removeListener:function(t){for(var e=0;e<this._listeners.length;e++)if(this._listeners[e]===t)return void this._listeners.splice(e,1)},_fireEvent:function(t,e){for(var i=0;i<this._listeners.length;i++){var n=this._listeners[i][t];n&&n(e)}},_listeners:[]}},{}],40:[function(t,e){var i=t("./less-error"),n=t("./transform-tree"),o=t("./logger");e.exports=function(t){var e=function(t,e){this.root=t,this.imports=e};return e.prototype.toCSS=function(e){var r,s,a={};try{r=n(this.root,e)}catch(p){throw new i(p,this.imports)}try{var l=Boolean(e.compress);l&&o.warn("The compress option has been deprecated. We recommend you use a dedicated css minifier, for instance see less-plugin-clean-css.");var c={compress:l,dumpLineNumbers:e.dumpLineNumbers,strictUnits:Boolean(e.strictUnits),numPrecision:8};e.sourceMap?(s=new t(e.sourceMap),a.css=s.toCSS(r,c,this.imports)):a.css=r.toCSS(c)}catch(p){throw new i(p,this.imports)}if(e.pluginManager)for(var h=e.pluginManager.getPostProcessors(),u=0;u<h.length;u++)a.css=h[u].process(a.css,{sourceMap:s,options:e,imports:this.imports});for(var d in e.sourceMap&&(a.map=s.getExternalSourceMap()),a.imports=[],this.imports.files)this.imports.files.hasOwnProperty(d)&&d!==this.imports.rootFilename&&a.imports.push(d);return a},e}},{"./less-error":38,"./logger":39,"./transform-tree":49}],41:[function(t,e){var i,n=t("./contexts"),o=t("./parser/parser"),r=t("./plugin-manager"),s=t("./less-error"),a=t("./utils");e.exports=function(e,l,c){var h=function(e,l,u){if("function"==typeof l?(u=l,l=a.copyOptions(this.options,{})):l=a.copyOptions(this.options,l||{}),!u){i||(i="undefined"==typeof Promise?t("promise"):Promise);var d=this;return new i(function(t,i){h.call(d,e,l,function(e,n){e?i(e):t(n)})})}var p,f,g=new r(this,!l.reUsePluginManager);if(l.pluginManager=g,p=new n.Parse(l),l.rootFileInfo)f=l.rootFileInfo;else{var m=l.filename||"input",v=m.replace(/[^\/\\]*$/,"");(f={filename:m,rewriteUrls:p.rewriteUrls,rootpath:p.rootpath||"",currentDirectory:v,entryPath:v,rootFilename:m}).rootpath&&"/"!==f.rootpath.slice(-1)&&(f.rootpath+="/")}var b=new c(this,p,f);this.importManager=b,l.plugins&&l.plugins.forEach(function(t){var e,i;if(t.fileContent){if(i=t.fileContent.replace(/^\uFEFF/,""),(e=g.Loader.evalPlugin(i,p,b,t.options,t.filename))instanceof s)return u(e)}else g.addPlugin(t)}),new o(p,b,f).parse(e,function(t,e){return t?u(t):void u(null,e,b,l)},l)};return h}},{"./contexts":13,"./less-error":38,"./parser/parser":44,"./plugin-manager":45,"./utils":89,promise:void 0}],42:[function(t,e){e.exports=function(t,e){function i(e){var i=a-m;i<512&&!e||!i||(g.push(t.slice(m,a+1)),m=a+1)}var n,o,r,s,a,l,c,h,u,d=t.length,p=0,f=0,g=[],m=0;for(a=0;a<d;a++)if(!((c=t.charCodeAt(a))>=97&&c<=122||c<34))switch(c){case 40:f++,o=a;continue;case 41:if(--f<0)return e("missing opening `(`",a);continue;case 59:f||i();continue;case 123:p++,n=a;continue;case 125:if(--p<0)return e("missing opening `{`",a);p||f||i();continue;case 92:if(a<d-1){a++;continue}return e("unescaped `\\`",a);case 34:case 39:case 96:for(u=0,l=a,a+=1;a<d;a++)if(!((h=t.charCodeAt(a))>96)){if(h==c){u=1;break}if(92==h){if(a==d-1)return e("unescaped `\\`",a);a++}}if(u)continue;return e("unmatched `"+String.fromCharCode(c)+"`",l);case 47:if(f||a==d-1)continue;if(47==(h=t.charCodeAt(a+1)))for(a+=2;a<d&&(!((h=t.charCodeAt(a))<=13)||10!=h&&13!=h);a++);else if(42==h){for(r=l=a,a+=2;a<d-1&&(125==(h=t.charCodeAt(a))&&(s=a),42!=h||47!=t.charCodeAt(a+1));a++);if(a==d-1)return e("missing closing `*/`",l);a++}continue;case 42:if(a<d-1&&47==t.charCodeAt(a+1))return e("unmatched `/*`",a);continue}return 0!==p?e(r>n&&s>r?"missing closing `}` or `*/`":"missing closing `}`",n):0!==f?e("missing closing `)`",o):(i(!0),g)}},{}],43:[function(t,e){var i=t("./chunker");e.exports=function(){function t(i){for(var o,r,c,g=h.i,m=n,b=h.i-l,y=h.i+a.length-b,S=h.i+=i,k=e;h.i<y;h.i++){if(o=k.charCodeAt(h.i),h.autoCommentAbsorb&&o===v){if("/"===(r=k.charAt(h.i+1))){c={index:h.i,isLineComment:!0};var w=k.indexOf("\n",h.i+2);w<0&&(w=y),h.i=w,c.text=k.substr(c.index,h.i-c.index),h.commentStore.push(c);continue}if("*"===r){var _=k.indexOf("*/",h.i+2);if(_>=0){c={index:h.i,text:k.substr(h.i,_+2-h.i),isLineComment:!1},h.i+=c.text.length-1,h.commentStore.push(c);continue}}break}if(o!==u&&o!==p&&o!==d&&o!==f)break}if(a=a.slice(i+h.i-S+b),l=h.i,!a.length){if(n<s.length-1)return a=s[++n],t(0),!0;h.finished=!0}return g!==h.i||m!==n}var e,n,o,r,s,a,l,c=[],h={},u=32,d=9,p=10,f=13,g=43,m=44,v=47,b=57;return h.save=function(){l=h.i,c.push({current:a,i:h.i,j:n})},h.restore=function(t){(h.i>o||h.i===o&&t&&!r)&&(o=h.i,r=t);var e=c.pop();a=e.current,l=h.i=e.i,n=e.j},h.forget=function(){c.pop()},h.isWhitespace=function(t){var i=h.i+(t||0),n=e.charCodeAt(i);return n===u||n===f||n===d||n===p},h.$re=function(e){h.i>l&&(a=a.slice(h.i-l),l=h.i);var i=e.exec(a);return i?(t(i[0].length),"string"==typeof i?i:1===i.length?i[0]:i):null},h.$char=function(i){return e.charAt(h.i)!==i?null:(t(1),i)},h.$str=function(i){for(var n=i.length,o=0;o<n;o++)if(e.charAt(h.i+o)!==i.charAt(o))return null;return t(n),i},h.$quoted=function(i){var n=i||h.i,o=e.charAt(n);if("'"===o||'"'===o){for(var r=e.length,s=n,a=1;a+s<r;a++){switch(e.charAt(a+s)){case"\\":a++;continue;case"\r":case"\n":break;case o:var l=e.substr(s,a+1);return i||0===i?[o,l]:(t(a+1),l)}}return null}},h.$parseUntil=function(i){var n,o="",r=null,s=!1,a=0,l=[],c=[],u=e.length,d=h.i,p=h.i,f=h.i,g=!0;n="string"==typeof i?function(t){return t===i}:function(t){return i.test(t)};do{var m=e.charAt(f);if(0===a&&n(m))r=e.substr(p,f-p),c.push(r||" "),r=c,t(f-d),g=!1;else{if(s){"*"===m&&"/"===e.charAt(f+1)&&(f++,a--,s=!1),f++;continue}switch(m){case"\\":f++,m=e.charAt(f),c.push(e.substr(p,f-p+1)),p=f+1;break;case"/":"*"===e.charAt(f+1)&&(f++,s=!0,a++);break;case"'":case'"':(o=h.$quoted(f))?(c.push(e.substr(p,f-p),o),p=(f+=o[1].length-1)+1):(t(f-d),r=m,g=!1);break;case"{":l.push("}"),a++;break;case"(":l.push(")"),a++;break;case"[":l.push("]"),a++;break;case"}":case")":case"]":var v=l.pop();m===v?a--:(t(f-d),r=v,g=!1)}++f>u&&(g=!1)}m}while(g);return r||null},h.autoCommentAbsorb=!0,h.commentStore=[],h.finished=!1,h.peek=function(t){if("string"==typeof t){for(var i=0;i<t.length;i++)if(e.charAt(h.i+i)!==t.charAt(i))return!1;return!0}return t.test(a)},h.peekChar=function(t){return e.charAt(h.i)===t},h.currentChar=function(){return e.charAt(h.i)},h.prevChar=function(){return e.charAt(h.i-1)},h.getInput=function(){return e},h.peekNotNumeric=function(){var t=e.charCodeAt(h.i);return t>b||t<g||t===v||t===m},h.start=function(r,c,u){e=r,h.i=n=l=o=0,s=c?i(r,u):[r],a=s[0],t(0)},h.end=function(){var t,i=h.i>=e.length;return h.i<o&&(t=r,h.i=o),{isFinished:i,furthest:h.i,furthestPossibleErrorMessage:t,furthestReachedEnd:h.i>=e.length-1,furthestChar:e[h.i]}},h}},{"./chunker":42}],44:[function(t,e){var i=t("../less-error"),n=t("../tree"),o=t("../visitors"),r=t("./parser-input"),s=t("../utils"),a=t("../functions/function-registry"),l=function c(t,e,l){function h(t,n){throw new i({index:m.i,filename:l.filename,type:n||"Syntax",message:t},e)}function u(t,e){var i=t instanceof Function?t.call(g):m.$re(t);return i||void h(e||("string"==typeof t?"expected '"+t+"' got '"+m.currentChar()+"'":"unexpected token"))}function d(t,e){return m.$char(t)?t:void h(e||"expected '"+t+"' got '"+m.currentChar()+"'")}function p(t){var e=l.filename;return{lineNumber:s.getLocation(t,m.getInput()).line+1,fileName:e}}function f(t,n,o,r,s){var a,l=[],c=m;try{c.start(t,!1,function(t,e){s({message:t,index:e+o})});for(var h,u,d=0;h=n[d];d++)u=c.i,(a=g[h]())?(a._index=u+o,a._fileInfo=r,l.push(a)):l.push(null);c.end().isFinished?s(null,l):s(!0,null)}catch(f){throw new i({index:f.index+o,message:f.message},e,r.filename)}}var g,m=r();return{parserInput:m,imports:e,fileInfo:l,parseNode:f,parse:function(r,s,h){var u,d,p,f,g=null,v="";if(d=h&&h.globalVars?c.serializeVars(h.globalVars)+"\n":"",p=h&&h.modifyVars?"\n"+c.serializeVars(h.modifyVars):"",t.pluginManager)for(var b=t.pluginManager.getPreProcessors(),y=0;y<b.length;y++)r=b[y].process(r,{context:t,imports:e,fileInfo:l});(d||h&&h.banner)&&(v=(h&&h.banner?h.banner:"")+d,(f=e.contentsIgnoredChars)[l.filename]=f[l.filename]||0,f[l.filename]+=v.length),r=v+(r=r.replace(/\r\n?/g,"\n")).replace(/^\uFEFF/,"")+p,e.contents[l.filename]=r;try{m.start(r,t.chunkInput,function(t,n){throw new i({index:n,type:"Parse",message:t,filename:l.filename},e)}),n.Node.prototype.parse=this,u=new n.Ruleset(null,this.parsers.primary()),n.Node.prototype.rootNode=u,u.root=!0,u.firstRoot=!0,u.functionRegistry=a.inherit()}catch(_){return s(new i(_,e,l.filename))}var S=m.end();if(!S.isFinished){var k=S.furthestPossibleErrorMessage;k||(k="Unrecognised input","}"===S.furthestChar?k+=". Possibly missing opening '{'":")"===S.furthestChar?k+=". Possibly missing opening '('":S.furthestReachedEnd&&(k+=". Possibly missing something")),g=new i({type:"Parse",message:k,index:S.furthest,filename:l.filename},e)}var w=function(t){return(t=g||t||e.error)?(t instanceof i||(t=new i(t,e,l.filename)),s(t)):s(null,u)};return!1===t.processImports?w():void new o.ImportVisitor(e,w).run(u)},parsers:g={primary:function(){for(var t,e=this.mixin,i=[];;){for(;t=this.comment();)i.push(t);if(m.finished)break;if(m.peek("}"))break;if(t=this.extendRule())i=i.concat(t);else if(t=e.definition()||this.declaration()||this.ruleset()||e.call(!1,!1)||this.variableCall()||this.entities.call()||this.atrule())i.push(t);else{for(var n=!1;m.$char(";");)n=!0;if(!n)break}}return i},comment:function(){if(m.commentStore.length){var t=m.commentStore.shift();return new n.Comment(t.text,t.isLineComment,t.index,l)}},entities:{mixinLookup:function(){return g.mixin.call(!0,!0)},quoted:function(t){var e,i=m.i,o=!1;if(m.save(),m.$char("~"))o=!0;else if(t)return void m.restore();return(e=m.$quoted())?(m.forget(),new n.Quoted(e.charAt(0),e.substr(1,e.length-2),o,i,l)):void m.restore()},keyword:function(){var t=m.$char("%")||m.$re(/^\[?(?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+\]?/);if(t)return n.Color.fromKeyword(t)||new n.Keyword(t)},call:function(){var t,e,i,o=m.i;if(!m.peek(/^url\(/i))return m.save(),(t=m.$re(/^([\w-]+|%|progid:[\w\.]+)\(/))?(t=t[1],(i=this.customFuncCall(t))&&((e=i.parse())&&i.stop)?(m.forget(),e):(e=this.arguments(e),m.$char(")")?(m.forget(),new n.Call(t,e,o,l)):void m.restore("Could not parse call arguments or missing ')'"))):void m.forget()},customFuncCall:function(t){function e(t,e){return{parse:t,stop:e}}function i(){return[u(g.condition,"expected condition")]}return{alpha:e(g.ieAlpha,!0),boolean:e(i),"if":e(i)}[t.toLowerCase()]},arguments:function(t){var e,i,o=t||[],r=[];for(m.save();;){if(t)t=!1;else{if(!(i=g.detachedRuleset()||this.assignment()||g.expression()))break;i.value&&1==i.value.length&&(i=i.value[0]),o.push(i)}m.$char(",")||(m.$char(";")||e)&&(e=!0,i=o.length<1?o[0]:new n.Value(o),r.push(i),o=[])}return m.forget(),e?r:o},literal:function(){return this.dimension()||this.color()||this.quoted()||this.unicodeDescriptor()},assignment:function(){var t,e;return m.save(),(t=m.$re(/^\w+(?=\s?=)/i))&&m.$char("=")&&(e=g.entity())?(m.forget(),new n.Assignment(t,e)):void m.restore()},url:function(){var t,e=m.i;return m.autoCommentAbsorb=!1,m.$str("url(")?(t=this.quoted()||this.variable()||this.property()||m.$re(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",m.autoCommentAbsorb=!0,d(")"),new n.URL(null!=t.value||t instanceof n.Variable||t instanceof n.Property?t:new n.Anonymous(t,e),e,l)):void(m.autoCommentAbsorb=!0)},variable:function(){var t,e,i=m.i;if(m.save(),"@"===m.currentChar()&&(e=m.$re(/^@@?[\w-]+/))){if("("===(t=m.currentChar())||"["===t&&!m.prevChar().match(/^\s/)){var o=g.variableCall(e);if(o)return m.forget(),o}return m.forget(),new n.Variable(e,i,l)}m.restore()},variableCurly:function(){var t,e=m.i;if("@"===m.currentChar()&&(t=m.$re(/^@\{([\w-]+)\}/)))return new n.Variable("@"+t[1],e,l)},property:function(){var t,e=m.i;if("$"===m.currentChar()&&(t=m.$re(/^\$[\w-]+/)))return new n.Property(t,e,l)},propertyCurly:function(){var t,e=m.i;if("$"===m.currentChar()&&(t=m.$re(/^\$\{([\w-]+)\}/)))return new n.Property("$"+t[1],e,l)},color:function(){var t;if("#"===m.currentChar()&&(t=m.$re(/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})/)))return new n.Color(t[1],void 0,t[0])},colorKeyword:function(){m.save();var t=m.autoCommentAbsorb;m.autoCommentAbsorb=!1;var e=m.$re(/^[_A-Za-z-][_A-Za-z0-9-]+/);if(m.autoCommentAbsorb=t,e){m.restore();var i=n.Color.fromKeyword(e);return i?(m.$str(e),i):void 0}m.forget()},dimension:function(){if(!m.peekNotNumeric()){var t=m.$re(/^([+-]?\d*\.?\d+)(%|[a-z_]+)?/i);return t?new n.Dimension(t[1],t[2]):void 0}},unicodeDescriptor:function(){var t;if(t=m.$re(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/))return new n.UnicodeDescriptor(t[0])},javascript:function(){var t,e=m.i;m.save();var i=m.$char("~");return m.$char("`")?(t=m.$re(/^[^`]*`/))?(m.forget(),new n.JavaScript(t.substr(0,t.length-1),Boolean(i),e,l)):void m.restore("invalid javascript definition"):void m.restore()}},variable:function(){var t;if("@"===m.currentChar()&&(t=m.$re(/^(@[\w-]+)\s*:/)))return t[1]},variableCall:function(t){var e,i,o=m.i,r=!!t,s=t;if(m.save(),s||"@"===m.currentChar()&&(s=m.$re(/^(@[\w-]+)(\(\s*\))?/))){if(!(e=this.mixin.ruleLookups())&&(r&&"()"!==m.$str("()")||"()"!==s[2]))return void m.restore("Missing '[...]' lookup in variable call");r||(s=s[1]),e&&g.important()&&(i=!0);var a=new n.VariableCall(s,o,l);return!r&&g.end()?(m.forget(),a):(m.forget(),new n.NamespaceValue(a,e,i,o,l))}m.restore()},extend:function(t){var e,i,o,r,s,a=m.i;if(m.$str(t?"&:extend(":":extend(")){do{for(o=null,e=null;!(o=m.$re(/^(all)(?=\s*(\)|,))/))&&(i=this.element());)e?e.push(i):e=[i];o=o&&o[1],e||h("Missing target selector for :extend()."),s=new n.Extend(new n.Selector(e),o,a,l),r?r.push(s):r=[s]}while(m.$char(","));return u(/^\)/),t&&u(/^;/),r}},extendRule:function(){return this.extend(!0)},mixin:{call:function(t,e){var i,o,r,s,a=m.currentChar(),c=!1,h=m.i;if("."===a||"#"===a){if(m.save(),o=this.elements()){if(m.$char("(")&&(r=this.args(!0).args,d(")"),s=!0),!1!==e&&(i=this.ruleLookups()),!0===e&&!i)return void m.restore();if(t&&!i&&!s)return void m.restore();if(!t&&g.important()&&(c=!0),t||g.end()){m.forget();var u=new n.mixin.Call(o,r,h,l,!i&&c);return i?new n.NamespaceValue(u,i,c):u}}m.restore()}},elements:function(){for(var t,e,i,o,r,s=/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/;r=m.i,e=m.$re(s);)o=new n.Element(i,e,!1,r,l),t?t.push(o):t=[o],i=m.$char(">");return t},args:function(t){var e,i,o,r,s,a,l,c=g.entities,u={args:null,variadic:!1},d=[],p=[],f=[],v=!0;for(m.save();;){if(t)a=g.detachedRuleset()||g.expression();else{if(m.commentStore.length=0,m.$str("...")){u.variadic=!0,m.$char(";")&&!e&&(e=!0),(e?p:f).push({variadic:!0});break}a=c.variable()||c.property()||c.literal()||c.keyword()||this.call(!0)}if(!a||!v)break;r=null,a.throwAwayComments&&a.throwAwayComments(),s=a;var b=null;if(t?a.value&&1==a.value.length&&(b=a.value[0]):b=a,b&&(b instanceof n.Variable||b instanceof n.Property))if(m.$char(":")){if(d.length>0&&(e&&h("Cannot mix ; and , as delimiter types"),i=!0),!(s=g.detachedRuleset()||g.expression())){if(!t)return m.restore(),u.args=[],u;h("could not understand value for named argument")}r=o=b.name}else if(m.$str("...")){if(!t){u.variadic=!0,m.$char(";")&&!e&&(e=!0),(e?p:f).push({name:a.name,variadic:!0});break}l=!0}else t||(o=r=b.name,s=null);s&&d.push(s),f.push({name:r,value:s,expand:l}),m.$char(",")?v=!0:((v=";"===m.$char(";"))||e)&&(i&&h("Cannot mix ; and , as delimiter types"),e=!0,d.length>1&&(s=new n.Value(d)),p.push({name:o,value:s,expand:l}),o=null,d=[],i=!1)}return m.forget(),u.args=e?p:f,u},definition:function(){var t,e,i,o,r=[],s=!1;if(!("."!==m.currentChar()&&"#"!==m.currentChar()||m.peek(/^[^{]*\}/)))if(m.save(),e=m.$re(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/)){t=e[1];var a=this.args(!1);if(r=a.args,s=a.variadic,!m.$char(")"))return void m.restore("Missing closing ')'");if(m.commentStore.length=0,m.$str("when")&&(o=u(g.conditions,"expected condition")),i=g.block())return m.forget(),new n.mixin.Definition(t,r,i,o,s);m.restore()}else m.forget()},ruleLookups:function(){var t,e=[];if("["===m.currentChar()){for(;;){if(m.save(),null,!(t=this.lookupValue())&&""!==t){m.restore();break}e.push(t),m.forget()}return e.length>0?e:void 0}},lookupValue:function(){if(m.save(),m.$char("[")){var t=m.$re(/^(?:[@$]{0,2})[_a-zA-Z0-9-]*/);return m.$char("]")&&(t||""===t)?(m.forget(),t):void m.restore()}m.restore()}},entity:function(){var t=this.entities;return this.comment()||t.literal()||t.variable()||t.url()||t.property()||t.call()||t.keyword()||this.mixin.call(!0)||t.javascript()},end:function(){return m.$char(";")||m.peek("}")},ieAlpha:function(){var t;if(m.$re(/^opacity=/i))return(t=m.$re(/^\d+/))||(t="@{"+(t=u(g.entities.variable,"Could not parse alpha")).name.slice(1)+"}"),d(")"),new n.Quoted("","alpha(opacity="+t+")")},element:function(){var t,e,i,o=m.i;if(e=this.combinator(),(t=m.$re(/^(?:\d+\.\d+|\d+)%/)||m.$re(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||m.$char("*")||m.$char("&")||this.attribute()||m.$re(/^\([^&()@]+\)/)||m.$re(/^[\.#:](?=@)/)||this.entities.variableCurly())||(m.save(),m.$char("(")?(i=this.selector(!1))&&m.$char(")")?(t=new n.Paren(i),m.forget()):m.restore("Missing closing ')'"):m.forget()),t)return new n.Element(e,t,t instanceof n.Variable,o,l)},combinator:function(){var t=m.currentChar();if("/"===t){m.save();var e=m.$re(/^\/[a-z]+\//i);if(e)return m.forget(),new n.Combinator(e);m.restore()}if(">"===t||"+"===t||"~"===t||"|"===t||"^"===t){for(m.i++,"^"===t&&"^"===m.currentChar()&&(t="^^",m.i++);m.isWhitespace();)m.i++;return new n.Combinator(t)}return new n.Combinator(m.isWhitespace(-1)?" ":null)},selector:function(t){var e,i,o,r,s,a,c,d=m.i;for(t=!1!==t;(t&&(i=this.extend())||t&&(a=m.$str("when"))||(r=this.element()))&&(a?c=u(this.conditions,"expected condition"):c?h("CSS guard can only be used at the end of selector"):i?s=s?s.concat(i):i:(s&&h("Extend can only be used at the end of selector"),o=m.currentChar(),e?e.push(r):e=[r],r=null),"{"!==o&&"}"!==o&&";"!==o&&","!==o&&")"!==o););return e?new n.Selector(e,s,c,d,l):void(s&&h("Extend must be used to extend a selector, it cannot be used on its own"))},selectors:function(){for(var t,e;(t=this.selector())&&(e?e.push(t):e=[t],m.commentStore.length=0,t.condition&&e.length>1&&h("Guards are only currently allowed on a single selector."),m.$char(","));)t.condition&&h("Guards are only currently allowed on a single selector."),m.commentStore.length=0;return e},attribute:function(){if(m.$char("[")){var t,e,i,o=this.entities;return(t=o.variableCurly())||(t=u(/^(?:[_A-Za-z0-9-\*]*\|)?(?:[_A-Za-z0-9-]|\\.)+/)),(i=m.$re(/^[|~*$^]?=/))&&(e=o.quoted()||m.$re(/^[0-9]+%/)||m.$re(/^[\w-]+/)||o.variableCurly()),d("]"),new n.Attribute(t,i,e)}},block:function(){var t;if(m.$char("{")&&(t=this.primary())&&m.$char("}"))return t},blockRuleset:function(){var t=this.block();return t&&(t=new n.Ruleset(null,t)),t},detachedRuleset:function(){var t,e,i;if(m.save(),!m.$re(/^[.#]\(/)||(e=(t=this.mixin.args(!1)).args,i=t.variadic,m.$char(")"))){var o=this.blockRuleset();return o?(m.forget(),e?new n.mixin.Definition(null,e,o,null,i):new n.DetachedRuleset(o)):void m.restore()}m.restore()},ruleset:function(){var e,i,o;if(m.save(),t.dumpLineNumbers&&(o=p(m.i)),(e=this.selectors())&&(i=this.block())){m.forget();var r=new n.Ruleset(e,i,t.strictImports);return t.dumpLineNumbers&&(r.debugInfo=o),r}m.restore()},declaration:function(){var t,e,i,o,r,s,a=m.i,c=m.currentChar();if("."!==c&&"#"!==c&&"&"!==c&&":"!==c)if(m.save(),t=this.variable()||this.ruleProperty()){if((s="string"==typeof t)&&((e=this.detachedRuleset())&&(i=!0)),m.commentStore.length=0,!e){if(r=!s&&t.length>1&&t.pop().value,e=t[0].value&&"--"===t[0].value.slice(0,2)?this.permissiveValue():this.anonymousValue())return m.forget(),new n.Declaration(t,e,!1,r,a,l);e||(e=this.value()),e?o=this.important():s&&(e=this.permissiveValue())}if(e&&(this.end()||i))return m.forget(),new n.Declaration(t,e,o,r,a,l);m.restore()}else m.restore()},anonymousValue:function(){var t=m.i,e=m.$re(/^([^.#@\$+\/'"*`(;{}-]*);/);if(e)return new n.Anonymous(e[1],t)},permissiveValue:function(t){function e(){var t=m.currentChar();return"string"==typeof a?t===a:a.test(t)}var i,o,r,s,a=t||";",c=m.i,u=[];if(!e()){s=[];do{(o=this.comment())?s.push(o):(o=this.entity())&&s.push(o)}while(o);if(r=e(),s.length>0){if(s=new n.Expression(s),r)return s;u.push(s)," "===m.prevChar()&&u.push(new n.Anonymous(" ",c))}if(m.save(),s=m.$parseUntil(a)){if("string"==typeof s&&h("Expected '"+s+"'","Parse"),1===s.length&&" "===s[0])return m.forget(),new n.Anonymous("",c);var d;for(i=0;i<s.length;i++)if(d=s[i],Array.isArray(d))u.push(new n.Quoted(d[0],d[1],!0,c,l));else{i===s.length-1&&(d=d.trim());var p=new n.Quoted("'",d,!0,c,l);p.variableRegex=/@([\w-]+)/g,p.propRegex=/\$([\w-]+)/g,u.push(p)}return m.forget(),new n.Expression(u,!0)}m.restore()}},"import":function(){var t,e,i=m.i,o=m.$re(/^@import?\s+/);if(o){var r=(o?this.importOptions():null)||{};if(t=this.entities.quoted()||this.entities.url())return e=this.mediaFeatures(),m.$char(";")||(m.i=i,h("missing semi-colon or unrecognised media features on import")),e=e&&new n.Value(e),new n.Import(t,e,r,i,l);m.i=i,h("malformed import statement")}},importOptions:function(){var t,e,i,n={};if(!m.$char("("))return null;do{if(t=this.importOption()){switch(i=!0,e=t){case"css":e="less",i=!1;break;case"once":e="multiple",i=!1}if(n[e]=i,!m.$char(","))break}}while(t);return d(")"),n},importOption:function(){var t=m.$re(/^(less|css|multiple|once|inline|reference|optional)/);if(t)return t[1]},mediaFeature:function(){var t,e,i=this.entities,o=[];m.save();do{(t=i.keyword()||i.variable()||i.mixinLookup())?o.push(t):m.$char("(")&&(e=this.property(),t=this.value(),m.$char(")")?e&&t?o.push(new n.Paren(new n.Declaration(e,t,null,null,m.i,l,!0))):t?o.push(new n.Paren(t)):h("badly formed media feature definition"):h("Missing closing ')'","Parse"))}while(t);if(m.forget(),o.length>0)return new n.Expression(o)},mediaFeatures:function(){var t,e=this.entities,i=[];do{if(t=this.mediaFeature()){if(i.push(t),!m.$char(","))break}else if((t=e.variable()||e.mixinLookup())&&(i.push(t),!m.$char(",")))break}while(t);return i.length>0?i:null},media:function(){var e,i,o,r,s=m.i;return t.dumpLineNumbers&&(r=p(s)),m.save(),m.$str("@media")?(e=this.mediaFeatures(),(i=this.block())||h("media definitions require block statements after any features"),m.forget(),o=new n.Media(i,e,s,l),t.dumpLineNumbers&&(o.debugInfo=r),o):void m.restore()},plugin:function(){var t,e,i,o=m.i;if(m.$re(/^@plugin?\s+/)){if(i=(e=this.pluginArgs())?{pluginArgs:e,isPlugin:!0}:{isPlugin:!0},t=this.entities.quoted()||this.entities.url())return m.$char(";")||(m.i=o,h("missing semi-colon on @plugin")),new n.Import(t,null,i,o,l);m.i=o,h("malformed @plugin statement")}},pluginArgs:function(){if(m.save(),!m.$char("("))return m.restore(),null;var t=m.$re(/^\s*([^\);]+)\)\s*/);return t[1]?(m.forget(),t[1].trim()):(m.restore(),null)},atrule:function(){var e,i,o,r,s,a,c,u=m.i,d=!0,f=!0;if("@"===m.currentChar()){if(i=this["import"]()||this.plugin()||this.media())return i;if(m.save(),e=m.$re(/^@[a-z-]+/)){switch(r=e,"-"==e.charAt(1)&&e.indexOf("-",2)>0&&(r="@"+e.slice(e.indexOf("-",2)+1)),r){case"@charset":s=!0,d=!1;break;case"@namespace":a=!0,d=!1;break;case"@keyframes":case"@counter-style":s=!0;break;case"@document":case"@supports":c=!0,f=!1;break;default:c=!0}return m.commentStore.length=0,s?(i=this.entity())||h("expected "+e+" identifier"):a?(i=this.expression())||h("expected "+e+" expression"):c&&(i=this.permissiveValue(/^[{;]/),d="{"===m.currentChar(),i?i.value||(i=null):d||";"===m.currentChar()||h(e+" rule is missing block or ending semi-colon")),d&&(o=this.blockRuleset()),o||!d&&i&&m.$char(";")?(m.forget(),new n.AtRule(e,i,o,u,l,t.dumpLineNumbers?p(u):null,f)):void m.restore("at-rule options not recognised")}}},value:function(){var t,e=[],i=m.i;do{if((t=this.expression())&&(e.push(t),!m.$char(",")))break}while(t);if(e.length>0)return new n.Value(e,i)},important:function(){if("!"===m.currentChar())return m.$re(/^! *important/)},sub:function(){var t,e;return m.save(),m.$char("(")?(t=this.addition())&&m.$char(")")?(m.forget(),(e=new n.Expression([t])).parens=!0,e):void m.restore("Expected ')'"):void m.restore()},multiplication:function(){var t,e,i,o,r;if(t=this.operand()){for(r=m.isWhitespace(-1);!m.peek(/^\/[*\/]/);){if(m.save(),!(i=m.$char("/")||m.$char("*")||m.$str("./"))){m.forget()
;break}if(!(e=this.operand())){m.restore();break}m.forget(),t.parensInOp=!0,e.parensInOp=!0,o=new n.Operation(i,[o||t,e],r),r=m.isWhitespace(-1)}return o||t}},addition:function(){var t,e,i,o,r;if(t=this.multiplication()){for(r=m.isWhitespace(-1);(i=m.$re(/^[-+]\s+/)||!r&&(m.$char("+")||m.$char("-")))&&(e=this.multiplication());)t.parensInOp=!0,e.parensInOp=!0,o=new n.Operation(i,[o||t,e],r),r=m.isWhitespace(-1);return o||t}},conditions:function(){var t,e,i,o=m.i;if(t=this.condition(!0)){for(;m.peek(/^,\s*(not\s*)?\(/)&&m.$char(",")&&(e=this.condition(!0));)i=new n.Condition("or",i||t,e,o);return i||t}},condition:function(t){function e(){return m.$str("or")}var i,o,r;if(i=this.conditionAnd(t)){if(o=e()){if(!(r=this.condition(t)))return;i=new n.Condition(o,i,r)}return i}},conditionAnd:function(t){function e(){var e=a.negatedCondition(t)||a.parenthesisCondition(t);return e||t?e:a.atomicCondition(t)}function i(){return m.$str("and")}var o,r,s,a=this;if(o=e()){if(r=i()){if(!(s=this.conditionAnd(t)))return;o=new n.Condition(r,o,s)}return o}},negatedCondition:function(t){if(m.$str("not")){var e=this.parenthesisCondition(t);return e&&(e.negate=!e.negate),e}},parenthesisCondition:function(t){function e(e){var i;return m.save(),(i=e.condition(t))&&m.$char(")")?(m.forget(),i):void m.restore()}var i;return m.save(),m.$str("(")?(i=e(this))?(m.forget(),i):(i=this.atomicCondition(t))?m.$char(")")?(m.forget(),i):void m.restore("expected ')' got '"+m.currentChar()+"'"):void m.restore():void m.restore()},atomicCondition:function(){function t(){return this.addition()||s.keyword()||s.quoted()||s.mixinLookup()}var e,i,o,r,s=this.entities,a=m.i;if(e=(t=t.bind(this))())return m.$char(">")?r=m.$char("=")?">=":">":m.$char("<")?r=m.$char("=")?"<=":"<":m.$char("=")&&(r=m.$char(">")?"=>":m.$char("<")?"=<":"="),r?(i=t())?o=new n.Condition(r,e,i,a,!1):h("expected expression"):o=new n.Condition("=",e,new n.Keyword("true"),a,!1),o},operand:function(){var t,e=this.entities;m.peek(/^-[@\$\(]/)&&(t=m.$char("-"));var i=this.sub()||e.dimension()||e.color()||e.variable()||e.property()||e.call()||e.quoted(!0)||e.colorKeyword()||e.mixinLookup();return t&&(i.parensInOp=!0,i=new n.Negative(i)),i},expression:function(){var t,e,i=[],o=m.i;do{(t=this.comment())?i.push(t):(t=this.addition()||this.entity())&&(i.push(t),m.peek(/^\/[\/*]/)||(e=m.$char("/"))&&i.push(new n.Anonymous(e,o)))}while(t);if(i.length>0)return new n.Expression(i)},property:function(){var t=m.$re(/^(\*?-?[_a-zA-Z0-9-]+)\s*:/);if(t)return t[1]},ruleProperty:function(){function t(t){var e=m.i,i=m.$re(t);if(i)return r.push(e),o.push(i[1])}var e,i,o=[],r=[];m.save();var s=m.$re(/^([_a-zA-Z0-9-]+)\s*:/);if(s)return o=[new n.Keyword(s[1])],m.forget(),o;for(t(/^(\*?)/);t(/^((?:[\w-]+)|(?:[@\$]\{[\w-]+\}))/););if(o.length>1&&t(/^((?:\+_|\+)?)\s*:/)){for(m.forget(),""===o[0]&&(o.shift(),r.shift()),i=0;i<o.length;i++)e=o[i],o[i]="@"!==e.charAt(0)&&"$"!==e.charAt(0)?new n.Keyword(e):"@"===e.charAt(0)?new n.Variable("@"+e.slice(2,-1),r[i],l):new n.Property("$"+e.slice(2,-1),r[i],l);return o}m.restore()}}}};l.serializeVars=function(t){var e="";for(var i in t)if(Object.hasOwnProperty.call(t,i)){var n=t[i];e+=("@"===i[0]?"":"@")+i+": "+n+(";"===String(n).slice(-1)?"":";")}return e},e.exports=l},{"../functions/function-registry":27,"../less-error":38,"../tree":67,"../utils":89,"../visitors":93,"./parser-input":43}],45:[function(t,e){var i,n=function(t){this.less=t,this.visitors=[],this.preProcessors=[],this.postProcessors=[],this.installedPlugins=[],this.fileManagers=[],this.iterator=-1,this.pluginCache={},this.Loader=new t.PluginLoader(t)},o=function(t,e){return!e&&i||(i=new n(t)),i};n.prototype.addPlugins=function(t){if(t)for(var e=0;e<t.length;e++)this.addPlugin(t[e])},n.prototype.addPlugin=function(t,e,i){this.installedPlugins.push(t),e&&(this.pluginCache[e]=t),t.install&&t.install(this.less,this,i||this.less.functions.functionRegistry)},n.prototype.get=function(t){return this.pluginCache[t]},n.prototype.addVisitor=function(t){this.visitors.push(t)},n.prototype.addPreProcessor=function(t,e){var i;for(i=0;i<this.preProcessors.length&&!(this.preProcessors[i].priority>=e);i++);this.preProcessors.splice(i,0,{preProcessor:t,priority:e})},n.prototype.addPostProcessor=function(t,e){var i;for(i=0;i<this.postProcessors.length&&!(this.postProcessors[i].priority>=e);i++);this.postProcessors.splice(i,0,{postProcessor:t,priority:e})},n.prototype.addFileManager=function(t){this.fileManagers.push(t)},n.prototype.getPreProcessors=function(){for(var t=[],e=0;e<this.preProcessors.length;e++)t.push(this.preProcessors[e].preProcessor);return t},n.prototype.getPostProcessors=function(){for(var t=[],e=0;e<this.postProcessors.length;e++)t.push(this.postProcessors[e].postProcessor);return t},n.prototype.getVisitors=function(){return this.visitors},n.prototype.visitor=function(){var t=this;return{first:function(){return t.iterator=-1,t.visitors[t.iterator]},get:function(){return t.iterator+=1,t.visitors[t.iterator]}}},n.prototype.getFileManagers=function(){return this.fileManagers},e.exports=o},{}],46:[function(t,e){var i,n=t("./utils");e.exports=function(e,o){var r=function(e,s,a){if("function"==typeof s?(a=s,s=n.copyOptions(this.options,{})):s=n.copyOptions(this.options,s||{}),!a){i||(i="undefined"==typeof Promise?t("promise"):Promise);var l=this;return new i(function(t,i){r.call(l,e,s,function(e,n){e?i(e):t(n)})})}this.parse(e,s,function(t,e,i,n){if(t)return a(t);var r;try{r=new o(e,i).toCSS(n)}catch(t){return a(t)}a(null,r)})};return r}},{"./utils":89,promise:void 0}],47:[function(t,e){e.exports=function(t,e){var i=function(t){this.options=t};return i.prototype.toCSS=function(e,i,n){var o=new t({contentsIgnoredCharsMap:n.contentsIgnoredChars,rootNode:e,contentsMap:n.contents,sourceMapFilename:this.options.sourceMapFilename,sourceMapURL:this.options.sourceMapURL,outputFilename:this.options.sourceMapOutputFilename,sourceMapBasepath:this.options.sourceMapBasepath,sourceMapRootpath:this.options.sourceMapRootpath,outputSourceFiles:this.options.outputSourceFiles,sourceMapGenerator:this.options.sourceMapGenerator,sourceMapFileInline:this.options.sourceMapFileInline}),r=o.toCSS(i);return this.sourceMap=o.sourceMap,this.sourceMapURL=o.sourceMapURL,this.options.sourceMapInputFilename&&(this.sourceMapInputFilename=o.normalizeFilename(this.options.sourceMapInputFilename)),void 0!==this.options.sourceMapBasepath&&void 0!==this.sourceMapURL&&(this.sourceMapURL=o.removeBasepath(this.sourceMapURL)),r+this.getCSSAppendage()},i.prototype.getCSSAppendage=function(){var t=this.sourceMapURL;if(this.options.sourceMapFileInline){if(void 0===this.sourceMap)return"";t="data:application/json;base64,"+e.encodeBase64(this.sourceMap)}return t?"/*# sourceMappingURL="+t+" */":""},i.prototype.getExternalSourceMap=function(){return this.sourceMap},i.prototype.setExternalSourceMap=function(t){this.sourceMap=t},i.prototype.isInline=function(){return this.options.sourceMapFileInline},i.prototype.getSourceMapURL=function(){return this.sourceMapURL},i.prototype.getOutputFilename=function(){return this.options.sourceMapOutputFilename},i.prototype.getInputFilename=function(){return this.sourceMapInputFilename},i}},{}],48:[function(t,e){e.exports=function(t){var e=function(e){this._css=[],this._rootNode=e.rootNode,this._contentsMap=e.contentsMap,this._contentsIgnoredCharsMap=e.contentsIgnoredCharsMap,e.sourceMapFilename&&(this._sourceMapFilename=e.sourceMapFilename.replace(/\\/g,"/")),this._outputFilename=e.outputFilename,this.sourceMapURL=e.sourceMapURL,e.sourceMapBasepath&&(this._sourceMapBasepath=e.sourceMapBasepath.replace(/\\/g,"/")),e.sourceMapRootpath?(this._sourceMapRootpath=e.sourceMapRootpath.replace(/\\/g,"/"),"/"!==this._sourceMapRootpath.charAt(this._sourceMapRootpath.length-1)&&(this._sourceMapRootpath+="/")):this._sourceMapRootpath="",this._outputSourceFiles=e.outputSourceFiles,this._sourceMapGeneratorConstructor=t.getSourceMapGenerator(),this._lineNumber=0,this._column=0};return e.prototype.removeBasepath=function(t){return this._sourceMapBasepath&&0===t.indexOf(this._sourceMapBasepath)&&("\\"!==(t=t.substring(this._sourceMapBasepath.length)).charAt(0)&&"/"!==t.charAt(0)||(t=t.substring(1))),t},e.prototype.normalizeFilename=function(t){return t=t.replace(/\\/g,"/"),t=this.removeBasepath(t),(this._sourceMapRootpath||"")+t},e.prototype.add=function(t,e,i,n){if(t){var o,r,s,a,l;if(e&&e.filename){var c=this._contentsMap[e.filename];this._contentsIgnoredCharsMap[e.filename]&&((i-=this._contentsIgnoredCharsMap[e.filename])<0&&(i=0),c=c.slice(this._contentsIgnoredCharsMap[e.filename])),a=(r=(c=c.substring(0,i)).split("\n"))[r.length-1]}if(s=(o=t.split("\n"))[o.length-1],e&&e.filename)if(n)for(l=0;l<o.length;l++)this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+l+1,column:0===l?this._column:0},original:{line:r.length+l,column:0===l?a.length:0},source:this.normalizeFilename(e.filename)});else this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+1,column:this._column},original:{line:r.length,column:a.length},source:this.normalizeFilename(e.filename)});1===o.length?this._column+=s.length:(this._lineNumber+=o.length-1,this._column=s.length),this._css.push(t)}},e.prototype.isEmpty=function(){return 0===this._css.length},e.prototype.toCSS=function(t){if(this._sourceMapGenerator=new this._sourceMapGeneratorConstructor({file:this._outputFilename,sourceRoot:null}),this._outputSourceFiles)for(var e in this._contentsMap)if(this._contentsMap.hasOwnProperty(e)){var i=this._contentsMap[e];this._contentsIgnoredCharsMap[e]&&(i=i.slice(this._contentsIgnoredCharsMap[e])),this._sourceMapGenerator.setSourceContent(this.normalizeFilename(e),i)}if(this._rootNode.genCSS(t,this),this._css.length>0){var n,o=JSON.stringify(this._sourceMapGenerator.toJSON());this.sourceMapURL?n=this.sourceMapURL:this._sourceMapFilename&&(n=this._sourceMapFilename),this.sourceMapURL=n,this.sourceMap=o}return this._css.join("")},e}},{}],49:[function(t,e){var i=t("./contexts"),n=t("./visitors"),o=t("./tree");e.exports=function(t,e){var r,s=(e=e||{}).variables,a=new i.Eval(e);"object"!=typeof s||Array.isArray(s)||(s=Object.keys(s).map(function(t){var e=s[t];return e instanceof o.Value||(e instanceof o.Expression||(e=new o.Expression([e])),e=new o.Value([e])),new o.Declaration("@"+t,e,!1,null,0)}),a.frames=[new o.Ruleset(null,s)]);var l,c,h=[new n.JoinSelectorVisitor,new n.MarkVisibleSelectorsVisitor(!0),new n.ExtendVisitor,new n.ToCSSVisitor({compress:Boolean(e.compress)})],u=[];if(e.pluginManager){c=e.pluginManager.visitor();for(var d=0;d<2;d++)for(c.first();l=c.get();)l.isPreEvalVisitor?0!==d&&-1!==u.indexOf(l)||(u.push(l),l.run(t)):0!==d&&-1!==h.indexOf(l)||(l.isPreVisitor?h.unshift(l):h.push(l))}r=t.eval(a);for(d=0;d<h.length;d++)h[d].run(r);if(e.pluginManager)for(c.first();l=c.get();)-1===h.indexOf(l)&&-1===u.indexOf(l)&&l.run(r);return r}},{"./contexts":13,"./tree":67,"./visitors":93}],50:[function(t,e){var i=t("./node"),n=function(t,e,i,n,o,r){this.value=t,this._index=e,this._fileInfo=i,this.mapLines=n,this.rulesetLike=void 0!==o&&o,this.allowRoot=!0,this.copyVisibilityInfo(r)};n.prototype=new i,n.prototype.type="Anonymous",n.prototype.eval=function(){return new n(this.value,this._index,this._fileInfo,this.mapLines,this.rulesetLike,this.visibilityInfo())},n.prototype.compare=function(t){return t.toCSS&&this.toCSS()===t.toCSS()?0:void 0},n.prototype.isRulesetLike=function(){return this.rulesetLike},n.prototype.genCSS=function(t,e){this.nodeVisible=Boolean(this.value),this.nodeVisible&&e.add(this.value,this._fileInfo,this._index,this.mapLines)},e.exports=n},{"./node":76}],51:[function(t,e){var i=t("./node"),n=function(t,e){this.key=t,this.value=e};n.prototype=new i,n.prototype.type="Assignment",n.prototype.accept=function(t){this.value=t.visit(this.value)},n.prototype.eval=function(t){return this.value.eval?new n(this.key,this.value.eval(t)):this},n.prototype.genCSS=function(t,e){e.add(this.key+"="),this.value.genCSS?this.value.genCSS(t,e):e.add(this.value)},e.exports=n},{"./node":76}],52:[function(t,e){var i=t("./node"),n=t("./selector"),o=t("./ruleset"),r=t("./anonymous"),s=function(t,e,o,s,a,l,c,h){var u;if(this.name=t,this.value=e instanceof i?e:e?new r(e):e,o){for(Array.isArray(o)?this.rules=o:(this.rules=[o],this.rules[0].selectors=new n([],null,null,s,a).createEmptySelectors()),u=0;u<this.rules.length;u++)this.rules[u].allowImports=!0;this.setParent(this.rules,this)}this._index=s,this._fileInfo=a,this.debugInfo=l,this.isRooted=c||!1,this.copyVisibilityInfo(h),this.allowRoot=!0};s.prototype=new i,s.prototype.type="AtRule",s.prototype.accept=function(t){var e=this.value,i=this.rules;i&&(this.rules=t.visitArray(i)),e&&(this.value=t.visit(e))},s.prototype.isRulesetLike=function(){return this.rules||!this.isCharset()},s.prototype.isCharset=function(){return"@charset"===this.name},s.prototype.genCSS=function(t,e){var i=this.value,n=this.rules;e.add(this.name,this.fileInfo(),this.getIndex()),i&&(e.add(" "),i.genCSS(t,e)),n?this.outputRuleset(t,e,n):e.add(";")},s.prototype.eval=function(t){var e,i,n=this.value,o=this.rules;return e=t.mediaPath,i=t.mediaBlocks,t.mediaPath=[],t.mediaBlocks=[],n&&(n=n.eval(t)),o&&((o=[o[0].eval(t)])[0].root=!0),t.mediaPath=e,t.mediaBlocks=i,new s(this.name,n,o,this.getIndex(),this.fileInfo(),this.debugInfo,this.isRooted,this.visibilityInfo())},s.prototype.variable=function(t){if(this.rules)return o.prototype.variable.call(this.rules[0],t)},s.prototype.find=function(){if(this.rules)return o.prototype.find.apply(this.rules[0],arguments)},s.prototype.rulesets=function(){if(this.rules)return o.prototype.rulesets.apply(this.rules[0])},s.prototype.outputRuleset=function(t,e,i){var n,o=i.length;if(t.tabLevel=1+(0|t.tabLevel),t.compress){for(e.add("{"),n=0;n<o;n++)i[n].genCSS(t,e);return e.add("}"),void t.tabLevel--}var r="\n"+Array(t.tabLevel).join("  "),s=r+"  ";if(o){for(e.add(" {"+s),i[0].genCSS(t,e),n=1;n<o;n++)e.add(s),i[n].genCSS(t,e);e.add(r+"}")}else e.add(" {"+r+"}");t.tabLevel--},e.exports=s},{"./anonymous":50,"./node":76,"./ruleset":81,"./selector":82}],53:[function(t,e){var i=t("./node"),n=function(t,e,i){this.key=t,this.op=e,this.value=i};n.prototype=new i,n.prototype.type="Attribute",n.prototype.eval=function(t){return new n(this.key.eval?this.key.eval(t):this.key,this.op,this.value&&this.value.eval?this.value.eval(t):this.value)},n.prototype.genCSS=function(t,e){e.add(this.toCSS(t))},n.prototype.toCSS=function(t){var e=this.key.toCSS?this.key.toCSS(t):this.key;return this.op&&(e+=this.op,e+=this.value.toCSS?this.value.toCSS(t):this.value),"["+e+"]"},e.exports=n},{"./node":76}],54:[function(t,e){var i=t("./node"),n=t("./anonymous"),o=t("../functions/function-caller"),r=function(t,e,i,n){this.name=t,this.args=e,this.calc="calc"===t,this._index=i,this._fileInfo=n};r.prototype=new i,r.prototype.type="Call",r.prototype.accept=function(t){this.args&&(this.args=t.visitArray(this.args))},r.prototype.eval=function(t){var e=t.mathOn;t.mathOn=!this.calc,(this.calc||t.inCalc)&&t.enterCalc();var s=this.args.map(function(e){return e.eval(t)});(this.calc||t.inCalc)&&t.exitCalc(),t.mathOn=e;var a,l=new o(this.name,t,this.getIndex(),this.fileInfo());if(l.isValid()){try{a=l.call(s)}catch(c){throw{type:c.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(c.message?": "+c.message:""),index:this.getIndex(),filename:this.fileInfo().filename,line:c.lineNumber,column:c.columnNumber}}if(null!=a)return a instanceof i||(a=new n(a&&!0!==a?a.toString():null)),a._index=this._index,a._fileInfo=this._fileInfo,a}return new r(this.name,s,this.getIndex(),this.fileInfo())},r.prototype.genCSS=function(t,e){e.add(this.name+"(",this.fileInfo(),this.getIndex());for(var i=0;i<this.args.length;i++)this.args[i].genCSS(t,e),i+1<this.args.length&&e.add(", ");e.add(")")},e.exports=r},{"../functions/function-caller":26,"./anonymous":50,"./node":76}],55:[function(t,e){function i(t,e){return Math.min(Math.max(t,0),e)}function n(t){return"#"+t.map(function(t){return((t=i(Math.round(t),255))<16?"0":"")+t.toString(16)}).join("")}var o=t("./node"),r=t("../data/colors"),s=function(t,e,i){var n=this;Array.isArray(t)?this.rgb=t:t.length>=6?(this.rgb=[],t.match(/.{2}/g).map(function(t,e){e<3?n.rgb.push(parseInt(t,16)):n.alpha=parseInt(t,16)/255})):(this.rgb=[],t.split("").map(function(t,e){e<3?n.rgb.push(parseInt(t+t,16)):n.alpha=parseInt(t+t,16)/255})),this.alpha=this.alpha||("number"==typeof e?e:1),void 0!==i&&(this.value=i)};s.prototype=new o,s.prototype.type="Color",s.prototype.luma=function(){var t=this.rgb[0]/255,e=this.rgb[1]/255,i=this.rgb[2]/255;return.2126*(t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))},s.prototype.genCSS=function(t,e){e.add(this.toCSS(t))},s.prototype.toCSS=function(t,e){var n,o,r,s=t&&t.compress&&!e,a=[];if(o=this.fround(t,this.alpha),this.value)if(0===this.value.indexOf("rgb"))o<1&&(r="rgba");else{if(0!==this.value.indexOf("hsl"))return this.value;r=o<1?"hsla":"hsl"}else o<1&&(r="rgba");switch(r){case"rgba":a=this.rgb.map(function(t){return i(Math.round(t),255)}).concat(i(o,1));break;case"hsla":a.push(i(o,1));case"hsl":n=this.toHSL(),a=[this.fround(t,n.h),this.fround(t,100*n.s)+"%",this.fround(t,100*n.l)+"%"].concat(a)}if(r)return r+"("+a.join(","+(s?"":" "))+")";if(n=this.toRGB(),s){var l=n.split("");l[1]===l[2]&&l[3]===l[4]&&l[5]===l[6]&&(n="#"+l[1]+l[3]+l[5])}return n},s.prototype.operate=function(t,e,i){for(var n=new Array(3),o=this.alpha*(1-i.alpha)+i.alpha,r=0;r<3;r++)n[r]=this._operate(t,e,this.rgb[r],i.rgb[r]);return new s(n,o)},s.prototype.toRGB=function(){return n(this.rgb)},s.prototype.toHSL=function(){var t,e,i=this.rgb[0]/255,n=this.rgb[1]/255,o=this.rgb[2]/255,r=this.alpha,s=Math.max(i,n,o),a=Math.min(i,n,o),l=(s+a)/2,c=s-a;if(s===a)t=e=0;else{switch(e=l>.5?c/(2-s-a):c/(s+a),s){case i:t=(n-o)/c+(n<o?6:0);break;case n:t=(o-i)/c+2;break;case o:t=(i-n)/c+4}t/=6}return{h:360*t,s:e,l:l,a:r}},s.prototype.toHSV=function(){var t,e,i=this.rgb[0]/255,n=this.rgb[1]/255,o=this.rgb[2]/255,r=this.alpha,s=Math.max(i,n,o),a=Math.min(i,n,o),l=s,c=s-a;if(e=0===s?0:c/s,s===a)t=0;else{switch(s){case i:t=(n-o)/c+(n<o?6:0);break;case n:t=(o-i)/c+2;break;case o:t=(i-n)/c+4}t/=6}return{h:360*t,s:e,v:l,a:r}},s.prototype.toARGB=function(){return n([255*this.alpha].concat(this.rgb))},s.prototype.compare=function(t){return t.rgb&&t.rgb[0]===this.rgb[0]&&t.rgb[1]===this.rgb[1]&&t.rgb[2]===this.rgb[2]&&t.alpha===this.alpha?0:void 0},s.fromKeyword=function(t){var e,i=t.toLowerCase();if(r.hasOwnProperty(i)?e=new s(r[i].slice(1)):"transparent"===i&&(e=new s([0,0,0],0)),e)return e.value=t,e},e.exports=s},{"../data/colors":14,"./node":76}],56:[function(t,e){var i=t("./node"),n=function(t){" "===t?(this.value=" ",this.emptyOrWhitespace=!0):(this.value=t?t.trim():"",this.emptyOrWhitespace=""===this.value)};n.prototype=new i,n.prototype.type="Combinator";var o={"":!0," ":!0,"|":!0};n.prototype.genCSS=function(t,e){var i=t.compress||o[this.value]?"":" ";e.add(i+this.value+i)},e.exports=n},{"./node":76}],57:[function(t,e){var i=t("./node"),n=t("./debug-info"),o=function(t,e,i,n){this.value=t,this.isLineComment=e,this._index=i,this._fileInfo=n,this.allowRoot=!0};o.prototype=new i,o.prototype.type="Comment",o.prototype.genCSS=function(t,e){this.debugInfo&&e.add(n(t,this),this.fileInfo(),this.getIndex()),e.add(this.value)},o.prototype.isSilent=function(t){var e=t.compress&&"!"!==this.value[2];return this.isLineComment||e},e.exports=o},{"./debug-info":59,"./node":76}],58:[function(t,e){var i=t("./node"),n=function(t,e,i,n,o){this.op=t.trim(),this.lvalue=e,this.rvalue=i,this._index=n,this.negate=o};n.prototype=new i,n.prototype.type="Condition",n.prototype.accept=function(t){this.lvalue=t.visit(this.lvalue),this.rvalue=t.visit(this.rvalue)},n.prototype.eval=function(t){var e=function(t,e,n){switch(t){case"and":return e&&n;case"or":return e||n;default:switch(i.compare(e,n)){case-1:return"<"===t||"=<"===t||"<="===t;case 0:return"="===t||">="===t||"=<"===t||"<="===t;case 1:return">"===t||">="===t;default:return!1}}}(this.op,this.lvalue.eval(t),this.rvalue.eval(t));return this.negate?!e:e},e.exports=n},{"./node":76}],59:[function(t,e){var i=function(t,e,n){var o="";if(t.dumpLineNumbers&&!t.compress)switch(t.dumpLineNumbers){case"comments":o=i.asComment(e);break;case"mediaquery":o=i.asMediaQuery(e);break;case"all":o=i.asComment(e)+(n||"")+i.asMediaQuery(e)}return o};i.asComment=function(t){return"/* line "+t.debugInfo.lineNumber+", "+t.debugInfo.fileName+" */\n"},i.asMediaQuery=function(t){var e=t.debugInfo.fileName;return/^[a-z]+:\/\//i.test(e)||(e="file://"+e),"@media -sass-debug-info{filename{font-family:"+e.replace(/([.:\/\\])/g,function(t){return"\\"==t&&(t="/"),"\\"+t})+"}line{font-family:\\00003"+t.debugInfo.lineNumber+"}}\n"},e.exports=i},{}],60:[function(t,e,i){function n(t,e){var i,n="",o=e.length,r={add:function(t){n+=t}};for(i=0;i<o;i++)e[i].eval(t).genCSS(t,r);return n}var o=t("./node"),r=t("./value"),s=t("./keyword"),a=t("./anonymous"),l=t("../constants").Math,c=function(t,e,i,n,s,l,c,h){this.name=t,this.value=e instanceof o?e:new r([e?new a(e):null]),this.important=i?" "+i.trim():"",this.merge=n,this._index=s,this._fileInfo=l,this.inline=c||!1,this.variable=void 0!==h?h:t.charAt&&"@"===t.charAt(0),this.allowRoot=!0,this.setParent(this.value,this)};c.prototype=new o,c.prototype.type="Declaration",c.prototype.genCSS=function(t,e){e.add(this.name+(t.compress?":":": "),this.fileInfo(),this.getIndex());try{this.value.genCSS(t,e)}catch(i){throw i.index=this._index,i.filename=this._fileInfo.filename,i}e.add(this.important+(this.inline||t.lastRule&&t.compress?"":";"),this._fileInfo,this._index)},c.prototype.eval=function(t){var e,i,o=!1,r=this.name,a=this.variable;"string"!=typeof r&&(r=1===r.length&&r[0]instanceof s?r[0].value:n(t,r),a=!1),"font"===r&&t.math===l.ALWAYS&&(o=!0,e=t.math,t.math=l.PARENS_DIVISION);try{if(t.importantScope.push({}),i=this.value.eval(t),!this.variable&&"DetachedRuleset"===i.type)throw{message:"Rulesets cannot be evaluated on a property.",index:this.getIndex(),filename:this.fileInfo().filename};var h=this.important,u=t.importantScope.pop();return!h&&u.important&&(h=u.important),new c(r,i,h,this.merge,this.getIndex(),this.fileInfo(),this.inline,a)}catch(d){throw"number"!=typeof d.index&&(d.index=this.getIndex(),d.filename=this.fileInfo().filename),d}finally{o&&(t.math=e)}},c.prototype.makeImportant=function(){return new c(this.name,this.value,"!important",this.merge,this.getIndex(),this.fileInfo(),this.inline)},e.exports=c},{"../constants":12,"./anonymous":50,"./keyword":70,"./node":76,"./value":86}],61:[function(t,e){var i=t("./node"),n=t("../contexts"),o=t("../utils"),r=function(t,e){this.ruleset=t,this.frames=e,this.setParent(this.ruleset,this)};r.prototype=new i,r.prototype.type="DetachedRuleset",r.prototype.evalFirst=!0,r.prototype.accept=function(t){this.ruleset=t.visit(this.ruleset)},r.prototype.eval=function(t){var e=this.frames||o.copyArray(t.frames);return new r(this.ruleset,e)},r.prototype.callEval=function(t){return this.ruleset.eval(this.frames?new n.Eval(t,this.frames.concat(t.frames)):t)},e.exports=r},{"../contexts":13,"../utils":89,"./node":76}],62:[function(t,e){var i=t("./node"),n=t("../data/unit-conversions"),o=t("./unit"),r=t("./color"),s=function(t,e){if(this.value=parseFloat(t),isNaN(this.value))throw new Error("Dimension is not a number.");this.unit=e&&e instanceof o?e:new o(e?[e]:void 0),this.setParent(this.unit,this)};s.prototype=new i,s.prototype.type="Dimension",s.prototype.accept=function(t){this.unit=t.visit(this.unit)},s.prototype.eval=function(){return this},s.prototype.toColor=function(){return new r([this.value,this.value,this.value])},s.prototype.genCSS=function(t,e){if(t&&t.strictUnits&&!this.unit.isSingular())throw new Error("Multiple units in dimension. Correct the units or use the unit function. Bad unit: "+this.unit.toString());var i=this.fround(t,this.value),n=String(i);if(0!==i&&i<1e-6&&i>-1e-6&&(n=i.toFixed(20).replace(/0+$/,"")),t&&t.compress){if(0===i&&this.unit.isLength())return void e.add(n);i>0&&i<1&&(n=n.substr(1))}e.add(n),this.unit.genCSS(t,e)},s.prototype.operate=function(t,e,i){var n=this._operate(t,e,this.value,i.value),o=this.unit.clone();if("+"===e||"-"===e)if(0===o.numerator.length&&0===o.denominator.length)o=i.unit.clone(),this.unit.backupUnit&&(o.backupUnit=this.unit.backupUnit);else if(0===i.unit.numerator.length&&0===o.denominator.length);else{if(i=i.convertTo(this.unit.usedUnits()),t.strictUnits&&i.unit.toString()!==o.toString())throw new Error("Incompatible units. Change the units or use the unit function. Bad units: '"+o.toString()+"' and '"+i.unit.toString()+"'.");n=this._operate(t,e,this.value,i.value)}else"*"===e?(o.numerator=o.numerator.concat(i.unit.numerator).sort(),o.denominator=o.denominator.concat(i.unit.denominator).sort(),o.cancel()):"/"===e&&(o.numerator=o.numerator.concat(i.unit.denominator).sort(),o.denominator=o.denominator.concat(i.unit.numerator).sort(),o.cancel());return new s(n,o)},s.prototype.compare=function(t){var e,n;if(t instanceof s){if(this.unit.isEmpty()||t.unit.isEmpty())e=this,n=t;else if(e=this.unify(),n=t.unify(),0!==e.unit.compare(n.unit))return;return i.numericCompare(e.value,n.value)}},s.prototype.unify=function(){return this.convertTo({length:"px",duration:"s",angle:"rad"})},s.prototype.convertTo=function(t){var e,i,o,r,a,l=this.value,c=this.unit.clone(),h={};if("string"==typeof t){for(e in n)n[e].hasOwnProperty(t)&&((h={})[e]=t);t=h}for(i in a=function(t,e){return o.hasOwnProperty(t)?(e?l/=o[t]/o[r]:l*=o[t]/o[r],r):t},t)t.hasOwnProperty(i)&&(r=t[i],o=n[i],c.map(a));return c.cancel(),new s(l,c)},e.exports=s},{"../data/unit-conversions":16,"./color":55,"./node":76,"./unit":84}],63:[function(t,e){var i=t("./node"),n=t("./paren"),o=t("./combinator"),r=function(t,e,i,n,r,s){this.combinator=t instanceof o?t:new o(t),this.value="string"==typeof e?e.trim():e||"",this.isVariable=i,this._index=n,this._fileInfo=r,this.copyVisibilityInfo(s),this.setParent(this.combinator,this)};r.prototype=new i,r.prototype.type="Element",r.prototype.accept=function(t){var e=this.value;this.combinator=t.visit(this.combinator),"object"==typeof e&&(this.value=t.visit(e))},r.prototype.eval=function(t){return new r(this.combinator,this.value.eval?this.value.eval(t):this.value,this.isVariable,this.getIndex(),this.fileInfo(),this.visibilityInfo())},r.prototype.clone=function(){return new r(this.combinator,this.value,this.isVariable,this.getIndex(),this.fileInfo(),this.visibilityInfo())},r.prototype.genCSS=function(t,e){e.add(this.toCSS(t),this.fileInfo(),this.getIndex())},r.prototype.toCSS=function(t){t=t||{};var e=this.value,i=t.firstSelector;return e instanceof n&&(t.firstSelector=!0),e=e.toCSS?e.toCSS(t):e,t.firstSelector=i,""===e&&"&"===this.combinator.value.charAt(0)?"":this.combinator.toCSS(t)+e},e.exports=r},{"./combinator":56,"./node":76,"./paren":78}],64:[function(t,e){var i=t("./node"),n=t("./paren"),o=t("./comment"),r=t("./dimension"),s=t("../constants").Math,a=function(t,e){if(this.value=t,this.noSpacing=e,!t)throw new Error("Expression requires an array parameter")};a.prototype=new i,a.prototype.type="Expression",a.prototype.accept=function(t){this.value=t.visitArray(this.value)},a.prototype.eval=function(t){var e,i=t.isMathOn(),o=this.parens&&(t.math!==s.STRICT_LEGACY||!this.parensInOp),l=!1;return o&&t.inParenthesis(),this.value.length>1?e=new a(this.value.map(function(e){return e.eval?e.eval(t):e}),this.noSpacing):1===this.value.length?(!this.value[0].parens||this.value[0].parensInOp||t.inCalc||(l=!0),e=this.value[0].eval(t)):e=this,o&&t.outOfParenthesis(),!this.parens||!this.parensInOp||i||l||e instanceof r||(e=new n(e)),e},a.prototype.genCSS=function(t,e){for(var i=0;i<this.value.length;i++)this.value[i].genCSS(t,e),!this.noSpacing&&i+1<this.value.length&&e.add(" ")},a.prototype.throwAwayComments=function(){this.value=this.value.filter(function(t){return!(t instanceof o)})},e.exports=a},{"../constants":12,"./comment":57,"./dimension":62,"./node":76,"./paren":78}],65:[function(t,e){var i=t("./node"),n=t("./selector"),o=function r(t,e,i,n,o){switch(this.selector=t,this.option=e,this.object_id=r.next_id++,this.parent_ids=[this.object_id],this._index=i,this._fileInfo=n,this.copyVisibilityInfo(o),this.allowRoot=!0,e){case"all":this.allowBefore=!0,this.allowAfter=!0;break;default:this.allowBefore=!1,this.allowAfter=!1}this.setParent(this.selector,this)};o.next_id=0,o.prototype=new i,o.prototype.type="Extend",o.prototype.accept=function(t){this.selector=t.visit(this.selector)},o.prototype.eval=function(t){return new o(this.selector.eval(t),this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},o.prototype.clone=function(){return new o(this.selector,this.option,this.getIndex(),this.fileInfo(),this.visibilityInfo())},o.prototype.findSelfSelectors=function(t){var e,i,o=[];for(e=0;e<t.length;e++)i=t[e].elements,e>0&&i.length&&""===i[0].combinator.value&&(i[0].combinator.value=" "),o=o.concat(t[e].elements);this.selfSelectors=[new n(o)],this.selfSelectors[0].copyVisibilityInfo(this.visibilityInfo())},e.exports=o},{"./node":76,"./selector":82}],66:[function(t,e){var i=t("./node"),n=t("./media"),o=t("./url"),r=t("./quoted"),s=t("./ruleset"),a=t("./anonymous"),l=t("../utils"),c=t("../less-error"),h=function(t,e,i,n,o,r){if(this.options=i,this._index=n,this._fileInfo=o,this.path=t,this.features=e,this.allowRoot=!0,void 0!==this.options.less||this.options.inline)this.css=!this.options.less||this.options.inline;else{var s=this.getPath();s&&/[#\.\&\?]css([\?;].*)?$/.test(s)&&(this.css=!0)}this.copyVisibilityInfo(r),this.setParent(this.features,this),this.setParent(this.path,this)};h.prototype=new i,h.prototype.type="Import",h.prototype.accept=function(t){this.features&&(this.features=t.visit(this.features)),this.path=t.visit(this.path),this.options.isPlugin||this.options.inline||!this.root||(this.root=t.visit(this.root))},h.prototype.genCSS=function(t,e){this.css&&void 0===this.path._fileInfo.reference&&(e.add("@import ",this._fileInfo,this._index),this.path.genCSS(t,e),this.features&&(e.add(" "),this.features.genCSS(t,e)),e.add(";"))},h.prototype.getPath=function(){return this.path instanceof o?this.path.value.value:this.path.value},h.prototype.isVariableImport=function(){var t=this.path;return t instanceof o&&(t=t.value),!(t instanceof r)||t.containsVariables()},h.prototype.evalForImport=function(t){var e=this.path;return e instanceof o&&(e=e.value),new h(e.eval(t),this.features,this.options,this._index,this._fileInfo,this.visibilityInfo())},h.prototype.evalPath=function(t){var e=this.path.eval(t),i=this._fileInfo;if(!(e instanceof o)){var n=e.value;e.value=i&&n&&t.pathRequiresRewrite(n)?t.rewritePath(n,i.rootpath):t.normalizePath(e.value)}return e},h.prototype.eval=function(t){var e=this.doEval(t);return(this.options.reference||this.blocksVisibility())&&(e.length||0===e.length?e.forEach(function(t){t.addVisibilityBlock()}):e.addVisibilityBlock()),e},h.prototype.doEval=function(t){var e,i,r=this.features&&this.features.eval(t);if(this.options.isPlugin){if(this.root&&this.root.eval)try{this.root.eval(t)}catch(o){throw o.message="Plugin error during evaluation",new c(o,this.root.imports,this.root.filename)}return(i=t.frames[0]&&t.frames[0].functionRegistry)&&this.root&&this.root.functions&&i.addMultiple(this.root.functions),[]}if(this.skip&&("function"==typeof this.skip&&(this.skip=this.skip()),this.skip))return[];if(this.options.inline){var u=new a(this.root,0,{filename:this.importedFilename,reference:this.path._fileInfo&&this.path._fileInfo.reference},!0,!0);return this.features?new n([u],this.features.value):[u]}if(this.css){var d=new h(this.evalPath(t),r,this.options,this._index);if(!d.css&&this.error)throw this.error;return d}return(e=new s(null,l.copyArray(this.root.rules))).evalImports(t),this.features?new n(e.rules,this.features.value):e.rules},e.exports=h},{"../less-error":38,"../utils":89,"./anonymous":50,"./media":71,"./node":76,"./quoted":80,"./ruleset":81,"./url":85}],67:[function(t,e){var i=Object.create(null);i.Node=t("./node"),i.Color=t("./color"),i.AtRule=t("./atrule"),i.DetachedRuleset=t("./detached-ruleset"),i.Operation=t("./operation"),i.Dimension=t("./dimension"),i.Unit=t("./unit"),i.Keyword=t("./keyword"),i.Variable=t("./variable"),i.Property=t("./property"),i.Ruleset=t("./ruleset"),i.Element=t("./element"),i.Attribute=t("./attribute"),i.Combinator=t("./combinator"),i.Selector=t("./selector"),i.Quoted=t("./quoted"),i.Expression=t("./expression"),i.Declaration=t("./declaration"),i.Call=t("./call"),i.URL=t("./url"),i.Import=t("./import"),
i.mixin={Call:t("./mixin-call"),Definition:t("./mixin-definition")},i.Comment=t("./comment"),i.Anonymous=t("./anonymous"),i.Value=t("./value"),i.JavaScript=t("./javascript"),i.Assignment=t("./assignment"),i.Condition=t("./condition"),i.Paren=t("./paren"),i.Media=t("./media"),i.UnicodeDescriptor=t("./unicode-descriptor"),i.Negative=t("./negative"),i.Extend=t("./extend"),i.VariableCall=t("./variable-call"),i.NamespaceValue=t("./namespace-value"),e.exports=i},{"./anonymous":50,"./assignment":51,"./atrule":52,"./attribute":53,"./call":54,"./color":55,"./combinator":56,"./comment":57,"./condition":58,"./declaration":60,"./detached-ruleset":61,"./dimension":62,"./element":63,"./expression":64,"./extend":65,"./import":66,"./javascript":68,"./keyword":70,"./media":71,"./mixin-call":72,"./mixin-definition":73,"./namespace-value":74,"./negative":75,"./node":76,"./operation":77,"./paren":78,"./property":79,"./quoted":80,"./ruleset":81,"./selector":82,"./unicode-descriptor":83,"./unit":84,"./url":85,"./value":86,"./variable":88,"./variable-call":87}],68:[function(t,e){var i=t("./js-eval-node"),n=t("./dimension"),o=t("./quoted"),r=t("./anonymous"),s=function(t,e,i,n){this.escaped=e,this.expression=t,this._index=i,this._fileInfo=n};s.prototype=new i,s.prototype.type="JavaScript",s.prototype.eval=function(t){var e=this.evaluateJavaScript(this.expression,t),i=typeof e;return"number"!==i||isNaN(e)?"string"===i?new o('"'+e+'"',e,this.escaped,this._index):new r(Array.isArray(e)?e.join(", "):e):new n(e)},e.exports=s},{"./anonymous":50,"./dimension":62,"./js-eval-node":69,"./quoted":80}],69:[function(t,e){var i=t("./node"),n=t("./variable"),o=function(){};o.prototype=new i,o.prototype.evaluateJavaScript=function(t,e){var i,o=this,r={};if(!e.javascriptEnabled)throw{message:"Inline JavaScript is not enabled. Is it set in your options?",filename:this.fileInfo().filename,index:this.getIndex()};t=t.replace(/@\{([\w-]+)\}/g,function(t,i){return o.jsify(new n("@"+i,o.getIndex(),o.fileInfo()).eval(e))});try{t=new Function("return ("+t+")")}catch(l){throw{message:"JavaScript evaluation error: "+l.message+" from `"+t+"`",filename:this.fileInfo().filename,index:this.getIndex()}}var s=e.frames[0].variables();for(var a in s)s.hasOwnProperty(a)&&(r[a.slice(1)]={value:s[a].value,toJS:function(){return this.value.eval(e).toCSS()}});try{i=t.call(r)}catch(l){throw{message:"JavaScript evaluation error: '"+l.name+": "+l.message.replace(/["]/g,"'")+"'",filename:this.fileInfo().filename,index:this.getIndex()}}return i},o.prototype.jsify=function(t){return Array.isArray(t.value)&&t.value.length>1?"["+t.value.map(function(t){return t.toCSS()}).join(", ")+"]":t.toCSS()},e.exports=o},{"./node":76,"./variable":88}],70:[function(t,e){var i=t("./node"),n=function(t){this.value=t};n.prototype=new i,n.prototype.type="Keyword",n.prototype.genCSS=function(t,e){if("%"===this.value)throw{type:"Syntax",message:"Invalid % without number"};e.add(this.value)},n.True=new n("true"),n.False=new n("false"),e.exports=n},{"./node":76}],71:[function(t,e){var i=t("./ruleset"),n=t("./value"),o=t("./selector"),r=t("./anonymous"),s=t("./expression"),a=t("./atrule"),l=t("../utils"),c=function(t,e,r,s,a){this._index=r,this._fileInfo=s;var l=new o([],null,null,this._index,this._fileInfo).createEmptySelectors();this.features=new n(e),this.rules=[new i(l,t)],this.rules[0].allowImports=!0,this.copyVisibilityInfo(a),this.allowRoot=!0,this.setParent(l,this),this.setParent(this.features,this),this.setParent(this.rules,this)};c.prototype=new a,c.prototype.type="Media",c.prototype.isRulesetLike=function(){return!0},c.prototype.accept=function(t){this.features&&(this.features=t.visit(this.features)),this.rules&&(this.rules=t.visitArray(this.rules))},c.prototype.genCSS=function(t,e){e.add("@media ",this._fileInfo,this._index),this.features.genCSS(t,e),this.outputRuleset(t,e,this.rules)},c.prototype.eval=function(t){t.mediaBlocks||(t.mediaBlocks=[],t.mediaPath=[]);var e=new c(null,[],this._index,this._fileInfo,this.visibilityInfo());return this.debugInfo&&(this.rules[0].debugInfo=this.debugInfo,e.debugInfo=this.debugInfo),e.features=this.features.eval(t),t.mediaPath.push(e),t.mediaBlocks.push(e),this.rules[0].functionRegistry=t.frames[0].functionRegistry.inherit(),t.frames.unshift(this.rules[0]),e.rules=[this.rules[0].eval(t)],t.frames.shift(),t.mediaPath.pop(),0===t.mediaPath.length?e.evalTop(t):e.evalNested(t)},c.prototype.evalTop=function(t){var e=this;if(t.mediaBlocks.length>1){var n=new o([],null,null,this.getIndex(),this.fileInfo()).createEmptySelectors();(e=new i(n,t.mediaBlocks)).multiMedia=!0,e.copyVisibilityInfo(this.visibilityInfo()),this.setParent(e,this)}return delete t.mediaBlocks,delete t.mediaPath,e},c.prototype.evalNested=function(t){var e,o,a=t.mediaPath.concat([this]);for(e=0;e<a.length;e++)o=a[e].features instanceof n?a[e].features.value:a[e].features,a[e]=Array.isArray(o)?o:[o];return this.features=new n(this.permute(a).map(function(t){for(t=t.map(function(t){return t.toCSS?t:new r(t)}),e=t.length-1;e>0;e--)t.splice(e,0,new r("and"));return new s(t)})),this.setParent(this.features,this),new i([],[])},c.prototype.permute=function(t){if(0===t.length)return[];if(1===t.length)return t[0];for(var e=[],i=this.permute(t.slice(1)),n=0;n<i.length;n++)for(var o=0;o<t[0].length;o++)e.push([t[0][o]].concat(i[n]));return e},c.prototype.bubbleSelectors=function(t){t&&(this.rules=[new i(l.copyArray(t),[this.rules[0]])],this.setParent(this.rules,this))},e.exports=c},{"../utils":89,"./anonymous":50,"./atrule":52,"./expression":64,"./ruleset":81,"./selector":82,"./value":86}],72:[function(t,e){var i=t("./node"),n=t("./selector"),o=t("./mixin-definition"),r=t("../functions/default"),s=function(t,e,i,o,r){this.selector=new n(t),this.arguments=e||[],this._index=i,this._fileInfo=o,this.important=r,this.allowRoot=!0,this.setParent(this.selector,this)};s.prototype=new i,s.prototype.type="MixinCall",s.prototype.accept=function(t){this.selector&&(this.selector=t.visit(this.selector)),this.arguments.length&&(this.arguments=t.visitArray(this.arguments))},s.prototype.eval=function(t){function e(e,i){var n,o,s;for(n=0;n<2;n++){for(_[n]=!0,r.value(n),o=0;o<i.length&&_[n];o++)(s=i[o]).matchCondition&&(_[n]=_[n]&&s.matchCondition(null,t));e.matchCondition&&(_[n]=_[n]&&e.matchCondition(y,t))}return _[0]||_[1]?_[0]!=_[1]?_[1]?C:E:L:x}var i,n,s,a,l,c,h,u,d,p,f,g,m,v,b,y=[],S=[],k=!1,w=[],_=[],x=-1,L=0,C=1,E=2;for(this.selector=this.selector.eval(t),c=0;c<this.arguments.length;c++)if(l=(a=this.arguments[c]).value.eval(t),a.expand&&Array.isArray(l.value))for(l=l.value,h=0;h<l.length;h++)y.push({value:l[h]});else y.push({name:a.name,value:l});for(b=function(e){return e.matchArgs(null,t)},c=0;c<t.frames.length;c++)if((i=t.frames[c].find(this.selector,null,b)).length>0){for(p=!0,h=0;h<i.length;h++){for(n=i[h].rule,s=i[h].path,d=!1,u=0;u<t.frames.length;u++)if(!(n instanceof o)&&n===(t.frames[u].originalRuleset||t.frames[u])){d=!0;break}d||n.matchArgs(y,t)&&((f={mixin:n,group:e(n,s)}).group!==x&&w.push(f),k=!0)}for(r.reset(),m=[0,0,0],h=0;h<w.length;h++)m[w[h].group]++;if(m[L]>0)g=E;else if(g=C,m[C]+m[E]>1)throw{type:"Runtime",message:"Ambiguous use of `default()` found when matching for `"+this.format(y)+"`",index:this.getIndex(),filename:this.fileInfo().filename};for(h=0;h<w.length;h++)if((f=w[h].group)===L||f===g)try{(n=w[h].mixin)instanceof o||(v=n.originalRuleset||n,(n=new o("",[],n.rules,null,!1,null,v.visibilityInfo())).originalRuleset=v);var T=n.evalCall(t,y,this.important).rules;this._setVisibilityToReplacement(T),Array.prototype.push.apply(S,T)}catch(M){throw{message:M.message,index:this.getIndex(),filename:this.fileInfo().filename,stack:M.stack}}if(k)return S}throw p?{type:"Runtime",message:"No matching definition was found for `"+this.format(y)+"`",index:this.getIndex(),filename:this.fileInfo().filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.getIndex(),filename:this.fileInfo().filename}},s.prototype._setVisibilityToReplacement=function(t){var e;if(this.blocksVisibility())for(e=0;e<t.length;e++)t[e].addVisibilityBlock()},s.prototype.format=function(t){return this.selector.toCSS().trim()+"("+(t?t.map(function(t){var e="";return t.name&&(e+=t.name+":"),e+(t.value.toCSS?t.value.toCSS():"???")}).join(", "):"")+")"},e.exports=s},{"../functions/default":25,"./mixin-definition":73,"./node":76,"./selector":82}],73:[function(t,e){var i=t("./selector"),n=t("./element"),o=t("./ruleset"),r=t("./declaration"),s=t("./detached-ruleset"),a=t("./expression"),l=t("../contexts"),c=t("../utils"),h=function(t,e,o,r,s,a,l){this.name=t||"anonymous mixin",this.selectors=[new i([new n(null,t,!1,this._index,this._fileInfo)])],this.params=e,this.condition=r,this.variadic=s,this.arity=e.length,this.rules=o,this._lookups={};var c=[];this.required=e.reduce(function(t,e){return!e.name||e.name&&!e.value?t+1:(c.push(e.name),t)},0),this.optionalParameters=c,this.frames=a,this.copyVisibilityInfo(l),this.allowRoot=!0};h.prototype=new o,h.prototype.type="MixinDefinition",h.prototype.evalFirst=!0,h.prototype.accept=function(t){this.params&&this.params.length&&(this.params=t.visitArray(this.params)),this.rules=t.visitArray(this.rules),this.condition&&(this.condition=t.visit(this.condition))},h.prototype.evalParams=function(t,e,i,n){var h,u,d,p,f,g,m,v,b=new o(null,null),y=c.copyArray(this.params),S=0;if(e.frames&&e.frames[0]&&e.frames[0].functionRegistry&&(b.functionRegistry=e.frames[0].functionRegistry.inherit()),e=new l.Eval(e,[b].concat(e.frames)),i)for(S=(i=c.copyArray(i)).length,d=0;d<S;d++)if(g=(u=i[d])&&u.name){for(m=!1,p=0;p<y.length;p++)if(!n[p]&&g===y[p].name){n[p]=u.value.eval(t),b.prependRule(new r(g,u.value.eval(t))),m=!0;break}if(m){i.splice(d,1),d--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+i[d].name+" not found"}}for(v=0,d=0;d<y.length;d++)if(!n[d]){if(u=i&&i[v],g=y[d].name)if(y[d].variadic){for(h=[],p=v;p<S;p++)h.push(i[p].value.eval(t));b.prependRule(new r(g,new a(h).eval(t)))}else{if(f=u&&u.value)f=Array.isArray(f)?new s(new o("",f)):f.eval(t);else{if(!y[d].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+S+" for "+this.arity+")"};f=y[d].value.eval(e),b.resetCache()}b.prependRule(new r(g,f)),n[d]=f}if(y[d].variadic&&i)for(p=v;p<S;p++)n[p]=i[p].value.eval(t);v++}return b},h.prototype.makeImportant=function(){var t=this.rules?this.rules.map(function(t){return t.makeImportant?t.makeImportant(!0):t}):this.rules;return new h(this.name,this.params,t,this.condition,this.variadic,this.frames)},h.prototype.eval=function(t){return new h(this.name,this.params,this.rules,this.condition,this.variadic,this.frames||c.copyArray(t.frames))},h.prototype.evalCall=function(t,e,i){var n,s,h=[],u=this.frames?this.frames.concat(t.frames):t.frames,d=this.evalParams(t,new l.Eval(t,u),e,h);return d.prependRule(new r("@arguments",new a(h).eval(t))),n=c.copyArray(this.rules),(s=new o(null,n)).originalRuleset=this,s=s.eval(new l.Eval(t,[this,d].concat(u))),i&&(s=s.makeImportant()),s},h.prototype.matchCondition=function(t,e){return!(this.condition&&!this.condition.eval(new l.Eval(e,[this.evalParams(e,new l.Eval(e,this.frames?this.frames.concat(e.frames):e.frames),t,[])].concat(this.frames||[]).concat(e.frames))))},h.prototype.matchArgs=function(t,e){var i,n=t&&t.length||0,o=this.optionalParameters,r=t?t.reduce(function(t,e){return o.indexOf(e.name)<0?t+1:t},0):0;if(this.variadic){if(r<this.required-1)return!1}else{if(r<this.required)return!1;if(n>this.params.length)return!1}i=Math.min(r,this.arity);for(var s=0;s<i;s++)if(!this.params[s].name&&!this.params[s].variadic&&t[s].value.eval(e).toCSS()!=this.params[s].value.eval(e).toCSS())return!1;return!0},e.exports=h},{"../contexts":13,"../utils":89,"./declaration":60,"./detached-ruleset":61,"./element":63,"./expression":64,"./ruleset":81,"./selector":82}],74:[function(t,e){var i=t("./node"),n=t("./variable"),o=t("./ruleset"),r=t("./selector"),s=function(t,e,i,n,o){this.value=t,this.lookups=e,this.important=i,this._index=n,this._fileInfo=o};s.prototype=new i,s.prototype.type="NamespaceValue",s.prototype.eval=function(t){var e,i,s=this.value.eval(t);for(e=0;e<this.lookups.length;e++){if(i=this.lookups[e],Array.isArray(s)&&(s=new o([new r],s)),""===i)s=s.lastDeclaration();else if("@"===i.charAt(0)){if("@"===i.charAt(1)&&(i="@"+new n(i.substr(1)).eval(t).value),s.variables&&(s=s.variable(i)),!s)throw{type:"Name",message:"variable "+i+" not found",filename:this.fileInfo().filename,index:this.getIndex()}}else{if(i="$@"===i.substring(0,2)?"$"+new n(i.substr(1)).eval(t).value:"$"===i.charAt(0)?i:"$"+i,s.properties&&(s=s.property(i)),!s)throw{type:"Name",message:'property "'+i.substr(1)+'" not found',filename:this.fileInfo().filename,index:this.getIndex()};s=s[s.length-1]}s.value&&(s=s.eval(t).value),s.ruleset&&(s=s.ruleset.eval(t))}return s},e.exports=s},{"./node":76,"./ruleset":81,"./selector":82,"./variable":88}],75:[function(t,e){var i=t("./node"),n=t("./operation"),o=t("./dimension"),r=function(t){this.value=t};r.prototype=new i,r.prototype.type="Negative",r.prototype.genCSS=function(t,e){e.add("-"),this.value.genCSS(t,e)},r.prototype.eval=function(t){return t.isMathOn()?new n("*",[new o(-1),this.value]).eval(t):new r(this.value.eval(t))},e.exports=r},{"./dimension":62,"./node":76,"./operation":77}],76:[function(t,e){var i=function(){this.parent=null,this.visibilityBlocks=void 0,this.nodeVisible=void 0,this.rootNode=null,this.parsed=null;var t=this;Object.defineProperty(this,"currentFileInfo",{get:function(){return t.fileInfo()}}),Object.defineProperty(this,"index",{get:function(){return t.getIndex()}})};i.prototype.setParent=function(t,e){function n(t){t&&t instanceof i&&(t.parent=e)}Array.isArray(t)?t.forEach(n):n(t)},i.prototype.getIndex=function(){return this._index||this.parent&&this.parent.getIndex()||0},i.prototype.fileInfo=function(){return this._fileInfo||this.parent&&this.parent.fileInfo()||{}},i.prototype.isRulesetLike=function(){return!1},i.prototype.toCSS=function(t){var e=[];return this.genCSS(t,{add:function(t){e.push(t)},isEmpty:function(){return 0===e.length}}),e.join("")},i.prototype.genCSS=function(t,e){e.add(this.value)},i.prototype.accept=function(t){this.value=t.visit(this.value)},i.prototype.eval=function(){return this},i.prototype._operate=function(t,e,i,n){switch(e){case"+":return i+n;case"-":return i-n;case"*":return i*n;case"/":return i/n}},i.prototype.fround=function(t,e){var i=t&&t.numPrecision;return i?Number((e+2e-16).toFixed(i)):e},i.compare=function(t,e){if(t.compare&&"Quoted"!==e.type&&"Anonymous"!==e.type)return t.compare(e);if(e.compare)return-e.compare(t);if(t.type===e.type){if(t=t.value,e=e.value,!Array.isArray(t))return t===e?0:void 0;if(t.length===e.length){for(var n=0;n<t.length;n++)if(0!==i.compare(t[n],e[n]))return;return 0}}},i.numericCompare=function(t,e){return t<e?-1:t===e?0:t>e?1:void 0},i.prototype.blocksVisibility=function(){return null==this.visibilityBlocks&&(this.visibilityBlocks=0),0!==this.visibilityBlocks},i.prototype.addVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks+1},i.prototype.removeVisibilityBlock=function(){null==this.visibilityBlocks&&(this.visibilityBlocks=0),this.visibilityBlocks=this.visibilityBlocks-1},i.prototype.ensureVisibility=function(){this.nodeVisible=!0},i.prototype.ensureInvisibility=function(){this.nodeVisible=!1},i.prototype.isVisible=function(){return this.nodeVisible},i.prototype.visibilityInfo=function(){return{visibilityBlocks:this.visibilityBlocks,nodeVisible:this.nodeVisible}},i.prototype.copyVisibilityInfo=function(t){t&&(this.visibilityBlocks=t.visibilityBlocks,this.nodeVisible=t.nodeVisible)},e.exports=i},{}],77:[function(t,e){var i=t("./node"),n=t("./color"),o=t("./dimension"),r=t("../constants").Math,s=function(t,e,i){this.op=t.trim(),this.operands=e,this.isSpaced=i};s.prototype=new i,s.prototype.type="Operation",s.prototype.accept=function(t){this.operands=t.visit(this.operands)},s.prototype.eval=function(t){var e,i=this.operands[0].eval(t),a=this.operands[1].eval(t);if(t.isMathOn(this.op)){if(e="./"===this.op?"/":this.op,i instanceof o&&a instanceof n&&(i=i.toColor()),a instanceof o&&i instanceof n&&(a=a.toColor()),!i.operate){if(i instanceof s&&"/"===i.op&&t.math===r.PARENS_DIVISION)return new s(this.op,[i,a],this.isSpaced);throw{type:"Operation",message:"Operation on an invalid type"}}return i.operate(t,e,a)}return new s(this.op,[i,a],this.isSpaced)},s.prototype.genCSS=function(t,e){this.operands[0].genCSS(t,e),this.isSpaced&&e.add(" "),e.add(this.op),this.isSpaced&&e.add(" "),this.operands[1].genCSS(t,e)},e.exports=s},{"../constants":12,"./color":55,"./dimension":62,"./node":76}],78:[function(t,e){var i=t("./node"),n=function(t){this.value=t};n.prototype=new i,n.prototype.type="Paren",n.prototype.genCSS=function(t,e){e.add("("),this.value.genCSS(t,e),e.add(")")},n.prototype.eval=function(t){return new n(this.value.eval(t))},e.exports=n},{"./node":76}],79:[function(t,e){var i=t("./node"),n=t("./declaration"),o=function(t,e,i){this.name=t,this._index=e,this._fileInfo=i};o.prototype=new i,o.prototype.type="Property",o.prototype.eval=function(t){var e,i=this.name,o=t.pluginManager.less.visitors.ToCSSVisitor.prototype._mergeRules;if(this.evaluating)throw{type:"Name",message:"Recursive property reference for "+i,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,e=this.find(t.frames,function(e){var r,s=e.property(i);if(s){for(var a=0;a<s.length;a++)r=s[a],s[a]=new n(r.name,r.value,r.important,r.merge,r.index,r.currentFileInfo,r.inline,r.variable);if(o(s),(r=s[s.length-1]).important)t.importantScope[t.importantScope.length-1].important=r.important;return r.value.eval(t)}}))return this.evaluating=!1,e;throw{type:"Name",message:"Property '"+i+"' is undefined",filename:this.currentFileInfo.filename,index:this.index}},o.prototype.find=function(t,e){for(var i,n=0;n<t.length;n++)if(i=e.call(t,t[n]))return i;return null},e.exports=o},{"./declaration":60,"./node":76}],80:[function(t,e){var i=t("./node"),n=t("./variable"),o=t("./property"),r=function(t,e,i,n,o){this.escaped=null==i||i,this.value=e||"",this.quote=t.charAt(0),this._index=n,this._fileInfo=o,this.variableRegex=/@\{([\w-]+)\}/g,this.propRegex=/\$\{([\w-]+)\}/g};r.prototype=new i,r.prototype.type="Quoted",r.prototype.genCSS=function(t,e){this.escaped||e.add(this.quote,this.fileInfo(),this.getIndex()),e.add(this.value),this.escaped||e.add(this.quote)},r.prototype.containsVariables=function(){return this.value.match(this.variableRegex)},r.prototype.eval=function(t){function e(t,e,i){var n=t;do{n=(t=n).replace(e,i)}while(t!==n);return n}var i=this,s=this.value,a=function(e,o){var s=new n("@"+o,i.getIndex(),i.fileInfo()).eval(t,!0);return s instanceof r?s.value:s.toCSS()},l=function(e,n){var s=new o("$"+n,i.getIndex(),i.fileInfo()).eval(t,!0);return s instanceof r?s.value:s.toCSS()};return s=e(s=e(s,this.variableRegex,a),this.propRegex,l),new r(this.quote+s+this.quote,s,this.escaped,this.getIndex(),this.fileInfo())},r.prototype.compare=function(t){return"Quoted"!==t.type||this.escaped||t.escaped?t.toCSS&&this.toCSS()===t.toCSS()?0:void 0:i.numericCompare(this.value,t.value)},e.exports=r},{"./node":76,"./property":79,"./variable":88}],81:[function(t,e){var i=t("./node"),n=t("./declaration"),o=t("./keyword"),r=t("./comment"),s=t("./paren"),a=t("./selector"),l=t("./element"),c=t("./anonymous"),h=t("../contexts"),u=t("../functions/function-registry"),d=t("../functions/default"),p=t("./debug-info"),f=t("../utils"),g=function(t,e,i,n){this.selectors=t,this.rules=e,this._lookups={},this._variables=null,this._properties=null,this.strictImports=i,this.copyVisibilityInfo(n),this.allowRoot=!0,this.setParent(this.selectors,this),this.setParent(this.rules,this)};g.prototype=new i,g.prototype.type="Ruleset",g.prototype.isRuleset=!0,g.prototype.isRulesetLike=function(){return!0},g.prototype.accept=function(t){this.paths?this.paths=t.visitArray(this.paths,!0):this.selectors&&(this.selectors=t.visitArray(this.selectors)),this.rules&&this.rules.length&&(this.rules=t.visitArray(this.rules))},g.prototype.eval=function(t){var e,o,r,s,a,l=!1;if(this.selectors&&(o=this.selectors.length)){for(e=new Array(o),d.error({type:"Syntax",message:"it is currently only allowed in parametric mixin guards,"}),s=0;s<o;s++){r=this.selectors[s].eval(t);for(var c=0;c<r.elements.length;c++)if(r.elements[c].isVariable){a=!0;break}e[s]=r,r.evaldCondition&&(l=!0)}if(a){var h=new Array(o);for(s=0;s<o;s++)r=e[s],h[s]=r.toCSS(t);this.parse.parseNode(h.join(","),["selectors"],e[0].getIndex(),e[0].fileInfo(),function(t,i){i&&(e=f.flattenArray(i))})}d.reset()}else l=!0;var p,m,v=this.rules?f.copyArray(this.rules):null,b=new g(e,v,this.strictImports,this.visibilityInfo());b.originalRuleset=this,b.root=this.root,b.firstRoot=this.firstRoot,b.allowImports=this.allowImports,this.debugInfo&&(b.debugInfo=this.debugInfo),l||(v.length=0),b.functionRegistry=function(t){for(var e,i=0,n=t.length;i!==n;++i)if(e=t[i].functionRegistry)return e;return u}(t.frames).inherit();var y=t.frames;y.unshift(b);var S=t.selectors;S||(t.selectors=S=[]),S.unshift(this.selectors),(b.root||b.allowImports||!b.strictImports)&&b.evalImports(t);var k=b.rules;for(s=0;p=k[s];s++)p.evalFirst&&(k[s]=p.eval(t));var w=t.mediaBlocks&&t.mediaBlocks.length||0;for(s=0;p=k[s];s++)"MixinCall"===p.type?(v=p.eval(t).filter(function(t){return!(t instanceof n&&t.variable&&b.variable(t.name))}),k.splice.apply(k,[s,1].concat(v)),s+=v.length-1,b.resetCache()):"VariableCall"===p.type&&(v=p.eval(t).rules.filter(function(t){return!(t instanceof n&&t.variable)}),k.splice.apply(k,[s,1].concat(v)),s+=v.length-1,b.resetCache());for(s=0;p=k[s];s++)p.evalFirst||(k[s]=p=p.eval?p.eval(t):p);for(s=0;p=k[s];s++)if(p instanceof g&&p.selectors&&1===p.selectors.length&&p.selectors[0]&&p.selectors[0].isJustParentSelector()){k.splice(s--,1);for(c=0;m=p.rules[c];c++)m instanceof i&&(m.copyVisibilityInfo(p.visibilityInfo()),m instanceof n&&m.variable||k.splice(++s,0,m))}if(y.shift(),S.shift(),t.mediaBlocks)for(s=w;s<t.mediaBlocks.length;s++)t.mediaBlocks[s].bubbleSelectors(e);return b},g.prototype.evalImports=function(t){var e,i,n=this.rules;if(n)for(e=0;e<n.length;e++)"Import"===n[e].type&&((i=n[e].eval(t))&&(i.length||0===i.length)?(n.splice.apply(n,[e,1].concat(i)),e+=i.length-1):n.splice(e,1,i),this.resetCache())},g.prototype.makeImportant=function(){return new g(this.selectors,this.rules.map(function(t){return t.makeImportant?t.makeImportant():t}),this.strictImports,this.visibilityInfo())},g.prototype.matchArgs=function(t){return!t||0===t.length},g.prototype.matchCondition=function(t,e){var i=this.selectors[this.selectors.length-1];return!(!i.evaldCondition||i.condition&&!i.condition.eval(new h.Eval(e,e.frames)))},g.prototype.resetCache=function(){this._rulesets=null,this._variables=null,this._properties=null,this._lookups={}},g.prototype.variables=function(){return this._variables||(this._variables=this.rules?this.rules.reduce(function(t,e){if(e instanceof n&&!0===e.variable&&(t[e.name]=e),"Import"===e.type&&e.root&&e.root.variables){var i=e.root.variables();for(var o in i)i.hasOwnProperty(o)&&(t[o]=e.root.variable(o))}return t},{}):{}),this._variables},g.prototype.properties=function(){return this._properties||(this._properties=this.rules?this.rules.reduce(function(t,e){if(e instanceof n&&!0!==e.variable){var i=1===e.name.length&&e.name[0]instanceof o?e.name[0].value:e.name;t["$"+i]?t["$"+i].push(e):t["$"+i]=[e]}return t},{}):{}),this._properties},g.prototype.variable=function(t){var e=this.variables()[t];if(e)return this.parseValue(e)},g.prototype.property=function(t){var e=this.properties()[t];if(e)return this.parseValue(e)},g.prototype.lastDeclaration=function(){for(var t=this.rules.length;t>0;t--){var e=this.rules[t-1];if(e instanceof n)return this.parseValue(e)}},g.prototype.parseValue=function(t){function e(t){return t.value instanceof c&&!t.parsed?("string"==typeof t.value.value?this.parse.parseNode(t.value.value,["value","important"],t.value.getIndex(),t.fileInfo(),function(e,i){e&&(t.parsed=!0),i&&(t.value=i[0],t.important=i[1]||"",t.parsed=!0)}):t.parsed=!0,t):t}var i=this;if(Array.isArray(t)){var n=[];return t.forEach(function(t){n.push(e.call(i,t))}),n}return e.call(i,t)},g.prototype.rulesets=function(){if(!this.rules)return[];var t,e,i=[],n=this.rules;for(t=0;e=n[t];t++)e.isRuleset&&i.push(e);return i},g.prototype.prependRule=function(t){var e=this.rules;e?e.unshift(t):this.rules=[t],this.setParent(t,this)},g.prototype.find=function(t,e,i){e=e||this;var n,o,r=[],s=t.toCSS();return s in this._lookups?this._lookups[s]:(this.rulesets().forEach(function(s){if(s!==e)for(var l=0;l<s.selectors.length;l++)if(n=t.match(s.selectors[l])){if(t.elements.length>n){if(!i||i(s)){o=s.find(new a(t.elements.slice(n)),e,i);for(var c=0;c<o.length;++c)o[c].path.push(s);Array.prototype.push.apply(r,o)}}else r.push({rule:s,path:[]});break}}),this._lookups[s]=r,r)},g.prototype.genCSS=function(t,e){var i,n,o,s,a,l=[],c=[];t.tabLevel=t.tabLevel||0,this.root||t.tabLevel++;var h,u=t.compress?"":Array(t.tabLevel+1).join("  "),d=t.compress?"":Array(t.tabLevel).join("  "),f=0,g=0;for(i=0;s=this.rules[i];i++)s instanceof r?(g===i&&g++,c.push(s)):s.isCharset&&s.isCharset()?(c.splice(f,0,s),f++,g++):"Import"===s.type?(c.splice(g,0,s),g++):c.push(s);if(c=l.concat(c),!this.root){(o=p(t,this,d))&&(e.add(o),e.add(d));var m,v=this.paths,b=v.length;for(h=t.compress?",":",\n"+d,i=0;i<b;i++)if(m=(a=v[i]).length)for(i>0&&e.add(h),t.firstSelector=!0,a[0].genCSS(t,e),t.firstSelector=!1,n=1;n<m;n++)a[n].genCSS(t,e);e.add((t.compress?"{":" {\n")+u)}for(i=0;s=c[i];i++){i+1===c.length&&(t.lastRule=!0);var y=t.lastRule;s.isRulesetLike(s)&&(t.lastRule=!1),s.genCSS?s.genCSS(t,e):s.value&&e.add(s.value.toString()),t.lastRule=y,!t.lastRule&&s.isVisible()?e.add(t.compress?"":"\n"+u):t.lastRule=!1}this.root||(e.add(t.compress?"}":"\n"+d+"}"),t.tabLevel--),e.isEmpty()||t.compress||!this.firstRoot||e.add("\n")},g.prototype.joinSelectors=function(t,e,i){for(var n=0;n<i.length;n++)this.joinSelector(t,e,i[n])},g.prototype.joinSelector=function(t,e,i){function n(t,e){var i,n;if(0===t.length)i=new s(t[0]);else{var o=new Array(t.length);for(n=0;n<t.length;n++)o[n]=new l(null,t[n],e.isVariable,e._index,e._fileInfo);i=new s(new a(o))}return i}function o(t,e){var i;return i=new l(null,t,e.isVariable,e._index,e._fileInfo),new a([i])}function r(t,e,i,n){var o,r,s;if(o=[],t.length>0?(r=(o=f.copyArray(t)).pop(),s=n.createDerived(f.copyArray(r.elements))):s=n.createDerived([]),e.length>0){var a=i.combinator,c=e[0].elements[0];a.emptyOrWhitespace&&!c.combinator.emptyOrWhitespace&&(a=c.combinator),s.elements.push(new l(a,c.value,i.isVariable,i._index,i._fileInfo)),s.elements=s.elements.concat(e[0].elements.slice(1))}if(0!==s.elements.length&&o.push(s),e.length>1){var h=e.slice(1);h=h.map(function(t){return t.createDerived(t.elements,[])}),o=o.concat(h)}return o}function c(t,e,i,n,o){var s;for(s=0;s<t.length;s++){var a=r(t[s],e,i,n);o.push(a)}return o}function h(t,e){var i,n;if(0!==t.length){if(0===e.length)return void e.push([new a(t)]);for(i=0;n=e[i];i++)n.length>0?n[n.length-1]=n[n.length-1].createDerived(n[n.length-1].elements.concat(t)):n.push(new a(t))}}function u(t,e,i){function d(t){var e;return t.value instanceof s?(e=t.value.value)instanceof a?e:null:null}var p,f,g,m,v,b,y,S,k,w,_=!1;for(m=[],v=[[]],p=0;S=i.elements[p];p++)if("&"!==S.value){var x=d(S);if(null!=x){h(m,v);var L,C=[],E=[];for(L=u(C,e,x),_=_||L,g=0;g<C.length;g++){c(v,[o(n(C[g],S),S)],S,i,E)}v=E,m=[]}else m.push(S)}else{for(_=!0,b=[],h(m,v),f=0;f<v.length;f++)if(y=v[f],0===e.length)y.length>0&&y[0].elements.push(new l(S.combinator,"",S.isVariable,S._index,S._fileInfo)),b.push(y);else for(g=0;g<e.length;g++){var T=r(y,e[g],S,i);b.push(T)}v=b,m=[]}for(h(m,v),p=0;p<v.length;p++)(k=v[p].length)>0&&(t.push(v[p]),w=v[p][k-1],v[p][k-1]=w.createDerived(w.elements,i.extendList));return _}function d(t,e){var i=e.createDerived(e.elements,e.extendList,e.evaldCondition);return i.copyVisibilityInfo(t),i}var p,g;if(!u(g=[],e,i))if(e.length>0)for(g=[],p=0;p<e.length;p++){var m=e[p].map(d.bind(this,i.visibilityInfo()));m.push(i),g.push(m)}else g=[[i]];for(p=0;p<g.length;p++)t.push(g[p])},e.exports=g},{"../contexts":13,"../functions/default":25,"../functions/function-registry":27,"../utils":89,"./anonymous":50,"./comment":57,"./debug-info":59,"./declaration":60,"./element":63,"./keyword":70,"./node":76,"./paren":78,"./selector":82}],82:[function(t,e){var i=t("./node"),n=t("./element"),o=t("../less-error"),r=function(t,e,i,n,o,r){this.extendList=e,this.condition=i,this.evaldCondition=!i,this._index=n,this._fileInfo=o,this.elements=this.getElements(t),this.mixinElements_=void 0,this.copyVisibilityInfo(r),this.setParent(this.elements,this)};r.prototype=new i,r.prototype.type="Selector",r.prototype.accept=function(t){this.elements&&(this.elements=t.visitArray(this.elements)),this.extendList&&(this.extendList=t.visitArray(this.extendList)),this.condition&&(this.condition=t.visit(this.condition))},r.prototype.createDerived=function(t,e,i){t=this.getElements(t);var n=new r(t,e||this.extendList,null,this.getIndex(),this.fileInfo(),this.visibilityInfo());return n.evaldCondition=null!=i?i:this.evaldCondition,n.mediaEmpty=this.mediaEmpty,n},r.prototype.getElements=function(t){return t?("string"==typeof t&&this.parse.parseNode(t,["selector"],this._index,this._fileInfo,function(e,i){if(e)throw new o({index:e.index,message:e.message},this.parse.imports,this._fileInfo.filename);t=i[0].elements}),t):[new n("","&",!1,this._index,this._fileInfo)]},r.prototype.createEmptySelectors=function(){var t=new n("","&",!1,this._index,this._fileInfo),e=[new r([t],null,null,this._index,this._fileInfo)];return e[0].mediaEmpty=!0,e},r.prototype.match=function(t){var e,i,n=this.elements,o=n.length;if(0===(e=(t=t.mixinElements()).length)||o<e)return 0;for(i=0;i<e;i++)if(n[i].value!==t[i])return 0;return e},r.prototype.mixinElements=function(){if(this.mixinElements_)return this.mixinElements_;var t=this.elements.map(function(t){return t.combinator.value+(t.value.value||t.value)}).join("").match(/[,&#\*\.\w-]([\w-]|(\\.))*/g);return t?"&"===t[0]&&t.shift():t=[],this.mixinElements_=t},r.prototype.isJustParentSelector=function(){return!this.mediaEmpty&&1===this.elements.length&&"&"===this.elements[0].value&&(" "===this.elements[0].combinator.value||""===this.elements[0].combinator.value)},r.prototype.eval=function(t){var e=this.condition&&this.condition.eval(t),i=this.elements,n=this.extendList;return i=i&&i.map(function(e){return e.eval(t)}),n=n&&n.map(function(e){return e.eval(t)}),this.createDerived(i,n,e)},r.prototype.genCSS=function(t,e){var i;for(t&&t.firstSelector||""!==this.elements[0].combinator.value||e.add(" ",this.fileInfo(),this.getIndex()),i=0;i<this.elements.length;i++)this.elements[i].genCSS(t,e)},r.prototype.getIsOutput=function(){return this.evaldCondition},e.exports=r},{"../less-error":38,"./element":63,"./node":76}],83:[function(t,e){var i=t("./node"),n=function(t){this.value=t};n.prototype=new i,n.prototype.type="UnicodeDescriptor",e.exports=n},{"./node":76}],84:[function(t,e){var i=t("./node"),n=t("../data/unit-conversions"),o=t("../utils"),r=function(t,e,i){this.numerator=t?o.copyArray(t).sort():[],this.denominator=e?o.copyArray(e).sort():[],i?this.backupUnit=i:t&&t.length&&(this.backupUnit=t[0])};r.prototype=new i,r.prototype.type="Unit",r.prototype.clone=function(){return new r(o.copyArray(this.numerator),o.copyArray(this.denominator),this.backupUnit)},r.prototype.genCSS=function(t,e){var i=t&&t.strictUnits;1===this.numerator.length?e.add(this.numerator[0]):!i&&this.backupUnit?e.add(this.backupUnit):!i&&this.denominator.length&&e.add(this.denominator[0])},r.prototype.toString=function(){var t,e=this.numerator.join("*");for(t=0;t<this.denominator.length;t++)e+="/"+this.denominator[t];return e},r.prototype.compare=function(t){return this.is(t.toString())?0:void 0},r.prototype.is=function(t){return this.toString().toUpperCase()===t.toUpperCase()},r.prototype.isLength=function(){return RegExp("^(px|em|ex|ch|rem|in|cm|mm|pc|pt|ex|vw|vh|vmin|vmax)$","gi").test(this.toCSS())},r.prototype.isEmpty=function(){return 0===this.numerator.length&&0===this.denominator.length},r.prototype.isSingular=function(){return this.numerator.length<=1&&0===this.denominator.length},r.prototype.map=function(t){var e;for(e=0;e<this.numerator.length;e++)this.numerator[e]=t(this.numerator[e],!1);for(e=0;e<this.denominator.length;e++)this.denominator[e]=t(this.denominator[e],!0)},r.prototype.usedUnits=function(){var t,e,i,o={};for(i in e=function(e){
return t.hasOwnProperty(e)&&!o[i]&&(o[i]=e),e},n)n.hasOwnProperty(i)&&(t=n[i],this.map(e));return o},r.prototype.cancel=function(){var t,e,i={};for(e=0;e<this.numerator.length;e++)i[t=this.numerator[e]]=(i[t]||0)+1;for(e=0;e<this.denominator.length;e++)i[t=this.denominator[e]]=(i[t]||0)-1;for(t in this.numerator=[],this.denominator=[],i)if(i.hasOwnProperty(t)){var n=i[t];if(n>0)for(e=0;e<n;e++)this.numerator.push(t);else if(n<0)for(e=0;e<-n;e++)this.denominator.push(t)}this.numerator.sort(),this.denominator.sort()},e.exports=r},{"../data/unit-conversions":16,"../utils":89,"./node":76}],85:[function(t,e){function i(t){return t.replace(/[\(\)'"\s]/g,function(t){return"\\"+t})}var n=t("./node"),o=function(t,e,i,n){this.value=t,this._index=e,this._fileInfo=i,this.isEvald=n};o.prototype=new n,o.prototype.type="Url",o.prototype.accept=function(t){this.value=t.visit(this.value)},o.prototype.genCSS=function(t,e){e.add("url("),this.value.genCSS(t,e),e.add(")")},o.prototype.eval=function(t){var e,n=this.value.eval(t);if(!this.isEvald&&("string"==typeof(e=this.fileInfo()&&this.fileInfo().rootpath)&&"string"==typeof n.value&&t.pathRequiresRewrite(n.value)?(n.quote||(e=i(e)),n.value=t.rewritePath(n.value,e)):n.value=t.normalizePath(n.value),t.urlArgs&&!n.value.match(/^\s*data:/))){var r=(-1===n.value.indexOf("?")?"?":"&")+t.urlArgs;-1!==n.value.indexOf("#")?n.value=n.value.replace("#",r+"#"):n.value+=r}return new o(n,this.getIndex(),this.fileInfo(),!0)},e.exports=o},{"./node":76}],86:[function(t,e){var i=t("./node"),n=function(t){if(!t)throw new Error("Value requires an array argument");this.value=Array.isArray(t)?t:[t]};n.prototype=new i,n.prototype.type="Value",n.prototype.accept=function(t){this.value&&(this.value=t.visitArray(this.value))},n.prototype.eval=function(t){return 1===this.value.length?this.value[0].eval(t):new n(this.value.map(function(e){return e.eval(t)}))},n.prototype.genCSS=function(t,e){var i;for(i=0;i<this.value.length;i++)this.value[i].genCSS(t,e),i+1<this.value.length&&e.add(t&&t.compress?",":", ")},e.exports=n},{"./node":76}],87:[function(t,e){var i=t("./node"),n=t("./variable"),o=t("./ruleset"),r=t("./detached-ruleset"),s=t("../less-error"),a=function(t,e,i){this.variable=t,this._index=e,this._fileInfo=i,this.allowRoot=!0};a.prototype=new i,a.prototype.type="VariableCall",a.prototype.eval=function(t){var e,i=new n(this.variable,this.getIndex(),this.fileInfo()).eval(t),a=new s({message:"Could not evaluate variable call "+this.variable});if(!i.ruleset){if(Array.isArray(i))e=i;else{if(!Array.isArray(i.value))throw a;e=i.value}i=new r(new o("",e))}if(i.ruleset)return i.callEval(t);throw a},e.exports=a},{"../less-error":38,"./detached-ruleset":61,"./node":76,"./ruleset":81,"./variable":88}],88:[function(t,e){var i=t("./node"),n=t("./call"),o=function(t,e,i){this.name=t,this._index=e,this._fileInfo=i};o.prototype=new i,o.prototype.type="Variable",o.prototype.eval=function(t){var e,i=this.name;if(0===i.indexOf("@@")&&(i="@"+new o(i.slice(1),this.getIndex(),this.fileInfo()).eval(t).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+i,filename:this.fileInfo().filename,index:this.getIndex()};if(this.evaluating=!0,e=this.find(t.frames,function(e){var o=e.variable(i);if(o){if(o.important)t.importantScope[t.importantScope.length-1].important=o.important;return t.inCalc?new n("_SELF",[o.value]).eval(t):o.value.eval(t)}}))return this.evaluating=!1,e;throw{type:"Name",message:"variable "+i+" is undefined",filename:this.fileInfo().filename,index:this.getIndex()}},o.prototype.find=function(t,e){for(var i,n=0;n<t.length;n++)if(i=e.call(t,t[n]))return i;return null},e.exports=o},{"./call":54,"./node":76}],89:[function(t,e){var i=t("./constants"),n=t("clone"),o={getLocation:function(t,e){for(var i=t+1,n=null,o=-1;--i>=0&&"\n"!==e.charAt(i);)o++;return"number"==typeof t&&(n=(e.slice(0,t).match(/\n/g)||"").length),{line:n,column:o}},copyArray:function(t){var e,i=t.length,n=new Array(i);for(e=0;e<i;e++)n[e]=t[e];return n},clone:function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},copyOptions:function(t,e){if(e&&e._defaults)return e;var n=o.defaults(t,e);if(n.strictMath&&(n.math=i.Math.STRICT_LEGACY),n.relativeUrls&&(n.rewriteUrls=i.RewriteUrls.ALL),"string"==typeof n.math)switch(n.math.toLowerCase()){case"always":n.math=i.Math.ALWAYS;break;case"parens-division":n.math=i.Math.PARENS_DIVISION;break;case"strict":case"parens":n.math=i.Math.PARENS;break;case"strict-legacy":n.math=i.Math.STRICT_LEGACY}if("string"==typeof n.rewriteUrls)switch(n.rewriteUrls.toLowerCase()){case"off":n.rewriteUrls=i.RewriteUrls.OFF;break;case"local":n.rewriteUrls=i.RewriteUrls.LOCAL;break;case"all":n.rewriteUrls=i.RewriteUrls.ALL}return n},defaults:function(t,e){var i=e||{};if(!e._defaults){i={};var o=n(t);i._defaults=o;var r=e?n(e):{};Object.assign(i,o,r)}return i},merge:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},flattenArray:function(t,e){e=e||[];for(var i=0,n=t.length;i<n;i++){var r=t[i];Array.isArray(r)?o.flattenArray(r,e):void 0!==r&&e.push(r)}return e}};e.exports=o},{"./constants":12,clone:102}],90:[function(t,e){var i=t("../tree"),n=t("./visitor"),o=t("../logger"),r=t("../utils"),s=function(){this._visitor=new n(this),this.contexts=[],this.allExtendsStack=[[]]};s.prototype={run:function(t){return(t=this._visitor.visit(t)).allExtends=this.allExtendsStack[0],t},visitDeclaration:function(t,e){e.visitDeeper=!1},visitMixinDefinition:function(t,e){e.visitDeeper=!1},visitRuleset:function(t){if(!t.root){var e,n,o,s,a=[],l=t.rules,c=l?l.length:0;for(e=0;e<c;e++)t.rules[e]instanceof i.Extend&&(a.push(l[e]),t.extendOnEveryPath=!0);var h=t.paths;for(e=0;e<h.length;e++){var u=h[e],d=u[u.length-1].extendList;for((s=d?r.copyArray(d).concat(a):a)&&(s=s.map(function(t){return t.clone()})),n=0;n<s.length;n++)this.foundExtends=!0,(o=s[n]).findSelfSelectors(u),o.ruleset=t,0===n&&(o.firstExtendOnThisSelectorPath=!0),this.allExtendsStack[this.allExtendsStack.length-1].push(o)}this.contexts.push(t.selectors)}},visitRulesetOut:function(t){t.root||(this.contexts.length=this.contexts.length-1)},visitMedia:function(t){t.allExtends=[],this.allExtendsStack.push(t.allExtends)},visitMediaOut:function(){this.allExtendsStack.length=this.allExtendsStack.length-1},visitAtRule:function(t){t.allExtends=[],this.allExtendsStack.push(t.allExtends)},visitAtRuleOut:function(){this.allExtendsStack.length=this.allExtendsStack.length-1}};var a=function(){this._visitor=new n(this)};a.prototype={run:function(t){var e=new s;if(this.extendIndices={},e.run(t),!e.foundExtends)return t;t.allExtends=t.allExtends.concat(this.doExtendChaining(t.allExtends,t.allExtends)),this.allExtendsStack=[t.allExtends];var i=this._visitor.visit(t);return this.checkExtendsForNonMatched(t.allExtends),i},checkExtendsForNonMatched:function(t){var e=this.extendIndices;t.filter(function(t){return!t.hasFoundMatches&&1==t.parent_ids.length}).forEach(function(t){var n="_unknown_";try{n=t.selector.toCSS({})}catch(i){}e[t.index+" "+n]||(e[t.index+" "+n]=!0,o.warn("extend '"+n+"' has no matches"))})},doExtendChaining:function(t,e,n){var o,r,s,a,l,c,h,u,d=[],p=this;for(n=n||0,o=0;o<t.length;o++)for(r=0;r<e.length;r++)c=t[o],h=e[r],c.parent_ids.indexOf(h.object_id)>=0||(l=[h.selfSelectors[0]],(s=p.findMatch(c,l)).length&&(c.hasFoundMatches=!0,c.selfSelectors.forEach(function(t){var e=h.visibilityInfo();a=p.extendSelector(s,l,t,c.isVisible()),(u=new i.Extend(h.selector,h.option,0,h.fileInfo(),e)).selfSelectors=a,a[a.length-1].extendList=[u],d.push(u),u.ruleset=h.ruleset,u.parent_ids=u.parent_ids.concat(h.parent_ids,c.parent_ids),h.firstExtendOnThisSelectorPath&&(u.firstExtendOnThisSelectorPath=!0,h.ruleset.paths.push(a))})));if(d.length){if(this.extendChainCount++,n>100){var f="{unable to calculate}",g="{unable to calculate}";try{f=d[0].selfSelectors[0].toCSS(),g=d[0].selector.toCSS()}catch(m){}throw{message:"extend circular reference detected. One of the circular extends is currently:"+f+":extend("+g+")"}}return d.concat(p.doExtendChaining(d,e,n+1))}return d},visitDeclaration:function(t,e){e.visitDeeper=!1},visitMixinDefinition:function(t,e){e.visitDeeper=!1},visitSelector:function(t,e){e.visitDeeper=!1},visitRuleset:function(t){if(!t.root){var e,i,n,o,r=this.allExtendsStack[this.allExtendsStack.length-1],s=[],a=this;for(n=0;n<r.length;n++)for(i=0;i<t.paths.length;i++)if(o=t.paths[i],!t.extendOnEveryPath){var l=o[o.length-1].extendList;l&&l.length||(e=this.findMatch(r[n],o)).length&&(r[n].hasFoundMatches=!0,r[n].selfSelectors.forEach(function(t){var i;i=a.extendSelector(e,o,t,r[n].isVisible()),s.push(i)}))}t.paths=t.paths.concat(s)}},findMatch:function(t,e){var i,n,o,r,s,a,l,c=this,h=t.selector.elements,u=[],d=[];for(i=0;i<e.length;i++)for(n=e[i],o=0;o<n.elements.length;o++)for(r=n.elements[o],(t.allowBefore||0===i&&0===o)&&u.push({pathIndex:i,index:o,matched:0,initialCombinator:r.combinator}),a=0;a<u.length;a++)l=u[a],""===(s=r.combinator.value)&&0===o&&(s=" "),!c.isElementValuesEqual(h[l.matched].value,r.value)||l.matched>0&&h[l.matched].combinator.value!==s?l=null:l.matched++,l&&(l.finished=l.matched===h.length,l.finished&&!t.allowAfter&&(o+1<n.elements.length||i+1<e.length)&&(l=null)),l?l.finished&&(l.length=h.length,l.endPathIndex=i,l.endPathElementIndex=o+1,u.length=0,d.push(l)):(u.splice(a,1),a--);return d},isElementValuesEqual:function(t,e){if("string"==typeof t||"string"==typeof e)return t===e;if(t instanceof i.Attribute)return t.op===e.op&&t.key===e.key&&(t.value&&e.value?(t=t.value.value||t.value)===(e=e.value.value||e.value):!t.value&&!e.value);if(t=t.value,e=e.value,t instanceof i.Selector){if(!(e instanceof i.Selector)||t.elements.length!==e.elements.length)return!1;for(var n=0;n<t.elements.length;n++){if(t.elements[n].combinator.value!==e.elements[n].combinator.value&&(0!==n||(t.elements[n].combinator.value||" ")!==(e.elements[n].combinator.value||" ")))return!1;if(!this.isElementValuesEqual(t.elements[n].value,e.elements[n].value))return!1}return!0}return!1},extendSelector:function(t,e,n,o){var r,s,a,l,c,h=0,u=0,d=[];for(r=0;r<t.length;r++)s=e[(l=t[r]).pathIndex],a=new i.Element(l.initialCombinator,n.elements[0].value,n.elements[0].isVariable,n.elements[0].getIndex(),n.elements[0].fileInfo()),l.pathIndex>h&&u>0&&(d[d.length-1].elements=d[d.length-1].elements.concat(e[h].elements.slice(u)),u=0,h++),c=s.elements.slice(u,l.index).concat([a]).concat(n.elements.slice(1)),h===l.pathIndex&&r>0?d[d.length-1].elements=d[d.length-1].elements.concat(c):(d=d.concat(e.slice(h,l.pathIndex))).push(new i.Selector(c)),h=l.endPathIndex,(u=l.endPathElementIndex)>=e[h].elements.length&&(u=0,h++);return h<e.length&&u>0&&(d[d.length-1].elements=d[d.length-1].elements.concat(e[h].elements.slice(u)),h++),(d=d.concat(e.slice(h,e.length))).map(function(t){var e=t.createDerived(t.elements);return o?e.ensureVisibility():e.ensureInvisibility(),e})},visitMedia:function(t){var e=t.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);e=e.concat(this.doExtendChaining(e,t.allExtends)),this.allExtendsStack.push(e)},visitMediaOut:function(){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t},visitAtRule:function(t){var e=t.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);e=e.concat(this.doExtendChaining(e,t.allExtends)),this.allExtendsStack.push(e)},visitAtRuleOut:function(){var t=this.allExtendsStack.length-1;this.allExtendsStack.length=t}},e.exports=a},{"../logger":39,"../tree":67,"../utils":89,"./visitor":97}],91:[function(t,e){function i(t){this.imports=[],this.variableImports=[],this._onSequencerEmpty=t,this._currentDepth=0}i.prototype.addImport=function(t){var e=this,i={callback:t,args:null,isReady:!1};return this.imports.push(i),function(){i.args=Array.prototype.slice.call(arguments,0),i.isReady=!0,e.tryRun()}},i.prototype.addVariableImport=function(t){this.variableImports.push(t)},i.prototype.tryRun=function(){this._currentDepth++;try{for(;;){for(;this.imports.length>0;){var t=this.imports[0];if(!t.isReady)return;this.imports=this.imports.slice(1),t.callback.apply(null,t.args)}if(0===this.variableImports.length)break;var e=this.variableImports[0];this.variableImports=this.variableImports.slice(1),e()}}finally{this._currentDepth--}0===this._currentDepth&&this._onSequencerEmpty&&this._onSequencerEmpty()},e.exports=i},{}],92:[function(t,e){var i=t("../contexts"),n=t("./visitor"),o=t("./import-sequencer"),r=t("../utils"),s=function(t,e){this._visitor=new n(this),this._importer=t,this._finish=e,this.context=new i.Eval,this.importCount=0,this.onceFileDetectionMap={},this.recursionDetector={},this._sequencer=new o(this._onSequencerEmpty.bind(this))};s.prototype={isReplacing:!1,run:function(t){try{this._visitor.visit(t)}catch(e){this.error=e}this.isFinished=!0,this._sequencer.tryRun()},_onSequencerEmpty:function(){this.isFinished&&this._finish(this.error)},visitImport:function(t,e){var n=t.options.inline;if(!t.css||n){var o=new i.Eval(this.context,r.copyArray(this.context.frames)),s=o.frames[0];this.importCount++,t.isVariableImport()?this._sequencer.addVariableImport(this.processImportNode.bind(this,t,o,s)):this.processImportNode(t,o,s)}e.visitDeeper=!1},processImportNode:function(t,e,i){var n,r=t.options.inline;try{n=t.evalForImport(e)}catch(o){o.filename||(o.index=t.getIndex(),o.filename=t.fileInfo().filename),t.css=!0,t.error=o}if(!n||n.css&&!r)this.importCount--,this.isFinished&&this._sequencer.tryRun();else{n.options.multiple&&(e.importMultiple=!0);for(var s=void 0===n.css,a=0;a<i.rules.length;a++)if(i.rules[a]===t){i.rules[a]=n;break}var l=this.onImported.bind(this,n,e),c=this._sequencer.addImport(l);this._importer.push(n.getPath(),s,n.fileInfo(),n.options,c)}},onImported:function(t,e,i,n,o,r){i&&(i.filename||(i.index=t.getIndex(),i.filename=t.fileInfo().filename),this.error=i);var s=this,a=t.options.inline,l=t.options.isPlugin,c=t.options.optional,h=o||r in s.recursionDetector;if(e.importMultiple||(t.skip=!!h||function(){return r in s.onceFileDetectionMap||(s.onceFileDetectionMap[r]=!0,!1)}),!r&&c&&(t.skip=!0),n&&(t.root=n,t.importedFilename=r,!a&&!l&&(e.importMultiple||!h))){s.recursionDetector[r]=!0;var u=this.context;this.context=e;try{this._visitor.visit(n)}catch(i){this.error=i}this.context=u}s.importCount--,s.isFinished&&s._sequencer.tryRun()},visitDeclaration:function(t,e){"DetachedRuleset"===t.value.type?this.context.frames.unshift(t):e.visitDeeper=!1},visitDeclarationOut:function(t){"DetachedRuleset"===t.value.type&&this.context.frames.shift()},visitAtRule:function(t){this.context.frames.unshift(t)},visitAtRuleOut:function(){this.context.frames.shift()},visitMixinDefinition:function(t){this.context.frames.unshift(t)},visitMixinDefinitionOut:function(){this.context.frames.shift()},visitRuleset:function(t){this.context.frames.unshift(t)},visitRulesetOut:function(){this.context.frames.shift()},visitMedia:function(t){this.context.frames.unshift(t.rules[0])},visitMediaOut:function(){this.context.frames.shift()}},e.exports=s},{"../contexts":13,"../utils":89,"./import-sequencer":91,"./visitor":97}],93:[function(t,e){var i={Visitor:t("./visitor"),ImportVisitor:t("./import-visitor"),MarkVisibleSelectorsVisitor:t("./set-tree-visibility-visitor"),ExtendVisitor:t("./extend-visitor"),JoinSelectorVisitor:t("./join-selector-visitor"),ToCSSVisitor:t("./to-css-visitor")};e.exports=i},{"./extend-visitor":90,"./import-visitor":92,"./join-selector-visitor":94,"./set-tree-visibility-visitor":95,"./to-css-visitor":96,"./visitor":97}],94:[function(t,e){var i=t("./visitor"),n=function(){this.contexts=[[]],this._visitor=new i(this)};n.prototype={run:function(t){return this._visitor.visit(t)},visitDeclaration:function(t,e){e.visitDeeper=!1},visitMixinDefinition:function(t,e){e.visitDeeper=!1},visitRuleset:function(t){var e,i=this.contexts[this.contexts.length-1],n=[];this.contexts.push(n),t.root||((e=t.selectors)&&(e=e.filter(function(t){return t.getIsOutput()}),t.selectors=e.length?e:e=null,e&&t.joinSelectors(n,i,e)),e||(t.rules=null),t.paths=n)},visitRulesetOut:function(){this.contexts.length=this.contexts.length-1},visitMedia:function(t){var e=this.contexts[this.contexts.length-1];t.rules[0].root=0===e.length||e[0].multiMedia},visitAtRule:function(t){var e=this.contexts[this.contexts.length-1];t.rules&&t.rules.length&&(t.rules[0].root=t.isRooted||0===e.length||null)}},e.exports=n},{"./visitor":97}],95:[function(t,e){var i=function(t){this.visible=t};i.prototype.run=function(t){this.visit(t)},i.prototype.visitArray=function(t){if(!t)return t;var e,i=t.length;for(e=0;e<i;e++)this.visit(t[e]);return t},i.prototype.visit=function(t){return t?t.constructor===Array?this.visitArray(t):!t.blocksVisibility||t.blocksVisibility()?t:(this.visible?t.ensureVisibility():t.ensureInvisibility(),t.accept(this),t):t},e.exports=i},{}],96:[function(t,e){var i=t("../tree"),n=t("./visitor"),o=function(t){this._visitor=new n(this),this._context=t};o.prototype={containsSilentNonBlockedChild:function(t){var e;if(!t)return!1;for(var i=0;i<t.length;i++)if((e=t[i]).isSilent&&e.isSilent(this._context)&&!e.blocksVisibility())return!0;return!1},keepOnlyVisibleChilds:function(t){t&&t.rules&&(t.rules=t.rules.filter(function(t){return t.isVisible()}))},isEmpty:function(t){return!t||!t.rules||0===t.rules.length},hasVisibleSelector:function(t){return!(!t||!t.paths)&&t.paths.length>0},resolveVisibility:function(t,e){if(!t.blocksVisibility()){if(this.isEmpty(t)&&!this.containsSilentNonBlockedChild(e))return;return t}var i=t.rules[0];if(this.keepOnlyVisibleChilds(i),!this.isEmpty(i))return t.ensureVisibility(),t.removeVisibilityBlock(),t},isVisibleRuleset:function(t){return!!t.firstRoot||!this.isEmpty(t)&&!(!t.root&&!this.hasVisibleSelector(t))}};var r=function(t){this._visitor=new n(this),this._context=t,this.utils=new o(t)};r.prototype={isReplacing:!0,run:function(t){return this._visitor.visit(t)},visitDeclaration:function(t){if(!t.blocksVisibility()&&!t.variable)return t},visitMixinDefinition:function(t){t.frames=[]},visitExtend:function(){},visitComment:function(t){if(!t.blocksVisibility()&&!t.isSilent(this._context))return t},visitMedia:function(t,e){var i=t.rules[0].rules;return t.accept(this._visitor),e.visitDeeper=!1,this.utils.resolveVisibility(t,i)},visitImport:function(t){if(!t.blocksVisibility())return t},visitAtRule:function(t,e){return t.rules&&t.rules.length?this.visitAtRuleWithBody(t,e):this.visitAtRuleWithoutBody(t,e)},visitAnonymous:function(t){if(!t.blocksVisibility())return t.accept(this._visitor),t},visitAtRuleWithBody:function(t,e){function i(t){var e=t.rules;return 1===e.length&&(!e[0].paths||0===e[0].paths.length)}function n(t){var e=t.rules;return i(t)?e[0].rules:e}var o=n(t);return t.accept(this._visitor),e.visitDeeper=!1,this.utils.isEmpty(t)||this._mergeRules(t.rules[0].rules),this.utils.resolveVisibility(t,o)},visitAtRuleWithoutBody:function(t){if(!t.blocksVisibility()){if("@charset"===t.name){if(this.charset){if(t.debugInfo){var e=new i.Comment("/* "+t.toCSS(this._context).replace(/\n/g,"")+" */\n");return e.debugInfo=t.debugInfo,this._visitor.visit(e)}return}this.charset=!0}return t}},checkValidNodes:function(t,e){if(t)for(var n=0;n<t.length;n++){var o=t[n];if(e&&o instanceof i.Declaration&&!o.variable)throw{message:"Properties must be inside selector blocks. They cannot be in the root",index:o.getIndex(),filename:o.fileInfo()&&o.fileInfo().filename};if(o instanceof i.Call)throw{message:"Function '"+o.name+"' is undefined",index:o.getIndex(),filename:o.fileInfo()&&o.fileInfo().filename};if(o.type&&!o.allowRoot)throw{message:o.type+" node returned by a function is not valid here",index:o.getIndex(),filename:o.fileInfo()&&o.fileInfo().filename}}},visitRuleset:function(t,e){var i,n=[];if(this.checkValidNodes(t.rules,t.firstRoot),t.root)t.accept(this._visitor),e.visitDeeper=!1;else{this._compileRulesetPaths(t);for(var o=t.rules,r=o?o.length:0,s=0;s<r;)(i=o[s])&&i.rules?(n.push(this._visitor.visit(i)),o.splice(s,1),r--):s++;r>0?t.accept(this._visitor):t.rules=null,e.visitDeeper=!1}return t.rules&&(this._mergeRules(t.rules),this._removeDuplicateRules(t.rules)),this.utils.isVisibleRuleset(t)&&(t.ensureVisibility(),n.splice(0,0,t)),1===n.length?n[0]:n},_compileRulesetPaths:function(t){t.paths&&(t.paths=t.paths.filter(function(t){var e;for(" "===t[0].elements[0].combinator.value&&(t[0].elements[0].combinator=new i.Combinator("")),e=0;e<t.length;e++)if(t[e].isVisible()&&t[e].getIsOutput())return!0;return!1}))},_removeDuplicateRules:function(t){if(t){var e,n,o,r={};for(o=t.length-1;o>=0;o--)if((n=t[o])instanceof i.Declaration)if(r[n.name]){(e=r[n.name])instanceof i.Declaration&&(e=r[n.name]=[r[n.name].toCSS(this._context)]);var s=n.toCSS(this._context);-1!==e.indexOf(s)?t.splice(o,1):e.push(s)}else r[n.name]=n}},_mergeRules:function(t){if(t){for(var e={},n=[],o=0;o<t.length;o++){var r=t[o];if(r.merge){var s=r.name;e[s]?t.splice(o--,1):n.push(e[s]=[]),e[s].push(r)}}n.forEach(function(t){if(t.length>0){var e=t[0],n=[],o=[new i.Expression(n)];t.forEach(function(t){"+"===t.merge&&n.length>0&&o.push(new i.Expression(n=[])),n.push(t.value),e.important=e.important||t.important}),e.value=new i.Value(o)}})}}},e.exports=r},{"../tree":67,"./visitor":97}],97:[function(t,e){function i(t){return t}function n(t,e){var i,o;for(i in t)switch(o=t[i],typeof o){case"function":o.prototype&&o.prototype.type&&(o.prototype.typeIndex=e++);break;case"object":e=n(o,e)}return e}var o=t("../tree"),r={visitDeeper:!0},s=!1,a=function(t){this._implementation=t,this._visitInCache={},this._visitOutCache={},s||(n(o,1),s=!0)};a.prototype={visit:function(t){if(!t)return t;var e=t.typeIndex;if(!e)return t.value&&t.value.typeIndex&&this.visit(t.value),t;var n,o=this._implementation,s=this._visitInCache[e],a=this._visitOutCache[e],l=r;if(l.visitDeeper=!0,s||(s=o[n="visit"+t.type]||i,a=o[n+"Out"]||i,this._visitInCache[e]=s,this._visitOutCache[e]=a),s!==i){var c=s.call(o,t,l);t&&o.isReplacing&&(t=c)}return l.visitDeeper&&t&&t.accept&&t.accept(this),a!=i&&a.call(o,t),t},visitArray:function(t,e){if(!t)return t;var i,n=t.length;if(e||!this._implementation.isReplacing){for(i=0;i<n;i++)this.visit(t[i]);return t}var o=[];for(i=0;i<n;i++){var r=this.visit(t[i]);void 0!==r&&(r.splice?r.length&&this.flatten(r,o):o.push(r))}return o},flatten:function(t,e){var i,n,o,r,s,a;for(e||(e=[]),n=0,i=t.length;n<i;n++)if(void 0!==(o=t[n]))if(o.splice)for(s=0,r=o.length;s<r;s++)void 0!==(a=o[s])&&(a.splice?a.length&&this.flatten(a,e):e.push(a));else e.push(o);return e}},e.exports=a},{"../tree":67}],98:[function(t,e){"use strict";function i(){if(a.length)throw a.shift()}function n(t){var e;(e=s.length?s.pop():new o).task=t,r(e)}function o(){this.task=null}var r=t("./raw"),s=[],a=[],l=r.makeRequestCallFromTimer(i);e.exports=n,o.prototype.call=function(){try{this.task.call()}catch(t){n.onerror?n.onerror(t):(a.push(t),l())}finally{this.task=null,s[s.length]=this}}},{"./raw":99}],99:[function(t,e){(function(t){"use strict";function i(t){a.length||(s(),!0),a[a.length]=t}function n(){for(;l<a.length;){var t=l;if(l+=1,a[t].call(),l>c){for(var e=0,i=a.length-l;e<i;e++)a[e]=a[e+l];a.length-=l,l=0}}a.length=0,l=0,!1}function o(t){var e=1,i=new u(t),n=document.createTextNode("");return i.observe(n,{characterData:!0}),function(){e=-e,n.data=e}}function r(t){return function(){function e(){clearTimeout(i),clearInterval(n),t()}var i=setTimeout(e,0),n=setInterval(e,50)}}e.exports=i;var s,a=[],l=0,c=1024,h=void 0!==t?t:self,u=h.MutationObserver||h.WebKitMutationObserver;s="function"==typeof u?o(n):r(n),i.requestFlush=s,i.makeRequestCallFromTimer=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],100:[function(t,e,i){"use strict";function n(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function o(t){return 3*t.length/4-n(t)}function r(t){var e,i,o,r,s,a=t.length;r=n(t),s=new u(3*a/4-r),i=r>0?a-4:a;var l=0;for(e=0;e<i;e+=4)o=h[t.charCodeAt(e)]<<18|h[t.charCodeAt(e+1)]<<12|h[t.charCodeAt(e+2)]<<6|h[t.charCodeAt(e+3)],s[l++]=o>>16&255,s[l++]=o>>8&255,s[l++]=255&o;return 2===r?(o=h[t.charCodeAt(e)]<<2|h[t.charCodeAt(e+1)]>>4,s[l++]=255&o):1===r&&(o=h[t.charCodeAt(e)]<<10|h[t.charCodeAt(e+1)]<<4|h[t.charCodeAt(e+2)]>>2,s[l++]=o>>8&255,s[l++]=255&o),s}function s(t){return c[t>>18&63]+c[t>>12&63]+c[t>>6&63]+c[63&t]}function a(t,e,i){for(var n,o=[],r=e;r<i;r+=3)n=(t[r]<<16)+(t[r+1]<<8)+t[r+2],o.push(s(n));return o.join("")}function l(t){for(var e,i=t.length,n=i%3,o="",r=[],s=16383,l=0,h=i-n;l<h;l+=s)r.push(a(t,l,l+s>h?h:l+s));return 1===n?(e=t[i-1],o+=c[e>>2],o+=c[e<<4&63],o+="=="):2===n&&(e=(t[i-2]<<8)+t[i-1],o+=c[e>>10],o+=c[e>>4&63],o+=c[e<<2&63],o+="="),r.push(o),r.join("")}i.byteLength=o,i.toByteArray=r,i.fromByteArray=l;for(var c=[],h=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,f=d.length;p<f;++p)c[p]=d[p],h[d.charCodeAt(p)]=p;h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},{}],101:[function(t,e,i){"use strict";function n(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}function o(t){if(t>Z)throw new RangeError("Invalid typed array length");var e=new Uint8Array(t);return e.__proto__=r.prototype,e}function r(t,e,i){if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(t)}return s(t,e,i)}function s(t,e,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return G(t)?d(t,e,i):"string"==typeof t?h(t,e):p(t)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e,i){return a(t),t<=0?o(t):void 0!==e?"string"==typeof i?o(t).fill(e,i):o(t).fill(e):o(t)}function c(t){return a(t),o(t<0?0:0|f(t))}function h(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!r.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(t,e),n=o(i),s=n.write(t,e);return s!==i&&(n=n.slice(0,s)),n}function u(t){for(var e=t.length<0?0:0|f(t.length),i=o(e),n=0;n<e;n+=1)i[n]=255&t[n];return i}function d(t,e,i){if(e<0||t.byteLength<e)throw new RangeError("'offset' is out of bounds");if(t.byteLength<e+(i||0))throw new RangeError("'length' is out of bounds");var n;return(n=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i)).__proto__=r.prototype,n}function p(t){if(r.isBuffer(t)){var e=0|f(t.length),i=o(e);return 0===i.length?i:(t.copy(i,0,0,e),i)}if(t){if(q(t)||"length"in t)return"number"!=typeof t.length||K(t.length)?o(0):u(t);if("Buffer"===t.type&&Array.isArray(t.data))return u(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function f(t){if(t>=Z)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Z.toString(16)+" bytes");return 0|t}function g(t){return+t!=t&&(t=0),r.alloc(+t)}function m(t,e){if(r.isBuffer(t))return t.length;if(q(t)||G(t))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return W(t).length;default:if(n)return $(t).length;e=(""+e).toLowerCase(),n=!0}}function v(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,i);case"utf8":case"utf-8":return T(this,e,i);case"ascii":return A(this,e,i);case"latin1":case"binary":return I(this,e,i);case"base64":return E(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function y(t,e,i,n,o){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),K(i=+i)&&(i=o?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(o)return-1;i=t.length-1}else if(i<0){if(!o)return-1;i=0}if("string"==typeof e&&(e=r.from(e,n)),r.isBuffer(e))return 0===e.length?-1:S(t,e,i,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):S(t,[e],i,n,o);throw new TypeError("val must be string, number or Buffer")}function S(t,e,i,n,o){function r(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}var s,a=1,l=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,l/=2,c/=2,i/=2}if(o){var h=-1;for(s=i;s<l;s++)if(r(t,s)===r(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===c)return h*a}else-1!==h&&(s-=s-h),h=-1}else for(i+c>l&&(i=l-c),s=i;s>=0;s--){for(var u=!0,d=0;d<c;d++)if(r(t,s+d)!==r(e,d)){u=!1;break}if(u)return s}return-1}function k(t,e,i,n){i=Number(i)||0;var o=t.length-i;n?(n=Number(n))>o&&(n=o):n=o;var r=e.length;if(r%2!=0)throw new TypeError("Invalid hex string");n>r/2&&(n=r/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(K(a))return s;t[i+s]=a}return s}function w(t,e,i,n){return j($(e,t.length-i),t,i,n)}function _(t,e,i,n){return j(H(e),t,i,n)}function x(t,e,i,n){return _(t,e,i,n)}function L(t,e,i,n){return j(W(e),t,i,n)}function C(t,e,i,n){return j(U(e,t.length-i),t,i,n)}function E(t,e,i){return X.fromByteArray(0===e&&i===t.length?t:t.slice(e,i))}function T(t,e,i){i=Math.min(t.length,i);for(var n=[],o=e;o<i;){var r,s,a,l,c=t[o],h=null,u=c>239?4:c>223?3:c>191?2:1;if(o+u<=i)switch(u){case 1:c<128&&(h=c);break;case 2:128==(192&(r=t[o+1]))&&((l=(31&c)<<6|63&r)>127&&(h=l));break;case 3:r=t[o+1],s=t[o+2],128==(192&r)&&128==(192&s)&&((l=(15&c)<<12|(63&r)<<6|63&s)>2047&&(l<55296||l>57343)&&(h=l));break;case 4:r=t[o+1],s=t[o+2],a=t[o+3],128==(192&r)&&128==(192&s)&&128==(192&a)&&((l=(15&c)<<18|(63&r)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(h=l))}null===h?(h=65533,u=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),o+=u}return M(n)}function M(t){var e=t.length;if(e<=J)return String.fromCharCode.apply(String,t);for(var i="",n=0;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=J));return i}function A(t,e,i){var n="";i=Math.min(t.length,i);for(var o=e;o<i;++o)n+=String.fromCharCode(127&t[o]);return n}function I(t,e,i){var n="";i=Math.min(t.length,i);for(var o=e;o<i;++o)n+=String.fromCharCode(t[o]);return n}function O(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var o="",r=e;r<i;++r)o+=F(t[r]);return o}function R(t,e,i){for(var n=t.slice(e,i),o="",r=0;r<n.length;r+=2)o+=String.fromCharCode(n[r]+256*n[r+1]);return o}function D(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,i,n,o,s){if(!r.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function P(t,e,i,n){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function N(t,e,i,n,o){return e=+e,i>>>=0,o||P(t,e,i,4,3.4028234663852886e38,-3.4028234663852886e38),Y.write(t,e,i,n,23,4),i+4}function z(t,e,i,n,o){return e=+e,i>>>=0,o||P(t,e,i,8,1.7976931348623157e308,-1.7976931348623157e308),Y.write(t,e,i,n,52,8),i+8}function V(t){if((t=t.trim().replace(Q,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,e){e=e||1/0;for(var i,n=t.length,o=null,r=[],s=0;s<n;++s){if((i=t.charCodeAt(s))>55295&&i<57344){if(!o){if(i>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&r.push(239,191,189);continue}o=i;continue}if(i<56320){(e-=3)>-1&&r.push(239,191,189),o=i;continue}i=65536+(o-55296<<10|i-56320)}else o&&(e-=3)>-1&&r.push(239,191,189);if(o=null,i<128){if((e-=1)<0)break;r.push(i)}else if(i<2048){if((e-=2)<0)break;r.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;r.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return r}function H(t){
for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}function U(t,e){for(var i,n,o,r=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(i=t.charCodeAt(s))>>8,o=i%256,r.push(o),r.push(n);return r}function W(t){return X.toByteArray(V(t))}function j(t,e,i,n){for(var o=0;o<n&&!(o+i>=e.length||o>=t.length);++o)e[o+i]=t[o];return o}function G(t){return t instanceof ArrayBuffer||null!=t&&null!=t.constructor&&"ArrayBuffer"===t.constructor.name&&"number"==typeof t.byteLength}function q(t){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(t)}function K(t){return t!=t}var X=t("base64-js"),Y=t("ieee754");i.Buffer=r,i.SlowBuffer=g,i.INSPECT_MAX_BYTES=50;var Z=2147483647;i.kMaxLength=Z,r.TYPED_ARRAY_SUPPORT=n(),r.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(t,e,i){return s(t,e,i)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(t,e,i){return l(t,e,i)},r.allocUnsafe=function(t){return c(t)},r.allocUnsafeSlow=function(t){return c(t)},r.isBuffer=function(t){return null!=t&&!0===t._isBuffer},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,o=0,s=Math.min(i,n);o<s;++o)if(t[o]!==e[o]){i=t[o],n=e[o];break}return i<n?-1:n<i?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return r.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=r.allocUnsafe(e),o=0;for(i=0;i<t.length;++i){var s=t[i];if(!r.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},r.byteLength=m,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},r.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},r.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},r.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?T(this,0,t):v.apply(this,arguments)},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=i.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t,e,i,n,o){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||i>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=i)return 0;if(n>=o)return-1;if(e>=i)return 1;if(this===t)return 0;for(var s=(o>>>=0)-(n>>>=0),a=(i>>>=0)-(e>>>=0),l=Math.min(s,a),c=this.slice(n,o),h=t.slice(e,i),u=0;u<l;++u)if(c[u]!==h[u]){s=c[u],a=h[u];break}return s<a?-1:a<s?1:0},r.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},r.prototype.indexOf=function(t,e,i){return y(this,t,e,i,!0)},r.prototype.lastIndexOf=function(t,e,i){return y(this,t,e,i,!1)},r.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var o=this.length-e;if((void 0===i||i>o)&&(i=o),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var r=!1;;)switch(n){case"hex":return k(this,t,e,i);case"utf8":case"utf-8":return w(this,t,e,i);case"ascii":return _(this,t,e,i);case"latin1":case"binary":return x(this,t,e,i);case"base64":return L(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,i);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),r=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var J=4096;r.prototype.slice=function(t,e){var i=this.length;(t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);var n=this.subarray(t,e);return n.__proto__=r.prototype,n},r.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);for(var n=this[t],o=1,r=0;++r<e&&(o*=256);)n+=this[t+r]*o;return n},r.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},r.prototype.readUInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);for(var n=this[t],o=1,r=0;++r<e&&(o*=256);)n+=this[t+r]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},r.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||D(t,e,this.length);for(var n=e,o=1,r=this[t+--n];n>0&&(o*=256);)r+=this[t+--n]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},r.prototype.readInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,e){t>>>=0,e||D(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt16BE=function(t,e){t>>>=0,e||D(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return t>>>=0,e||D(t,4,this.length),Y.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return t>>>=0,e||D(t,4,this.length),Y.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return t>>>=0,e||D(t,8,this.length),Y.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return t>>>=0,e||D(t,8,this.length),Y.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e>>>=0,i>>>=0,n)||B(this,t,e,i,Math.pow(2,8*i)-1,0);var o=1,r=0;for(this[e]=255&t;++r<i&&(o*=256);)this[e+r]=t/o&255;return e+i},r.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e>>>=0,i>>>=0,n)||B(this,t,e,i,Math.pow(2,8*i)-1,0);var o=i-1,r=1;for(this[e+o]=255&t;--o>=0&&(r*=256);)this[e+o]=t/r&255;return e+i},r.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,1,255,0),this[e]=255&t,e+1},r.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},r.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},r.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},r.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},r.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*i-1);B(this,t,e,i,o-1,-o)}var r=0,s=1,a=0;for(this[e]=255&t;++r<i&&(s*=256);)t<0&&0===a&&0!==this[e+r-1]&&(a=1),this[e+r]=(t/s>>0)-a&255;return e+i},r.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*i-1);B(this,t,e,i,o-1,-o)}var r=i-1,s=1,a=0;for(this[e+r]=255&t;--r>=0&&(s*=256);)t<0&&0===a&&0!==this[e+r+1]&&(a=1),this[e+r]=(t/s>>0)-a&255;return e+i},r.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},r.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},r.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},r.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},r.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},r.prototype.writeFloatLE=function(t,e,i){return N(this,t,e,!0,i)},r.prototype.writeFloatBE=function(t,e,i){return N(this,t,e,!1,i)},r.prototype.writeDoubleLE=function(t,e,i){return z(this,t,e,!0,i)},r.prototype.writeDoubleBE=function(t,e,i){return z(this,t,e,!1,i)},r.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var o,r=n-i;if(this===t&&i<e&&e<n)for(o=r-1;o>=0;--o)t[o+e]=this[o+i];else if(r<1e3)for(o=0;o<r;++o)t[o+e]=this[o+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+r),e);return r},r.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!r.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var s;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(s=e;s<i;++s)this[s]=t;else{var a=r.isBuffer(t)?t:new r(t,n),l=a.length;for(s=0;s<i-e;++s)this[s+e]=a[s%l]}return this};var Q=/[^+\/0-9A-Za-z-_]/g},{"base64-js":100,ieee754:103}],102:[function(t,e){(function(t){var i=function(){"use strict";function e(t,e){return null!=e&&t instanceof e}function i(n,o,r,s,u){function d(n,r){if(null===n)return null;if(0===r)return n;var m,v;if("object"!=typeof n)return n;if(e(n,l))m=new l;else if(e(n,c))m=new c;else if(e(n,h))m=new h(function(t,e){n.then(function(e){t(d(e,r-1))},function(t){e(d(t,r-1))})});else if(i.__isArray(n))m=[];else if(i.__isRegExp(n))m=new RegExp(n.source,a(n)),n.lastIndex&&(m.lastIndex=n.lastIndex);else if(i.__isDate(n))m=new Date(n.getTime());else{if(g&&t.isBuffer(n))return m=t.allocUnsafe?t.allocUnsafe(n.length):new t(n.length),n.copy(m),m;e(n,Error)?m=Object.create(n):void 0===s?(v=Object.getPrototypeOf(n),m=Object.create(v)):(m=Object.create(s),v=s)}if(o){var b=p.indexOf(n);if(-1!=b)return f[b];p.push(n),f.push(m)}for(var y in e(n,l)&&n.forEach(function(t,e){var i=d(e,r-1),n=d(t,r-1);m.set(i,n)}),e(n,c)&&n.forEach(function(t){var e=d(t,r-1);m.add(e)}),n){var S;v&&(S=Object.getOwnPropertyDescriptor(v,y)),S&&null==S.set||(m[y]=d(n[y],r-1))}if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(n);for(y=0;y<k.length;y++){var w=k[y];(!(x=Object.getOwnPropertyDescriptor(n,w))||x.enumerable||u)&&(m[w]=d(n[w],r-1),x.enumerable||Object.defineProperty(m,w,{enumerable:!1}))}}if(u){var _=Object.getOwnPropertyNames(n);for(y=0;y<_.length;y++){var x,L=_[y];(x=Object.getOwnPropertyDescriptor(n,L))&&x.enumerable||(m[L]=d(n[L],r-1),Object.defineProperty(m,L,{enumerable:!1}))}}return m}"object"==typeof o&&(r=o.depth,s=o.prototype,u=o.includeNonEnumerable,o=o.circular);var p=[],f=[],g=void 0!==t;return void 0===o&&(o=!0),void 0===r&&(r=1/0),d(n,r)}function n(t){return Object.prototype.toString.call(t)}function o(t){return"object"==typeof t&&"[object Date]"===n(t)}function r(t){return"object"==typeof t&&"[object Array]"===n(t)}function s(t){return"object"==typeof t&&"[object RegExp]"===n(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}var l,c,h;try{l=Map}catch(u){l=function(){}}try{c=Set}catch(u){c=function(){}}try{h=Promise}catch(u){h=function(){}}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=n,i.__isDate=o,i.__isArray=r,i.__isRegExp=s,i.__getRegExpFlags=a,i}();"object"==typeof e&&e.exports&&(e.exports=i)}).call(this,t("buffer").Buffer)},{buffer:101}],103:[function(t,e,i){i.read=function(t,e,i,n,o){var r,s,a=8*o-n-1,l=(1<<a)-1,c=l>>1,h=-7,u=i?o-1:0,d=i?-1:1,p=t[e+u];for(u+=d,r=p&(1<<-h)-1,p>>=-h,h+=a;h>0;r=256*r+t[e+u],u+=d,h-=8);for(s=r&(1<<-h)-1,r>>=-h,h+=n;h>0;s=256*s+t[e+u],u+=d,h-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),r-=c}return(p?-1:1)*s*Math.pow(2,r-n)},i.write=function(t,e,i,n,o,r){var s,a,l,c=8*r-o-1,h=(1<<c)-1,u=h>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:r-1,f=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(s++,l/=2),s+u>=h?(a=0,s=h):s+u>=1?(a=(e*l-1)*Math.pow(2,o),s+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,o),s=0));o>=8;t[i+p]=255&a,p+=f,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[i+p]=255&s,p+=f,s/=256,c-=8);t[i+p-f]|=128*g}},{}],104:[function(t,e,i){"use strict";function n(){}function o(t){try{return t.then}catch(e){return v=e,b}}function r(t,e){try{return t(e)}catch(i){return v=i,b}}function s(t,e,i){try{t(e,i)}catch(n){return v=n,b}}function a(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("Promise constructor's argument is not a function");this._40=0,this._65=0,this._55=null,this._72=null,t!==n&&g(t,this)}function l(t,e,i){return new t.constructor(function(o,r){var s=new a(n);s.then(o,r),c(t,new f(e,i,s))})}function c(t,e){for(;3===t._65;)t=t._55;return a._37&&a._37(t),0===t._65?0===t._40?(t._40=1,void(t._72=e)):1===t._40?(t._40=2,void(t._72=[t._72,e])):void t._72.push(e):void h(t,e)}function h(t,e){m(function(){var i=1===t._65?e.onFulfilled:e.onRejected;if(null!==i){var n=r(i,t._55);n===b?d(e.promise,v):u(e.promise,n)}else 1===t._65?u(e.promise,t._55):d(e.promise,t._55)})}function u(t,e){if(e===t)return d(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"==typeof e||"function"==typeof e)){var i=o(e);if(i===b)return d(t,v);if(i===t.then&&e instanceof a)return t._65=3,t._55=e,void p(t);if("function"==typeof i)return void g(i.bind(e),t)}t._65=1,t._55=e,p(t)}function d(t,e){t._65=2,t._55=e,a._87&&a._87(t,e),p(t)}function p(t){if(1===t._40&&(c(t,t._72),t._72=null),2===t._40){for(var e=0;e<t._72.length;e++)c(t,t._72[e]);t._72=null}}function f(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}function g(t,e){var i=!1,n=s(t,function(t){i||(i=!0,u(e,t))},function(t){i||(i=!0,d(e,t))});i||n!==b||(i=!0,d(e,v))}var m=t("asap/raw"),v=null,b={};e.exports=a,a._37=null,a._87=null,a._61=n,a.prototype.then=function(t,e){if(this.constructor!==a)return l(this,t,e);var i=new a(n);return c(this,new f(t,e,i)),i}},{"asap/raw":99}],105:[function(t,e,i){"use strict";function n(t){var e=new o(o._61);return e._65=1,e._55=t,e}var o=t("./core.js");e.exports=o;var r=n(!0),s=n(!1),a=n(null),l=n(void 0),c=n(0),h=n("");o.resolve=function(t){if(t instanceof o)return t;if(null===t)return a;if(void 0===t)return l;if(!0===t)return r;if(!1===t)return s;if(0===t)return c;if(""===t)return h;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new o(e.bind(t))}catch(i){return new o(function(e,n){n(i)})}return n(t)},o.all=function(t){var e=Array.prototype.slice.call(t);return new o(function(t,i){function n(s,a){if(a&&("object"==typeof a||"function"==typeof a)){if(a instanceof o&&a.then===o.prototype.then){for(;3===a._65;)a=a._55;return 1===a._65?n(s,a._55):(2===a._65&&i(a._55),void a.then(function(t){n(s,t)},i))}var l=a.then;if("function"==typeof l)return void new o(l.bind(a)).then(function(t){n(s,t)},i)}e[s]=a,0==--r&&t(e)}if(0===e.length)return t([]);for(var r=e.length,s=0;s<e.length;s++)n(s,e[s])})},o.reject=function(t){return new o(function(e,i){i(t)})},o.race=function(t){return new o(function(e,i){t.forEach(function(t){o.resolve(t).then(e,i)})})},o.prototype["catch"]=function(t){return this.then(null,t)}},{"./core.js":104}],106:[function(){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(){(arguments.length?this.then.apply(this,arguments):this).then(null,function(t){setTimeout(function(){throw t},0)})})},{}],107:[function(t){t("asap"),"undefined"==typeof Promise&&(Promise=t("./lib/core.js"),t("./lib/es6-extensions.js")),t("./polyfill-done.js")},{"./lib/core.js":104,"./lib/es6-extensions.js":105,"./polyfill-done.js":106,asap:98}]},{},[2])(2)}),function(t){var e,i;t.event.fix=(i=t.event.fix,function(t){return 0!==(t=i.apply(this,arguments)).type.indexOf("copy")&&0!==t.type.indexOf("paste")||(t.clipboardData=t.originalEvent.clipboardData),t}),e={callback:t.noop,matchType:/image.*/},t.fn.pasteImageReader=function(i){return"function"==typeof i&&(i={callback:i}),i=t.extend({},e,i),this.each(function(){var e;return e=this,t(this).bind("paste",function(t){var n,o;return o=!1,n=t.clipboardData,Array.prototype.forEach.call(n.types,function(t,r){var s,a;if(!o)return n.items&&(t.match(i.matchType)||n.items[r].type.match(i.matchType))?(s=n.items[r].getAsFile(),(a=new FileReader).onload=function(t){return i.callback.call(e,{dataURL:t.target.result,event:t,file:s,name:s.name})},a.readAsDataURL(s),o=!0):void 0})})})}}(jQuery),
/**
 * innerHTML property for SVGElement
 * Copyright(c) 2010, Jeff Schiller
 *
 * Licensed under the Apache License, Version 2
 *
 * Works in a SVG document in Chrome 6+, Safari 5+, Firefox 4+ and IE9+.
 * Works in a HTML5 document in Chrome 7+, Firefox 4+ and IE9+.
 * Does not work in Opera since it doesn't support the SVGElement interface yet.
 *
 * I haven't decided on the best name for this property - thus the duplication.
 */
function(){var t=function(e,i){var n=e.nodeType;if(3==n)i.push(e.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"));else if(1==n){if(i.push("<",e.tagName),e.hasAttributes())for(var o=e.attributes,r=0,s=o.length;r<s;++r){var a=o.item(r);i.push(" ",a.name,"='",a.value,"'")}if(e.hasChildNodes()){i.push(">");var l=e.childNodes;for(r=0,s=l.length;r<s;++r)t(l.item(r),i);i.push("</",e.tagName,">")}else i.push("/>")}else{if(8!=n)throw"Error serializing XML. Unhandled node of type: "+n;i.push("<!--",e.nodeValue,"-->")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){for(var e=[],i=this.firstChild;i;)t(i,e),i=i.nextSibling;return e.join("")},set:function(t){for(;this.firstChild;)this.removeChild(this.firstChild);try{var e=new DOMParser;e.async=!1,sXML="<svg xmlns='http://www.w3.org/2000/svg'>"+t+"</svg>";for(var i=e.parseFromString(sXML,"text/xml").documentElement.firstChild;i;)this.appendChild(this.ownerDocument.importNode(i,!0)),i=i.nextSibling}catch(n){throw new Error("Error parsing XML string")}}}),Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}})}(),function(t,e){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("jquery")):t.jQueryBridget=e(t,t.jQuery)}(window,function(t,e){"use strict";function i(i,r,a){function l(t,e,n){var o,r="$()."+i+'("'+e+'")';return t.each(function(t,l){var c=a.data(l,i);if(c){var h=c[e];if(h&&"_"!=e.charAt(0)){var u=h.apply(c,n);o=void 0===o?u:o}else s(r+" is not a valid method")}else s(i+" not initialized. Cannot call methods, i.e. "+r)}),void 0!==o?o:t}function c(t,e){t.each(function(t,n){var o=a.data(n,i);o?(o.option(e),o._init()):(o=new r(n,e),a.data(n,i,o))})}(a=a||e||t.jQuery)&&(r.prototype.option||(r.prototype.option=function(t){a.isPlainObject(t)&&(this.options=a.extend(!0,this.options,t))}),a.fn[i]=function(t){return"string"==typeof t?l(this,t,o.call(arguments,1)):(c(this,t),this)},n(a))}function n(t){!t||t&&t.bridget||(t.bridget=i)}var o=Array.prototype.slice,r=t.console,s=void 0===r?function(){}:function(t){r.error(t)};return n(e||t.jQuery),i}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],o=0;o<i.length;o++){var r=i[o];n&&n[r]&&(this.off(t,r),delete n[r]),r.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("get-size/get-size",[],function(){return e()}):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e()}(window,function(){"use strict";function t(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}function e(){}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;c>e;e++){t[l[e]]=0}return t}function n(t){var e=getComputedStyle(t);return e||a("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),e}function o(){if(!h){h=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(e);var o=n(e);r.isBoxSizeOuter=s=200==t(o.width),i.removeChild(e)}}function r(e){if(o(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var r=n(e);if("none"==r.display)return i();var a={};a.width=e.offsetWidth,a.height=e.offsetHeight;for(var h=a.isBorderBox="border-box"==r.boxSizing,u=0;c>u;u++){var d=l[u],p=r[d],f=parseFloat(p);a[d]=isNaN(f)?0:f}var g=a.paddingLeft+a.paddingRight,m=a.paddingTop+a.paddingBottom,v=a.marginLeft+a.marginRight,b=a.marginTop+a.marginBottom,y=a.borderLeftWidth+a.borderRightWidth,S=a.borderTopWidth+a.borderBottomWidth,k=h&&s,w=t(r.width);!1!==w&&(a.width=w+(k?0:g+y));var _=t(r.height);return!1!==_&&(a.height=_+(k?0:m+S)),a.innerWidth=a.width-(g+y),a.innerHeight=a.height-(m+S),a.outerWidth=a.width+v,a.outerHeight=a.height+b,a}}var s,a="undefined"==typeof console?e:function(t){console.error(t)},l=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],c=l.length,h=!1;return r}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e()}(window,function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i]+"MatchesSelector";if(t[n])return n}}();return function(e,i){return e[t](i)}}),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.matchesSelector)}(window,function(t,e){var i={extend:function(t,e){for(var i in e)t[i]=e[i];return t},modulo:function(t,e){return(t%e+e)%e},makeArray:function(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"object"==typeof t&&"number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e},removeFrom:function(t,e){var i=t.indexOf(e);-1!=i&&t.splice(i,1)},getParent:function(t,i){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,e(t,i))return t},getQueryElement:function(t){return"string"==typeof t?document.querySelector(t):t},handleEvent:function(t){var e="on"+t.type;this[e]&&this[e](t)},filterFindElements:function(t,n){t=i.makeArray(t);var o=[];return t.forEach(function(t){if(t instanceof HTMLElement){if(!n)return void o.push(t);e(t,n)&&o.push(t);for(var i=t.querySelectorAll(n),r=0;r<i.length;r++)o.push(i[r])}}),o},debounceMethod:function(t,e,i){var n=t.prototype[e],o=e+"Timeout";t.prototype[e]=function(){var t=this[o];t&&clearTimeout(t);var e=arguments,r=this;this[o]=setTimeout(function(){n.apply(r,e),delete r[o]},i||100)}},docReady:function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},toDashed:function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()}},n=t.console;return i.htmlInit=function(e,o){i.docReady(function(){var r=i.toDashed(o),s="data-"+r,a=document.querySelectorAll("["+s+"]"),l=document.querySelectorAll(".js-"+r),c=i.makeArray(a).concat(i.makeArray(l)),h=s+"-options",u=t.jQuery;c.forEach(function(t){var i,r=t.getAttribute(s)||t.getAttribute(h);try{i=r&&JSON.parse(r)}catch(a){return void(n&&n.error("Error parsing "+s+" on "+t.className+": "+a))}var l=new e(t,i);u&&u.data(t,o,l)})})},i}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("ev-emitter"),require("get-size")):(t.Outlayer={},t.Outlayer.Item=e(t.EvEmitter,t.getSize))}(window,function(t,e){"use strict";function i(t){for(var e in t)return!1;return null,!0}function n(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}function o(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}var r=document.documentElement.style,s="string"==typeof r.transition?"transition":"WebkitTransition",a="string"==typeof r.transform?"transform":"WebkitTransform",l={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[s],c={transform:a,transition:s,transitionDuration:s+"Duration",transitionProperty:s+"Property",transitionDelay:s+"Delay"},h=n.prototype=Object.create(t.prototype);h.constructor=n,h._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},h.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},h.getSize=function(){this.size=e(this.element)},h.css=function(t){var e=this.element.style;for(var i in t){e[c[i]||i]=t[i]}},h.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),n=t[e?"left":"right"],o=t[i?"top":"bottom"],r=this.layout.size,s=-1!=n.indexOf("%")?parseFloat(n)/100*r.width:parseInt(n,10),a=-1!=o.indexOf("%")?parseFloat(o)/100*r.height:parseInt(o,10);s=isNaN(s)?0:s,a=isNaN(a)?0:a,s-=e?r.paddingLeft:r.paddingRight,a-=i?r.paddingTop:r.paddingBottom,this.position.x=s,this.position.y=a},h.layoutPosition=function(){var t=this.layout.size,e={},i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop"),o=i?"paddingLeft":"paddingRight",r=i?"left":"right",s=i?"right":"left",a=this.position.x+t[o];e[r]=this.getXValue(a),e[s]="";var l=n?"paddingTop":"paddingBottom",c=n?"top":"bottom",h=n?"bottom":"top",u=this.position.y+t[l];e[c]=this.getYValue(u),e[h]="",this.css(e),this.emitEvent("layout",[this])},h.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px"},h.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px"},h._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,o=parseInt(t,10),r=parseInt(e,10),s=o===this.position.x&&r===this.position.y;if(this.setPosition(t,e),!s||this.isTransitioning){var a=t-i,l=e-n,c={};c.transform=this.getTranslate(a,l),this.transition({to:c,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},h.getTranslate=function(t,e){return"translate3d("+(t=this.layout._getOption("originLeft")?t:-t)+"px, "+(e=this.layout._getOption("originTop")?e:-e)+"px, 0)"},h.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},h.moveTo=h._transitionTo,h.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},h._nonTransition=function(t){for(var e in this.css(t.to),t.isCleaning&&this._removeStyles(t.to),t.onTransitionEnd)t.onTransitionEnd[e].call(this)},h.transition=function(t){if(parseFloat(this.layout.options.transitionDuration)){var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);this.element.offsetHeight;null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0}else this._nonTransition(t)};var u="opacity,"+o(a);h.enableTransition=function(){if(!this.isTransitioning){var t=this.layout.options.transitionDuration;t="number"==typeof t?t+"ms":t,this.css({transitionProperty:u,transitionDuration:t,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(l,this,!1)}},h.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},h.onotransitionend=function(t){this.ontransitionend(t)};var d={"-webkit-transform":"transform"};h.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,n=d[t.propertyName]||t.propertyName;if(delete e.ingProperties[n],i(e.ingProperties)&&this.disableTransition(),n in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[n]),n in e.onEnd)e.onEnd[n].call(this),delete e.onEnd[n];this.emitEvent("transitionEnd",[this])}},h.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(l,this,!1),this.isTransitioning=!1},h._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var p={transitionProperty:"",transitionDuration:"",transitionDelay:""};return h.removeTransitionStyles=function(){this.css(p)},h.stagger=function(t){t=isNaN(t)?0:t,this.staggerDelay=t+"ms"},h.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},h.remove=function(){return s&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),void this.hide()):void this.removeElem()},h.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},h.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},h.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var i in e)return i},h.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},h.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},h.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},n}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,n,o,r){return e(t,i,n,o,r)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):t.Outlayer=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,t.Outlayer.Item)}(window,function(t,e,i,n,o){"use strict";function r(t,e){var i=n.getQueryElement(t);if(i){this.element=i,c&&(this.$element=c(this.element)),this.options=n.extend({},this.constructor.defaults),this.option(e);var o=++u;this.element.outlayerGUID=o,d[o]=this,this._create(),this._getOption("initLayout")&&this.layout()}else l&&l.error("Bad element for "+this.constructor.namespace+": "+(i||t))}function s(t){function e(){t.apply(this,arguments)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}function a(t){if("number"==typeof t)return t;var e=t.match(/(^\d*\.?\d*)(\w*)/),i=e&&e[1],n=e&&e[2];return i.length?(i=parseFloat(i))*(f[n]||1):0}var l=t.console,c=t.jQuery,h=function(){},u=0,d={};r.namespace="outlayer",r.Item=o,r.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var p=r.prototype;n.extend(p,e.prototype),p.option=function(t){n.extend(this.options,t)},p._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t]},r.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},p._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),n.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},p.reloadItems=function(){this.items=this._itemize(this.element.children)},p._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,n=[],o=0;o<e.length;o++){var r=new i(e[o],this);n.push(r)}return n},p._filterFindItemElements=function(t){return n.filterFindElements(t,this.options.itemSelector)},p.getItemElements=function(){return this.items.map(function(t){return t.element})},p.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},p._init=p.layout,p._resetLayout=function(){this.getSize()},p.getSize=function(){this.size=i(this.element)},p._getMeasurement=function(t,e){var n,o=this.options[t];o?("string"==typeof o?n=this.element.querySelector(o):o instanceof HTMLElement&&(n=o),this[t]=n?i(n)[e]:o):this[t]=0},p.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},p._getItemsForLayout=function(t){return t.filter(function(t){return!t.isIgnored})},p._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var i=[];t.forEach(function(t){var n=this._getItemLayoutPosition(t);n.item=t,n.isInstant=e||t.isLayoutInstant,i.push(n)},this),this._processLayoutQueue(i)}},p._getItemLayoutPosition=function(){return{x:0,y:0}},p._processLayoutQueue=function(t){this.updateStagger(),t.forEach(function(t,e){this._positionItem(t.item,t.x,t.y,t.isInstant,e)},this)},p.updateStagger=function(){var t=this.options.stagger;return null==t?void(this.stagger=0):(this.stagger=a(t),this.stagger)},p._positionItem=function(t,e,i,n,o){n?t.goTo(e,i):(t.stagger(o*this.stagger),t.moveTo(e,i))},p._postLayout=function(){this.resizeContainer()},p.resizeContainer=function(){if(this._getOption("resizeContainer")){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))}},p._getContainerSize=h,p._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},p._emitCompleteOnItems=function(t,e){function i(){o.dispatchEvent(t+"Complete",null,[e])}function n(){++s==r&&i()}var o=this,r=e.length;if(e&&r){var s=0;e.forEach(function(e){e.once(t,n)})}else i()},p.dispatchEvent=function(t,e,i){var n=e?[e].concat(i):i;if(this.emitEvent(t,n),c)if(this.$element=this.$element||c(this.element),e){var o=c.Event(e);o.type=t,this.$element.trigger(o,i)}else this.$element.trigger(t,i)},p.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},p.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},p.stamp=function(t){(t=this._find(t))&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this))},p.unstamp=function(t){(t=this._find(t))&&t.forEach(function(t){n.removeFrom(this.stamps,t),this.unignore(t)},this)},p._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n.makeArray(t)):void 0},p._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},p._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},p._manageStamp=h,p._getElementOffset=function(t){var e=t.getBoundingClientRect(),n=this._boundingRect,o=i(t);return{left:e.left-n.left-o.marginLeft,top:e.top-n.top-o.marginTop,right:n.right-e.right-o.marginRight,bottom:n.bottom-e.bottom-o.marginBottom}},p.handleEvent=n.handleEvent,p.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0},p.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1},p.onresize=function(){this.resize()},n.debounceMethod(r,"onresize",100),p.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},p.needsResizeLayout=function(){var t=i(this.element);return this.size&&t&&t.innerWidth!==this.size.innerWidth},p.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},p.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},p.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},p.reveal=function(t){if(this._emitCompleteOnItems("reveal",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.reveal()})}},p.hide=function(t){if(this._emitCompleteOnItems("hide",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.hide()})}},p.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},p.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},p.getItem=function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.element==t)return i}},p.getItems=function(t){t=n.makeArray(t);var e=[];return t.forEach(function(t){var i=this.getItem(t);i&&e.push(i)},this),e},p.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach(function(t){t.remove(),n.removeFrom(this.items,t)},this)},p.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach(function(t){t.destroy()}),this.unbindResize();var e=this.element.outlayerGUID;delete d[e],delete this.element.outlayerGUID,c&&c.removeData(this.element,this.constructor.namespace)},r.data=function(t){var e=(t=n.getQueryElement(t))&&t.outlayerGUID;return e&&d[e]},r.create=function(t,e){var i=s(r);return i.defaults=n.extend({},r.defaults),n.extend(i.defaults,e),i.compatOptions=n.extend({},r.compatOptions),i.namespace=t,i.data=r.data,i.Item=s(o),n.htmlInit(i,t),c&&c.bridget&&c.bridget(t,i),i};var f={ms:1,s:1e3};return r.Item=o,r}),function(t,e){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("outlayer"),require("get-size")):t.Masonry=e(t.Outlayer,t.getSize)}(window,function(t,e){var i=t.create("masonry");i.compatOptions.fitWidth="isFitWidth";var n=i.prototype;return n._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},n.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],i=t&&t.element;this.columnWidth=i&&e(i).outerWidth||this.containerWidth}var n=this.columnWidth+=this.gutter,o=this.containerWidth+this.gutter,r=o/n,s=n-o%n;r=Math[s&&1>s?"round":"floor"](r),this.cols=Math.max(r,1)},n.getContainerWidth=function(){var t=this._getOption("fitWidth")?this.element.parentNode:this.element,i=e(t);this.containerWidth=i&&i.innerWidth},n._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,i=Math[e&&1>e?"round":"ceil"](t.size.outerWidth/this.columnWidth);i=Math.min(i,this.cols);for(var n=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](i,t),o={x:this.columnWidth*n.col,y:n.y},r=n.y+t.size.outerHeight,s=i+n.col,a=n.col;s>a;a++)this.colYs[a]=r;return o},n._getTopColPosition=function(t){var e=this._getTopColGroup(t),i=Math.min.apply(Math,e);return{col:e.indexOf(i),y:i}},n._getTopColGroup=function(t){if(2>t)return this.colYs;for(var e=[],i=this.cols+1-t,n=0;i>n;n++)e[n]=this._getColGroupY(n,t);return e},n._getColGroupY=function(t,e){if(2>e)return this.colYs[t];var i=this.colYs.slice(t,t+e);return Math.max.apply(Math,i)},n._getHorizontalColPosition=function(t,e){var i=this.horizontalColIndex%this.cols;i=t>1&&i+t>this.cols?0:i;var n=e.size.outerWidth&&e.size.outerHeight;return this.horizontalColIndex=n?i+t:this.horizontalColIndex,{col:i,y:this._getColGroupY(i,t)}},n._manageStamp=function(t){var i=e(t),n=this._getElementOffset(t),o=this._getOption("originLeft")?n.left:n.right,r=o+i.outerWidth,s=Math.floor(o/this.columnWidth);s=Math.max(0,s);var a=Math.floor(r/this.columnWidth);a-=r%this.columnWidth?0:1,a=Math.min(this.cols-1,a);for(var l=(this._getOption("originTop")?n.top:n.bottom)+i.outerHeight,c=s;a>=c;c++)this.colYs[c]=Math.max(l,this.colYs[c])},n._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t},n._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},n.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth},i}),
/*! socket.io.min.js build:1.4.5. Copyright (c) 2014 Guillermo Rauch. MIT Licensed */
function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).io=t()}}(function(){var t;return function e(t,i,n){function o(s,a){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[s]={exports:{}};t[s][0].call(h.exports,function(e){var i=t[s][1][e];return o(i||e)},h,h.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e){e.exports=t("./lib/")},{"./lib/":2}],2:[function(t,e){e.exports=t("./socket"),e.exports.parser=t("engine.io-parser")},{"./socket":3,"engine.io-parser":19}],3:[function(t,e){(function(i){function n(t,e){if(!(this instanceof n))return new n(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=h(t),e.hostname=t.host,e.secure="https"==t.protocol||"wss"==t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=h(e.host).host),this.secure=null!=e.secure?e.secure:i.location&&"https:"==location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||(i.location?location.hostname:"localhost"),this.port=e.port||(i.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=e.rejectUnauthorized===undefined?null:e.rejectUnauthorized;var o="object"==typeof i&&i;o.global===o&&e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),this.open()}function o(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}var r=t("./transports"),s=t("component-emitter"),a=t("debug")("engine.io-client:socket"),l=t("indexof"),c=t("engine.io-parser"),h=t("parseuri"),u=t("parsejson"),d=t("parseqs");e.exports=n,n.priorWebsocketSuccess=!1,s(n.prototype),n.protocol=c.protocol,n.Socket=n,n.Transport=t("./transport"),n.transports=t("./transports"),n.parser=t("engine.io-parser"),n.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=o(this.query);return e.EIO=c.protocol,e.transport=t,this.id&&(e.sid=this.id),new r[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders})},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(i){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},n.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},n.prototype.probe=function(t){function e(){if(d.onlyBinaryUpgrades){var e=!this.supportsBinary&&d.transport.supportsBinary;u=u||e}u||(a('probe transport "%s" opened',t),h.send([{type:"ping",data:"probe"}]),h.once("packet",function(e){if(!u)if("pong"==e.type&&"probe"==e.data){if(a('probe transport "%s" pong',t),d.upgrading=!0,d.emit("upgrading",h),!h)return;n.priorWebsocketSuccess="websocket"==h.name,a('pausing current transport "%s"',d.transport.name),d.transport.pause(function(){u||"closed"!=d.readyState&&(a("changing transport and sending upgrade packet"),c(),d.setTransport(h),h.send([{type:"upgrade"}]),d.emit("upgrade",h),h=null,d.upgrading=!1,d.flush())})}else{a('probe transport "%s" failed',t);var i=new Error("probe error");i.transport=h.name,d.emit("upgradeError",i)}}))}function i(){u||(u=!0,c(),h.close(),h=null)}function o(e){var n=new Error("probe error: "+e);n.transport=h.name,i(),a('probe transport "%s" failed because of error: %s',t,e),d.emit("upgradeError",n)}function r(){o("transport closed")}function s(){o("socket closed")}function l(t){h&&t.name!=h.name&&(a('"%s" works - aborting "%s"',t.name,h.name),i())}function c(){h.removeListener("open",e),h.removeListener("error",o),h.removeListener("close",r),d.removeListener("close",s),d.removeListener("upgrading",l)}a('probing transport "%s"',t);var h=this.createTransport(t,{probe:1}),u=!1,d=this;n.priorWebsocketSuccess=!1,h.once("open",e),h.once("error",o),h.once("close",r),this.once("close",s),this.once("upgrading",l),h.open()},n.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},n.prototype.onPacket=function(t){if("opening"==this.readyState||"open"==this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(u(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!=e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},n.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},n.prototype.sendPacket=function(t,e,i,n){if("function"==typeof e&&(n=e,e=undefined),"function"==typeof i&&(n=i,i=null),"closing"!=this.readyState&&"closed"!=this.readyState){(i=i||{}).compress=!1!==i.compress;var o={type:t,data:e,options:i};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},n.prototype.close=function(){function t(){n.onClose("forced close"),a("socket closing - telling transport to close"),n.transport.close()}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t()}function i(){n.once("upgrade",e),n.once("upgradeError",e)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}return this},n.prototype.onError=function(t){a("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},n.prototype.onClose=function(t,e){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){a('socket close with reason: "%s"',t);var i=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),i.writeBuffer=[],i.prevBufferLen=0}},n.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~l(this.transports,t[i])&&e.push(t[i]);return e}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./transport":4,"./transports":5,"component-emitter":15,debug:17,"engine.io-parser":19,indexof:23,parsejson:26,parseqs:27,parseuri:28}],4:[function(t,e){function i(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders}var n=t("engine.io-parser"),o=t("component-emitter");e.exports=i,o(i.prototype),i.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},i.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(t){if("open"!=this.readyState)throw new Error("Transport not open");this.write(t)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(t){var e=n.decodePacket(t,this.socket.binaryType);this.onPacket(e)},i.prototype.onPacket=function(t){this.emit("packet",t)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":15,"engine.io-parser":19}],5:[function(t,e,i){(function(e){function n(t){var i=!1,n=!1,a=!1!==t.jsonp;if(e.location){var l="https:"==location.protocol,c=location.port;c||(c=l?443:80),i=t.hostname!=location.hostname||c!=t.port,n=t.secure!=l}if(t.xdomain=i,t.xscheme=n,"open"in new o(t)&&!t.forceJSONP)return new r(t);if(!a)throw new Error("JSONP disabled");return new s(t)}var o=t("xmlhttprequest-ssl"),r=t("./polling-xhr"),s=t("./polling-jsonp"),a=t("./websocket");i.polling=n,i.websocket=a}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling-jsonp":6,"./polling-xhr":7,"./websocket":9,"xmlhttprequest-ssl":10}],6:[function(t,e){(function(i){function n(){}function o(t){r.call(this,t),this.query=this.query||{},a||(i.___eio||(i.___eio=[]),a=i.___eio),this.index=a.length;var e=this;a.push(function(t){e.onData(t)}),this.query.j=this.index,i.document&&i.addEventListener&&i.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=n)},!1)}var r=t("./polling"),s=t("component-inherit");e.exports=o;var a,l=/\n/g,c=/\\n/g;s(o,r),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},o.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},o.prototype.doWrite=function(t,e){function i(){n(),e()}function n(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+o.iframeId+'">';r=document.createElement(t)}catch(e){(r=document.createElement("iframe")).name=o.iframeId,r.src="javascript:0"}r.id=o.iframeId,o.form.appendChild(r),o.iframe=r}var o=this;if(!this.form){var r,s=document.createElement("form"),a=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=h,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),t=t.replace(c,"\\\n"),this.area.value=t.replace(l,"\\n");try{this.form.submit()}catch(u){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==o.iframe.readyState&&i()}:this.iframe.onload=i}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":8,"component-inherit":16}],7:[function(t,e){(function(i){function n(){}function o(t){if(l.call(this,t),i.location){var e="https:"==location.protocol,n=location.port;n||(n=e?443:80),this.xd=t.hostname!=i.location.hostname||n!=t.port,this.xs=t.secure!=e}else this.extraHeaders=t.extraHeaders}function r(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=undefined!=t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function s(){for(var t in r.requests)r.requests.hasOwnProperty(t)&&r.requests[t].abort()}var a=t("xmlhttprequest-ssl"),l=t("./polling"),c=t("component-emitter"),h=t("component-inherit"),u=t("debug")("engine.io-client:polling-xhr");e.exports=o,e.exports.Request=r,h(o,l),o.prototype.supportsBinary=!0,o.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.extraHeaders=this.extraHeaders,new r(t)},o.prototype.doWrite=function(t,e){var i="string"!=typeof t&&t!==undefined,n=this.request({method:"POST",data:t,isBinary:i}),o=this;n.on("success",e),n.on("error",function(t){o.onError("xhr post error",t)}),this.sendXhr=n},o.prototype.doPoll=function(){u("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},c(r.prototype),r.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new a(t),n=this;try{u("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&e.setRequestHeader(o,this.extraHeaders[o])}catch(s){}if(this.supportsBinary&&(e.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}"withCredentials"in e&&(e.withCredentials=!0),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){4==e.readyState&&(200==e.status||1223==e.status?n.onLoad():setTimeout(function(){n.onError(e.status)},0))},u("xhr data %s",this.data),e.send(this.data)}catch(s){return void setTimeout(function(){n.onError(s)},0)}i.document&&(this.index=r.requestsCount++,r.requests[this.index]=this)},r.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},r.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},r.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},r.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,t)try{this.xhr.abort()}catch(e){}i.document&&delete r.requests[this.index],this.xhr=null}},r.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(s){}if("application/octet-stream"===e)t=this.xhr.response;else if(this.supportsBinary)try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(s){for(var i=new Uint8Array(this.xhr.response),n=[],o=0,r=i.length;o<r;o++)n.push(i[o]);t=String.fromCharCode.apply(null,n)}else t=this.xhr.responseText}catch(s){this.onError(s)}null!=t&&this.onData(t)},r.prototype.hasXDR=function(){return"undefined"!=typeof i.XDomainRequest&&!this.xs&&this.enablesXDR},r.prototype.abort=function(){this.cleanup()},i.document&&(r.requestsCount=0,r.requests={},i.attachEvent?i.attachEvent("onunload",s):i.addEventListener&&i.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":8,"component-emitter":15,"component-inherit":16,debug:17,"xmlhttprequest-ssl":10}],8:[function(t,e){function i(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),n.call(this,t)}var n=t("../transport"),o=t("parseqs"),r=t("engine.io-parser"),s=t("component-inherit"),a=t("yeast"),l=t("debug")("engine.io-client:polling");e.exports=i;var c=null!=new(t("xmlhttprequest-ssl"))({xdomain:!1}).responseType;s(i,n),i.prototype.name="polling",i.prototype.doOpen=function(){this.poll()},i.prototype.pause=function(t){function e(){l("paused"),i.readyState="paused",t()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(l("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){l("pre-pause polling complete"),--n||e()})),this.writable||(l("we are currently writing - waiting to pause"),n++,this.once("drain",function(){l("pre-pause writing complete"),--n||e()}))}else e()},i.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},i.prototype.onData=function(t){var e=this;l("polling got data %s",t);var i=function(t){if("opening"==e.readyState&&e.onOpen(),"close"==t.type)return e.onClose(),!1;e.onPacket(t)};r.decodePayload(t,this.socket.binaryType,i),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},i.prototype.doClose=function(){function t(){l("writing close packet"),e.write([{type:"close"}])}var e=this;"open"==this.readyState?(l("transport open - closing"),t()):(l("transport not open - deferring close"),this.once("open",t))},i.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};e=this;r.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},i.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=o.encode(t),this.port&&("https"==e&&443!=this.port||"http"==e&&80!=this.port)&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t}},{"../transport":4,"component-inherit":16,debug:17,"engine.io-parser":19,parseqs:27,"xmlhttprequest-ssl":10,yeast:30}],9:[function(t,e){(function(i){function n(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,o.call(this,t)}var o=t("../transport"),r=t("engine.io-parser"),s=t("parseqs"),a=t("component-inherit"),l=t("yeast"),c=t("debug")("engine.io-client:websocket"),h=i.WebSocket||i.MozWebSocket,u=h;if(!u&&"undefined"==typeof window)try{u=t("ws")}catch(d){}e.exports=n,a(n,o),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.ws=h?new u(t):new u(t,e,i),this.ws.binaryType===undefined&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(n.prototype.onData=function(t){var e=this;setTimeout(function(){o.prototype.onData.call(e,t)},0)}),n.prototype.write=function(t){function e(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}var n=this;this.writable=!1;for(var o=t.length,s=0,a=o;s<a;s++)!function(t){r.encodePacket(t,n.supportsBinary,function(r){if(!h){var s={};if(t.options&&(s.compress=t.options.compress),n.perMessageDeflate)("string"==typeof r?i.Buffer.byteLength(r):r.length)<n.perMessageDeflate.threshold&&(s.compress=!1)}try{h?n.ws.send(r):n.ws.send(r,s)}catch(d){c("websocket closed before onclose event")}--o||e()})}(t[s])},n.prototype.onClose=function(){o.prototype.onClose.call(this)},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";return this.port&&("wss"==e&&443!=this.port||"ws"==e&&80!=this.port)&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=l()),this.supportsBinary||(t.b64=1),(t=s.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},n.prototype.check=function(){return!(!u||"__initialize"in u&&this.name===n.prototype.name)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"../transport":4,"component-inherit":16,debug:17,"engine.io-parser":19,parseqs:27,ws:undefined,yeast:30}],10:[function(t,e){var i=t("has-cors");e.exports=function(t){var e=t.xdomain,n=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||i))return new XMLHttpRequest}catch(r){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(r){}if(!e)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(r){}}},{"has-cors":22}],11:[function(t,e){function i(t,e,i){function o(t,n){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(r=!0,e(t),e=i):0!==o.count||r||e(null,n)}var r=!1;return i=i||n,o.count=t,0===t?e():o}function n(){}e.exports=i},{}],12:[function(t,e){e.exports=function(t,e,i){var n=t.byteLength;if(e=e||0,i=i||n,t.slice)return t.slice(e,i);if(e<0&&(e+=n),i<0&&(i+=n),i>n&&(i=n),e>=n||e>=i||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(t),r=new Uint8Array(i-e),s=e,a=0;s<i;s++,a++)r[a]=o[s];return r.buffer}},{}],13:[function(t,e,i){
/*
 * base64-arraybuffer
 * https://github.com/niklasvh/base64-arraybuffer
 *
 * Copyright (c) 2012 Niklas von Hertzen
 * Licensed under the MIT license.
 */
!function(t){"use strict";i.encode=function(e){var i,n=new Uint8Array(e),o=n.length,r="";for(i=0;i<o;i+=3)r+=t[n[i]>>2],r+=t[(3&n[i])<<4|n[i+1]>>4],r+=t[(15&n[i+1])<<2|n[i+2]>>6],r+=t[63&n[i+2]];return o%3==2?r=r.substring(0,r.length-1)+"=":o%3==1&&(r=r.substring(0,r.length-2)+"=="),r},i.decode=function(e){var i,n,o,r,s,a=.75*e.length,l=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var h=new ArrayBuffer(a),u=new Uint8Array(h);for(i=0;i<l;i+=4)n=t.indexOf(e[i]),o=t.indexOf(e[i+1]),r=t.indexOf(e[i+2]),s=t.indexOf(e[i+3]),u[c++]=n<<2|o>>4,u[c++]=(15&o)<<4|r>>2,u[c++]=(3&r)<<6|63&s;return h}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],14:[function(t,e){(function(t){function i(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.buffer instanceof ArrayBuffer){var n=i.buffer;if(i.byteLength!==n.byteLength){var o=new Uint8Array(i.byteLength);o.set(new Uint8Array(n,i.byteOffset,i.byteLength)),n=o.buffer}t[e]=n}}}function n(t,e){e=e||{};var n=new r;i(t);for(var o=0;o<t.length;o++)n.append(t[o]);return e.type?n.getBlob(e.type):n.getBlob()}function o(t,e){return i(t),new Blob(t,e||{})}var r=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,s=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),a=s&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),l=r&&r.prototype.append&&r.prototype.getBlob;e.exports=s?a?t.Blob:o:l?n:undefined}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],15:[function(t,e){function i(t){if(t)return n(t)}function n(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}e.exports=i,i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},i.prototype.once=function(t,e){function i(){n.off(t,i),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},i.fn=e,this.on(t,i),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks[t];if(!n)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks[t];if(i)for(var n=0,o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,e);return this},i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],16:[function(t,e){e.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],17:[function(t,e,i){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+i.humanize(this.diff),!e)return t;var n="color: "+this.color;t=[t[0],n,"color: inherit"].concat(Array.prototype.slice.call(t,1));var o=0,r=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&"%c"===t&&(r=++o)}),t.splice(r,0,n),t}function r(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?i.storage.removeItem("debug"):i.storage.debug=t}catch(e){}}function a(){var t;try{t=i.storage.debug}catch(e){}return t}function l(){try{return window.localStorage}catch(t){}}(i=e.exports=t("./debug")).log=r,i.formatArgs=o,i.save=s,i.load=a,i.useColors=n,i.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:l(),i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(t){return JSON.stringify(t)},i.enable(a())},{"./debug":18}],18:[function(t,e,i){function n(){return i.colors[h++%i.colors.length]}function o(t){function e(){}function o(){var t=o,e=+new Date,r=e-(c||e);t.diff=r,t.prev=c,t.curr=e,c=e,null==t.useColors&&(t.useColors=i.useColors()),null==t.color&&t.useColors&&(t.color=n());var s=Array.prototype.slice.call(arguments);s[0]=i.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(e,n){if("%%"===e)return e;a++;var o=i.formatters[n];if("function"==typeof o){var r=s[a];e=o.call(t,r),s.splice(a,1),a--}return e}),"function"==typeof i.formatArgs&&(s=i.formatArgs.apply(t,s)),(o.log||i.log||console.log.bind(console)).apply(t,s)}e.enabled=!1,o.enabled=!0;var r=i.enabled(t)?o:e;return r.namespace=t,r}function r(t){i.save(t);for(var e=(t||"").split(/[\s,]+/),n=e.length,o=0;o<n;o++)e[o]&&("-"===(t=e[o].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+t.substr(1)+"$")):i.names.push(new RegExp("^"+t+"$")))}function s(){i.enable("")}function a(t){var e,n;for(e=0,n=i.skips.length;e<n;e++)if(i.skips[e].test(t))return!1;for(e=0,n=i.names.length;e<n;e++)if(i.names[e].test(t))return!0;return!1}function l(t){return t instanceof Error?t.stack||t.message:t}(i=e.exports=o).coerce=l,i.disable=s,i.enable=r,i.enabled=a,i.humanize=t("ms"),i.names=[],i.skips=[],i.formatters={};var c,h=0},{ms:25}],19:[function(t,e,i){(function(e){function n(t,e){return e("b"+i.packets[t.type]+t.data.data)}function o(t,e,n){if(!e)return i.encodeBase64Packet(t,n);var o=t.data,r=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=v[t.type];for(var a=0;a<r.length;a++)s[a+1]=r[a];return n(s.buffer)}function r(t,e,n){if(!e)return i.encodeBase64Packet(t,n);var o=new FileReader;return o.onload=function(){t.data=o.result,i.encodePacket(t,e,!0,n)},o.readAsArrayBuffer(t.data)}function s(t,e,n){if(!e)return i.encodeBase64Packet(t,n);if(m)return r(t,e,n);var o=new Uint8Array(1);return o[0]=v[t.type],n(new S([o.buffer,t.data]))}function a(t,e,i){for(var n=new Array(t.length),o=d(t.length,i),r=function(t,i,o){e(i,function(e,i){n[t]=i,o(e,n)})},s=0;s<t.length;s++)r(s,t[s],o)}var l=t("./keys"),c=t("has-binary"),h=t("arraybuffer.slice"),u=t("base64-arraybuffer"),d=t("after"),p=t("utf8"),f=navigator.userAgent.match(/Android/i),g=/PhantomJS/i.test(navigator.userAgent),m=f||g;i.protocol=3;var v=i.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=l(v),y={type:"error",data:"parser error"},S=t("blob");i.encodePacket=function(t,i,r,a){"function"==typeof i&&(a=i,i=!1),"function"==typeof r&&(a=r,r=null);var l=t.data===undefined?undefined:t.data.buffer||t.data;if(e.ArrayBuffer&&l instanceof ArrayBuffer)return o(t,i,a);if(S&&l instanceof e.Blob)return s(t,i,a);if(l&&l.base64)return n(t,a);var c=v[t.type];return undefined!==t.data&&(c+=r?p.encode(String(t.data)):String(t.data)),a(""+c)},i.encodeBase64Packet=function(t,n){var o,r="b"+i.packets[t.type];if(S&&t.data instanceof e.Blob){var s=new FileReader;return s.onload=function(){var t=s.result.split(",")[1];n(r+t)},s.readAsDataURL(t.data)}try{o=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(h){for(var a=new Uint8Array(t.data),l=new Array(a.length),c=0;c<a.length;c++)l[c]=a[c];o=String.fromCharCode.apply(null,l)}return r+=e.btoa(o),n(r)},i.decodePacket=function(t,e,n){if("string"==typeof t||t===undefined){if("b"==t.charAt(0))return i.decodeBase64Packet(t.substr(1),e);if(n)try{t=p.decode(t)}catch(s){return y}var o=t.charAt(0);return Number(o)==o&&b[o]?t.length>1?{type:b[o],data:t.substring(1)}:{type:b[o]}:y}o=new Uint8Array(t)[0];var r=h(t,1);return S&&"blob"===e&&(r=new S([r])),{type:b[o],data:r}},i.decodeBase64Packet=function(t,i){var n=b[t.charAt(0)];if(!e.ArrayBuffer)return{type:n,data:{base64:!0,data:t.substr(1)}};var o=u.decode(t.substr(1));return"blob"===i&&S&&(o=new S([o])),{type:n,data:o}},i.encodePayload=function(t,e,n){function o(t){return t.length+":"+t}function r(t,n){i.encodePacket(t,!!s&&e,!0,function(t){n(null,o(t))})}"function"==typeof e&&(n=e,e=null);var s=c(t);return e&&s?S&&!m?i.encodePayloadAsBlob(t,n):i.encodePayloadAsArrayBuffer(t,n):t.length?void a(t,r,function(t,e){return n(e.join(""))}):n("0:")},i.decodePayload=function(t,e,n){if("string"!=typeof t)return i.decodePayloadAsBinary(t,e,n);var o;if("function"==typeof e&&(n=e,e=null),""==t)return n(y,0,1);for(var r,s,a="",l=0,c=t.length;l<c;l++){var h=t.charAt(l);if(":"!=h)a+=h;else{if(""==a||a!=(r=Number(a)))return n(y,0,1);if(a!=(s=t.substr(l+1,r)).length)return n(y,0,1);if(s.length){if(o=i.decodePacket(s,e,!0),y.type==o.type&&y.data==o.data)return n(y,0,1);if(!1===n(o,l+r,c))return}l+=r,a=""}}return""!=a?n(y,0,1):void 0},i.encodePayloadAsArrayBuffer=function(t,e){function n(t,e){i.encodePacket(t,!0,!0,function(t){return e(null,t)})}if(!t.length)return e(new ArrayBuffer(0));a(t,n,function(t,i){var n=i.reduce(function(t,e){var i;return t+(i="string"==typeof e?e.length:e.byteLength).toString().length+i+2},0),o=new Uint8Array(n),r=0;return i.forEach(function(t){var e="string"==typeof t,i=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);i=n.buffer}o[r++]=e?0:1;var a=i.byteLength.toString();for(s=0;s<a.length;s++)o[r++]=parseInt(a[s]);o[r++]=255;for(n=new Uint8Array(i),s=0;s<n.length;s++)o[r++]=n[s]}),e(o.buffer)})},i.encodePayloadAsBlob=function(t,e){function n(t,e){i.encodePacket(t,!0,!0,function(t){var i=new Uint8Array(1);if(i[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),o=0;o<t.length;o++)n[o]=t.charCodeAt(o);t=n.buffer,i[0]=0}var r=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(r.length+1);for(o=0;o<r.length;o++)s[o]=parseInt(r[o]);if(s[r.length]=255,S){var a=new S([i.buffer,s.buffer,t]);e(null,a)}})}a(t,n,function(t,i){return e(new S(i))})},i.decodePayloadAsBinary=function(t,e,n){"function"==typeof e&&(n=e,e=null);for(var o=t,r=[],s=!1;o.byteLength>0;){for(var a=new Uint8Array(o),l=0===a[0],c="",u=1;255!=a[u];u++){if(c.length>310){s=!0;break}c+=a[u]}if(s)return n(y,0,1);o=h(o,2+c.length),c=parseInt(c);var d=h(o,0,c);if(l)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(g){var p=new Uint8Array(d);d="";for(u=0;u<p.length;u++)d+=String.fromCharCode(p[u])}r.push(d),o=h(o,c)}var f=r.length;r.forEach(function(t,o){n(i.decodePacket(t,e,!0),o,f)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./keys":20,after:11,"arraybuffer.slice":12,"base64-arraybuffer":13,blob:14,"has-binary":21,utf8:29}],20:[function(t,e){e.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&e.push(n);return e}},{}],21:[function(t,e){(function(i){function n(t){function e(t){if(!t)return!1;if(i.Buffer&&i.Buffer.isBuffer(t)||i.ArrayBuffer&&t instanceof ArrayBuffer||i.Blob&&t instanceof Blob||i.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t)for(var r in t.toJSON&&(t=t.toJSON()),t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}return e(t)}var o=t("isarray");e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:24}],22:[function(t,e){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(i){e.exports=!1}},{}],23:[function(t,e){var i=[].indexOf;e.exports=function(t,e){if(i)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},{}],24:[function(t,e){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],25:[function(t,e){function i(t){if(!((t=""+t).length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*h;case"days":case"day":case"d":return i*c;case"hours":case"hour":case"hrs":case"hr":case"h":return i*l;case"minutes":case"minute":case"mins":case"min":case"m":return i*a;case"seconds":case"second":case"secs":case"sec":case"s":return i*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i}}}}function n(t){return t>=c?Math.round(t/c)+"d":t>=l?Math.round(t/l)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function o(t){return r(t,c,"day")||r(t,l,"hour")||r(t,a,"minute")||r(t,s,"second")||t+" ms"}function r(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var s=1e3,a=60*s,l=60*a,c=24*l,h=365.25*c;e.exports=function(t,e){return e=e||{},"string"==typeof t?i(t):e.long?o(t):n(t)}},{}],26:[function(t,e){(function(t){var i=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(a,""),t.JSON&&JSON.parse?JSON.parse(e):i.test(e.replace(n,"@").replace(o,"]").replace(r,""))?new Function("return "+e)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],27:[function(t,e,i){i.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},i.decode=function(t){for(var e={},i=t.split("&"),n=0,o=i.length;n<o;n++){var r=i[n].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}},{}],28:[function(t,e){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(t){var e=t,o=t.indexOf("["),r=t.indexOf("]");-1!=o&&-1!=r&&(t=t.substring(0,o)+t.substring(o,r).replace(/:/g,";")+t.substring(r,t.length));for(var s=i.exec(t||""),a={},l=14;l--;)a[n[l]]=s[l]||"";return-1!=o&&-1!=r&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],29:[function(e,i,n){(function(e){!function(o){function r(t){for(var e,i,n=[],o=0,r=t.length;o<r;)(e=t.charCodeAt(o++))>=55296&&e<=56319&&o<r?56320==(64512&(i=t.charCodeAt(o++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),o--):n.push(e);return n}function s(t){for(var e,i=t.length,n=-1,o="";++n<i;)(e=t[n])>65535&&(o+=S((e-=65536)>>>10&1023|55296),e=56320|1023&e),o+=S(e);return o}function a(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}function l(t,e){return S(t>>e&63|128)}function c(t){if(0==(4294967168&t))return S(t);var e="";return 0==(4294965248&t)?e=S(t>>6&31|192):0==(4294901760&t)?(a(t),e=S(t>>12&15|224),e+=l(t,6)):0==(4292870144&t)&&(e=S(t>>18&7|240),e+=l(t,12),e+=l(t,6)),e+=S(63&t|128)}function h(t){for(var e=r(t),i=e.length,n=-1,o="";++n<i;)o+=c(e[n]);return o}function u(){if(y>=b)throw Error("Invalid byte index");var t=255&v[y];if(y++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function d(){var t,e;if(y>b)throw Error("Invalid byte index");if(y==b)return!1;if(t=255&v[y],y++,0==(128&t))return t;if(192==(224&t)){if((e=(31&t)<<6|u())>=128)return e;throw Error("Invalid continuation byte")}if(224==(240&t)){if((e=(15&t)<<12|u()<<6|u())>=2048)return a(e),e;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=(15&t)<<18|u()<<12|u()<<6|u())>=65536&&e<=1114111)return e;throw Error("Invalid UTF-8 detected")}function p(t){v=r(t),b=v.length,y=0;for(var e,i=[];!1!==(e=d());)i.push(e);return s(i)}var f="object"==typeof n&&n,g="object"==typeof i&&i&&i.exports==f&&i,m="object"==typeof e&&e;m.global!==m&&m.window!==m||(o=m);var v,b,y,S=String.fromCharCode,k={version:"2.0.0",encode:h,decode:p};if("function"==typeof t&&"object"==typeof t.amd&&t.amd)t(function(){return k});else if(f&&!f.nodeType)if(g)g.exports=k;else{var w={}.hasOwnProperty;for(var _ in k)w.call(k,_)&&(f[_]=k[_])}else o.utf8=k}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],30:[function(t,e){"use strict";function i(t){var e="";do{e=s[t%a]+e,t=Math.floor(t/a)}while(t>0);return e}function n(t){var e=0;for(h=0;h<t.length;h++)e=e*a+l[t.charAt(h)];return e}function o(){var t=i(+new Date);return t!==r?(c=0,r=t):t+"."+i(c++)}for(var r,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,l={},c=0,h=0;h<a;h++)l[s[h]]=h;o.encode=i,o.decode=n,e.exports=o},{}],31:[function(t,e,i){function n(t,e){"object"==typeof t&&(e=t,t=undefined),e=e||{};var i,n=o(t),r=n.source,c=n.id,h=n.path,u=l[c]&&h in l[c].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||u?(a("ignoring socket cache for %s",r),i=s(r,e)):(l[c]||(a("new io instance for %s",r),l[c]=s(r,e)),i=l[c]),i.socket(n.path)}var o=t("./url"),r=t("socket.io-parser"),s=t("./manager"),a=t("debug")("socket.io-client");e.exports=i=n;var l=i.managers={};i.protocol=r.protocol,i.connect=n,i.Manager=t("./manager"),i.Socket=t("./socket")},{"./manager":32,"./socket":34,"./url":35,debug:39,"socket.io-parser":47}],32:[function(t,e){function i(t,e){if(!(this instanceof i))return new i(t,e);t&&"object"==typeof t&&(e=t,t=undefined),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||Infinity),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}var n=t("engine.io-client"),o=t("./socket"),r=t("component-emitter"),s=t("socket.io-parser"),a=t("./on"),l=t("component-bind"),c=t("debug")("socket.io-client:manager"),h=t("indexof"),u=t("backo2"),d=Object.prototype.hasOwnProperty;e.exports=i,i.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)d.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},i.prototype.updateSocketIds=function(){for(var t in this.nsps)d.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id)},r(i.prototype),i.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},i.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},i.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},i.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},i.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},i.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},i.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},i.prototype.open=i.prototype.connect=function(t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=n(this.uri,this.opts);var e=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=a(e,"open",function(){i.onopen(),t&&t()}),r=a(e,"error",function(e){if(c("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;c("connect attempt will timeout after %d",s);var l=setTimeout(function(){c("connect attempt timed out after %d",s),o.destroy(),e.close(),e.emit("error","timeout"),i.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(o),this.subs.push(r),this},i.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(a(t,"data",l(this,"ondata"))),this.subs.push(a(t,"ping",l(this,"onping"))),this.subs.push(a(t,"pong",l(this,"onpong"))),this.subs.push(a(t,"error",l(this,"onerror"))),this.subs.push(a(t,"close",l(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",l(this,"ondecoded")))},i.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},i.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},i.prototype.ondata=function(t){this.decoder.add(t)},i.prototype.ondecoded=function(t){this.emit("packet",t)},i.prototype.onerror=function(t){c("error",t),this.emitAll("error",t)},i.prototype.socket=function(t){function e(){~h(n.connecting,i)||n.connecting.push(i)}var i=this.nsps[t];if(!i){i=new o(this,t),this.nsps[t]=i;var n=this;i.on("connecting",e),i.on("connect",function(){i.id=n.engine.id}),this.autoConnect&&e()}return i},i.prototype.destroy=function(t){var e=h(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},i.prototype.packet=function(t){c("writing packet %j",t);var e=this;e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(i){for(var n=0;n<i.length;n++)e.engine.write(i[n],t.options);e.encoding=!1,e.processPacketQueue()}))},i.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},i.prototype.cleanup=function(){var t;for(c("cleanup");t=this.subs.shift();)t.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},i.prototype.close=i.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},i.prototype.onclose=function(t){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},i.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();c("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout(function(){t.skipReconnect||(c("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(c("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(c("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(i)}})}},i.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},{"./on":33,"./socket":34,backo2:36,"component-bind":37,"component-emitter":38,debug:39,"engine.io-client":1,indexof:42,"socket.io-parser":47}],33:[function(t,e){function i(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}e.exports=i},{}],34:[function(t,e){function i(t,e){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}var n=t("socket.io-parser"),o=t("component-emitter"),r=t("to-array"),s=t("./on"),a=t("component-bind"),l=t("debug")("socket.io-client:socket"),c=t("has-binary");e.exports=i;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},u=o.prototype.emit;o(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[s(t,"open",a(this,"onopen")),s(t,"packet",a(this,"onpacket")),s(t,"close",a(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting"),this)},i.prototype.send=function(){var t=r(arguments);return t.unshift("message"),this.emit.apply(this,t),this},i.prototype.emit=function(t){if(h.hasOwnProperty(t))return u.apply(this,arguments),this;var e=r(arguments),i=n.EVENT;c(e)&&(i=n.BINARY_EVENT);var o={type:i,data:e,options:{}};return o.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),o.id=this.ids++),this.connected?this.packet(o):this.sendBuffer.push(o),delete this.flags,this},i.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},i.prototype.onopen=function(){l("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:n.CONNECT})},i.prototype.onclose=function(t){l("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},i.prototype.onpacket=function(t){if(t.nsp==this.nsp)switch(t.type){case n.CONNECT:this.onconnect();break;case n.EVENT:case n.BINARY_EVENT:this.onevent(t);break;case n.ACK:case n.BINARY_ACK:this.onack(t);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",t.data)}},i.prototype.onevent=function(t){var e=t.data||[];l("emitting event %j",e),null!=t.id&&(l("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?u.apply(this,e):this.receiveBuffer.push(e)},i.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var o=r(arguments);l("sending ack %j",o);var s=c(o)?n.BINARY_ACK:n.ACK;e.packet({type:s,id:t,data:o})}}},i.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(l("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):l("bad ack %s",t.id)},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)u.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:n.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},i.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this}},{"./on":33,"component-bind":37,"component-emitter":38,debug:39,"has-binary":41,"socket.io-parser":47,"to-array":51}],35:[function(t,e){(function(i){function n(t,e){var n=t;e=e||i.location;null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"==t.charAt(0)&&(t="/"==t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),r("parse %s",t),n=o(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port,n.href=n.protocol+"://"+s+(e&&e.port==n.port?"":":"+n.port),n}var o=t("parseuri"),r=t("debug")("socket.io-client:url");e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{debug:39,parseuri:45}],36:[function(t,e){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}e.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},{}],37:[function(t,e){var i=[].slice;e.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}},{}],38:[function(t,e){function i(t){if(t)return n(t)}function n(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}e.exports=i,i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},i.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var n=0,o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,e);return this},i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],39:[function(t,e,i){arguments[4][17][0].apply(i,arguments)},{"./debug":40,dup:17}],40:[function(t,e,i){arguments[4][18][0].apply(i,arguments)},{dup:18,ms:44}],41:[function(t,e){(function(i){function n(t){function e(t){if(!t)return!1;if(i.Buffer&&i.Buffer.isBuffer&&i.Buffer.isBuffer(t)||i.ArrayBuffer&&t instanceof ArrayBuffer||i.Blob&&t instanceof Blob||i.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t)for(var r in t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}return e(t)}var o=t("isarray");e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:43}],42:[function(t,e,i){arguments[4][23][0].apply(i,arguments)},{dup:23}],43:[function(t,e,i){arguments[4][24][0].apply(i,arguments)},{dup:24}],44:[function(t,e,i){arguments[4][25][0].apply(i,arguments)},{dup:25}],45:[function(t,e,i){arguments[4][28][0].apply(i,arguments)},{dup:28}],46:[function(t,e,i){(function(e){var n=t("isarray"),o=t("./is-buffer");i.deconstructPacket=function(t){function e(t){if(!t)return t;if(o(t)){var r={_placeholder:!0,num:i.length};return i.push(t),r}if(n(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a]);return s}if("object"==typeof t&&!(t instanceof Date)){s={};for(var l in t)s[l]=e(t[l]);return s}return t}var i=[],r=t.data,s=t;return s.data=e(r),s.attachments=i.length,{packet:s,buffers:i}},i.reconstructPacket=function(t,e){function i(t){if(t&&t._placeholder)return e[t.num];if(n(t)){for(var o=0;o<t.length;o++)t[o]=i(t[o]);return t}if(t&&"object"==typeof t){for(var r in t)t[r]=i(t[r]);return t}return t}return t.data=i(t.data),t.attachments=undefined,t},i.removeBlobs=function(t,i){function r(t,l,c){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){s++;var h=new FileReader;h.onload=function(){c?c[l]=this.result:a=this.result,--s||i(a)},h.readAsArrayBuffer(t)}else if(n(t))for(var u=0;u<t.length;u++)r(t[u],u,t);else if(t&&"object"==typeof t&&!o(t))for(var d in t)r(t[d],d,t)
}var s=0,a=t;r(a),s||i(a)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./is-buffer":48,isarray:43}],47:[function(t,e,i){function n(){}function o(t){var e="",n=!1;return e+=t.type,i.BINARY_EVENT!=t.type&&i.BINARY_ACK!=t.type||(e+=t.attachments,e+="-"),t.nsp&&"/"!=t.nsp&&(n=!0,e+=t.nsp),null!=t.id&&(n&&(e+=",",n=!1),e+=t.id),null!=t.data&&(n&&(e+=","),e+=u.stringify(t.data)),h("encoded %j as %s",t,e),e}function r(t,e){function i(t){var i=p.deconstructPacket(t),n=o(i.packet),r=i.buffers;r.unshift(n),e(r)}p.removeBlobs(t,i)}function s(){this.reconstructor=null}function a(t){var e={},n=0;if(e.type=Number(t.charAt(0)),null==i.types[e.type])return c();if(i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type){for(var o="";"-"!=t.charAt(++n)&&(o+=t.charAt(n),n!=t.length););if(o!=Number(o)||"-"!=t.charAt(n))throw new Error("Illegal attachments");e.attachments=Number(o)}if("/"==t.charAt(n+1))for(e.nsp="";++n;){if(","==(s=t.charAt(n)))break;if(e.nsp+=s,n==t.length)break}else e.nsp="/";var r=t.charAt(n+1);if(""!==r&&Number(r)==r){for(e.id="";++n;){var s;if(null==(s=t.charAt(n))||Number(s)!=s){--n;break}if(e.id+=t.charAt(n),n==t.length)break}e.id=Number(e.id)}if(t.charAt(++n))try{e.data=u.parse(t.substr(n))}catch(a){return c()}return h("decoded %s as %j",t,e),e}function l(t){this.reconPack=t,this.buffers=[]}function c(){return{type:i.ERROR,data:"parser error"}}var h=t("debug")("socket.io-parser"),u=t("json3"),d=(t("isarray"),t("component-emitter")),p=t("./binary"),f=t("./is-buffer");i.protocol=4,i.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],i.CONNECT=0,i.DISCONNECT=1,i.EVENT=2,i.ACK=3,i.ERROR=4,i.BINARY_EVENT=5,i.BINARY_ACK=6,i.Encoder=n,i.Decoder=s,n.prototype.encode=function(t,e){(h("encoding packet %j",t),i.BINARY_EVENT==t.type||i.BINARY_ACK==t.type)?r(t,e):e([o(t)])},d(s.prototype),s.prototype.add=function(t){var e;if("string"==typeof t)e=a(t),i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type?(this.reconstructor=new l(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!f(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",e))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},l.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=p.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},l.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":46,"./is-buffer":48,"component-emitter":49,debug:39,isarray:43,json3:50}],48:[function(t,e){(function(t){function i(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],49:[function(t,e,i){arguments[4][15][0].apply(i,arguments)},{dup:15}],50:[function(e,i,n){(function(e){(function(){function o(t,e){function i(t){if(i[t]!==m)return i[t];var o;if("bug-string-char-index"==t)o="a"!="a"[0];else if("json"==t)o=i("json-stringify")&&i("json-parse");else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var l=e.stringify,h="function"==typeof l&&y;if(h){(s=function(){return 1}).toJSON=s;try{h="0"===l(0)&&"0"===l(new n)&&'""'==l(new r)&&l(b)===m&&l(m)===m&&l()===m&&"1"===l(s)&&"[1]"==l([s])&&"[null]"==l([m])&&"null"==l(null)&&"[null,null,null]"==l([m,b,null])&&l({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===l(null,s)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new c(-1))}catch(p){h=!1}}o=h}if("json-parse"==t){var u=e.parse;if("function"==typeof u)try{if(0===u("0")&&!u(!1)){var d=5==(s=u(a)).a.length&&1===s.a[0];if(d){try{d=!u('"\t"')}catch(p){}if(d)try{d=1!==u("01")}catch(p){}if(d)try{d=1!==u("1.")}catch(p){}}}}catch(p){d=!1}o=d}}return i[t]=!!o}t||(t=l.Object()),e||(e=l.Object());var n=t.Number||l.Number,r=t.String||l.String,a=t.Object||l.Object,c=t.Date||l.Date,h=t.SyntaxError||l.SyntaxError,u=t.TypeError||l.TypeError,d=t.Math||l.Math,p=t.JSON||l.JSON;"object"==typeof p&&p&&(e.stringify=p.stringify,e.parse=p.parse);var f,g,m,v=a.prototype,b=v.toString,y=new c(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(j){}if(!i("json")){var S="[object Function]",k="[object Date]",w="[object Number]",_="[object String]",x="[object Array]",L="[object Boolean]",C=i("bug-string-char-index");if(!y)var E=d.floor,T=[0,31,59,90,120,151,181,212,243,273,304,334],M=function(t,e){return T[e]+365*(t-1970)+E((t-1969+(e=+(e>1)))/4)-E((t-1901+e)/100)+E((t-1601+e)/400)};if((f=v.hasOwnProperty)||(f=function(t){var e,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=b?f=function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(e=i.constructor,f=function(t){var i=(this.constructor||e).prototype;return t in this&&!(t in i&&this[t]===i[t])}),i=null,f.call(this,t)}),g=function(t,e){var i,n,o,r=0;for(o in(i=function(){this.valueOf=0}).prototype.valueOf=0,n=new i)f.call(n,o)&&r++;return i=n=null,r?g=2==r?function(t,e){var i,n={},o=b.call(t)==S;for(i in t)o&&"prototype"==i||f.call(n,i)||!(n[i]=1)||!f.call(t,i)||e(i)}:function(t,e){var i,n,o=b.call(t)==S;for(i in t)o&&"prototype"==i||!f.call(t,i)||(n="constructor"===i)||e(i);(n||f.call(t,i="constructor"))&&e(i)}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(t,e){var i,o,r=b.call(t)==S,a=!r&&"function"!=typeof t.constructor&&s[typeof t.hasOwnProperty]&&t.hasOwnProperty||f;for(i in t)r&&"prototype"==i||!a.call(t,i)||e(i);for(o=n.length;i=n[--o];a.call(t,i)&&e(i));}),g(t,e)},!i("json-stringify")){var A={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},I="000000",O=function(t,e){return(I+(e||0)).slice(-t)},R="\\u00",D=function(t){for(var e='"',i=0,n=t.length,o=!C||n>10,r=o&&(C?t.split(""):t);i<n;i++){var s=t.charCodeAt(i);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=A[s];break;default:if(s<32){e+=R+O(2,s.toString(16));break}e+=o?r[i]:t.charAt(i)}}return e+'"'},B=function(t,e,i,n,o,r,s){var a,l,c,h,d,p,v,y,S,C,T,A,I,R,P,N;try{a=e[t]}catch(j){}if("object"==typeof a&&a)if((l=b.call(a))!=k||f.call(a,"toJSON"))"function"==typeof a.toJSON&&(l!=w&&l!=_&&l!=x||f.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&a<1/0){if(M){for(d=E(a/864e5),c=E(d/365.2425)+1970-1;M(c+1,0)<=d;c++);for(h=E((d-M(c,0))/30.42);M(c,h+1)<=d;h++);d=1+d-M(c,h),v=E((p=(a%864e5+864e5)%864e5)/36e5)%24,y=E(p/6e4)%60,S=E(p/1e3)%60,C=p%1e3}else c=a.getUTCFullYear(),h=a.getUTCMonth(),d=a.getUTCDate(),v=a.getUTCHours(),y=a.getUTCMinutes(),S=a.getUTCSeconds(),C=a.getUTCMilliseconds();a=(c<=0||c>=1e4?(c<0?"-":"+")+O(6,c<0?-c:c):O(4,c))+"-"+O(2,h+1)+"-"+O(2,d)+"T"+O(2,v)+":"+O(2,y)+":"+O(2,S)+"."+O(3,C)+"Z"}else a=null;if(i&&(a=i.call(e,t,a)),null===a)return"null";if((l=b.call(a))==L)return""+a;if(l==w)return a>-1/0&&a<1/0?""+a:"null";if(l==_)return D(""+a);if("object"==typeof a){for(R=s.length;R--;)if(s[R]===a)throw u();if(s.push(a),T=[],P=r,r+=o,l==x){for(I=0,R=a.length;I<R;I++)A=B(I,a,i,n,o,r,s),T.push(A===m?"null":A);N=T.length?o?"[\n"+r+T.join(",\n"+r)+"\n"+P+"]":"["+T.join(",")+"]":"[]"}else g(n||a,function(t){var e=B(t,a,i,n,o,r,s);e!==m&&T.push(D(t)+":"+(o?" ":"")+e)}),N=T.length?o?"{\n"+r+T.join(",\n"+r)+"\n"+P+"}":"{"+T.join(",")+"}":"{}";return s.pop(),N}};e.stringify=function(t,e,i){var n,o,r,a;if(s[typeof e]&&e)if((a=b.call(e))==S)o=e;else if(a==x){r={};for(var l,c=0,h=e.length;c<h;l=e[c++],((a=b.call(l))==_||a==w)&&(r[l]=1));}if(i)if((a=b.call(i))==w){if((i-=i%1)>0)for(n="",i>10&&(i=10);n.length<i;n+=" ");}else a==_&&(n=i.length<=10?i:i.slice(0,10));return B("",((l={})[""]=t,l),o,r,n,"",[])}}if(!i("json-parse")){var P,N,z=r.fromCharCode,V={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},F=function(){throw P=N=null,h()},$=function(){for(var t,e,i,n,o,r=N,s=r.length;P<s;)switch(o=r.charCodeAt(P)){case 9:case 10:case 13:case 32:P++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=C?r.charAt(P):r[P],P++,t;case 34:for(t="@",P++;P<s;)if((o=r.charCodeAt(P))<32)F();else if(92==o)switch(o=r.charCodeAt(++P)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=V[o],P++;break;case 117:for(e=++P,i=P+4;P<i;P++)(o=r.charCodeAt(P))>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||F();t+=z("0x"+r.slice(e,P));break;default:F()}else{if(34==o)break;for(o=r.charCodeAt(P),e=P;o>=32&&92!=o&&34!=o;)o=r.charCodeAt(++P);t+=r.slice(e,P)}if(34==r.charCodeAt(P))return P++,t;F();default:if(e=P,45==o&&(n=!0,o=r.charCodeAt(++P)),o>=48&&o<=57){for(48==o&&((o=r.charCodeAt(P+1))>=48&&o<=57)&&F(),n=!1;P<s&&((o=r.charCodeAt(P))>=48&&o<=57);P++);if(46==r.charCodeAt(P)){for(i=++P;i<s&&((o=r.charCodeAt(i))>=48&&o<=57);i++);i==P&&F(),P=i}if(101==(o=r.charCodeAt(P))||69==o){for(43!=(o=r.charCodeAt(++P))&&45!=o||P++,i=P;i<s&&((o=r.charCodeAt(i))>=48&&o<=57);i++);i==P&&F(),P=i}return+r.slice(e,P)}if(n&&F(),"true"==r.slice(P,P+4))return P+=4,!0;if("false"==r.slice(P,P+5))return P+=5,!1;if("null"==r.slice(P,P+4))return P+=4,null;F()}return"$"},H=function(t){var e,i;if("$"==t&&F(),"string"==typeof t){if("@"==(C?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];"]"!=(t=$());i||(i=!0))i&&(","==t?"]"==(t=$())&&F():F()),","==t&&F(),e.push(H(t));return e}if("{"==t){for(e={};"}"!=(t=$());i||(i=!0))i&&(","==t?"}"==(t=$())&&F():F()),","!=t&&"string"==typeof t&&"@"==(C?t.charAt(0):t[0])&&":"==$()||F(),e[t.slice(1)]=H($());return e}F()}return t},U=function(t,e,i){var n=W(t,e,i);n===m?delete t[e]:t[e]=n},W=function(t,e,i){var n,o=t[e];if("object"==typeof o&&o)if(b.call(o)==x)for(n=o.length;n--;)U(o,n,i);else g(o,function(t){U(o,t,i)});return i.call(t,e,o)};e.parse=function(t,e){var i,n;return P=0,N=""+t,i=H($()),"$"!=$()&&F(),P=N=null,e&&b.call(e)==S?W(((n={})[""]=i,n),"",e):i}}}return e.runInContext=o,e}var r="function"==typeof t&&t.amd,s={"function":!0,object:!0},a=s[typeof n]&&n&&!n.nodeType&&n,l=s[typeof window]&&window||this,c=a&&s[typeof i]&&i&&!i.nodeType&&"object"==typeof e&&e;if(!c||c.global!==c&&c.window!==c&&c.self!==c||(l=c),a&&!r)o(l,a);else{var h=l.JSON,u=l.JSON3,d=!1,p=o(l,l.JSON3={noConflict:function(){return d||(d=!0,l.JSON=h,l.JSON3=u,h=u=null),p}});l.JSON={parse:p.parse,stringify:p.stringify}}r&&t(function(){return p})}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],51:[function(t,e){function i(t,e){for(var i=[],n=(e=e||0)||0;n<t.length;n++)i[n-e]=t[n];return i}e.exports=i},{}]},{},[31])(31)}),
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.


 Style HTML
---------------

  Written by Nochum Sossonko, (nsossonko@hotmail.com)

  Based on code initially developed by: Einar Lielmanis, <einar@beautifier.io>
    https://beautifier.io/

  Usage:
    style_html(html_source);

    style_html(html_source, options);

  The options are:
    indent_inner_html (default false)   indent <head> and <body> sections,
    indent_size (default 4)           indentation size,
    indent_char (default space)       character to indent with,
    wrap_line_length (default 250)            -  maximum amount of characters per line (0 = disable)
    brace_style (default "collapse") - "collapse" | "expand" | "end-expand" | "none"
            put braces on the same line as control statements (default), or put braces on own line (Allman / ANSI style), or just put end braces on own line, or attempt to keep them where they are.
    inline (defaults to inline tags) - list of tags to be considered inline tags
    unformatted (defaults to inline tags) - list of tags, that shouldn't be reformatted
    content_unformatted (defaults to ["pre", "textarea"] tags) - list of tags, whose content shouldn't be reformatted
    indent_scripts (default normal)  - "keep"|"separate"|"normal"
    preserve_newlines (default true) - whether existing line breaks before elements should be preserved
                                        Only works before elements, not inside tags or for text.
    max_preserve_newlines (default unlimited) - maximum number of line breaks to be preserved in one chunk
    indent_handlebars (default false) - format and indent {{#foo}} and {{/foo}}
    end_with_newline (false)          - end with a newline
    extra_liners (default [head,body,/html]) -List of tags that should have an extra newline before them.

    e.g.

    style_html(html_source, {
      'indent_inner_html': false,
      'indent_size': 2,
      'indent_char': ' ',
      'wrap_line_length': 78,
      'brace_style': 'expand',
      'preserve_newlines': true,
      'max_preserve_newlines': 5,
      'indent_handlebars': false,
      'extra_liners': ['/html']
    });
*/
function(){var t=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=18)}([,,function(t){"use strict";
/*
  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function e(t){this.__parent=t,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function i(t,e){this.__cache=[""],this.__indent_size=t.indent_size,this.__indent_string=t.indent_char,t.indent_with_tabs||(this.__indent_string=new Array(t.indent_size+1).join(t.indent_char)),e=e||"",t.indent_level>0&&(e=new Array(t.indent_level+1).join(this.__indent_string)),this.__base_string=e,this.__base_string_length=e.length}function n(t,n){this.__indent_cache=new i(t,n),this.raw=!1,this._end_with_newline=t.end_with_newline,this.indent_size=t.indent_size,this.wrap_line_length=t.wrap_line_length,this.indent_empty_lines=t.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new e(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}e.prototype.clone_empty=function(){var t=new e(this.__parent);return t.set_indent(this.__indent_count,this.__alignment_count),t},e.prototype.item=function(t){return t<0?this.__items[this.__items.length+t]:this.__items[t]},e.prototype.has_match=function(t){for(var e=this.__items.length-1;e>=0;e--)if(this.__items[e].match(t))return!0;return!1},e.prototype.set_indent=function(t,e){this.is_empty()&&(this.__indent_count=t||0,this.__alignment_count=e||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},e.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},e.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},e.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var t=this.__parent.current_line;return t.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),t.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),t.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===t.__items[0]&&(t.__items.splice(0,1),t.__character_count-=1),!0}return!1},e.prototype.is_empty=function(){return 0===this.__items.length},e.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},e.prototype.push=function(t){this.__items.push(t);var e=t.lastIndexOf("\n");-1!==e?this.__character_count=t.length-e:this.__character_count+=t.length},e.prototype.pop=function(){var t=null;return this.is_empty()||(t=this.__items.pop(),this.__character_count-=t.length),t},e.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},e.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},e.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},e.prototype.toString=function(){var t="";return this.is_empty()?this.__parent.indent_empty_lines&&(t=this.__parent.get_indent_string(this.__indent_count)):(t=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),t+=this.__items.join("")),t},i.prototype.get_indent_size=function(t,e){var i=this.__base_string_length;return e=e||0,t<0&&(i=0),i+=t*this.__indent_size,i+=e},i.prototype.get_indent_string=function(t,e){var i=this.__base_string;return e=e||0,t<0&&(t=0,i=""),e+=t*this.__indent_size,this.__ensure_cache(e),i+=this.__cache[e]},i.prototype.__ensure_cache=function(t){for(;t>=this.__cache.length;)this.__add_column()},i.prototype.__add_column=function(){var t=this.__cache.length,e=0,i="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,i=new Array(e+1).join(this.__indent_string)),t&&(i+=new Array(t+1).join(" ")),this.__cache.push(i)},n.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},n.prototype.get_line_number=function(){return this.__lines.length},n.prototype.get_indent_string=function(t,e){return this.__indent_cache.get_indent_string(t,e)},n.prototype.get_indent_size=function(t,e){return this.__indent_cache.get_indent_size(t,e)},n.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},n.prototype.add_new_line=function(t){return!(this.is_empty()||!t&&this.just_added_newline())&&(this.raw||this.__add_outputline(),!0)},n.prototype.get_code=function(t){this.trim(!0);var e=this.current_line.pop();e&&("\n"===e[e.length-1]&&(e=e.replace(/\n+$/g,"")),this.current_line.push(e)),this._end_with_newline&&this.__add_outputline();var i=this.__lines.join("\n");return"\n"!==t&&(i=i.replace(/[\n]/g,t)),i},n.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},n.prototype.set_indent=function(t,e){return t=t||0,e=e||0,this.next_line.set_indent(t,e),this.__lines.length>1?(this.current_line.set_indent(t,e),!0):(this.current_line.set_indent(),!1)},n.prototype.add_raw_token=function(t){for(var e=0;e<t.newlines;e++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(t.whitespace_before),this.current_line.push(t.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},n.prototype.add_token=function(t){this.__add_space_before_token(),this.current_line.push(t),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},n.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},n.prototype.remove_indent=function(t){for(var e=this.__lines.length;t<e;)this.__lines[t]._remove_indent(),t++;this.current_line._remove_wrap_indent()},n.prototype.trim=function(t){for(t=t!==undefined&&t,this.current_line.trim();t&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},n.prototype.just_added_newline=function(){return this.current_line.is_empty()},n.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},n.prototype.ensure_empty_line_above=function(t,i){for(var n=this.__lines.length-2;n>=0;){var o=this.__lines[n];if(o.is_empty())break;if(0!==o.item(0).indexOf(t)&&o.item(-1)!==i){this.__lines.splice(n+1,0,new e(this)),this.previous_line=this.__lines[this.__lines.length-2];break}n--}},t.exports.Output=n},function(t){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function e(t,e,i,n){this.type=t,this.text=e,this.comments_before=null,this.newlines=i||0,this.whitespace_before=n||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}t.exports.Token=e},,,function(t){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function e(t,e){this.raw_options=i(t,e),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php"],["auto"])}function i(t,e){var i,o={};for(i in t=n(t))i!==e&&(o[i]=t[i]);if(e&&t[e])for(i in t[e])o[i]=t[e][i];return o}function n(t){var e,i={};for(e in t){i[e.replace(/-/g,"_")]=t[e]}return i}e.prototype._get_array=function(t,e){var i=this.raw_options[t],n=e||[];return"object"==typeof i?null!==i&&"function"==typeof i.concat&&(n=i.concat()):"string"==typeof i&&(n=i.split(/[^a-zA-Z0-9_\/\-]+/)),n},e.prototype._get_boolean=function(t,e){var i=this.raw_options[t];return i===undefined?!!e:!!i},e.prototype._get_characters=function(t,e){var i=this.raw_options[t],n=e||"";return"string"==typeof i&&(n=i.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),n},e.prototype._get_number=function(t,e){var i=this.raw_options[t];e=parseInt(e,10),isNaN(e)&&(e=0);var n=parseInt(i,10);return isNaN(n)&&(n=e),n},e.prototype._get_selection=function(t,e,i){var n=this._get_selection_list(t,e,i);if(1!==n.length)throw new Error("Invalid Option Value: The option '"+t+"' can only be one of the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return n[0]},e.prototype._get_selection_list=function(t,e,i){if(!e||0===e.length)throw new Error("Selection list cannot be empty.");if(i=i||[e[0]],!this._is_valid_selection(i,e))throw new Error("Invalid Default Value!");var n=this._get_array(t,i);if(!this._is_valid_selection(n,e))throw new Error("Invalid Option Value: The option '"+t+"' can contain only the following values:\n"+e+"\nYou passed in: '"+this.raw_options[t]+"'");return n},e.prototype._is_valid_selection=function(t,e){return t.length&&e.length&&!t.some(function(t){return-1===e.indexOf(t)})},t.exports.Options=e,t.exports.normalizeOpts=n,t.exports.mergeOpts=i},,function(t){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function e(t){this.__input=t||"",this.__input_length=this.__input.length,this.__position=0}var i=RegExp.prototype.hasOwnProperty("sticky");e.prototype.restart=function(){this.__position=0},e.prototype.back=function(){this.__position>0&&(this.__position-=1)},e.prototype.hasNext=function(){return this.__position<this.__input_length},e.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__input.charAt(this.__position),this.__position+=1),t},e.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__input_length&&(e=this.__input.charAt(t)),e},e.prototype.__match=function(t,e){t.lastIndex=e;var n=t.exec(this.__input);return!n||i&&t.sticky||n.index!==e&&(n=null),n},e.prototype.test=function(t,e){return e=e||0,(e+=this.__position)>=0&&e<this.__input_length&&!!this.__match(t,e)},e.prototype.testChar=function(t,e){var i=this.peek(e);return t.lastIndex=0,null!==i&&t.test(i)},e.prototype.match=function(t){var e=this.__match(t,this.__position);return e?this.__position+=e[0].length:e=null,e},e.prototype.read=function(t,e,i){var n,o="";return t&&(n=this.match(t))&&(o+=n[0]),!e||!n&&t||(o+=this.readUntil(e,i)),o},e.prototype.readUntil=function(t,e){var i="",n=this.__position;t.lastIndex=this.__position;var o=t.exec(this.__input);return o?(n=o.index,e&&(n+=o[0].length)):n=this.__input_length,i=this.__input.substring(this.__position,n),this.__position=n,i},e.prototype.readUntilAfter=function(t){return this.readUntil(t,!0)},e.prototype.get_regexp=function(t,e){var n=null,o="g";return e&&i&&(o="y"),"string"==typeof t&&""!==t?n=new RegExp(t,o):t&&(n=new RegExp(t.source,o)),n},e.prototype.get_literal_regexp=function(t){return RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},e.prototype.peekUntilAfter=function(t){var e=this.__position,i=this.readUntilAfter(t);return this.__position=e,i},e.prototype.lookBack=function(t){var e=this.__position-1;return e>=t.length&&this.__input.substring(e-t.length,e).toLowerCase()===t},t.exports.InputScanner=e},function(t,e,i){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/var n=i(8).InputScanner,o=i(3).Token,r=i(10).TokenStream,s=i(11).WhitespacePattern,a={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},l=function(t,e){this._input=new n(t),this._options=e||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new s(this._input)};l.prototype.tokenize=function(){var t;this._input.restart(),this.__tokens=new r,this._reset();for(var e=new o(a.START,""),i=null,n=[],s=new r;e.type!==a.EOF;){for(t=this._get_next_token(e,i);this._is_comment(t);)s.add(t),t=this._get_next_token(e,i);s.isEmpty()||(t.comments_before=s,s=new r),t.parent=i,this._is_opening(t)?(n.push(i),i=t):i&&this._is_closing(t,i)&&(t.opened=i,i.closed=t,i=n.pop(),t.parent=i),t.previous=e,e.next=t,this.__tokens.add(t),e=t}return this.__tokens},l.prototype._is_first_token=function(){return this.__tokens.isEmpty()},l.prototype._reset=function(){},l.prototype._get_next_token=function(){this._readWhitespace();var t=this._input.read(/.+/g);return t?this._create_token(a.RAW,t):this._create_token(a.EOF,"")},l.prototype._is_comment=function(){return!1},l.prototype._is_opening=function(){return!1},l.prototype._is_closing=function(){return!1},l.prototype._create_token=function(t,e){return new o(t,e,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},l.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},t.exports.Tokenizer=l,t.exports.TOKEN=a},function(t){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function e(t){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=t}e.prototype.restart=function(){this.__position=0},e.prototype.isEmpty=function(){return 0===this.__tokens_length},e.prototype.hasNext=function(){return this.__position<this.__tokens_length},e.prototype.next=function(){var t=null;return this.hasNext()&&(t=this.__tokens[this.__position],this.__position+=1),t},e.prototype.peek=function(t){var e=null;return t=t||0,(t+=this.__position)>=0&&t<this.__tokens_length&&(e=this.__tokens[t]),e},e.prototype.add=function(t){this.__parent_token&&(t.parent=this.__parent_token),this.__tokens.push(t),this.__tokens_length+=1},t.exports.TokenStream=e},function(t,e,i){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function n(t,e){o.call(this,t,e),e?this._line_regexp=this._input.get_regexp(e._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}var o=i(12).Pattern;n.prototype=new o,n.prototype.__set_whitespace_patterns=function(t,e){t+="\\t ",e+="\\n\\r",this._match_pattern=this._input.get_regexp("["+t+e+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+e+"]")},n.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var t=this._input.read(this._match_pattern);if(" "===t)this.whitespace_before_token=" ";else if(t){var e=this.__split(this._newline_regexp,t);this.newline_count=e.length-1,this.whitespace_before_token=e[this.newline_count]}return t},n.prototype.matching=function(t,e){var i=this._create();return i.__set_whitespace_patterns(t,e),i._update(),i},n.prototype._create=function(){return new n(this._input,this)},n.prototype.__split=function(t,e){t.lastIndex=0;for(var i=0,n=[],o=t.exec(e);o;)n.push(e.substring(i,o.index)),i=o.index+o[0].length,o=t.exec(e);return i<e.length?n.push(e.substring(i,e.length)):n.push(""),n},t.exports.WhitespacePattern=n},function(t){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function e(t,e){this._input=t,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,e&&(this._starting_pattern=this._input.get_regexp(e._starting_pattern,!0),this._match_pattern=this._input.get_regexp(e._match_pattern,!0),this._until_pattern=this._input.get_regexp(e._until_pattern),this._until_after=e._until_after)}e.prototype.read=function(){var t=this._input.read(this._starting_pattern);return this._starting_pattern&&!t||(t+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),t},e.prototype.read_match=function(){return this._input.match(this._match_pattern)},e.prototype.until_after=function(t){var e=this._create();return e._until_after=!0,e._until_pattern=this._input.get_regexp(t),e._update(),e},e.prototype.until=function(t){var e=this._create();return e._until_after=!1,e._until_pattern=this._input.get_regexp(t),e._update(),e},e.prototype.starting_with=function(t){var e=this._create();return e._starting_pattern=this._input.get_regexp(t,!0),e._update(),e},e.prototype.matching=function(t){var e=this._create();return e._match_pattern=this._input.get_regexp(t,!0),e._update(),e},e.prototype._create=function(){return new e(this._input,this)},e.prototype._update=function(){},t.exports.Pattern=e},function(t){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function e(t,e){t="string"==typeof t?t:t.source,e="string"==typeof e?e:e.source,this.__directives_block_pattern=new RegExp(t+/ beautify( \w+[:]\w+)+ /.source+e,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(t+/\sbeautify\signore:end\s/.source+e,"g")}e.prototype.get_directives=function(t){if(!t.match(this.__directives_block_pattern))return null;var e={};this.__directive_pattern.lastIndex=0;for(var i=this.__directive_pattern.exec(t);i;)e[i[1]]=i[2],i=this.__directive_pattern.exec(t);return e},e.prototype.readIgnored=function(t){return t.readUntilAfter(this.__directives_end_ignore_pattern)},t.exports.Directives=e},function(t,e,i){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function n(t,e){o.call(this,t,e),this.__template_pattern=null,this._disabled=Object.assign({},r),this._excluded=Object.assign({},r),e&&(this.__template_pattern=this._input.get_regexp(e.__template_pattern),this._excluded=Object.assign(this._excluded,e._excluded),this._disabled=Object.assign(this._disabled,e._disabled));var i=new o(t);this.__patterns={handlebars_comment:i.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:i.starting_with(/{{{/).until_after(/}}}/),handlebars:i.starting_with(/{{/).until_after(/}}/),php:i.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:i.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:i.starting_with(/{%/).until_after(/%}/),django_value:i.starting_with(/{{/).until_after(/}}/),django_comment:i.starting_with(/{#/).until_after(/#}/)}}var o=i(12).Pattern,r={django:!1,erb:!1,handlebars:!1,php:!1};n.prototype=new o,n.prototype._create=function(){return new n(this._input,this)},n.prototype._update=function(){this.__set_templated_pattern()},n.prototype.disable=function(t){var e=this._create();return e._disabled[t]=!0,e._update(),e},n.prototype.read_options=function(t){var e=this._create();for(var i in r)e._disabled[i]=-1===t.templating.indexOf(i);return e._update(),e},n.prototype.exclude=function(t){var e=this._create();return e._excluded[t]=!0,e._update(),e},n.prototype.read=function(){var t="";t=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var e=this._read_template();e;)this._match_pattern?e+=this._input.read(this._match_pattern):e+=this._input.readUntil(this.__template_pattern),t+=e,e=this._read_template();return this._until_after&&(t+=this._input.readUntilAfter(this._until_pattern)),t},n.prototype.__set_templated_pattern=function(){var t=[];this._disabled.php||t.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||t.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||t.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(t.push(this.__patterns.django._starting_pattern.source),t.push(this.__patterns.django_value._starting_pattern.source),t.push(this.__patterns.django_comment._starting_pattern.source)),this._until_pattern&&t.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+t.join("|")+")")},n.prototype._read_template=function(){var t="",e=this._input.peek();if("<"===e){var i=this._input.peek(1);this._disabled.php||this._excluded.php||"?"!==i||(t=t||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==i||(t=t||this.__patterns.erb.read())}else"{"===e&&(this._disabled.handlebars||this._excluded.handlebars||(t=(t=(t=t||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(t=t||this.__patterns.django_value.read()),this._excluded.django||(t=(t=t||this.__patterns.django_comment.read())||this.__patterns.django.read())));return t},t.exports.TemplatablePattern=n},,,,function(t,e,i){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function n(t,e,i,n){return new o(t,e,i,n).beautify()}var o=i(19).Beautifier,r=i(20).Options;t.exports=n,t.exports.defaultOptions=function(){return new r}},function(t,e,i){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function n(t,e){return-1!==e.indexOf(t)}function o(t,e,i){this.parent=t||null,this.tag=e?e.tag_name:"",this.indent_level=i||0,this.parser_token=e||null}function r(t){this._printer=t,this._current_frame=null}function s(t,e,i,n){this._source_text=t||"",e=e||{},this._js_beautify=i,this._css_beautify=n,this._tag_stack=null;var o=new a(e,"html");this._options=o,this._is_wrap_attributes_force="force"===this._options.wrap_attributes.substr(0,"force".length),this._is_wrap_attributes_force_expand_multiline="force-expand-multiline"===this._options.wrap_attributes,this._is_wrap_attributes_force_aligned="force-aligned"===this._options.wrap_attributes,this._is_wrap_attributes_aligned_multiple="aligned-multiple"===this._options.wrap_attributes,this._is_wrap_attributes_preserve="preserve"===this._options.wrap_attributes.substr(0,"preserve".length),this._is_wrap_attributes_preserve_aligned="preserve-aligned"===this._options.wrap_attributes}var a=i(20).Options,l=i(2).Output,c=i(21).Tokenizer,h=i(21).TOKEN,u=/\r\n|[\r\n]/,d=/\r\n|[\r\n]/g,p=function(t,e){this.indent_level=0,this.alignment_size=0,this.max_preserve_newlines=t.max_preserve_newlines,this.preserve_newlines=t.preserve_newlines,this._output=new l(t,e)};p.prototype.current_line_has_match=function(t){return this._output.current_line.has_match(t)},p.prototype.set_space_before_token=function(t,e){this._output.space_before_token=t,this._output.non_breaking_space=e},p.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size),this._output.set_wrap_point()},p.prototype.add_raw_token=function(t){this._output.add_raw_token(t)},p.prototype.print_preserved_newlines=function(t){var e=0;t.type!==h.TEXT&&t.previous.type!==h.TEXT&&(e=t.newlines?1:0),this.preserve_newlines&&(e=t.newlines<this.max_preserve_newlines+1?t.newlines:this.max_preserve_newlines+1);for(var i=0;i<e;i++)this.print_newline(i>0);return 0!==e},p.prototype.traverse_whitespace=function(t){return!(!t.whitespace_before&&!t.newlines)&&(this.print_preserved_newlines(t)||(this._output.space_before_token=!0),!0)},p.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped},p.prototype.print_newline=function(t){this._output.add_new_line(t)},p.prototype.print_token=function(t){t.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(t.text))},p.prototype.indent=function(){this.indent_level++},p.prototype.get_full_indent=function(t){return(t=this.indent_level+(t||0))<1?"":this._output.get_indent_string(t)};var f=function(t){for(var e=null,i=t.next;i.type!==h.EOF&&t.closed!==i;){if(i.type===h.ATTRIBUTE&&"type"===i.text){i.next&&i.next.type===h.EQUALS&&i.next.next&&i.next.next.type===h.VALUE&&(e=i.next.next.text);break}i=i.next}return e},g=function(t,e){var i=null,n=null;return e.closed?("script"===t?i="text/javascript":"style"===t&&(i="text/css"),(i=f(e)||i).search("text/css")>-1?n="css":i.search(/(text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect)/)>-1?n="javascript":i.search(/(text|application|dojo)\/(x-)?(html)/)>-1?n="html":i.search(/test\/null/)>-1&&(n="null"),n):null};r.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null},r.prototype.record_tag=function(t){var e=new o(this._current_frame,t,this._printer.indent_level);this._current_frame=e},r.prototype._try_pop_frame=function(t){var e=null;return t&&(e=t.parser_token,this._printer.indent_level=t.indent_level,this._current_frame=t.parent),e},r.prototype._get_frame=function(t,e){for(var i=this._current_frame;i&&-1===t.indexOf(i.tag);){if(e&&-1!==e.indexOf(i.tag)){i=null;break}i=i.parent}return i},r.prototype.try_pop=function(t,e){var i=this._get_frame([t],e);return this._try_pop_frame(i)},r.prototype.indent_to_tag=function(t){var e=this._get_frame(t);e&&(this._printer.indent_level=e.indent_level)},s.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var t=this._source_text,e=this._options.eol;"auto"===this._options.eol&&(e="\n",t&&u.test(t)&&(e=t.match(u)[0]));var i=(t=t.replace(d,"\n")).match(/^[\t ]*/)[0],n={text:"",type:""},o=new m,s=new p(this._options,i),a=new c(t,this._options).tokenize();this._tag_stack=new r(s);for(var l=null,f=a.next();f.type!==h.EOF;)f.type===h.TAG_OPEN||f.type===h.COMMENT?o=l=this._handle_tag_open(s,f,o,n):f.type===h.ATTRIBUTE||f.type===h.EQUALS||f.type===h.VALUE||f.type===h.TEXT&&!o.tag_complete?l=this._handle_inside_tag(s,f,o,a):f.type===h.TAG_CLOSE?l=this._handle_tag_close(s,f,o):f.type===h.TEXT?l=this._handle_text(s,f,o):s.add_raw_token(f),n=l,f=a.next();return s._output.get_code(e)},s.prototype._handle_tag_close=function(t,e,i){var n={text:e.text,type:e.type};return t.alignment_size=0,i.tag_complete=!0,t.set_space_before_token(e.newlines||""!==e.whitespace_before,!0),i.is_unformatted?t.add_raw_token(e):("<"===i.tag_start_char&&(t.set_space_before_token("/"===e.text[0],!0),this._is_wrap_attributes_force_expand_multiline&&i.has_wrapped_attrs&&t.print_newline(!1)),t.print_token(e)),!i.indent_content||i.is_unformatted||i.is_content_unformatted||(t.indent(),i.indent_content=!1),i.is_inline_element||i.is_unformatted||i.is_content_unformatted||t.set_wrap_point(),n},s.prototype._handle_inside_tag=function(t,e,i,n){var o=i.has_wrapped_attrs,r={text:e.text,type:e.type};if(t.set_space_before_token(e.newlines||""!==e.whitespace_before,!0),i.is_unformatted)t.add_raw_token(e);else if("{"===i.tag_start_char&&e.type===h.TEXT)t.print_preserved_newlines(e)?(e.newlines=0,t.add_raw_token(e)):t.print_token(e);else{if(e.type===h.ATTRIBUTE?(t.set_space_before_token(!0),i.attr_count+=1):e.type===h.EQUALS?t.set_space_before_token(!1):e.type===h.VALUE&&e.previous.type===h.EQUALS&&t.set_space_before_token(!1),e.type===h.ATTRIBUTE&&"<"===i.tag_start_char&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(t.traverse_whitespace(e),o=o||0!==e.newlines),this._is_wrap_attributes_force)){var s=i.attr_count>1;if(this._is_wrap_attributes_force_expand_multiline&&1===i.attr_count){var a,l=!0,c=0;do{if((a=n.peek(c)).type===h.ATTRIBUTE){l=!1;break}c+=1}while(c<4&&a.type!==h.EOF&&a.type!==h.TAG_CLOSE);s=!l}s&&(t.print_newline(!1),o=!0)}t.print_token(e),o=o||t.previous_token_wrapped(),i.has_wrapped_attrs=o}return r},s.prototype._handle_text=function(t,e,i){var n={text:e.text,type:"TK_CONTENT"};return i.custom_beautifier_name?this._print_custom_beatifier_text(t,e,i):i.is_unformatted||i.is_content_unformatted?t.add_raw_token(e):(t.traverse_whitespace(e),t.print_token(e)),n},s.prototype._print_custom_beatifier_text=function(t,e,i){var n=this;if(""!==e.text){var o,r=e.text,a=1,l="",c="";"javascript"===i.custom_beautifier_name&&"function"==typeof this._js_beautify?o=this._js_beautify:"css"===i.custom_beautifier_name&&"function"==typeof this._css_beautify?o=this._css_beautify:"html"===i.custom_beautifier_name&&(o=function(t,e){return new s(t,e,n._js_beautify,n._css_beautify).beautify()}),"keep"===this._options.indent_scripts?a=0:"separate"===this._options.indent_scripts&&(a=-t.indent_level);var h=t.get_full_indent(a);if(r=r.replace(/\n[ \t]*$/,""),"html"!==i.custom_beautifier_name&&"<"===r[0]&&r.match(/^(<!--|<!\[CDATA\[)/)){var u=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(r);if(!u)return void t.add_raw_token(e);l=h+u[1]+"\n",r=u[4],u[5]&&(c=h+u[5]),r=r.replace(/\n[ \t]*$/,""),(u[2]||-1!==u[3].indexOf("\n"))&&(u=u[3].match(/[ \t]+$/))&&(e.whitespace_before=u[0])}if(r)if(o){var d=function(){this.eol="\n"};d.prototype=this._options.raw_options,r=o(h+r,new d)}else{var p=e.whitespace_before;p&&(r=r.replace(new RegExp("\n("+p+")?","g"),"\n")),r=h+r.replace(/\n/g,"\n"+h)}l&&(r=r?l+r+"\n"+c:l+c),t.print_newline(!1),r&&(e.text=r,e.whitespace_before="",e.newlines=0,t.add_raw_token(e),t.print_newline(!0))}},s.prototype._handle_tag_open=function(t,e,i,n){var o=this._get_tag_open_token(e);return(i.is_unformatted||i.is_content_unformatted)&&e.type===h.TAG_OPEN&&0===e.text.indexOf("</")?t.add_raw_token(e):(t.traverse_whitespace(e),this._set_tag_position(t,e,o,i,n),o.is_inline_element||t.set_wrap_point(),t.print_token(e)),(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(o.alignment_size=e.text.length+1),o.tag_complete||o.is_unformatted||(t.alignment_size=o.alignment_size),o};var m=function(t,e){var i;(this.parent=t||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",e)?(this.tag_start_char=e.text[0],this.text=e.text,"<"===this.tag_start_char?(i=e.text.match(/^<([^\s>]*)/),this.tag_check=i?i[1]:""):(i=e.text.match(/^{{[#\^]?([^\s}]+)/),this.tag_check=i?i[1]:""),this.tag_check=this.tag_check.toLowerCase(),e.type===h.COMMENT&&(this.tag_complete=!0),this.is_start_tag="/"!==this.tag_check.charAt(0),this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||e.closed&&"/>"===e.closed.text,this.is_end_tag=this.is_end_tag||"{"===this.tag_start_char&&(this.text.length<3||/[^#\^]/.test(this.text.charAt(2)))):this.tag_complete=!0};s.prototype._get_tag_open_token=function(t){var e=new m(this._tag_stack.get_parser_token(),t);return e.alignment_size=this._options.wrap_attributes_indent_size,e.is_end_tag=e.is_end_tag||n(e.tag_check,this._options.void_elements),e.is_empty_element=e.tag_complete||e.is_start_tag&&e.is_end_tag,e.is_unformatted=!e.tag_complete&&n(e.tag_check,this._options.unformatted),e.is_content_unformatted=!e.is_empty_element&&n(e.tag_check,this._options.content_unformatted),e.is_inline_element=n(e.tag_name,this._options.inline)||"{"===e.tag_start_char,e},s.prototype._set_tag_position=function(t,e,i,o,r){if(i.is_empty_element||(i.is_end_tag?i.start_tag_token=this._tag_stack.try_pop(i.tag_name):(this._do_optional_end_element(i)&&(i.is_inline_element||(i.parent&&(i.parent.multiline_content=!0),t.print_newline(!1))),this._tag_stack.record_tag(i),"script"!==i.tag_name&&"style"!==i.tag_name||i.is_unformatted||i.is_content_unformatted||(i.custom_beautifier_name=g(i.tag_check,e)))),n(i.tag_check,this._options.extra_liners)&&(t.print_newline(!1),t._output.just_added_blankline()||t.print_newline(!0)),i.is_empty_element){if("{"===i.tag_start_char&&"else"===i.tag_check)this._tag_stack.indent_to_tag(["if","unless","each"]),i.indent_content=!0,t.current_line_has_match(/{{#if/)||t.print_newline(!1);"!--"===i.tag_name&&r.type===h.TAG_CLOSE&&o.is_end_tag&&-1===i.text.indexOf("\n")||i.is_inline_element||i.is_unformatted||t.print_newline(!1)}else i.is_unformatted||i.is_content_unformatted?i.is_inline_element||i.is_unformatted||t.print_newline(!1):i.is_end_tag?(i.start_tag_token&&i.start_tag_token.multiline_content||!(i.is_inline_element||o.is_inline_element||r.type===h.TAG_CLOSE&&i.start_tag_token===o||"TK_CONTENT"===r.type))&&t.print_newline(!1):(i.indent_content=!i.custom_beautifier_name,"<"===i.tag_start_char&&("html"===i.tag_name?i.indent_content=this._options.indent_inner_html:"head"===i.tag_name?i.indent_content=this._options.indent_head_inner_html:"body"===i.tag_name&&(i.indent_content=this._options.indent_body_inner_html)),i.is_inline_element||"TK_CONTENT"===r.type||(i.parent&&(i.parent.multiline_content=!0),t.print_newline(!1)))},s.prototype._do_optional_end_element=function(t){var e=null;if(!t.is_empty_element&&t.is_start_tag&&t.parent)return"body"===t.tag_name?e=e||this._tag_stack.try_pop("head"):"li"===t.tag_name?e=e||this._tag_stack.try_pop("li",["ol","ul"]):"dd"===t.tag_name||"dt"===t.tag_name?e=(e=e||this._tag_stack.try_pop("dt",["dl"]))||this._tag_stack.try_pop("dd",["dl"]):"rp"===t.tag_name||"rt"===t.tag_name?e=(e=e||this._tag_stack.try_pop("rt",["ruby","rtc"]))||this._tag_stack.try_pop("rp",["ruby","rtc"]):"optgroup"===t.tag_name?e=e||this._tag_stack.try_pop("optgroup",["select"]):"option"===t.tag_name?e=e||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):"colgroup"===t.tag_name?e=e||this._tag_stack.try_pop("caption",["table"]):"thead"===t.tag_name?e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]):"tbody"===t.tag_name||"tfoot"===t.tag_name?e=(e=(e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("thead",["table"]))||this._tag_stack.try_pop("tbody",["table"]):"tr"===t.tag_name?e=(e=(e=e||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"]):"th"!==t.tag_name&&"td"!==t.tag_name||(e=(e=e||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]))||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"])),t.parent=this._tag_stack.get_parser_token(),e},t.exports.Beautifier=s},function(t,e,i){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/function n(t){o.call(this,t,"html"),1===this.templating.length&&"auto"===this.templating[0]&&(this.templating=["django","erb","handlebars","php"]),this.indent_inner_html=this._get_boolean("indent_inner_html"),this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0),this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0),this.indent_handlebars=this._get_boolean("indent_handlebars",!0),this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]),this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size),this.extra_liners=this._get_array("extra_liners",["head","body","/html"]),this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]),this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]),this.unformatted=this._get_array("unformatted",[]),this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]),this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter"),this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}var o=i(6).Options;n.prototype=new o,t.exports.Options=n},function(t,e,i){"use strict";
/*

  The MIT License (MIT)

  Copyright (c) 2007-2018 Einar Lielmanis, Liam Newman, and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.
*/var n=i(9).Tokenizer,o=i(9).TOKEN,r=i(13).Directives,s=i(14).TemplatablePattern,a=i(12).Pattern,l={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:o.START,RAW:o.RAW,EOF:o.EOF},c=new r(/<\!--/,/-->/),h=function(t,e){n.call(this,t,e),this._current_tag_name="";var i=new s(this._input).read_options(this._options),o=new a(this._input);if(this.__patterns={word:i.until(/[\n\r\t <]/),single_quote:i.until_after(/'/),double_quote:i.until_after(/"/),attribute:i.until(/[\n\r\t =\/>]/),element_name:i.until(/[\n\r\t >\/]/),handlebars_comment:o.starting_with(/{{!--/).until_after(/--}}/),handlebars:o.starting_with(/{{/).until_after(/}}/),handlebars_open:o.until(/[\n\r\t }]/),handlebars_raw_close:o.until(/}}/),comment:o.starting_with(/<!--/).until_after(/-->/),cdata:o.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:o.starting_with(/<!\[/).until_after(/]>/),processing:o.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter){var r=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=o.matching(r).until_after(r)}};h.prototype=new n,h.prototype._is_comment=function(){return!1},h.prototype._is_opening=function(t){return t.type===l.TAG_OPEN},h.prototype._is_closing=function(t,e){return t.type===l.TAG_CLOSE&&e&&((">"===t.text||"/>"===t.text)&&"<"===e.text[0]||"}}"===t.text&&"{"===e.text[0]&&"{"===e.text[1])},h.prototype._reset=function(){this._current_tag_name=""},h.prototype._get_next_token=function(t,e){var i=null;this._readWhitespace();var n=this._input.peek();return null===n?this._create_token(l.EOF,""):i=(i=(i=(i=(i=(i=(i=(i=(i=i||this._read_open_handlebars(n,e))||this._read_attribute(n,t,e))||this._read_raw_content(n,t,e))||this._read_close(n,e))||this._read_content_word(n))||this._read_comment_or_cdata(n))||this._read_processing(n))||this._read_open(n,e))||this._create_token(l.UNKNOWN,this._input.next())},h.prototype._read_comment_or_cdata=function(t){var e=null,i=null,n=null;"<"===t&&("!"===this._input.peek(1)&&((i=this.__patterns.comment.read())?(n=c.get_directives(i))&&"start"===n.ignore&&(i+=c.readIgnored(this._input)):i=this.__patterns.cdata.read()),i&&((e=this._create_token(l.COMMENT,i)).directives=n));return e},h.prototype._read_processing=function(t){var e=null,i=null,n=null;if("<"===t){var o=this._input.peek(1);"!"!==o&&"?"!==o||(i=(i=this.__patterns.conditional_comment.read())||this.__patterns.processing.read()),i&&((e=this._create_token(l.COMMENT,i)).directives=n)}return e},h.prototype._read_open=function(t,e){var i=null,n=null;return e||"<"===t&&(i=this._input.next(),"/"===this._input.peek()&&(i+=this._input.next()),i+=this.__patterns.element_name.read(),n=this._create_token(l.TAG_OPEN,i)),n},h.prototype._read_open_handlebars=function(t,e){var i=null,n=null;return e||this._options.indent_handlebars&&"{"===t&&"{"===this._input.peek(1)&&("!"===this._input.peek(2)?(i=(i=this.__patterns.handlebars_comment.read())||this.__patterns.handlebars.read(),n=this._create_token(l.COMMENT,i)):(i=this.__patterns.handlebars_open.read(),n=this._create_token(l.TAG_OPEN,i))),n},h.prototype._read_close=function(t,e){var i=null,n=null;return e&&("<"===e.text[0]&&(">"===t||"/"===t&&">"===this._input.peek(1))?(i=this._input.next(),"/"===t&&(i+=this._input.next()),n=this._create_token(l.TAG_CLOSE,i)):"{"===e.text[0]&&"}"===t&&"}"===this._input.peek(1)&&(this._input.next(),this._input.next(),n=this._create_token(l.TAG_CLOSE,"}}"))),n},h.prototype._read_attribute=function(t,e,i){var n=null,o="";if(i&&"<"===i.text[0])if("="===t)n=this._create_token(l.EQUALS,this._input.next());else if('"'===t||"'"===t){var r=this._input.next();r+='"'===t?this.__patterns.double_quote.read():this.__patterns.single_quote.read(),n=this._create_token(l.VALUE,r)}else(o=this.__patterns.attribute.read())&&(n=e.type===l.EQUALS?this._create_token(l.VALUE,o):this._create_token(l.ATTRIBUTE,o));return n},h.prototype._is_content_unformatted=function(t){return-1===this._options.void_elements.indexOf(t)&&(-1!==this._options.content_unformatted.indexOf(t)||-1!==this._options.unformatted.indexOf(t))},h.prototype._read_raw_content=function(t,e,i){var n="";if(i&&"{"===i.text[0])n=this.__patterns.handlebars_raw_close.read();else if(e.type===l.TAG_CLOSE&&"<"===e.opened.text[0]){var o=e.opened.text.substr(1).toLowerCase();if("script"===o||"style"===o){var r=this._read_comment_or_cdata(t);if(r)return r.type=l.TEXT,r;n=this._input.readUntil(new RegExp("</"+o+"[\\n\\r\\t ]*?>","ig"))}else this._is_content_unformatted(o)&&(n=this._input.readUntil(new RegExp("</"+o+"[\\n\\r\\t ]*?>","ig")))}return n?this._create_token(l.TEXT,n):null},h.prototype._read_content_word=function(t){var e="";if(this._options.unformatted_content_delimiter&&t===this._options.unformatted_content_delimiter[0]&&(e=this.__patterns.unformatted_content_delimiter.read()),e||(e=this.__patterns.word.read()),e)return this._create_token(l.TEXT,e)},t.exports.Tokenizer=h,t.exports.TOKEN=l}]);if("function"==typeof define&&define.amd)define(["require","./beautify","./beautify-css"],function(e){var i=e("./beautify"),n=e("./beautify-css");return{html_beautify:function(e,o){return t(e,o,i.js_beautify,n.css_beautify)}}});else if("undefined"!=typeof exports){var e=require("./beautify.js"),i=require("./beautify-css.js");exports.html_beautify=function(n,o){return t(n,o,e.js_beautify,i.css_beautify)}}else"undefined"!=typeof window?window.html_beautify=function(e,i){return t(e,i,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(e,i){return t(e,i,global.js_beautify,global.css_beautify)})}(),function(){function t(t,e){return[t[0]+e[0],t[1]+e[1]]}function e(t,e){return[t[0]-e[0],t[1]-e[1]]}function i(t,e){return[e[0]-t[0],e[1]-t[1]]}function n(t,e){return[t[0]*e,t[1]*e]}function o(t,e){return[t[0]/e,t[1]/e]}function r(t){return[t[1],-t[0]]}function s(t,e){return t[0]*e[0]+t[1]*e[1]}function a(t){return Math.hypot(t[0],t[1])}function l(t){return t[0]*t[0]+t[1]*t[1]}function c(t,i){return l(e(t,i))}function h(t){return o(t,a(t))}function u(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function d(e,i){return n(t(e,i),.5)}function p(t,e,i){let n=Math.sin(i),o=Math.cos(i),r=t[0]-e[0],s=t[1]-e[1],a=r*n+s*o;return[r*o-s*n+e[0],a+e[1]]}function f(e,o,r){return t(e,n(i(e,o),r))}function g(t,e){return t[0]===e[0]&&t[1]===e[1]}function m(t,e,i){return t*(1-i)+e*i}function v(t,e,i){return Math.max(e,Math.min(i,t))}function b(t){return Array.isArray(t[0])?t.map(([t,e,i=.5])=>[t,e,i]):t.map(({x:t,y:e,pressure:i=.5})=>[t,e,i])}function y(t,e,i,n=.5){return e?(n=v(i(n),0,1),(e<0?m(t,t+t*v(e,-.95,-.05),n):m(t-t*v(e,.05,.95),t,n))/2):t/2}function S(i,n={}){let{streamline:o=.5}=n,{simulatePressure:r=!0}=n;o/=r?4:2;let s=b(i);if(0===s.length)return[];1===s.length&&s.push([...t(s[0],[1,1]),s[0][2]]);let a=[{point:[s[0][0],s[0][1]],pressure:s[0][2],vector:[0,0],distance:0,runningLength:0}];for(let t=1,i=0,n=s[t],r=a[i];t<s.length;n=s[++t],r=a[i]){let t=f(r.point,n,1-o);if(g(r.point,t))continue;let s=h(e(r.point,t)),l=u(t,r.point),c=r.runningLength+l,d={point:t,pressure:n[2],vector:s,distance:l,runningLength:c};a.push(d),i+=1}return a}function k(o,a={}){let{size:l=8,thinning:m=.5,smoothing:v=.5,simulatePressure:b=!0,easing:S=(t=>t),start:k={},end:w={},last:L=!1}=a,{streamline:C=.5}=a;C/=2;let{cap:E=!0,taper:T=0,easing:M=(t=>t*(2-t))}=k,{cap:A=!0,taper:I=0,easing:O=(t=>--t*t*t+1)}=w,R=o.length;if(0===R)return[];let D,B=o[R-1].runningLength,P=[],N=[],z=o.slice(0,5).reduce((t,e)=>(t+e.pressure)/2,o[0].pressure),V=y(l,m,S,o[R-1].pressure),F=o[0].vector,$=o[0].point,H=$,U=$,W=H,j=!0;for(let i=0;i<R-1;i++){let{pressure:a}=o[i],{point:h,vector:u,distance:d,runningLength:g}=o[i];if(i>0&&j&&g<l/2)continue;if(j&&(j=!1),m){if(b){let t=_(1,1-d/l),e=_(1,d/l);a=_(1,z+e/2*(t-z))}V=y(l,m,S,a)}else V=l/2;void 0===D&&(D=V);let k=g<T?M(g/T):1,w=B-g<I?O((B-g)/I):1;V=Math.max(.01,V*Math.min(k,w));let L=o[i+1].vector,E=s(u,L);if(E<0){let i=n(r(F),V);for(let n=0;n<1;n+=.2)W=p(t(h,i),h,x*-n),U=p(e(h,i),h,x*n),N.push(W),P.push(U);$=U,H=W;continue}let A=n(r(f(L,u,E)),V);U=e(h,A),W=t(h,A);let R=i<2||E<.25,G=Math.pow(Math.max((g>l?l:l/2)*v,1),2);(R||c($,U)>G)&&(P.push(f($,U,C)),$=U),(R||c(H,W)>G)&&(N.push(f(H,W,C)),H=W),z=a,F=u}let G=o[0],q=o[R-1],K=j||N.length<2||P.length<2;if(K&&(!T&&!I||L)){let t=0;for(let e=0;e<R;e++){let{pressure:i,runningLength:n}=o[e];if(n>l){t=y(l,m,S,i);break}}let s=e(G.point,n(r(h(i(q.point,G.point))),t||V)),a=[];for(let t=0,e=.1;t<=1;t+=e)a.push(p(s,G.point,2*x*t));return a}let X=[],Y=[];if(P.length>1&&N.length>1){W=N[1];for(let t=1;t<P.length;t++)if(!g(W,P[t])){U=P[t];break}if(E||T){if(T||I&&K)X.push(G.point,t(G.point,[.1,.1]));else if(!g(W,U)){let t=e(G.point,n(h(i(W,U)),u(W,U)/2));for(let e=0,i=.1;e<=1;e+=i)X.push(p(t,G.point,x*e));P.shift(),N.shift()}}else if(!g(W,U)){let o=h(i(W,U)),r=u(W,U)/2;X.push(e(G.point,n(o,.95*r))),X.push(e(G.point,n(o,r))),X.push(t(G.point,n(o,r))),X.push(t(G.point,n(o,.95*r))),P.shift(),N.shift()}let o=d(P[P.length-1],N[N.length-1]),s=a.last?q.point:f(o,q.point,.618),l=h(e(s,o));if(A||I)if(I||T&&K)Y.push(s);else{let e=t(s,n(r(l),V));for(let t=0,i=.15;t<=1;t+=i)Y.push(p(e,s,3*x*t))}else{let i=f(o,s,.95),a=.95*V;Y.push(t(i,n(r(l),a))),Y.push(t(s,n(r(l),a))),Y.push(e(s,n(r(l),a))),Y.push(e(i,n(r(l),a)))}}return P.concat(Y,N.reverse(),X)}function w(t,e={}){return k(S(t,e),e)}var{min:_,PI:x}=Math;window.PerfectFreehand={getStroke:w}}(),SL("editor.blocks").Base=Class.extend({init:function(t,e){this.type=t,this.pairings=[],this.plugins=[],this.measurements=null,this.anchorPositions=null,this.rotation=null,this.options=$.extend({contentElementType:"div",contentElementTypeImmutable:!1,aspectRatio:0,minWidth:SL.config.BLOCK_MIN_SIZE,minHeight:SL.config.BLOCK_MIN_SIZE,horizontalResizing:!0,verticalResizing:!0,rotation:!0,keyboardConsumer:!1,introDelay:1},e),this.options.element&&(this.domElement=$(this.options.element),this.contentElement=this.find(".sl-block-content").first()),this.setup(),this.validateProperties(),this.render(),this.bind(),this.format(),this.paint(),this.bindTransformBehavior(),this.plug(SL.editor.blocks.plugin.Filter)},setup:function(){this.watchlist={},this.removed=new signals.Signal,this.dragStarted=new signals.Signal,this.dragUpdated=new signals.Signal,this.dragEnded=new signals.Signal,this.focused=!1,this.moved=!1,this.mouseDownCursor={x:0,y:0},this.mouseDownMeasurements=null,this.properties={style:{opacity:{type:"number",unit:"%",minValue:0,maxValue:100,defaultValue:100,serialize:function(t){return parseInt(t,10)/100},deserialize:function(t){return 100*parseFloat(t)},setter:this.setOpacity.bind(this),getter:this.getOpacity.bind(this)},padding:{type:"number",unit:"px",decimals:0,minValue:0,maxValue:100,defaultValue:0},color:{computed:!0},"background-color":{computed:!0},"border-color":{computed:!0,getter:this.getBorderColor.bind(this)},"border-style":{defaultValue:"none",options:[{value:"solid",title:"Solid"},{value:"dashed",title:"Dashed"},{value:"dotted",title:"Dotted"}]},"border-width":{type:"number",unit:"px",decimals:0,minValue:0,maxValue:200,defaultValue:0},"border-radius":{type:"number",unit:"px",decimals:0,minValue:0,maxValue:200,defaultValue:0},"text-align":{options:[{value:"left",icon:"alignleft"},{value:"center",icon:"aligncenter"},{value:"right",icon:"alignright"},{value:"justify",icon:"alignjustify"}]},"font-size":{type:"number",unit:"%",minValue:1,maxValue:500,defaultValue:100},"line-height":{type:"number",unit:"%",minValue:0,maxValue:300,defaultValue:100,serialize:function(t){return parseInt(t,10)/100*1.3},deserialize:function(t){return parseFloat(t)/1.3*100}},"letter-spacing":{type:"number",unit:"%",minValue:0,maxValue:300,defaultValue:100,serialize:function(t){return parseInt(t,10)/100-1+"em"},deserialize:function(t){return 100*(parseFloat(t)+1)}},"z-index":{type:"number",minValue:0,maxValue:1e3,setter:this.setZ.bind(this),getter:this.getZ.bind(this)},"transition-duration":{type:"number",unit:"s",decimals:1,minValue:0,maxValue:10,stepSize:.1,defaultValue:0},"transition-delay":{type:"number",unit:"s",decimals:1,minValue:0,maxValue:100,stepSize:.1,defaultValue:0},"transform-origin":{defaultValue:"50% 50%",unsetWhenDefault:!0,deserialize:function(t){return"string"==typeof t?t.split(" ").slice(0,2).join(" "):t}}},transform:{rotate:{type:"number",toolbarUnit:"\xb0",decimals:0,minValue:0,maxValue:360,defaultValue:0,setter:this.setRotation.bind(this),getter:this.getRotation.bind(this)}},attribute:{"class":{type:"string",setter:this.setClassName.bind(this),getter:this.getClassName.bind(this)},"data-name":{type:"string",serialize:SL.util.string.slug,targetElement:function(){return this.domElement}},"data-locked":{type:"string",defaultValue:!1,unsetWhenDefault:!0,targetElement:function(){return this.domElement}},"data-animation-type":{options:[{value:"fade-in",title:"Fade in"},{value:"fade-out",title:"Fade out"},{value:"slide-up",title:"Slide up"},{value:"slide-down",title:"Slide down"},{value:"slide-right",title:"Slide right"},{value:"slide-left",title:"Slide left"},{value:"scale-up",title:"Scale up"},{value:"scale-down",title:"Scale down"}]},"data-animation-trigger":{defaultValue:"show",unsetWhenDefault:!0,options:[{value:"show",title:"Auto",tooltip:"Animate when the slide becomes visible"},{value:"click",title:"Click",tooltip:"Animate when an element is clicked"},{value:"hover",title:"Hover",tooltip:"Animate when an element is hovered"}]},"data-animation-trigger-id":{type:"string",defaultValue:"self"},"data-auto-animate-delay":{type:"number",unit:"s",decimals:1,minValue:SL.config.AUTO_ANIMATE_DELAY_MIN/1e3,maxValue:SL.config.AUTO_ANIMATE_DELAY_MAX/1e3,stepSize:.1,defaultValue:SL.config.AUTO_ANIMATE_DELAY_DEFAULT/1e3,unsetWhenDefault:!0,serialize:parseFloat,targetElement:function(){return this.domElement}},"data-auto-animate-duration":{type:"number",unit:"s",decimals:1,minValue:SL.config.AUTO_ANIMATE_DURATION_MIN/1e3,maxValue:SL.config.AUTO_ANIMATE_DURATION_MAX/1e3,stepSize:.1,defaultValue:SL.config.AUTO_ANIMATE_DURATION_DEFAULT/1e3,serialize:parseFloat,targetElement:function(){return this.domElement}},"data-auto-animate-easing":{options:SL.config.EASING_EQUATIONS,targetElement:function(){return this.domElement}}}}},getContextMenuOptions:function(){var t=[{label:SL.keyboard.getEditorShortcut("BRING_TO_FRONT").label,shortcut:SL.keyboard.getEditorShortcut("BRING_TO_FRONT").shortcut,callback:SL.editor.controllers.Blocks.moveBlocksToDepth.bind(null,null,"front")},{label:SL.keyboard.getEditorShortcut("SEND_TO_BACK").label,shortcut:SL.keyboard.getEditorShortcut("SEND_TO_BACK").shortcut,callback:SL.editor.controllers.Blocks.moveBlocksToDepth.bind(null,null,"back")},{type:"divider"},{label:SL.keyboard.getEditorShortcut("MOVE_CENTER").label,shortcut:SL.keyboard.getEditorShortcut("MOVE_CENTER").shortcut,callback:SL.editor.controllers.Blocks.centerBlocks},{label:SL.keyboard.getEditorShortcut("MOVE_TOP").label,shortcut:SL.keyboard.getEditorShortcut("MOVE_TOP").shortcut,callback:SL.editor.controllers.Blocks.align.bind(null,null,"top","slide")},{label:SL.keyboard.getEditorShortcut("MOVE_RIGHT").label,shortcut:SL.keyboard.getEditorShortcut("MOVE_RIGHT").shortcut,callback:SL.editor.controllers.Blocks.align.bind(null,null,"right","slide")},{label:SL.keyboard.getEditorShortcut("MOVE_BOTTOM").label,shortcut:SL.keyboard.getEditorShortcut("MOVE_BOTTOM").shortcut,callback:SL.editor.controllers.Blocks.align.bind(null,null,"bottom","slide")},{label:SL.keyboard.getEditorShortcut("MOVE_LEFT").label,shortcut:SL.keyboard.getEditorShortcut("MOVE_LEFT").shortcut,callback:SL.editor.controllers.Blocks.align.bind(null,null,"left","slide")},{type:"divider"}];return this.isGroup()&&t.push({label:SL.keyboard.getEditorShortcut("UNGROUP").label,shortcut:SL.keyboard.getEditorShortcut("UNGROUP").shortcut,callback:SL.editor.controllers.Blocks.ungroupBlocks}),t.push({label:SL.keyboard.getEditorShortcut("GROUP").label,shortcut:SL.keyboard.getEditorShortcut("GROUP").shortcut,callback:SL.editor.controllers.Blocks.groupBlocks}),t.push({label:this.isLocked()?"Unlock":"Lock",shortcut:SL.keyboard.getEditorShortcut("LOCK").shortcut,callback:this.toggleLocked.bind(this)},{label:SL.keyboard.getEditorShortcut("COPY").label,shortcut:SL.keyboard.getEditorShortcut("COPY").shortcut,callback:SL.editor.controllers.Blocks.copy},{label:SL.keyboard.getEditorShortcut("DUPLICATE").label,shortcut:SL.keyboard.getEditorShortcut("DUPLICATE").shortcut,callback:SL.editor.controllers.Blocks.duplicateBlocks},{label:SL.keyboard.getEditorShortcut("DELETE").label,shortcut:SL.keyboard.getEditorShortcut("DELETE").shortcut,callback:SL.editor.controllers.Blocks.removeBlocks}),t},validateProperties:function(){for(var t in this.properties){var e=this.properties[t];for(var i in this.properties[t]){var n=e[i],o=[];"number"===n.type&&("number"!=typeof n.minValue&&o.push("must have minValue"),"number"!=typeof n.maxValue&&o.push("must have maxValue"),"number"!=typeof n.decimals&&(n.decimals=0),"string"!=typeof n.unit&&(n.unit="")),o.length&&console.warn('Malformed property "'+t+"."+i+'"',o)}}},addProperties:function(t,e){this.properties[t]||(this.properties[t]={}),$.extend(this.properties[t],e),this.validateProperties()},find:function(t){return this.domElement.find(t)},render:function(){this.domElement||(this.domElement=$("<div>"),this.domElement.addClass("sl-block")),this.contentElement&&0!==this.contentElement.length||(this.contentElement=$("<"+this.options.contentElementType+">").appendTo(this.domElement),this.contentElement.addClass("sl-block-content")),this.domElement.attr("data-block-type",this.type),this.domElement.data("block-instance",this),this.domElement.removeClass("intro-start intro-end")},bind:function(){this.onClick=this.onClick.bind(this),this.onNativeClick=this.onNativeClick.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onDoubleClick=this.onDoubleClick.bind(this),this.syncTransformVisibility=this.syncTransformVisibility.bind(this),this.freezeMeasurements=this.freezeMeasurements.bind(this),this.unfreezeMeasurements=this.unfreezeMeasurements.bind(this),this.domElement.on("click",this.onNativeClick),this.domElement.on("vclick",this.onClick),this.domElement.on("vmousedown",this.onMouseDown),this.domElement.on("mouseenter",this.onMouseEnter),this.domElement.on("mouseleave",this.onMouseLeave),SL.editor.controllers.Blocks.focusChanged.add(this.syncTransformVisibility)},bindTransformBehavior:function(){var t=!1;this.transform&&(t=this.transform.isVisible(),this.transform.destroy()),this.transform=new SL.editor.blocks.behavior.Transform(this),this.transform.doubleClicked.add(this.onDoubleClick),t&&this.transform.show()},format:function(){!1===this.options.horizontalResizing&&this.domElement.css("width","auto"),!1===this.options.verticalResizing&&this.domElement.css("height","auto")},setDefaults:function(){this.domElement.css({"min-width":this.options.minWidth===SL.config.BLOCK_MIN_SIZE?"":this.options.minWidth,"min-height":this.options.minHeight===SL.config.BLOCK_MIN_SIZE?"":this.options.minHeight})},setID:function(t){this.domElement.attr("data-block-id",t)},getID:function(){return this.domElement.attr("data-block-id")},hasID:function(){return!!this.getID()},getType:function(){return this.type},appendTo:function(t){this.domElement.appendTo(t),this.invalidateMeasurements()},detach:function(){var t=this.getGroup();this.domElement.detach(),t&&t.afterBlockRemoved()},focus:function(){this.focused||(this.focused=!0,this.domElement.addClass("is-focused"),this.invalidateMeasurements(),this.transform.isVisible()&&this.transform.syncMetadata(),this.syncTransformVisibility(),$(document).on("keydown",this.onKeyDown),$(document).on("keyup",this.onKeyUp))},blur:function(){this.focused&&(this.focused=!1,this.domElement.removeClass("is-focused"),this.syncTransformVisibility(),this.hidePaddingHint(),$(document).off("keydown",this.onKeyDown),$(document).off("keyup",this.onKeyUp))},plug:function(t){this.hasPlugin(t)?console.log("Plugin is already plugged."):this.plugins.push(new t(this))},unplug:function(t){for(var e=0;e<this.plugins.length;e++){var i=this.plugins[e];i instanceof t&&(i.destroy(),this.plugins.splice(e,1))}},hasPlugin:function(t){return this.plugins.some(function(e){return e instanceof t})},isFocused:function(){return this.focused},isMoveable:function(){return SL.view.isEditing()&&!this.isLocked()&&(!this.isGrouped()||this.getGroup().isOpen())},isLocked:function(){return!0===this.get("attribute.data-locked")},toggleLocked:function(){this.set("attribute.data-locked",!this.isLocked())},showPaddingHint:function(t){var e=this.get("style.padding");if(e>0){this.paddingHintVisible=!0;var i=this.find(".sl-block-padding-hint");0===i.length&&((i=$('<div class="editing-ui sl-block-overlay sl-block-padding-hint">')).css("transform",this.getCSSTransform()),i.appendTo(this.domElement));var n=this.measure(),o=Math.round(window.devicePixelRatio||1);e*=o;var r=n.height*o,s=n.width*o,a=(Math.round(s/2),Math.round(r/2),Math.round(e)),l=(Math.round(s-e),Math.round(r-e),Math.round(e)),c=i.find("canvas");0===c.length&&(c=$("<canvas>").appendTo(i)),c.attr({width:s,height:r}),c.css({width:s/o,height:r/o});var h=c.get(0).getContext("2d");h.clearRect(0,0,s,r),h.fillStyle="rgba(220, 220, 0, 0.5)",h.fillRect(0,0,s,r),h.clearRect(l,a,s-2*e,r-2*e),this.syncZ(),clearTimeout(this.hintPaddingTimeout),"number"==typeof t&&(this.hintPaddingTimeout=setTimeout(this.hidePaddingHint.bind(this),t))}else this.hidePaddingHint()},syncPaddingHint:function(){this.isPaddingHintVisible()&&this.showPaddingHint()},hidePaddingHint:function(){this.paddingHintVisible=!1,clearTimeout(this.hintPaddingTimeout),this.find(".sl-block-padding-hint").remove()},isPaddingHintVisible:function(){return this.paddingHintVisible},watch:function(t,e){this.watchlist[t]||(this.watchlist[t]=new signals.Signal),this.watchlist[t].add(e)},unwatch:function(t,e){this.watchlist[t]&&this.watchlist[t].remove(e)},set:function(t,e){if("string"==typeof t){var i=t;(t={})[i]=e}var n=[];for(var o in t)if(t.hasOwnProperty(o)){var r=this.getPropertySettings(o);if(r){var s=o.split("."),a=t[o],l=a,c="function"==typeof r.targetElement?r.targetElement.call(this):this.contentElement;"number"==typeof a&&0===r.decimals&&(a=Math.round(a)),r.unit&&(a+=r.unit),r.serialize&&(a=r.serialize(a));var h="undefined"!=typeof r.defaultValue&&r.defaultValue===l,u=h&&!0===r.unsetWhenDefault;r.setter?u&&"function"==typeof r.unsetter?r.unsetter.call():r.setter.call(null,a):"style"===s[0]?h?c.css(s[1],""):c.css(s[1],a):"attribute"===s[0]&&(u?c.removeAttr(s[1]):c.attr(s[1],a)),n.push(o),this.watchlist[o]&&this.watchlist[o].dispatch()}else console.log("Property not found:",o)}n.length&&!this.destroyed&&this.onPropertyChanged(n)},get:function(t){var e=this.getPropertySettings(t);if(e){var i,n=t.split("."),o="function"==typeof e.targetElement?e.targetElement.call(this):this.contentElement;if(o&&o.length)if(e.getter)i=e.getter.call(this);else if("style"===n[0]){var r=n[1].replace(/-(\w)/g,function(t,e){return e.toUpperCase()});i=e.computed?o.css(r):o.get(0).style[r]}else if("attribute"===n[0]&&"string"==typeof(i=o.attr(n[1]))){if("null"===i)return null;if("true"===i)return!0;if("false"===i)return!1;if(i.match(/^\d+$/))return parseFloat(i)}return"number"===e.type&&(i=parseFloat(i)),e.deserialize&&(i=e.deserialize(i)),"undefined"!==e.defaultValue&&("number"===e.type?isNaN(i)&&(i=e.defaultValue):i||!1===i||(i=e.defaultValue)),i}return console.log("Property not found:",t),undefined},unset:function(t){"string"==typeof t&&(t=[t]);var e=[];t.forEach(function(t){var i=this.getPropertySettings(t);if(i){var n=t.split("."),o="function"==typeof i.targetElement?i.targetElement.call(this):this.contentElement;"function"==typeof i.unsetter?i.unsetter.call():"style"===n[0]?o.css(n[1],""):"attribute"===n[0]&&o.removeAttr(n[1]),e.push(t),this.watchlist[t]&&this.watchlist[t].dispatch()}}.bind(this)),e.length&&this.onPropertyChanged(e)},isset:function(t){var e=this.getPropertySettings(t);if(e){if("function"==typeof e.isset)return e.isset.call();var i=this.get(t);if(void 0!==i&&i!==e.defaultValue)return!0}return!1},triggerPropertyChange:function(t){t&&t.length&&(t.forEach(function(t){this.watchlist[t]&&this.watchlist[t].dispatch()},this),this.onPropertyChanged(t))},getPropertySettings:function(t){if("string"==typeof t){var e=(t=t.split("."))[0],i=t[1],n=this.properties[e]?this.properties[e][i]:null;if(n)return n;console.log("Property not found:",t)}return null},getPropertyDefault:function(t){var e=this.getPropertySettings(t);return e?e.defaultValue:null},getContentElement:function(){return this.contentElement},getAsClipboardText:function(){var t=$(this.domElement.prop("outerHTML"));return t.removeAttr("data-block-id"),t.attr("data-origin-id",this.getID()),t.find(">.editing-ui").remove(),t.prop("outerHTML")},setOpacity:function(t){this.contentElement.css("opacity",""),1===t?(this.getStyleWrapper().css("opacity",""),this.removeStyleWrapper()):this.createStyleWrapper().css("opacity",t)},getOpacity:function(){var t,e=this.getStyleWrapper();return t=e.length?e.get(0).style.opacity:this.contentElement.get(0).style.opacity,(void 0===(t=parseFloat(t))||isNaN(t))&&(t=1),t},setRotation:function(t){t&&0!==t?((t=parseInt(t,10)%360)>180&&(t-=360),this.createStyleWrapper().css("transform","rotate("+t+"deg)"),this.rotation=t):(this.getStyleWrapper().css("transform",""),this.removeStyleWrapper(),this.rotation=0),this.invalidateMeasurements(),this.transform&&this.transform.isVisible()&&this.transform.sync()},getRotation:function(){if(null===this.rotation){var t=this.getStyleWrapper();t.length?(this.rotation=(SL.util.parseCSSTransform(t.get(0).style.transform).rotate||0)%360,this.rotation<0&&(this.rotation+=360)):this.rotation=0}return this.rotation},getCSSTransform:function(){return this.getStyleWrapper().css("transform")||""},getDOMPosition:function(){var t=this.domElement.get(0),e=parseFloat(t.style.left),i=parseFloat(t.style.top);return{x:isNaN(e)?0:e,y:isNaN(i)?0:i}},getDOMDimensions:function(){var t=this.domElement.get(0),e=parseFloat(t.style.width),i=parseFloat(t.style.height);return{width:isNaN(e)?t.offsetWidth:e,height:isNaN(i)?t.offsetHeight:i}},getMinSize:function(){return{width:this.options.minWidth,height:this.options.minHeight}},hasTransform:function(){return this.isRotated()},isRotated:function(){return 0!==this.getRotation()},isGroup:function(){return"group"===this.getType()},isGrouped:function(){return this.domElement.parents(".sl-block-group").length>0},getGroup:function(){return this.domElement.parents(".sl-block-group").data("block-instance")},getParentGroups:function(){return this.domElement.parents(".sl-block").toArray().map(function(t){return $(t).data("block-instance")})},getGroupSiblings:function(){return this.domElement.siblings(".sl-block").toArray().map(function(t){return $(t).data("block-instance")})},setZ:function(t){this.contentElement.css("z-index",t),this.find(".sl-block-overlay").css("z-index",t),this.find(".sl-block-style").css("z-index",t)},getZ:function(){var t=parseInt(this.contentElement.css("z-index"),10);return isNaN(t)?0:t},syncZ:function(){var t=this.getZ();this.find(".sl-block-overlay").css("z-index",t),this.find(".sl-block-style").css("z-index",t)},setClassName:function(t){t=(t=(t=(t=t||"").replace(/\s{2,}/g," ")).replace(/[^a-zA-Z0-9-_\s]*/gi,"")).trim(),this.contentElement.attr("class","sl-block-content"+(t?" "+t:""))},getClassName:function(){var t=this.contentElement.attr("class");return t=(t=(t=t.split(" ").map(function(t){return t=t.trim(),(/^(sl\-|cke\_)/gi.test(t)||"visible"===t||"animate"===t||"notranslate"===t||"is-open"===t)&&(t=""),t}).join(" ")).replace(/\s{2,}/g," ")).trim()},getBorderColor:function(){return this.contentElement.css("border-top-color")},getAspectRatio:function(){return this.options.aspectRatio},hasAspectRatio:function(){return this.getAspectRatio()>0},syncAspectRatio:function(){if(this.hasAspectRatio()){var t=this.measure();this.resize({width:t.width,height:t.height,center:!0})}},syncTransformVisibility:function(){this.isFocused()?this.transform.show():this.transform.hide()},showPlaceholder:function(){0===this.contentElement.find(".sl-block-placeholder").length&&this.contentElement.append('<div class="editing-ui sl-block-overlay sl-block-placeholder">')},hidePlaceholder:function(){this.contentElement.find(".sl-block-placeholder").remove()},createStyleWrapper:function(){var t=this.getStyleWrapper();return 0===t.length?(t=$('<div class="sl-block-style"></div>'),this.contentElement.wrap(t),this.syncZ(),this.getStyleWrapper()):t},getStyleWrapper:function(){return this.find(".sl-block-style")},removeStyleWrapper:function(){this.contentElement.parent(".sl-block-style").length&&!this.isStyleWrapperRequired()&&this.contentElement.unwrap()},isStyleWrapperRequired:function(){return this.hasTransform()||this.hasFilter()||1!==this.getOpacity()||!0===this.options.contentElementTypeImmutable&&"function"==typeof this.isLinked&&this.isLinked()},paint:function(){this.isEmpty()?this.showPlaceholder():this.hidePlaceholder(),this.syncZ()},isEmpty:function(){return!1},isEditingText:function(){return!1},isFragment:function(){return this.contentElement.hasClass("fragment")},removeFragment:function(){this.contentElement.removeClass("fragment").removeAttr("data-fragment-index")},hasAnimation:function(){return this.isset("attribute.data-animation-type")},removeAnimation:function(){this.hasAnimation()&&this.unset(["attribute.data-animation-type","attribute.data-animation-trigger","attribute.data-animation-trigger-id","style.transition-duration","style.transition-delay"])},getToolbarOptions:function(){return[SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.BlockDepth,SL.editor.components.toolbars.options.BlockActions]},changeContentElementType:function(t){!0===this.options.contentElementTypeImmutable?t===this.options.contentElementType?(this.getStyleWrapper().changeElementType(t),this.removeStyleWrapper()):this.createStyleWrapper().changeElementType(t):(this.contentElement.changeElementType(t),this.contentElement=this.find(".sl-block-content").first())},move:function(t){t=t||{};var e=JSON.stringify(t);if(e!==this.lastMoveArguments||t.offset){this.lastMoveArguments=e;var i=0,n=0;if(this.hasTransform()&&!t.excludeTransforms){var o=this.measure();i=o.x-o.transformed.x,n=o.y-o.transformed.y}var r={};"number"==typeof t.x&&(r.left=t.x+i),"number"==typeof t.y&&(r.top=t.y+n),this.domElement.css(r),this.invalidateMeasurements()}},offset:function(t){if((t=t||{}).x||t.y){0===t.x&&(t.x=null),0===t.y&&(t.y=null);var e=this.measure();"number"==typeof t.x&&(t.x=e.x+t.x),"number"==typeof t.y&&(t.y=e.y+t.y),this.move({x:t.x,y:t.y,excludeTransforms:!0})}},moveToCenter:function(t){var e=this.measure().transformed,i=SL.view.getSlideSize(),n={x:(i.width-e.width)/2,y:(i.height-e.height)/2};t&&"number"==typeof t.minY&&(n.y=Math.max(n.y,t.minY)),this.move(n)},resize:function(t){t=t||{};var e,i,n=JSON.stringify(t);if(n===this.lastResizeOptions&&!t.force)return!1;this.lastResizeOptions=n,this.frozenMeasurements?(i=this.frozenAnchorPositions,e=this.frozenMeasurements.transformed):e=this.measure().transformed;var o="number"==typeof t.top,r="number"==typeof t.right,s="number"==typeof t.bottom,a="number"==typeof t.left;o&&(t.height=e.bottom-t.top,t.direction="n"),a&&(t.width=e.right-t.left,t.direction="w"),r&&(t.width=t.right-e.x),s&&(t.height=t.bottom-e.y);var l=this.getMinSize(),c=Math.max(t.width,l.width),h=Math.max(t.height,l.height);if(this.transform.isResizingProportionally()){var u=e.width/e.height;/s|n/.test(t.direction)?c=h*u:h=c/u}var d=this.hasAspectRatio();if(d){var p=this.getAspectRatio(),f=h*p,g=c/p;t.direction?/s|n/.test(t.direction)?c=f:h=g:f/c<g/h?c=f:h=g}if(this.setBlockWidthAndHeight(c,h,e),this.invalidateMeasurements(),this.transform.isResizingCentered()||t.center){var m=this.measure();this.move({x:e.x+(e.width-m.width)/2,y:e.y+(e.height-m.height)/2,excludeTransforms:!0})}else if(this.transform.isResizing()){var v=this.transform.getState().direction,b=SL.editor.blocks.behavior.Transform.OPPOSITE_ANCHOR_IDS[v],y=i?i[b]:null,S=this.getAnchorPositions()[b];if(y&&S){
var k=i.measurements.x+(y.x-S.x),w=i.measurements.y+(y.y-S.y);/n|s/.test(v)&&!this.options.horizontalResizing&&(k=null),/w|e/.test(v)&&!this.options.verticalResizing&&(w=null),this.isGroup()&&!d&&("w"!==v&&"e"!==v||(w=null),"n"!==v&&"s"!==v||(k=null)),this.move({x:k,y:w,excludeTransforms:!0})}}else t.direction&&(/n/.test(t.direction)&&this.move({y:e.bottom-h,excludeTransforms:!0}),/w/.test(t.direction)&&this.move({x:e.right-c,excludeTransforms:!0}),1===t.direction.length&&(/n|s/.test(t.direction)?this.move({x:e.x+(e.width-c)/2,excludeTransforms:!0}):/e|w/.test(t.direction)&&this.move({y:e.y+(e.height-h)/2,excludeTransforms:!0})));return this.invalidateMeasurements({recursive:!0}),this.transform&&this.transform.isVisible()&&this.transform.sync(),this.syncPaddingHint(),{width:c,height:h}},freezeMeasurements:function(){this.frozenMeasurements=this.measure(),this.frozenAnchorPositions=this.getAnchorPositions(),this.frozenRotation=this.getRotation()},unfreezeMeasurements:function(){this.frozenMeasurements=null,this.frozenAnchorPositions=null,this.frozenRotation=null},invalidateMeasurements:function(t){if(this.measurements=null,this.anchorPositions=null,t&&!0===t.recursive&&this.isGroup())this.getBlocks().forEach(function(e){e.invalidateMeasurements(t)});else if(this.isGrouped()){var e=this.getGroup();e&&e.invalidateMeasurements()}},measure:function(){if("number"==typeof SL.blockInvalidationID&&this.invalidationID!==SL.blockInvalidationID&&(this.invalidationID=SL.blockInvalidationID,this.invalidateMeasurements()),SL._measureTotal=(SL._measureTotal||0)+1,this.measurements)return this.measurements;SL._measureMisses=(SL._measureMisses||0)+1;var t=this.getDOMPosition(),e=this.getDOMDimensions();this.measurements={x:t.x,y:t.y,width:e.width,height:e.height},this.measurements.right=this.measurements.x+this.measurements.width,this.measurements.bottom=this.measurements.y+this.measurements.height;var i=this.getRotation();return this.measurements.transformed=0===i?{x:this.measurements.x,y:this.measurements.y,right:this.measurements.right,bottom:this.measurements.bottom,width:this.measurements.width,height:this.measurements.height}:SL.util.trig.rotateBoundingBox(this.measurements,i),this.measurements.angle=i,this.measurements},setBlockWidthAndHeight:function(t,e){this.domElement.css({width:this.options.horizontalResizing?t:"auto",height:this.options.verticalResizing?e:"auto"})},setHorizontalResizing:function(t){var e=t!==this.options.horizontalResizing;this.options.horizontalResizing=t,e&&(this.format(),this.bindTransformBehavior())},setVerticalResizing:function(t){var e=t!==this.options.verticalResizing;this.options.verticalResizing=t,e&&(this.format(),this.bindTransformBehavior())},getAnchorPositions:function(){if(!this.anchorPositions){var t=this.measure(),e=this.getRotation(),i=t.width/2,n=t.height/2;this.anchorPositions={n:SL.util.trig.rotateAround(i,0,i,n,e),e:SL.util.trig.rotateAround(t.width,n,i,n,e),s:SL.util.trig.rotateAround(i,t.height,i,n,e),w:SL.util.trig.rotateAround(0,n,i,n,e),nw:SL.util.trig.rotateAround(0,0,i,n,e),ne:SL.util.trig.rotateAround(t.width,0,i,n,e),se:SL.util.trig.rotateAround(t.width,t.height,i,n,e),sw:SL.util.trig.rotateAround(0,t.height,i,n,e),measurements:t}}return this.anchorPositions},hitTest:function(t,e){if(this.isRotated()){var i=this.getAnchorPositions(),n=i.measurements,o=n.transformed;if(o.x>t.x&&o.right<t.x+t.width&&o.y>t.y&&o.bottom<t.y+t.height)return!0;var r=[[{x:n.x+i.nw.x,y:n.y+i.nw.y},{x:n.x+i.ne.x,y:n.y+i.ne.y}],[{x:n.x+i.ne.x,y:n.y+i.ne.y},{x:n.x+i.se.x,y:n.y+i.se.y}],[{x:n.x+i.sw.x,y:n.y+i.sw.y},{x:n.x+i.se.x,y:n.y+i.se.y}],[{x:n.x+i.nw.x,y:n.y+i.nw.y},{x:n.x+i.sw.x,y:n.y+i.sw.y}]];return[[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y}],[{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height}],[{x:t.x,y:t.y+t.height},{x:t.x+t.width,y:t.y+t.height}],[{x:t.x,y:t.y},{x:t.x,y:t.y+t.height}]].some(function(t){return r.some(function(e){return!!SL.util.trig.findLineIntersection(e[0],e[1],t[0],t[1])})})}return SL.util.trig.intersects(this.measure(e),t)},runIntro:function(){var t=this.domElement;t.addClass("intro-start"),setTimeout(function(){t.removeClass("intro-start").addClass("intro-end"),this.introTimeout=setTimeout(function(){t.removeClass("intro-end")}.bind(this),500)}.bind(this),this.options.introDelay||1)},abortIntro:function(){clearTimeout(this.introTimeout),this.domElement.removeClass("intro-start intro-end")},pair:function(t,e){this.pairings.push({block:t,direction:e})},unpair:function(){this.pairings.length=0},syncPairs:function(){this.pairings.forEach(function(t){t.block.syncPairs()})},afterDragAndMove:function(){},checkIfDoubleClick:function(t){if(!t||"number"!=typeof t.button||2!==t.button&&3!==t.button){"number"!=typeof this.lastMouseUpTime&&(this.lastMouseUpTime=0,this.lastDoubleClickTime=0);var e=Date.now(),i=400;e-this.lastMouseUpTime<i&&(e-this.lastDoubleClickTime>i&&this.onDoubleClick(t),this.lastDoubleClickTime=e),this.lastMouseUpTime=e}},destroy:function(){for(var t in this.destroyed=!0,SL.editor.controllers.Blocks.focusChanged.remove(this.syncTransformVisibility),this.watchlist)this.watchlist[t].dispose(),delete this.watchlist[t];var e=this.getGroup();this.domElement.remove(),this.removed.dispatch(),this.removed.dispose(),this.dragStarted.dispose(),this.dragUpdated.dispose(),this.dragEnded.dispose(),this.transform.doubleClicked.remove(this.onDoubleClick),this.transform.destroy(),this.domElement.off("click",this.onNativeClick),this.domElement.off("vclick",this.onClick),this.domElement.off("vmousedown",this.onMouseDown),this.domElement.off("mouseenter",this.onMouseEnter),this.domElement.off("mouseleave",this.onMouseLeave),this.domElement.data("block-instance",null),$(document).off("keydown",this.onKeyDown),$(document).off("keyup",this.onKeyUp),e&&e.afterBlockRemoved()},onPropertyChanged:function(){},onNativeClick:function(t){SL.view.isEditing()&&this.hasPlugin(SL.editor.blocks.plugin.Link)&&this.isLinked()&&(t.preventDefault(),t.stopImmediatePropagation())},onClick:function(t){SL.view.isEditing()&&this.hasPlugin(SL.editor.blocks.plugin.Link)&&this.isLinked()&&t.preventDefault()},onMouseEnter:function(t){var e=t.metaKey||t.ctrlKey;!this.transform||!SL.view.isEditing()||this.isFocused()||!e&&this.isGrouped()&&!this.getGroup().isOpen()||SL.pointer.isDown()||(this.transform.show("hover"),t.stopImmediatePropagation())},onMouseLeave:function(){this.transform&&!this.isFocused()&&this.transform.hide()},onMouseDown:function(t){var e=this.isGrouped(),i=e&&this.getGroup().isOpen();return e&&!i&&(t.metaKey||t.ctrlKey)?(SL.editor.controllers.Blocks.focus(this,t.shiftKey),!0):!this.isLocked()||e&&!i||this.isGroup()&&this.isOpen()?!this.isMoveable()||$(t.target).closest(".sl-block-transform .anchor").length>0||$(t.target).closest(".sl-table-column-resizer").length>0||void(this.isEditingText()||(t.preventDefault(),$("input:focus, textarea:focus").blur(),$(document).on("vmousemove",this.onMouseMove),$(document).on("vmouseup",this.onMouseUp),this.moved=!1,this.mouseDownCursor.x=t.clientX,this.mouseDownCursor.y=t.clientY,this.dragScale=Reveal.getScale(),this.groupTargets=[],this.dragTargets=[])):(SL.editor.controllers.Blocks.focus(this,t.shiftKey||t.metaKey),this.checkIfDoubleClick(t),!0)},onMouseMove:function(t){if(SL.util.isMultiTouchEvent(t))return!1;var e=t.clientX-this.mouseDownCursor.x,i=t.clientY-this.mouseDownCursor.y;(this.moved||Math.abs(e)>1||Math.abs(i)>1)&&(t.preventDefault(),this.moved||(SL.editor.controllers.Blocks.focus(this),t.altKey&&SL.editor.controllers.Blocks.duplicateBlocks({silent:!0}),SL.editor.controllers.Blocks.getFocusedBlocks().forEach(function(t){t.isGroup()?(this.groupTargets.push(t),Array.prototype.push.apply(this.dragTargets,t.getNestedBlocks())):this.dragTargets.push(t)},this),this.dragTargets=this.dragTargets.map(function(t){return{block:t,origin:t.measure().transformed}},this)),t.shiftKey&&(Math.abs(i)>Math.abs(e)?e=0:i=0),this.dragTargets.forEach(function(t){t.block.move({x:t.origin.x+e/this.dragScale,y:t.origin.y+i/this.dragScale})},this),!1===this.moved&&SL.editor.controllers.Guides.start(this.dragTargets.map(function(t){return t.block})),SL.editor.controllers.Guides.sync(),this.groupTargets.forEach(function(t){t.transform.sync()},this),this.moved=!0)},onMouseUp:function(t){t.preventDefault(),this.moved&&(this.dragTargets.forEach(function(t){return t.block.afterDragAndMove()}),this.groupTargets.forEach(function(t){t.afterDragAndMove()})),this.groupTargets=null,this.dragTargets=null,this.dragScale=null,$(document).off("vmousemove",this.onMouseMove),$(document).off("vmouseup",this.onMouseUp),SL.editor.controllers.Guides.stop(),this.moved?SL.editor.controllers.History.pushLatest():(SL.editor.controllers.Blocks.focus(this,t.shiftKey||t.metaKey),this.checkIfDoubleClick(t))},onDoubleClick:function(){},onKeyDown:function(){},onKeyUp:function(){}}),SL("editor.blocks.behavior").TransformLine=Class.extend({ANCHOR_SIZE:16,init:function(t){this.block=t,this.visible=!1,this.transforming=!1,this.state={direction:null,originalCursorPosition:{x:0,y:0},originalPoint:{x:0,y:0}},this.render(),this.bind(),this.layout()},render:function(){this.domElement=$('<div class="sl-block-transform editing-ui">'),this.anchors={},this.anchors.p1=$('<div class="anchor" data-direction="p1">').appendTo(this.domElement),this.anchors.p2=$('<div class="anchor" data-direction="p2">').appendTo(this.domElement),this.domElement.find(".anchor").html('<div class="anchor-point"></div>')},bind:function(){for(var t in this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.transformStarted=new signals.Signal,this.transformEnded=new signals.Signal,this.doubleClicked=new signals.Signal,this.anchors)this.anchors[t].on("vmousedown",this.onMouseDown)},layout:function(){var t=this.block.getViewBox();this.anchors.p1.css({left:this.block.get("attribute.data-line-x1")-t.x,top:this.block.get("attribute.data-line-y1")-t.y}),this.anchors.p2.css({left:this.block.get("attribute.data-line-x2")-t.x,top:this.block.get("attribute.data-line-y2")-t.y})},sync:function(){},syncAnchors:function(){},syncMetadata:function(){},show:function(t){this.visible=!0,0===this.domElement.parent().length&&(this.domElement.appendTo(this.block.domElement),this.domElement.addClass("visible")),this.domElement.attr("data-state",t||"")},hide:function(){this.visible=!1,this.domElement.detach(),this.domElement.removeClass("visible"),this.domElement.removeAttr("data-state")},destroy:function(){this.transforming&&(SL.pointer.clearActiveCursor(),SL.editor.controllers.Guides.stop()),$(document).off("vmousemove",this.onMouseMove),$(document).off("vmouseup",this.onMouseUp),this.transformStarted.dispose(),this.transformEnded.dispose(),this.domElement.remove()},isVisible:function(){return this.visible},isResizing:function(){return!!this.state.direction},isResizingCentered:function(){return this.isResizing()&&this.state.centered},isResizingProportionally:function(){return this.isResizing()&&this.state.proportional},isTransforming:function(){return this.transforming},getState:function(){return this.state},onMouseDown:function(t){t.preventDefault(),this.transforming=!0,this.state.direction=$(t.currentTarget).attr("data-direction"),this.scale=Reveal.getScale(),this.state.direction&&($(document).on("vmousemove",this.onMouseMove),$(document).on("vmouseup",this.onMouseUp),this.moved=!1,this.block.freezeMeasurements(),this.state.originalCursorPosition.x=t.clientX,this.state.originalCursorPosition.y=t.clientY,this.state.direction===SL.editor.blocks.Line.POINT_1?(this.state.originalPoint.x=this.block.get("attribute.data-line-x1"),this.state.originalPoint.y=this.block.get("attribute.data-line-y1")):(this.state.originalPoint.x=this.block.get("attribute.data-line-x2"),this.state.originalPoint.y=this.block.get("attribute.data-line-y2")),SL.pointer.setActiveCursor("move"))},onMouseMove:function(t){t.preventDefault(),this.moved||(this.transformStarted.dispatch(this),SL.editor.controllers.Guides.start([this.block],{action:"line-anchor",direction:this.state.direction})),this.moved=!0;var e=(t.clientX-this.state.originalCursorPosition.x)/this.scale,i=(t.clientY-this.state.originalCursorPosition.y)/this.scale,n=this.state.originalPoint.x+e,o=this.state.originalPoint.y+i;this.state.direction===SL.editor.blocks.Line.POINT_1?this.block.set({"attribute.data-line-x1":n,"attribute.data-line-y1":o}):this.block.set({"attribute.data-line-x2":n,"attribute.data-line-y2":o}),SL.editor.controllers.Guides.sync()},onMouseUp:function(t){t.preventDefault(),this.transforming=!1,this.block.unfreezeMeasurements(),$(document).off("vmousemove",this.onMouseMove),$(document).off("vmouseup",this.onMouseUp),SL.editor.controllers.Guides.stop(),this.moved&&this.transformEnded.dispatch(this),this.state.direction=null,SL.pointer.clearActiveCursor()}}),SL("editor.blocks.behavior").Transform=Class.extend({ANCHOR_SIZE:16,MOUSE_MOVE_MAX_FREQUENCY:33,init:function(t){this.block=t,this.visible=!1,this.rotating=!1,this.state={direction:null,centered:!1,proportional:!1,originalMeasurements:null,originalCenter:{x:0,y:0},originalCursorPosition:{x:0,y:0}},this.render(),this.bind(),this.sync()},render:function(){this.domElement=$('<div class="sl-block-transform editing-ui">'),this.anchorsElement=$('<div class="anchor-wrapper">').appendTo(this.domElement),this.metadataElement=$('<div class="metadata"></div>').appendTo(this.domElement),this.metadataSize=$('<span class="metadata-item"></span>').appendTo(this.metadataElement),this.anchors={};var t='<div class="anchor-point"></div>';if(this.block.options.horizontalResizing&&this.block.options.verticalResizing){for(var e in SL.editor.blocks.behavior.Transform.ANCHOR_TEMPLATES)this.renderAnchor(e);this.domElement.find(".anchor-visible").html(t)}else this.block.options.horizontalResizing?(this.renderAnchor("e"),this.renderAnchor("w"),this.anchors.e.add(this.anchors.w).addClass("anchor-visible").append(t)):this.block.options.verticalResizing&&(this.renderAnchor("n"),this.renderAnchor("s"),this.anchors.n.add(this.anchors.s).addClass("anchor-visible").append(t));this.block.options.rotation&&this.domElement.find(".anchor-visible").append('<div class="anchor-rotation"></div>')},renderAnchor:function(t){var e=SL.editor.blocks.behavior.Transform.ANCHOR_TEMPLATES[t];return this.anchors[t]=$(e).appendTo(this.anchorsElement),this.anchors[t]},bind:function(){for(var t in this.onAnchorMouseDown=this.onAnchorMouseDown.bind(this),this.onResizeMouseMove=this.onResizeMouseMove.bind(this),this.onResizeMouseUp=this.onResizeMouseUp.bind(this),this.onRotateMouseMove=this.onRotateMouseMove.bind(this),this.onRotateMouseUp=this.onRotateMouseUp.bind(this),this.transformStarted=new signals.Signal,this.transformEnded=new signals.Signal,this.doubleClicked=new signals.Signal,this.anchors)this.anchors[t].on("vmousedown",this.onAnchorMouseDown)},sync:function(){var t=this.block.measure();if(!1===this.block.hasTransform())this.domElement.css("transform",""),this.domElement.find(".anchor[data-cursor-direction]").removeAttr("data-cursor-direction");else{this.domElement.css("transform",this.block.getCSSTransform());for(var e=SL.editor.blocks.behavior.Transform.ANCHOR_IDS,i=e.concat(),n=Math.round(t.angle/360*e.length);n<0;)i.unshift(i.pop()),n++;for(;n>0;)i.push(i.shift()),n--;this.domElement.find(".anchor").each(function(){var t=this.getAttribute("data-direction"),n=i[e.indexOf(t)];this.setAttribute("data-cursor-direction",n)})}this.previousMeasurements&&t.width===this.previousMeasurements.width&&t.height===this.previousMeasurements.height&&t.angle===this.previousMeasurements.angle||(this.syncMetadata(t),this.syncAnchors(t),this.previousMeasurements=t),this.block.isGroup()&&this.domElement.css({left:t.x,top:t.y,width:t.width,height:t.height})},syncMetadata:function(t){var e=(t=t||this.block.measure()).angle<0?t.angle+360:t.angle,i="number"==typeof t.angle;this.isRotating()&&i?this.metadataSize.html(Math.round(e)+"\xb0"):this.metadataSize.html(Math.round(t.width)+" &times; "+Math.round(t.height));var n="s";i&&(e>45&&e<135?n="w":e>=135&&e<225?n="n":e>=225&&e<315&&(n="e")),this.metadataElement.attr("data-side",n)},syncAnchors:function(t){var e=6,i=(1-Math.min(t.width/75,1))*e,n=(1-Math.min(t.height/75,1))*e,o=Math.max(i,n);o!==this.currentAnchorSpread&&(this.currentAnchorSpread=o,this.domElement.toggleClass("spread-anchors",o>0),this.getVisibleAnchors().forEach(function(t){var e=["rotate("+SL.editor.blocks.behavior.Transform.ANCHOR_ANGLES[t.direction]+"deg)","translate("+o+"px, "+o+"px)"].join(" ");/^(n|e|s|w)$/.test(t.direction)?t.pointElement.style.transform=e:t.element.style.transform=e})),this.metadataElement.css("padding",8+Math.round(2*Math.max(i,n)))},show:function(t){!1===this.visible&&(this.visible=!0,this.domElement.appendTo(this.block.domElement),this.domElement.addClass("visible"),this.sync()),this.domElement.attr("data-state",t||"")},hide:function(){!0===this.visible&&(this.visible=!1,this.domElement.detach(),this.domElement.removeClass("visible"),this.domElement.removeAttr("data-state"))},refreshAnchorLayout:function(t,e){t||(t=this.domElement.width()),e||(e=this.domElement.height()),this.domElement.toggleClass("spread-anchors",t<30||e<30)},destroy:function(){this.isTransforming&&(SL.editor.controllers.Guides.stop(),SL.pointer.clearActiveCursor()),$(document).off("vmousemove",this.onResizeMouseMove),$(document).off("vmouseup",this.onResizeMouseUp),$(document).off("vmousemove",this.onRotateMouseMove),$(document).off("vmouseup",this.onRotateMouseUp),this.transformStarted.dispose(),this.transformEnded.dispose(),this.doubleClicked.dispose(),this.anchors=null,this.visibleAnchors=null,this.domElement.remove()},isVisible:function(){return this.visible},isResizing:function(){return!!this.state.direction},isResizingCentered:function(){return this.isResizing()&&this.state.centered},isResizingProportionally:function(){return this.isResizing()&&this.state.proportional},isRotating:function(){return this.rotating},canUseGuides:function(){return!this.block.isRotated()},getVisibleAnchors:function(){return this.visibleAnchors||(this.visibleAnchors=this.domElement.find(".anchor-visible").toArray().map(function(t){return{direction:t.getAttribute("data-direction"),element:t,pointElement:t.querySelector(".anchor-point")}})),this.visibleAnchors},getState:function(){return this.state},calculateCursorAngle:function(t,e){var i=t-this.state.slideBounds.x/this.scale,n=e-this.state.slideBounds.y/this.scale,o=Math.atan2(n-this.state.originalCenter.y,i-this.state.originalCenter.x)+Math.PI/2;return o=180*o/Math.PI},checkDoubleClick:function(t){if(!t||"number"!=typeof t.button||2!==t.button&&3!==t.button){"number"!=typeof this.lastMouseUpTime&&(this.lastMouseUpTime=0,this.lastDoubleClickTime=0);var e=Date.now();if(e-this.lastMouseUpTime<SL.config.DOUBLE_CLICK_THRESHOLD){if(e-this.lastDoubleClickTime>SL.config.DOUBLE_CLICK_THRESHOLD)return this.doubleClicked.dispatch(t),!0;this.lastDoubleClickTime=e}return this.lastMouseUpTime=e,!1}},onAnchorMouseDown:function(t){t.preventDefault(),this.isTransforming=!0,this.moved=!1,this.scale=Reveal.getScale(),this.lastMouseMoveTime=0,$(t.target).hasClass("anchor-rotation")?(this.rotating=!0,this.block.freezeMeasurements(),$(document).on("vmousemove",this.onRotateMouseMove),$(document).on("vmouseup",this.onRotateMouseUp),this.state.slideBounds=SL.util.getRevealSlidesBounds(),this.state.originalCenter.x=(this.block.frozenMeasurements.x+this.block.frozenMeasurements.width/2)*this.scale,this.state.originalCenter.y=(this.block.frozenMeasurements.y+this.block.frozenMeasurements.height/2)*this.scale,this.state.originalCursorAngle=this.calculateCursorAngle(t.clientX,t.clientY),this.syncMetadata(this.block.frozenMeasurements)):(this.block.freezeMeasurements(),this.state.direction=$(t.currentTarget).attr("data-direction"),SL.pointer.setActiveCursor(SL.pointer.DIRECTION_TO_RESIZE_CURSOR[$(t.currentTarget).attr("data-cursor-direction")||this.state.direction]),this.state.direction&&($(document).on("vmousemove",this.onResizeMouseMove),$(document).on("vmouseup",this.onResizeMouseUp),this.state.originalCursorPosition.x=t.clientX,this.state.originalCursorPosition.y=t.clientY))},onResizeMouseMove:function(t){t.preventDefault(),clearTimeout(this.mouseMoveDebounceTimeout);var e=Date.now();if(e-this.lastMouseMoveTime<this.MOUSE_MOVE_MAX_FREQUENCY)return this.mouseMoveDebounceTimeout=setTimeout(this.onResizeMouseMove.bind(this,t),this.MOUSE_MOVE_MAX_FREQUENCY-(e-this.lastMouseMoveTime)),!1;this.lastMouseMoveTime=e,this.moved||(this.transformStarted.dispatch(this),SL.editor.controllers.Guides.start([this.block],{action:"resize",direction:this.state.direction})),this.moved=!0;var i=t.clientX,n=t.clientY,o=(i-this.state.originalCursorPosition.x)/this.scale,r=(n-this.state.originalCursorPosition.y)/this.scale,s=this.block.get("transform.rotate");if(s){var a=SL.util.trig.rotateAround(o,r,0,0,-s);o=a.x,r=a.y}t.altKey&&(o*=2,r*=2);var l="",c="";switch(this.state.direction){case"e":l=Math.max(this.block.frozenMeasurements.width+o,1);break;case"w":l=Math.max(this.block.frozenMeasurements.width-o,1);break;case"s":c=Math.max(this.block.frozenMeasurements.height+r,1);break;case"n":c=Math.max(this.block.frozenMeasurements.height-r,1);break;case"nw":l=Math.max(this.block.frozenMeasurements.width-o,1),c=Math.max(this.block.frozenMeasurements.height-r,1);break;case"ne":l=Math.max(this.block.frozenMeasurements.width+o,1),c=Math.max(this.block.frozenMeasurements.height-r,1);break;case"se":l=Math.max(this.block.frozenMeasurements.width+o,1),c=Math.max(this.block.frozenMeasurements.height+r,1);break;case"sw":l=Math.max(this.block.frozenMeasurements.width-o,1),c=Math.max(this.block.frozenMeasurements.height+r,1)}this.block.hasAspectRatio()?(""===l&&(l=this.block.frozenMeasurements.width*(c/this.block.frozenMeasurements.height)),""===c&&(c=this.block.frozenMeasurements.height*(l/this.block.frozenMeasurements.width))):(""===l&&(l=this.block.frozenMeasurements.width),""===c&&(c=this.block.frozenMeasurements.height)),this.state.centered=t.altKey,this.state.proportional=t.shiftKey,this.block.resize({width:l,height:c,direction:this.state.direction}),this.canUseGuides()&&SL.editor.controllers.Guides.sync()},onResizeMouseUp:function(t){t.preventDefault(),clearTimeout(this.mouseMoveDebounceTimeout),$(document).off("vmousemove",this.onResizeMouseMove),$(document).off("vmouseup",this.onResizeMouseUp),SL.editor.controllers.Guides.stop(),this.moved?(this.block.unfreezeMeasurements(),this.transformEnded.dispatch(this),SL.editor.controllers.History.pushLatest()):this.checkDoubleClick(t),this.state.direction=null,this.state.centered=null,this.state.proportional=null,SL.pointer.clearActiveCursor()},onRotateMouseMove:function(t){t.preventDefault(),this.moved||this.transformStarted.dispatch(this),this.moved=!0;var e=this.calculateCursorAngle(t.clientX,t.clientY);(e=this.block.frozenRotation+(e-this.state.originalCursorAngle))<0&&(e=360+e%360),e>0&&(e%=360),t.shiftKey?e=15*Math.round(e/15):SL.current_user.settings.get("editor_snap")&&(e=SL.editor.blocks.behavior.Transform.ROTATION_SNAP_ANGLES.find(t=>Math.abs(e-t)<SL.editor.blocks.behavior.Transform.ROTATION_SNAP_RANGE)||e),this.block.set("transform.rotate",e),this.sync()},onRotateMouseUp:function(t){t.preventDefault(),this.rotating=!1,$(document).off("vmousemove",this.onRotateMouseMove),$(document).off("vmouseup",this.onRotateMouseUp),this.moved?(this.block.invalidateMeasurements(),this.block.unfreezeMeasurements(),this.transformEnded.dispatch(this)):this.checkDoubleClick(t),this.syncMetadata(this.block.measure()),this.state.originalCursorAngle=null,this.state.originalRotation=null,SL.pointer.clearActiveCursor()}}),SL.editor.blocks.behavior.Transform.ROTATION_SNAP_RANGE=3,SL.editor.blocks.behavior.Transform.ROTATION_SNAP_ANGLES=[0,45,90,135,180,225,270,315,360],SL.editor.blocks.behavior.Transform.ANCHOR_IDS=["n","ne","e","se","s","sw","w","nw"],SL.editor.blocks.behavior.Transform.ANCHOR_ANGLES={se:0,s:45,sw:90,w:135,nw:180,n:225,ne:270,e:315},SL.editor.blocks.behavior.Transform.OPPOSITE_ANCHOR_IDS={n:"s",ne:"sw",e:"w",se:"nw",s:"n",sw:"ne",w:"e",nw:"se"},SL.editor.blocks.behavior.Transform.ANCHOR_TEMPLATES={n:'<div class="anchor" data-direction="n">',e:'<div class="anchor" data-direction="e">',s:'<div class="anchor" data-direction="s">',w:'<div class="anchor" data-direction="w">',nw:'<div class="anchor anchor-visible" data-direction="nw">',ne:'<div class="anchor anchor-visible" data-direction="ne">',se:'<div class="anchor anchor-visible" data-direction="se">',sw:'<div class="anchor anchor-visible" data-direction="sw">'},SL("editor.blocks").Code=SL.editor.blocks.Base.extend({init:function(t){this._super("code",t),this.editingRequested=new signals.Signal,this.paintThrottled=$.debounce(this.paint.bind(this),300)},setup:function(){this._super(),this.properties.style.padding={type:"number",unit:"px",decimals:0,minValue:0,maxValue:100,defaultValue:0,setter:this.setCodePadding.bind(this),getter:this.getCodePadding.bind(this)},this.properties.style["font-size"]={type:"number",unit:"px",minValue:3,maxValue:200,defaultValue:SL.config.CODE_BASE_SIZE,setter:this.setCodeSize.bind(this),getter:this.getCodeSize.bind(this)},this.properties.code={value:{setter:this.setCode.bind(this),getter:this.getCode.bind(this)},"line-numbers":{defaultValue:"",setter:this.setCodeLineNumbers.bind(this),getter:this.getCodeLineNumbers.bind(this),isset:this.hasCodeLineNumbers.bind(this)},language:{defaultValue:"none",setter:this.setCodeLanguage.bind(this),getter:this.getCodeLanguage.bind(this),options:SL.config.CODE_LANGUAGES},theme:{defaultValue:"monokai",setter:this.setCodeTheme.bind(this),getter:this.getCodeTheme.bind(this),options:[{value:"monokai",title:"Monokai"},{value:"a11y-dark",title:"A11y Dark"},{value:"a11y-light",title:"A11y Light"},{value:"ascetic",title:"Ascetic"},{value:"darcula",title:"Darcula"},{value:"far",title:"Far"},{value:"github-gist",title:"GitHub Gist"},{value:"ir-black",title:"Ir Black"},{value:"monokai-sublime",title:"Monokai Sublime"},{value:"obsidian",title:"Obsidian"},{value:"seti",title:"Seti"},{value:"solarized-dark",title:"Solarized Dark"},{value:"solarized-light",title:"Solarized Light"},{value:"sunburst",title:"Sunburst"},{value:"tomorrow",title:"Tomorrow"},{value:"xcode",title:"Xcode"},{value:"zenburn",title:"Zenburn"}]},frame:{defaultValue:"none",unsetWhenDefault:!0,setter:this.setCodeFrame.bind(this),getter:this.getCodeFrame.bind(this),options:[{value:"none",title:"None"},{value:"osx",title:"Color"},{value:"osx-grey",title:"Grey"}]}},this.properties.attribute["data-code-wrap"]={defaultValue:!1,unsetWhenDefault:!0},this.properties.attribute["data-code-autoheight"]={defaultValue:!1,unsetWhenDefault:!0}},paint:function(){var t=!0!==this.get("attribute.data-code-autoheight");if(t!==this.options.verticalResizing&&(this.setVerticalResizing(t),t&&this.resize({height:this.measure().height,force:!0})),this.isEmpty())this.domElement.find(".sl-block-placeholder, .sl-block-content-preview").remove(),this.domElement.addClass("is-empty"),this.showPlaceholder(),this.syncZ();else{this.domElement.find(".sl-block-placeholder").remove(),this.domElement.removeClass("is-empty");var e=this.domElement.find(".sl-block-content-preview");(0===e.length||this.previewInvalidated)&&(e.remove(),(e=$('<div class="editing-ui sl-block-content-preview visible-in-preview">')).append(this.getPreElement().clone()),e.appendTo(this.contentElement),Reveal.getPlugin("highlight").highlightBlock(e.find("code").get(0))),e.toggleClass("inline",!this.options.verticalResizing),"number"==typeof this.previewStep&&this.previewHighlightStep(this.previewStep),this.previewInvalidated=!1,this.syncZ()}this.invalidateMeasurements()},invalidatePreview:function(){this.previewInvalidated=!0},previewHighlightStep:function(t){this.previewStep=t;var e=this.domElement.find(".sl-block-content-preview pre code");"number"==typeof t?t<e.length&&(e.attr("data-preview-step","hidden"),e.eq(t).attr("data-preview-step","visible")):e.removeAttr("data-preview-step")},setDefaults:function(){this._super(),this.resize({width:500,height:300});var t=this.getDefaultCodeLanguage();t&&this.setCodeLanguage(t);var e=this.getDefaultCodeTheme();e&&this.setCodeTheme(e);var i=this.getDefaultCodeFrame();i&&this.setCodeFrame(i),this.setCodeSize(SL.config.CODE_BASE_SIZE),this.setCodeLineNumbers(""),this.contentElement.addClass("notranslate")},setCode:function(t){this.invalidatePreview(),this.getCodeElement().text(t),this.paintThrottled()},getCode:function(){return SL.util.unescapeHTMLEntities(this.getCodeElement().html())},migratePercentageSize:function(){/%/.test(this.contentElement.get(0).style.fontSize)&&(this.getPreElement().css("font-size",this.getCodeSize()+"px"),this.contentElement.get(0).style.fontSize="")},setCodeSize:function(t){this.migratePercentageSize();var e={fontSize:t,lineHeight:Math.round(parseInt(t,10)*SL.config.CODE_BASE_LINE_HEIGH)+"px"};this.getPreElement().css(e),this.domElement.find(".sl-block-content-preview pre").css(e)},getCodeSize:function(){var t=parseInt(this.getPreElement().css("font-size"),10);return isNaN(t)?SL.config.CODE_BASE_SIZE:Math.round(t)},setCodePadding:function(t){this.getCodeElement().css("padding",t),this.domElement.find(".sl-block-content-preview code").css("padding",t)},getCodePadding:function(){var t=parseInt(this.getCodeElement().css("padding"),10);return isNaN(t)?0:t},setCodeLanguage:function(t){this.invalidatePreview(),this.getPreElement().attr("class",t),this.paint(),SL.editor.blocks.Code.defaultLanguage=t},getCodeLanguage:function(){return this.getCodeLanguageFromPre(this.getPreElement())},getCodeLanguageDefinition:function(){var t=this.getCodeLanguage();return SL.config.CODE_LANGUAGES.find(function(e){return e.value===t})},getCodeLanguageFromPre:function(t){var e=t.attr("class")||"";return e=(e=e.replace(/hljs/gi,"")).trim()},getDefaultCodeLanguage:function(){if("string"==typeof SL.editor.blocks.Code.defaultLanguage)return SL.editor.blocks.Code.defaultLanguage;for(var t=$('.reveal .sl-block[data-block-type="code"] pre[class!="none"]').get(),e=0;e<t.length;e++){var i=this.getCodeLanguageFromPre($(t[e]));if(i)return i}return null},setCodeTheme:function(t){this.contentElement.attr("data-highlight-theme",t),SL.editor.blocks.Code.defaultTheme=t,!0===this.previewingTheme&&(this._themeBeforePreview=t)},getCodeTheme:function(){return this.contentElement.attr("data-highlight-theme")||"zenburn"},startThemePreview:function(t){this.previewingTheme=!0,this._themeBeforePreview=this.contentElement.attr("data-highlight-theme"),this.contentElement.attr("data-highlight-theme",t)},stopThemePreview:function(){this.previewingTheme=!1,this._themeBeforePreview?this.contentElement.attr("data-highlight-theme",this._themeBeforePreview):this.contentElement.removeAttr("data-highlight-theme")},getDefaultCodeTheme:function(){if("string"==typeof SL.editor.blocks.Code.defaultTheme)return SL.editor.blocks.Code.defaultTheme;var t=$('.reveal .sl-block[data-block-type="code"] .sl-block-content[data-highlight-theme]').first().attr("data-highlight-theme");return t||this.getPropertySettings("code.theme").defaultValue},setCodeFrame:function(t){"string"!=typeof t||""===t?this.contentElement.removeAttr("data-code-frame"):this.contentElement.attr("data-code-frame",t),this.triggerPropertyChange(["style.padding"]),SL.editor.blocks.Code.defaultFrame=t},getCodeFrame:function(){return this.contentElement.attr("data-code-frame")},getDefaultCodeFrame:function(){if("string"==typeof SL.editor.blocks.Code.defaultFrame)return SL.editor.blocks.Code.defaultFrame;var t=$('.reveal .sl-block[data-block-type="code"] .sl-block-content[data-code-frame]').first().attr("data-code-frame");return t||this.getPropertySettings("code.frame").defaultValue},setCodeLineNumbers:function(t){this.invalidatePreview(),"string"==typeof t?this.getCodeElement().attr("data-line-numbers",t):this.getCodeElement().removeAttr("data-line-numbers"),this.paintThrottled()},getCodeLineNumbers:function(){return this.getCodeElement().attr("data-line-numbers")},hasCodeLineNumbers:function(){return this.getCodeElement().get(0).hasAttribute("data-line-numbers")},getLabel:function(){var t=this.getCode().slice(0,50).trim().split("\n")[0];return t||""},getToolbarOptions:function(){
return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.Code,SL.editor.components.toolbars.options.CodeLanguage,SL.editor.components.toolbars.options.CodeTheme,SL.editor.components.toolbars.options.CodeFrame,SL.editor.components.toolbars.options.CodeSize,SL.editor.components.toolbars.options.CodeWrap,SL.editor.components.toolbars.options.CodeAutoHeight,SL.editor.components.toolbars.groups.CodeLineNumbers,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.Padding,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},getPreElement:function(){var t=this.contentElement.find(">pre");return 0===t.length&&(t=$("<pre><code></code></pre>").appendTo(this.contentElement)),t},getCodeElement:function(){var t=this.getPreElement(),e=t.find(">code");return 0===e.length&&(e=$("<code>").appendTo(t)),e},isEmpty:function(){return!this.isset("code.value")},onPropertyChanged:function(t){this._super.apply(this,arguments),(-1!==t.indexOf("code.frame")||-1!==t.indexOf("style.font-size")||-1!==t.indexOf("attribute.data-code-wrap")||-1!==t.indexOf("attribute.data-code-autoheight"))&&this.paint()},onDoubleClick:function(t){this._super(t),this.editingRequested.dispatch()},onKeyDown:function(t){this._super(t),13!==t.keyCode||SL.util.isTypingEvent(t)||(this.editingRequested.dispatch(),t.preventDefault())}}),SL("editor.blocks").Drawing=SL.editor.blocks.Base.extend({init:function(t){this._super("drawing",t),this.plug(SL.editor.blocks.plugin.Link)},setup:function(){this._super(),this.properties.svg={fill:{setter:this.setFillColor.bind(this),getter:this.getFillColor.bind(this)}}},setDefaults:function(){this._super(),this.setSVG(this.options.data.svg,this.options.data.bbox),this.options.data.points&&this.getContentElement().attr("data-points",this.options.data.points),this.options.data.timestamp&&this.getContentElement().attr("data-timestamp",this.options.data.timestamp)},paint:function(){},resize:function(){var t=this._super.apply(this,arguments);return t&&this.paint(),t},startEditing:function(){SL.editor.controllers.Mode.change("draw")},setFillColor:function(t){var e=this.getSVGElement().querySelector("path");e&&e.setAttribute("fill",t)},getFillColor:function(){var t=this.getSVGElement().querySelector("path");return t?t.getAttribute("fill"):"#000"},setSVG:function(t,e){var i=this.getSVGElement();i.innerHTML=t,i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("viewBox",[e.x,e.y,e.width,e.height].join(" "));Reveal.getScale();this.resize({width:e.width,height:e.height})},getSVGElement:function(){var t=this.contentElement.find("svg").get(0);return t||((t=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg")).setAttribute("xmlns",SL.editor.util.SVG.NAMESPACE),t.setAttribute("version","1.1"),t.setAttribute("preserveAspectRatio","none"),this.contentElement.append(t)),t},createThumbnail:function(t){var e=this.getSVGElement().cloneNode(!0),i=this.measure();return i=SL.util.math.fitWithin(i.width,i.height,t.width,t.height),e.setAttribute("width",i.width),e.setAttribute("height",i.height),e},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.SVGFillColor,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Link,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},onDoubleClick:function(){this._super(),this.startEditing()}}),SL("editor.blocks").Group=SL.editor.blocks.Base.extend({init:function(t){this.afterBlockRemoved=this.afterBlockRemoved.bind(this),this._super("group",$.extend(t,{horizontalResizing:!0,verticalResizing:!0,rotation:!1}))},render:function(){this._super.apply(this,arguments),this.domElement.addClass("sl-block-group"),this.contentElement.addClass("sl-block-group-content")},appendTo:function(){this._super.apply(this,arguments),this.invalidateMeasurements({recursive:!0}),this.paint()},addBlock:function(t,e){t.blur(),t.appendTo(this.contentElement),this.invalidateBlockList(),this.invalidateMeasurements({recursive:!0}),e||this.paint()},addBlocks:function(t){t.forEach(function(t){this.addBlock(t,!0)},this),this.paint()},ungroup:function(){var t=this.getBlocks(),e=this.domElement.parents(".sl-block-content, .slides section").first();t.forEach(function(t){t.appendTo(e)},this),this.invalidateBlockList(),this.destroy(),SL.editor.controllers.Blocks.focus(t,!0)},find:function(t){return this.domElement.find(">"+t+", >:not(.sl-block)> "+t+", >:not(.sl-block)>:not(.sl-block)> "+t)},paint:function(){var t=this.getBlocks(),e=t.every(function(t){return t.options.horizontalResizing||"line"===t.getType()}),i=t.every(function(t){return t.options.verticalResizing||"line"===t.getType()});e&&i||!this.hasAspectRatio()||(i=!1,e=!1),this.setHorizontalResizing(e),this.setVerticalResizing(i);var n=this.getTransformOrigin();this.set("style.transform-origin",n.x+"px "+n.y+"px"),this.transform&&this.transform.isVisible()&&this.transform.sync(),this.syncZ()},focus:function(){this._super.apply(this,arguments),this.paint()},isOpen:function(){return this.domElement.hasClass("is-open")},move:function(t){if(t=t||{},this.transform.isResizing()&&("number"==typeof t.x&&(t.x=Math.ceil(t.x)),"number"==typeof t.y&&(t.y=Math.ceil(t.y))),!t.offset){var e=this.measure().transformed;"number"==typeof t.x&&(t.x=t.x-e.x),"number"==typeof t.y&&(t.y=t.y-e.y)}this.getNestedBlocks().forEach(function(e){e.offset({x:t.x,y:t.y})}),this.invalidateMeasurements(),this.transform&&this.transform.sync()},afterDragAndMove:function(){this.paint()},invalidateBlockList:function(){this.blockListInvalidated=!0},setBlockWidthAndHeight:function(t,e,i){var n=this.measure();this.options.horizontalResizing||(t=i.width),this.options.verticalResizing||(e=i.height),isNaN(t)&&(t=n.width),isNaN(e)&&(e=n.height);var o=t/i.width,r=e/i.height,s=!1;this.frozenChildMeasurements||(this.freezeMeasurements(),s=!0),this.frozenChildMeasurements.forEach(function(t){if("line"===t.block.getType())t.block.setGlobalLinePoints(n.x+(t.p1.x-i.x)*o,n.y+(t.p1.y-i.y)*r,n.x+(t.p2.x-i.x)*o,n.y+(t.p2.y-i.y)*r);else{t.block.move({x:i.x+(t.measurements.transformed.x-i.x)*o,y:i.y+(t.measurements.transformed.y-i.y)*r});var e=1-Math.abs(1-t.block.getRotation()%180/90),s=o+(r-o)*e,a=r+(o-r)*e;t.block.hasAspectRatio()&&(this.options.horizontalResizing&&!this.options.verticalResizing&&(a=s),this.options.verticalResizing&&!this.options.horizontalResizing&&(s=a)),t.block.resize({width:t.measurements.width*s,height:t.measurements.height*a})}},this),s&&this.unfreezeMeasurements()},freezeMeasurements:function(){this.frozenChildMeasurements=this.getNestedBlocks().map(function(t){t.freezeMeasurements();var e={block:t,measurements:t.frozenMeasurements};return"line"===t.getType()&&(e.p1=t.getGlobalLinePoint(SL.editor.blocks.Line.POINT_1),e.p2=t.getGlobalLinePoint(SL.editor.blocks.Line.POINT_2)),e}),this._super.apply(this,arguments)},unfreezeMeasurements:function(){this.frozenChildMeasurements=null,this.getNestedBlocks().forEach(function(t){t.unfreezeMeasurements()}),this._super.apply(this,arguments)},getTransformOrigin:function(){var t=this.frozenMeasurements||this.measure();return{x:t.x+t.width/2,y:t.y+t.height/2}},setRotation:function(){this.rotation=0},getRotation:function(){return 0},getCSSTransform:function(){var t=this.getRotation();return 0===t?"":"rotate("+t+"deg)"},measure:function(){return"number"==typeof SL.blockInvalidationID&&this.invalidationID!==SL.blockInvalidationID&&(this.invalidationID=SL.blockInvalidationID,this.invalidateMeasurements()),this.measurements||(this.measurements=SL.editor.controllers.Blocks.getCombinedBounds(this.getBlocks())),this.measurements},getMinSize:function(){var t={y:Number.MAX_VALUE,right:0,bottom:0,x:Number.MAX_VALUE},e=0,i=0;return this.getNestedBlocks().forEach(function(n){var o=n.getMinSize(),r=n.measure().transformed;e=Math.max(o.width/r.width,e),i=Math.max(o.height/r.height,i),t.x=Math.min(t.x,r.x),t.y=Math.min(t.y,r.y),t.right=Math.max(t.right,r.right),t.bottom=Math.max(t.bottom,r.bottom)}.bind(this)),{width:Math.max((t.right-t.x)*e,SL.config.BLOCK_MIN_SIZE),height:Math.max((t.bottom-t.y)*i,SL.config.BLOCK_MIN_SIZE)}},getAspectRatio:function(){if(this.getBlocks().some(function(t){return t.hasAspectRatio()||t.isRotated()})){var t=this.measure().transformed;return t.width/t.height}return 0},getBlocks:function(){return this.blockList&&!0!==this.blockListInvalidated||(this.blockListInvalidated=!1,this.blockList=this.contentElement.find("> .sl-block").map(function(t,e){return $(e).data("block-instance")}).toArray()),this.blockList},getNestedBlocks:function(){return this.contentElement.find(".sl-block:not(.sl-block-group)").toArray().map(function(t){return $(t).data("block-instance")})},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.BlockAlignHorizontal,SL.editor.components.toolbars.options.BlockAlignVertical,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},destroy:function(){this.destroyed=!0,this.getBlocks().forEach(function(t){t.destroy()}),this._super.apply(this,arguments)},isMoveable:function(){return this._super()&&!this.isOpen()},afterBlockRemoved:function(){this.destroyed||(this.invalidateBlockList(),this.invalidateMeasurements(),0===this.getBlocks().length?this.destroy():this.paint())},onClosed:function(){this.invalidateMeasurements({recursive:!0}),this.paint()},onDoubleClick:function(t){this._super(t),SL.editor.controllers.Blocks.openGroup(this);var e=$(t.target).parents(".sl-block:not(.is-open)").last().data("block-instance");e&&SL.editor.controllers.Blocks.focus(e)},onKeyDown:function(t){this._super(t),13!==t.keyCode||SL.util.isTypingEvent(t)||(t.preventDefault(),t.stopImmediatePropagation(),SL.editor.controllers.Blocks.openGroup(this))}}),SL("editor.blocks").Iframe=SL.editor.blocks.Base.extend({init:function(t){this._super("iframe",t),this.editingRequested=new signals.Signal,this.iframeSourceChanged=new signals.Signal,t&&t.url&&this.setIframeURL(t.url),this.paint()},setup:function(){this._super(),this.setIframeURL=this.setIframeURL.bind(this),this.getIframeURL=this.getIframeURL.bind(this),this.setIframeAutoplay=this.setIframeAutoplay.bind(this),this.getIframeAutoplay=this.getIframeAutoplay.bind(this),this.checkXFrameOptions=this.checkXFrameOptions.bind(this),this.setIframeURLDebounced=$.debounce(this.setIframeURL,400),this.properties.attribute["data-preload"]={type:"string",defaultValue:!1,unsetWhenDefault:!0,targetElement:this.getIframeElement.bind(this)},this.properties.iframe={src:{setter:this.setIframeURLDebounced,getter:this.getIframeURL},autoplay:{defaultValue:!1,setter:this.setIframeAutoplay,getter:this.getIframeAutoplay}}},paint:function(){this._super.apply(this,arguments);var t=this.getIframeURL();"https:"===window.location.protocol&&t&&/^http:/gi.test(t)?this.showOverlayError("Please use a secure iframe URL (https://)."):"blocked"===this.getIframeElement().attr("data-x-frame-status")?this.showOverlayError(SL.locale.get("BLOCKED_BY_X_FRAME_OPTIONS")):this.domElement.find(".sl-block-overlay-message").remove()},showOverlayError:function(t){var e=this.domElement.find(".sl-block-overlay-message .overlay-content");e.length?e.html(t):this.contentElement.append(['<div class="editing-ui sl-block-overlay sl-block-overlay-message below-content">','<div class="overlay-content">'+t+"</div>","</div>"].join(""))},checkXFrameOptions:function(){var t=this.getIframeURL();SL.editor.controllers.URL.isBlockedByXFrameOptions(t).then(function(e){this.getIframeURL()===t&&(e?(this.getIframeElement().attr("data-x-frame-status","blocked"),this.paint()):(this.getIframeElement().removeAttr("data-x-frame-status"),this.paint()))}.bind(this),function(){this.getIframeURL()===t&&(this.getIframeElement().removeAttr("data-x-frame-status"),this.paint())}.bind(this))},hideXFrameWarning:function(){this.domElement.find(".iframe-src-warning").remove()},setDefaults:function(){this._super(),this.resize({width:360,height:300}),!0===this.getDefaultPreloadValue()&&this.set("attribute.data-preload",!0)},getDefaultPreloadValue:function(){return"boolean"==typeof SL.editor.blocks.Iframe.defaultPreload?SL.editor.blocks.Iframe.defaultPreload:"string"==typeof $('.reveal .sl-block[data-block-type="iframe"] iframe').last().attr("data-preload")||null},getLabel:function(){return(this.getIframeURL()||"").replace(/^(https?:)?\/\//gm,"").slice(0,50).trim()},getIframeURL:function(){return this.getIframeElement().attr("src")||this.getIframeElement().attr("data-src")},setIframeURL:function(t){t!==this.get("iframe.src")&&(this.getIframeElement().attr({src:t,"data-src":t,"data-x-frame-status":"pending"}),this.iframeSourceChanged.dispatch(t),this.checkXFrameOptions()),this.paint()},getIframeAutoplay:function(){return this.getIframeElement().get(0).hasAttribute("data-autoplay")},setIframeAutoplay:function(t){!0===t?this.getIframeElement().attr("data-autoplay",""):this.getIframeElement().removeAttr("data-autoplay")},getContextMenuOptions:function(){return this.isEmpty()?this._super():[{label:"Use iframe as slide background",callback:this.turnIntoSlideBackground.bind(this)},{type:"divider"}].concat(this._super())},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.IframeSRC,SL.editor.components.toolbars.options.IframePreload,SL.editor.components.toolbars.options.IframeAutoplay,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.Padding,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},getIframeElement:function(){var t=this.contentElement.find("iframe");return 0===t.length&&(t=$("<iframe>").appendTo(this.contentElement)),SL.deck.util.formatIframe(t.get(0)),t},isEmpty:function(){return!this.isset("iframe.src")},turnIntoSlideBackground:function(){var t=Reveal.getCurrentSlide();SL.util.deck.removeSlideBackground(t),t.setAttribute("data-background-iframe",this.get("iframe.src")),Reveal.syncSlide(t),SL.view.slideMenu.triggerBackgrounds(),this.destroy(),SL.editor.controllers.History.pushLatest()},destroy:function(){this.iframeSourceChanged.dispose(),this._super()},onDoubleClick:function(t){this._super(t),this.editingRequested.dispatch()},onKeyDown:function(t){this._super(t),13!==t.keyCode||SL.util.isTypingEvent(t)||(this.editingRequested.dispatch(),t.preventDefault())}}),SL("editor.blocks").Image=SL.editor.blocks.Base.extend({SVG_COLOR_PROPERTY:"--svg-color",init:function(t){this._super("image",t),this.plug(SL.editor.blocks.plugin.Link),this.imageURLChanged=new signals.Signal,this.imageStateChanged=new signals.Signal;var e=this.getImageElement();this.isInlineSVG()?e.css("display","none"):(this.removeInlineSVG(),e.on("error",function(){this.loadingFailed=!0,this.paint()}.bind(this))),this.domElement.css("min-width")!==this.options.minWidth&&this.domElement.css({"min-width":this.options.minWidth,"min-height":this.options.minHeight}),this.syncImageControls()},setup:function(){this._super(),this.properties.image={src:{setter:this.setImageURL.bind(this),getter:this.getImageURL.bind(this)},alt:{type:"string",setter:this.setImageAltText.bind(this),getter:this.getImageAltText.bind(this)},"crop-rect":{type:"object",setter:this.setCropRect.bind(this),getter:this.getCropRect.bind(this)}},this.properties.attribute["data-inline-svg"]={defaultValue:!1},this.properties.attribute["data-maintain-ar"]={defaultValue:!0,unsetWhenDefault:!0},this.properties.attribute["data-image-fill-color"]={setter:this.setSVGFillColor.bind(this),getter:this.getSVGFillColor.bind(this)}},render:function(){this._super(),this.imageControls=$('<div class="sl-block-image-controls editing-ui">'),this.imageControls.appendTo(this.domElement),this.panButton=$('<div class="sl-block-image-control button black-30 icon i-move" data-tooltip="Click &amp; drag to pan">'),this.panButton.appendTo(this.imageControls),this.panButton.hide(),this.panButton.on("vmousedown",this.onPanMouseDown.bind(this)),this.cropButton=$('<div class="sl-block-image-control button black-30 icon i-crop" data-tooltip="Crop">'),this.cropButton.appendTo(this.imageControls),this.cropButton.on("click",this.onCropClicked.bind(this))},bind:function(){this._super(),this.onUploadCompleted=this.onUploadCompleted.bind(this),this.onUploadFailed=this.onUploadFailed.bind(this),this.onPanMouseMove=this.onPanMouseMove.bind(this),this.onPanMouseUp=this.onPanMouseUp.bind(this)},setDefaults:function(){this._super();var t=this.getDefaultMaxSize();this.resize({width:t.width,height:t.height}),this.options.insertedFromToolbar&&(this.options.introDelay=300,this.browse())},setInitialSize:function(t){t=$.extend({crop:!0,silent:!1},t);var e=this.measurementsBeforeReplace||this.measure();if(this._importedProps&&"number"==typeof this._importedProps.width&&"number"==typeof this._importedProps.height&&(e.width=this._importedProps.width,e.height=this._importedProps.height,t.crop=!0,t.silent=!0),this.measurementsBeforeReplace=null,!0===t.crop){var i=this.getNaturalSize(!0),n=SL.util.math.fitOutside(i.width,i.height,e.width,e.height),o={x:(n.width-e.width)/2/n.width,y:(n.height-e.height)/2/n.height,width:e.width/n.width,height:e.height/n.height};this.naturalSizeBeforeReplace&&i.width===this.naturalSizeBeforeReplace.width&&i.height===this.naturalSizeBeforeReplace.height?this.resize({width:e.width,height:e.height,force:!0}):((o.width<.99||o.height<.99)&&!t.silent&&SL.notify("Image was cropped to fit",{id:"image-crop",duration:5e3,buttonsLayout:"inline",buttons:[{label:"Uncrop",callback:function(){this.setInitialSize({crop:!1})}.bind(this)}]}),(o.width<.99||o.height<.99)&&this.storeCropRect(o),this.resize({width:n.width,height:n.height,force:!0}))}else{this.set("image.crop-rect",{x:0,y:0,width:1,height:1}),this.resize({width:e.width,height:e.height}),this.syncAspectRatio();var r=this.measure();this.move({x:e.x+(e.width-r.width)/2,y:e.y+(e.height-r.height)/2,excludeTransforms:!0})}this.syncImageControls()},setNaturalSize:function(){var t=this.getNaturalSize(),e=t.width,i=t.height;if(this.isCropped()){var n=this.getCropRect();e*=n.width,i*=n.height}this.resize({width:e,height:i,center:!0}),this.syncAspectRatio()},getDefaultMaxSize:function(){var t=SL.util.deck.getSlideSize();return{width:.84*t.width,height:.74*t.height}},setBlockWidthAndHeight:function(t,e){if(this._super.apply(this,arguments),this.isLoaded()&&this.isCropped()){var i=this.getCropRect(),n=t/i.width,o=e/i.height;this.getImageAndSVGElements().css({left:Math.round(-n*i.x),top:Math.round(-o*i.y),width:Math.round(n),height:Math.round(o)})}else this.getImageAndSVGElements().css({top:"",left:"",width:"",height:""})},getContextMenuOptions:function(){if(this.isEmpty())return this._super();var t=this.getNaturalSize();return[{label:"Use image as slide background",callback:this.turnIntoSlideBackground.bind(this)},{label:SL.locale.get("SET_NATURAL_IMAGE_SIZE",t),callback:this.setNaturalSize.bind(this)},{label:"Replace",callback:this.browse.bind(this)},{label:"Crop",callback:this.showCropper.bind(this)},{type:"divider"}].concat(this._super())},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.Image,SL.editor.components.toolbars.options.ImageActions,SL.editor.components.toolbars.options.ImageMaintainAR,SL.editor.components.toolbars.options.ImageInlineSVG,SL.editor.components.toolbars.options.ImageSVGFillColor,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Link,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},setImageURL:function(t){var e=this.getImageElement(),i=this.hasLoadingFailed();if(1===e.length&&!0===e.prop("complete")&&0===e.prop("naturalWidth")&&(i=!0),t!==this.getImageURL()||i){this.measurementsBeforeReplace=this.measure(),this.naturalSizeBeforeReplace=this.getNaturalSize(),this.loading=!0,this.loadingFailed=!1,this.paint(),this.imageStateChanged.dispatch();var n=this.isEmptyAndDefaultSized();0===e.length?((e=$('<img src="'+t+'">')).css("visibility","hidden"),e.appendTo(this.contentElement)):e.attr("src",t),e.off("load").on("load",function(){e.off("load"),e.css("visibility",""),this.loading=!1,this.abortIntro(),this.setInitialSize({crop:!n}),this.paint(),this.imageStateChanged.dispatch(),this.paintInlineSVG()}.bind(this)),e.off("error").on("error",function(){SL.notify("Failed to load image","negative"),e.off("error"),this.loading=!1,this.loadingFailed=!0,this.paint(),this.imageStateChanged.dispatch()}.bind(this)),this.imageURLChanged.dispatch(t)}},getImageURL:function(){return this.getImageElement().attr("src")},getImageElement:function(){return this.contentElement.find("img")},getImageAndSVGElements:function(){return this.contentElement.find("img, svg")},setImageAltText:function(t){var e=this.contentElement.find("img");"string"==typeof t&&""!==t?e.attr("alt",t):e.removeAttr("alt")},getImageAltText:function(){return this.contentElement.find("img").attr("alt")},isEmpty:function(){return!this.isset("image.src")},isEmptyAndDefaultSized:function(){var t=this.getDefaultMaxSize(),e=this.measure();return this.isEmpty()&&e.width===t.width&&e.height===t.height},setMediaModel:function(t){t.isSVG()&&this.set("attribute.data-inline-svg",t.get("inline")),this.intermediateModel=t,this.intermediateModel.isUploaded()?this.onUploadCompleted():(this.paint(),this.imageStateChanged.dispatch(),this.intermediateModel.uploadCompleted.add(this.onUploadCompleted),this.intermediateModel.uploadFailed.add(this.onUploadFailed))},isLoading:function(){return!!this.loading||!!this.loadingSVG},isUploading:function(){return!(!this.intermediateModel||!this.intermediateModel.isWaitingToUpload()&&!this.intermediateModel.isUploading())},hasSource:function(){var t=this.get("image.src");return!!("string"==typeof t&&t.length>0)},hasLoadingFailed:function(){return this.loadingFailed},isLoaded:function(){var t=this.getNaturalSize(!0);return t&&t.width>0&&t.height>0},isSVG:function(){return this.hasSource()&&/^svg/i.test(this.get("image.src").split(".").pop())},isInlineSVG:function(){return this.isSVG()&&this.get("attribute.data-inline-svg")},getNaturalSize:function(t){var e=this.getImageElement();if(e.length){var i={};if(!t&&(i.width=parseInt(e.attr("data-natural-width"),10),i.height=parseInt(e.attr("data-natural-height"),10),i.width&&i.height))return i;if(i.width=e.get(0).naturalWidth,i.height=e.get(0).naturalHeight,i.width&&i.height)return e.attr({"data-natural-width":i.width,"data-natural-height":i.height}),i}return null},getImageBounds:function(){var t=this.getCropRect(),e=this.measure(),i=e.width/t.width,n=e.height/t.height;return{left:Math.round(-i*t.x),top:Math.round(-n*t.y),width:Math.round(i),height:Math.round(n)}},getAspectRatio:function(t){if(this.get("attribute.data-maintain-ar")){var e=this.getNaturalSize(t);if(e){if(this.isCropped()){var i=this.getCropRect();return e.width*i.width/(e.height*i.height)}return e.width/e.height}return this._super()}return 0},syncAspectRatio:function(t){if(void 0===t&&(t=!0),this.getNaturalSize(t)){var e=this.measure();this.resize({width:e.width,height:e.height,center:!0,force:!0})}},showCropper:function(){this.cropper||(this.cropper=new SL.components.Cropper({anchor:this.domElement}),this.cropper.saved.add(function(t){this.set("image.crop-rect",t)}.bind(this)),this.cropper.closed.add(this.syncTransformVisibility)),this.cropper.show({url:this.get("image.src"),angle:this.getRotation(),cropRect:this.getCropRect(),imageRect:this.getImageBounds()}),this.syncTransformVisibility()},setCropRect:function(t){var e=this.getImageElement(),i=this.getImageBounds(),n=this.getCropRect();if(1===t.width&&1===t.height)e.removeAttr("data-crop-x data-crop-y data-crop-width data-crop-height"),this.resize({width:i.width,height:i.height}),this.offset({x:i.width*(t.x-n.x),y:i.height*(t.y-n.y)});else{this.storeCropRect(t),this.resize({width:i.width*t.width,height:i.height*t.height,force:!0});var o=i.width*(t.x-n.x),r=i.height*(t.y-n.y),s=this.get("transform.rotate");if(s>0){var a=s/180*Math.PI;this.offset({x:o*Math.cos(a)-r*Math.sin(a),y:o*Math.sin(a)+r*Math.cos(a)})}else this.offset({x:o,y:r})}this.syncImageControls()},storeCropRect:function(t){this.getImageElement().attr({"data-crop-x":SL.util.math.limitDecimals(t.x,6),"data-crop-y":SL.util.math.limitDecimals(t.y,6),"data-crop-width":SL.util.math.limitDecimals(t.width,6),"data-crop-height":SL.util.math.limitDecimals(t.height,6)})},getCropRect:function(){var t=this.getImageElement(),e=parseFloat(t.attr("data-crop-x")),i=parseFloat(t.attr("data-crop-y")),n=parseFloat(t.attr("data-crop-width")),o=parseFloat(t.attr("data-crop-height"));return{x:isNaN(e)?0:e,y:isNaN(i)?0:i,width:isNaN(n)?1:n,height:isNaN(o)?1:o}},paint:function(){this.domElement.find(".sl-block-placeholder, .sl-block-overlay-warning, .media-progress").remove(),this.isLoading()||this.isUploading()?(this.contentElement.append(['<div class="editing-ui sl-block-overlay media-progress">','<span class="spinner centered"></span>',"</div>"].join("")),SL.util.html.generateSpinners()):this.hasLoadingFailed()?(this.contentElement.append(['<div class="editing-ui sl-block-overlay sl-block-overlay-warning">','<div class="overlay-content">Failed to load image.<br><button class="button white media-retry-button" style="margin-top: 10px;">Retry</button></div>',"</div>"].join("")),this.domElement.find(".media-retry-button").on("click",function(){this.setImageURL(this.getImageURL())}.bind(this))):this.hasSource()||this.showPlaceholder();var t=this.getImageElement();1!==t.length||"none"!==t.css("display")||this.isInlineSVG()||t.css("display",""),this.syncZ()},paintInlineSVG:function(){this.inlineSVGRequest&&(this.inlineSVGRequest.abort(),this.inlineSVGRequest=null),this.isInlineSVG()?(this.loadingSVG=!0,this.paint(),this.inlineSVGRequest=$.ajax({url:this.getImageURL()+"?t="+Date.now(),type:"GET",dataType:"xml",context:this}).done(function(t){var e=$(t).find("svg").first().get(0);if(e.innerHTML.length>SL.config.INLINE_SVG_MAX_LENGTH)SL.notify("This image is too large to inline (max "+SL.config.INLINE_SVG_MAX_LENGTH/1e6+"MB)","negative"),this.set("attribute.data-inline-svg",!1);else if(e){if(e.setAttribute("preserveAspectRatio","xMidYMid meet"),!e.hasAttribute("viewBox")){var i=this.getNaturalSize();i&&e.setAttribute("viewBox","0 0 "+i.width+" "+i.height)}$(e).find("style").remove(),this.getImageElement().css("display","none"),this.contentElement.find("svg").remove(),this.contentElement.append(e);var n=this.measure();this.resize({width:n.width,height:n.height,center:!0})}}).always(function(){this.loadingSVG=!1,this.inlineSVGRequest=null,this.paint(),this.imageStateChanged.dispatch()})):(this.getImageElement().css("display",""),this.removeInlineSVG(),this.setSVGFillColor(""))},removeInlineSVG:function(){this.contentElement.find("svg").remove()},setSVGFillColor:function(t){this.contentElement.find("svg").find("path, rect, circle, ellipse, line, polyline, polygon").each(function(t,e){var i=getComputedStyle(e),n=i.fill;n&&"none"!==n&&-1===e.style.fill.indexOf(this.SVG_COLOR_PROPERTY)&&(e.style.fill="var("+this.SVG_COLOR_PROPERTY+", "+n+")");var o=i.stroke;o&&"none"!==o&&-1===e.style.stroke.indexOf(this.SVG_COLOR_PROPERTY)&&(e.style.stroke="var("+this.SVG_COLOR_PROPERTY+", "+o+")")}.bind(this)),this.contentElement.get(0).style.setProperty(this.SVG_COLOR_PROPERTY,t)},getSVGFillColor:function(){return this.contentElement.get(0).style.getPropertyValue(this.SVG_COLOR_PROPERTY)||"#000000"},clear:function(){this.getImageElement().remove(),this.paint(),this.imageStateChanged.dispatch()},browse:function(){var t=SL.popup.open(SL.components.medialibrary.MediaLibrary,{select:SL.models.Media.IMAGE,selectExternal:!0});t.selected.addOnce(this.setMediaModel.bind(this)),t.selectedExternal.addOnce(this.setImageURL.bind(this))},turnIntoSlideBackground:function(){var t=Reveal.getCurrentSlide();SL.util.deck.removeSlideBackground(t,["size","position"]),t.setAttribute("data-background-image",this.get("image.src")),Reveal.syncSlide(t),SL.view.slideMenu.triggerBackgrounds(),this.destroy(),SL.editor.controllers.History.pushLatest()},syncTransformVisibility:function(){!this.isFocused()&&this.cropper&&(this.cropper.destroy(),this.cropper=null);var t=this.isCropping();this.domElement.toggleClass("is-cropping",t),this.isFocused()&&!t?this.transform.show():this.transform.hide()},syncImageControls:function(){var t=this.isCropped();this.cropButton.toggle(t),this.panButton.toggle(t)},isCropping:function(){return!(!this.cropper||!this.cropper.isVisible())},isCropped:function(){var t=this.getCropRect();return 1!==t.width||1!==t.height},destroy:function(){this.intermediateModel&&(this.intermediateModel.uploadCompleted.remove(this.onUploadCompleted),this.intermediateModel.uploadFailed.remove(this.onUploadFailed),this.intermediateModel=null),this.imageStateChanged.dispose(),this.imageStateChanged=null,this.imageURLChanged.dispose(),this.imageURLChanged=null,this.cropper&&(this.cropper.destroy(),this.cropper=null),this._super()},onUploadCompleted:function(){var t=this.intermediateModel.get("url");this.intermediateModel=null,this.set("image.src",t),this.imageStateChanged.dispatch()},onUploadFailed:function(){this.intermediateModel=null,this.paint(),this.imageStateChanged.dispatch()},onDoubleClick:function(t){$(t.target).is(".button")||this.browse()},onCropClicked:function(){return SL.editor.controllers.Blocks.focus(this),this.showCropper(),!1},onPanMouseDown:function(t){return SL.editor.controllers.Blocks.focus(this),$(document).on("vmousemove",this.onPanMouseMove),$(document).on("vmouseup",this.onPanMouseUp),this.domElement.addClass("is-panning"),this.panAngle=this.getRotation(),this.panMouseDownX=t.clientX,this.panMouseDownY=t.clientY,this.panImageBounds=this.getImageBounds(),this.panMeasurements=this.measure(),this.panCropRect=this.getCropRect(),!1},onPanMouseMove:function(t){var e=this.getImageElement(),i=this.panImageBounds.width-this.panMeasurements.width,n=this.panImageBounds.height-this.panMeasurements.height,o=t.clientX-this.panMouseDownX,r=t.clientY-this.panMouseDownY;if(this.panAngle){var s=SL.util.trig.rotateAround(o,r,0,0,-this.panAngle);o=s.x,r=s.y}var a=this.panImageBounds.left+o,l=this.panImageBounds.top+r;a=Math.min(Math.max(a,-i),0),l=Math.min(Math.max(l,-n),0),this.panCropRect.x=Math.abs(a)/this.panImageBounds.width,this.panCropRect.y=Math.abs(l)/this.panImageBounds.height,e.css({left:a,top:l}),this.storeCropRect(this.panCropRect)},onPanMouseUp:function(){$(document).off("vmousemove",this.onPanMouseMove),$(document).off("vmouseup",this.onPanMouseUp),this.domElement.removeClass("is-panning")},onPropertyChanged:function(t){if(this._super.apply(this,arguments),-1!==t.indexOf("attribute.data-inline-svg")&&this.paintInlineSVG(),-1!==t.indexOf("attribute.data-maintain-ar")){var e=this.measure();this.resize({width:e.width,height:e.height,center:!0})}}}),SL("editor.blocks").Line=SL.editor.blocks.Base.extend({init:function(t){this._super("line",$.extend({horizontalResizing:!1,verticalResizing:!1,minWidth:0,minHeight:0},t)),this.transform.destroy(),this.transform=new SL.editor.blocks.behavior.TransformLine(this),this.plug(SL.editor.blocks.plugin.Link)},setup:function(){this._super(),this.properties.attribute["data-line-style"]={defaultValue:"solid",options:[{value:"solid"},{value:"dotted"},{value:"dashed"}]},this.properties.attribute["data-line-start-type"]={defaultValue:"none",options:[{value:"none"},{value:"line-arrow"},{value:"arrow"},{value:"circle"},{
value:"square"}]},this.properties.attribute["data-line-end-type"]={defaultValue:"none",options:[{value:"none"},{value:"line-arrow"},{value:"arrow"},{value:"circle"},{value:"square"}]},this.properties.attribute["data-line-width"]={unit:"px",type:"number",minValue:1,maxValue:50,defaultValue:SL.editor.blocks.Line.DEFAULT_LINE_WIDTH},this.properties.attribute["data-line-color"]={defaultValue:SL.editor.blocks.Line.DEFAULT_COLOR},this.properties.attribute["data-line-x1"]={type:"number",decimals:6,minValue:0,maxValue:Number.MAX_VALUE,defaultValue:0},this.properties.attribute["data-line-y1"]={type:"number",decimals:6,minValue:0,maxValue:Number.MAX_VALUE,defaultValue:0},this.properties.attribute["data-line-x2"]={type:"number",decimals:6,minValue:0,maxValue:Number.MAX_VALUE,defaultValue:0},this.properties.attribute["data-line-y2"]={type:"number",decimals:6,minValue:0,maxValue:Number.MAX_VALUE,defaultValue:0}},setDefaults:function(){this._super(),this.set({"attribute.data-line-x1":0,"attribute.data-line-y1":200,"attribute.data-line-x2":200,"attribute.data-line-y2":0,"attribute.data-line-color":this.getPropertyDefault("attribute.data-line-color"),"attribute.data-line-start-type":this.getPropertyDefault("attribute.data-line-start-type"),"attribute.data-line-end-type":this.getPropertyDefault("attribute.data-line-end-type")})},paint:function(){var t=this.getSVGElement();t.setAttribute("preserveAspectRatio","xMidYMid"),t.innerHTML="",SL.editor.blocks.Line.generate(t,{startType:this.get("attribute.data-line-start-type"),endType:this.get("attribute.data-line-end-type"),style:this.get("attribute.data-line-style"),color:this.get("attribute.data-line-color"),width:this.get("attribute.data-line-width"),x1:this.get("attribute.data-line-x1"),y1:this.get("attribute.data-line-y1"),x2:this.get("attribute.data-line-x2"),y2:this.get("attribute.data-line-y2")});var e=this.getViewBox();t.setAttribute("width",e.width),t.setAttribute("height",e.height),t.setAttribute("viewBox",[e.x,e.y,e.width,e.height].join(" ")),this.transform&&this.transform.isTransforming()&&this.syncBlockPositionWithViewBox(e),this.transform&&this.transform.layout()},normalizeCoordinates:function(){var t=this.getViewBox(),e=this.get("attribute.data-line-x1"),i=this.get("attribute.data-line-y1"),n=this.get("attribute.data-line-x2"),o=this.get("attribute.data-line-y2");this.set({"attribute.data-line-x1":e-t.x,"attribute.data-line-y1":i-t.y,"attribute.data-line-x2":n-t.x,"attribute.data-line-y2":o-t.y})},syncBlockPositionWithViewBox:function(t){if(this.frozenMeasurements){var e=(t=t||this.getViewBox()).x-this.frozenViewBox.x,i=t.y-this.frozenViewBox.y;this.move({x:this.frozenMeasurements.x+e,y:this.frozenMeasurements.y+i})}},resize:function(){var t=this._super.apply(this,arguments);return this.paint(),t},freezeMeasurements:function(){this.frozenViewBox=this.getViewBox(),this._super.apply(this,arguments)},unfreezeMeasurements:function(){this.frozenViewBox=null,this._super.apply(this,arguments),this.normalizeCoordinates()},hitTest:function(t){var e=this.getGlobalLinePoint(SL.editor.blocks.Line.POINT_1),i=this.getGlobalLinePoint(SL.editor.blocks.Line.POINT_2);return!(!SL.util.trig.isPointWithinRect(e.x,e.y,t)||!SL.util.trig.isPointWithinRect(i.x,i.y,t))||[[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y}],[{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height}],[{x:t.x,y:t.y+t.height},{x:t.x+t.width,y:t.y+t.height}],[{x:t.x,y:t.y},{x:t.x,y:t.y+t.height}]].some(function(t){return!!SL.util.trig.findLineIntersection(e,i,t[0],t[1])})},setGlobalLinePoint:function(t,e,i){var n=this.getViewBox(),o=this.measure().transformed,r={};t===SL.editor.blocks.Line.POINT_1?("number"==typeof e&&(r["attribute.data-line-x1"]=e-(o.x-n.x)),"number"==typeof i&&(r["attribute.data-line-y1"]=i-(o.y-n.y))):t===SL.editor.blocks.Line.POINT_2&&("number"==typeof e&&(r["attribute.data-line-x2"]=e-(o.x-n.x)),"number"==typeof i&&(r["attribute.data-line-y2"]=i-(o.y-n.y))),Object.keys(r).length&&(this.set(r),this.invalidateMeasurements())},setGlobalLinePoints:function(t,e,i,n){var o=this.getViewBox(),r=this.measure().transformed;this.set({"attribute.data-line-x1":t-(r.x-o.x),"attribute.data-line-y1":e-(r.y-o.y),"attribute.data-line-x2":i-(r.x-o.x),"attribute.data-line-y2":n-(r.y-o.y)}),this.invalidateMeasurements(),this.transform&&this.transform.isTransforming()||this.syncBlockPositionWithViewBox()},getGlobalLinePoint:function(t){var e=this.getViewBox(),i=this.measure().transformed;return t===SL.editor.blocks.Line.POINT_1?{x:i.x-e.x+this.get("attribute.data-line-x1"),y:i.y-e.y+this.get("attribute.data-line-y1")}:t===SL.editor.blocks.Line.POINT_2?{x:i.x-e.x+this.get("attribute.data-line-x2"),y:i.y-e.y+this.get("attribute.data-line-y2")}:void 0},getOppositePointID:function(t){return t===SL.editor.blocks.Line.POINT_1?SL.editor.blocks.Line.POINT_2:SL.editor.blocks.Line.POINT_1},getViewBox:function(){var t=this.get("attribute.data-line-x1"),e=this.get("attribute.data-line-y1"),i=this.get("attribute.data-line-x2"),n=this.get("attribute.data-line-y2"),o={x:Math.min(t,i),y:Math.min(e,n)};return o.width=Math.max(Math.max(t,i)-o.x,1),o.height=Math.max(Math.max(e,n)-o.y,1),o},getSVGElement:function(){var t=this.contentElement.find("svg").get(0);return t||((t=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg")).setAttribute("xmlns",SL.editor.util.SVG.NAMESPACE),t.setAttribute("version","1.1"),this.contentElement.append(t)),t},getLineElement:function(){var t=this.getSVGElement(),e=t.querySelector("line");return e||(e=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"line"),t.appendChild(e)),e},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[[SL.editor.components.toolbars.options.LineStartType,SL.editor.components.toolbars.options.LineEndType],SL.editor.components.toolbars.options.LineStyle,SL.editor.components.toolbars.options.LineWidth,SL.editor.components.toolbars.options.LineColor,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.Link,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},onPropertyChanged:function(){this._super.apply(this,arguments),this.paint()}}),SL.editor.blocks.Line.DEFAULT_COLOR="#000000",SL.editor.blocks.Line.DEFAULT_LINE_WIDTH=2,SL.editor.blocks.Line.POINT_1="p1",SL.editor.blocks.Line.POINT_2="p2",SL.editor.blocks.Line.roundPoints=function(){for(var t=0;t<arguments.length;t++)arguments[t].x=Math.round(arguments[t].x),arguments[t].y=Math.round(arguments[t].y)},SL.editor.blocks.Line.generate=function(t,e){var i;(e=$.extend({color:SL.editor.blocks.Line.DEFAULT_COLOR,width:SL.editor.blocks.Line.DEFAULT_LINE_WIDTH,interactive:!0,x1:0,y1:0,x2:0,y2:0},e)).interactive&&e.width<15&&((i=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"line")).setAttribute("stroke","rgba(0,0,0,0)"),i.setAttribute("stroke-width",15),t.appendChild(i));var n={x:e.x1,y:e.y1},o={x:e.x2,y:e.y2},r=Math.max(SL.util.trig.distanceBetween(n,o),1),s=180*(Math.atan2(o.y-n.y,o.x-n.x)+Math.PI/2)/Math.PI;s=SL.util.math.limitDecimals(s,3);var a,l,c=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"line");if(c.setAttribute("class","line-element"),c.setAttribute("stroke",e.color),c.setAttribute("stroke-width",e.width),t.appendChild(c),"dotted"===e.style){var h=2*e.width;if(r>2*h){var u=r/h;h*=u/Math.ceil(u)}c.setAttribute("stroke-dasharray","0 "+h),c.setAttribute("stroke-linecap","round")}else if("dashed"===e.style){var d=3*e.width,p=3*e.width;if(r>2*(d+p)){var f=(r-p)/(d+p),g=f/Math.ceil(f);d*=g,p*=g}c.setAttribute("stroke-dasharray",d+" "+p),c.removeAttribute("stroke-linecap")}else c.removeAttribute("stroke-dasharray"),c.removeAttribute("stroke-linecap");var m=3*e.width,v=m/2,b=Math.max(m,8),y=b/2;"line-arrow"===e.startType&&(n.x+=(o.x-n.x)*(.25*b/r),n.y+=(o.y-n.y)*(.25*b/r),(a=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"path")).setAttribute("style","fill: rgba(0,0,0,0);"),a.setAttribute("stroke",e.color),a.setAttribute("stroke-width",e.width),a.setAttribute("transform","translate("+n.x+","+n.y+") rotate("+s+")"),a.setAttribute("d",["M",.75*-b,.75*-b,"L",0,0,"L",.75*b,.75*-b].join(" ")),t.appendChild(a)),"line-arrow"===e.endType&&(o.x+=(n.x-o.x)*(.25*b/r),o.y+=(n.y-o.y)*(.25*b/r),(l=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"path")).setAttribute("style","fill: rgba(0,0,0,0);"),l.setAttribute("stroke",e.color),l.setAttribute("stroke-width",e.width),l.setAttribute("transform","translate("+o.x+","+o.y+") rotate("+s+")"),l.setAttribute("d",["M",.75*b,.75*b,"L",0,0,"L",.75*-b,.75*b].join(" ")),t.appendChild(l)),"arrow"===e.startType&&(n.x+=(o.x-n.x)*(y/r),n.y+=(o.y-n.y)*(y/r),(a=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"polygon")).setAttribute("fill",e.color),a.setAttribute("transform","translate("+n.x+","+n.y+") rotate("+s+")"),a.setAttribute("points",SL.editor.util.SVG.pointsToPolygon([0,y,y,-y,-y,-y])),t.appendChild(a)),"arrow"===e.endType&&(o.x+=(n.x-o.x)*(y/r),o.y+=(n.y-o.y)*(y/r),(l=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"polygon")).setAttribute("fill",e.color),l.setAttribute("transform","translate("+o.x+","+o.y+") rotate("+s+")"),l.setAttribute("points",SL.editor.util.SVG.pointsToPolygon([0,-y,y,y,-y,y])),t.appendChild(l)),"circle"===e.startType&&(n.x+=(o.x-n.x)*(v/r),n.y+=(o.y-n.y)*(v/r),(a=SL.editor.util.SVG.ellipse(m,m)).setAttribute("cx",n.x),a.setAttribute("cy",n.y),a.setAttribute("fill",e.color),t.appendChild(a)),"circle"===e.endType&&(o.x+=(n.x-o.x)*(v/r),o.y+=(n.y-o.y)*(v/r),(l=SL.editor.util.SVG.ellipse(m,m)).setAttribute("cx",o.x),l.setAttribute("cy",o.y),l.setAttribute("fill",e.color),t.appendChild(l)),"square"===e.startType&&(n.x+=(o.x-n.x)*(v/r),n.y+=(o.y-n.y)*(v/r),(a=SL.editor.util.SVG.rect(m,m)).setAttribute("fill",e.color),a.setAttribute("x",-v),a.setAttribute("y",-v),a.setAttribute("transform","translate("+n.x+","+n.y+") rotate("+s+")"),t.appendChild(a)),"square"===e.endType&&(o.x+=(n.x-o.x)*(v/r),o.y+=(n.y-o.y)*(v/r),(l=SL.editor.util.SVG.rect(m,m)).setAttribute("fill",e.color),l.setAttribute("x",-v),l.setAttribute("y",-v),l.setAttribute("transform","translate("+o.x+","+o.y+") rotate("+s+")"),t.appendChild(l)),e.width%2==1&&(n.x+=.5,n.y+=.5,o.x+=.5,o.y+=.5),c.setAttribute("x1",n.x),c.setAttribute("y1",n.y),c.setAttribute("x2",o.x),c.setAttribute("y2",o.y),i&&(i.setAttribute("x1",n.x),i.setAttribute("y1",n.y),i.setAttribute("x2",o.x),i.setAttribute("y2",o.y))},SL("editor.blocks").Math=SL.editor.blocks.Base.extend({init:function(t){this._super("math",$.extend(t,{horizontalResizing:!1,verticalResizing:!1})),this.editingRequested=new signals.Signal},setup:function(){this._super(),this.properties.math={value:{setter:this.setValue.bind(this),getter:this.getValue.bind(this)}}},paint:function(){if(this.domElement.find(".sl-block-placeholder, .sl-block-content-preview, .sl-block-overlay-warning").remove(),this.isEmpty())this.domElement.addClass("is-empty"),this.showPlaceholder(),this.getMathOutputElement().empty();else{try{this.domElement.removeClass("is-empty"),katex.render(this.getMathInputElement().text(),this.getMathOutputElement().get(0))}catch(e){this.domElement.addClass("is-empty");var t=e.message.replace(/katex\sparse\serror:\s/i,"");this.contentElement.append(['<div class="editing-ui sl-block-overlay sl-block-overlay-warning">','<div class="overlay-content">','<span class="icon i-info"></span>',"LaTeX parse error: <br><br><code>"+t+"</code>","</div>","</div>"].join(""))}this.transform&&this.transform.isVisible()&&this.transform.sync()}this.syncZ()},setDefaults:function(){this._super(),this.contentElement.addClass("notranslate")},setValue:function(t){this.getMathInputElement().html(t),this.paint(),this.invalidateMeasurements()},getValue:function(){return this.getMathInputElement().text()},getMathInputElement:function(){var t=this.contentElement.find(".math-input");return 0===t.length&&(t=$('<div class="math-input"></div>').appendTo(this.contentElement)),t},getMathOutputElement:function(){this.contentElement.find(".math-output:gt(0)").remove();var t=this.contentElement.find(".math-output");return 0===t.length&&(t=$('<div class="math-output"></div>').appendTo(this.contentElement)),t},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.MathInput,SL.editor.components.toolbars.options.MathSize,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.MathColor,SL.editor.components.toolbars.options.BackgroundColor,SL.editor.components.toolbars.options.Padding,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},isEmpty:function(){return!this.isset("math.value")},onDoubleClick:function(t){this._super(t),this.editingRequested.dispatch()},onKeyDown:function(t){this._super(t),13!==t.keyCode||SL.util.isTypingEvent(t)||(this.editingRequested.dispatch(),t.preventDefault())},onPropertyChanged:function(t){this._super.apply(this,arguments),-1!==t.indexOf("style.padding")&&(this.invalidateMeasurements(),this.transform&&this.transform.isVisible()&&this.transform.sync())}}),SL("editor.blocks.plugin").Filter=Class.extend({init:function(t){this.block=t,this.parseCSSFilter(),t.hasFilter=function(){return this.currentFilterToString().length>0}.bind(this),t.hasBlurFilter=function(){return!!this.filter["blur-radius"]}.bind(this),t.hasDropShadowFilter=function(){return!!(this.filter["drop-shadow-x"]||this.filter["drop-shadow-y"]||this.filter["drop-shadow-radius"])}.bind(this),t.addProperties("filter",{"blur-radius":{type:"number",unit:"px",minValue:0,maxValue:200,stepSize:1,defaultValue:0,unsetWhenDefault:!0,setter:this.setFilterValue.bind(this,"blur-radius"),getter:this.getFilterValue.bind(this,"blur-radius"),unsetter:this.unsetFilterValue.bind(this,"blur-radius")},"drop-shadow-x":{type:"number",unit:"px",minValue:-1e3,maxValue:1e3,stepSize:1,defaultValue:0,setter:this.setFilterValue.bind(this,"drop-shadow-x"),getter:this.getFilterValue.bind(this,"drop-shadow-x"),unsetter:this.unsetFilterValue.bind(this,"drop-shadow-x")},"drop-shadow-y":{type:"number",unit:"px",minValue:-1e3,maxValue:1e3,stepSize:1,defaultValue:0,setter:this.setFilterValue.bind(this,"drop-shadow-y"),getter:this.getFilterValue.bind(this,"drop-shadow-y"),unsetter:this.unsetFilterValue.bind(this,"drop-shadow-y")},"drop-shadow-radius":{type:"number",unit:"px",minValue:0,maxValue:200,stepSize:1,defaultValue:0,setter:this.setFilterValue.bind(this,"drop-shadow-radius"),getter:this.getFilterValue.bind(this,"drop-shadow-radius"),unsetter:this.unsetFilterValue.bind(this,"drop-shadow-radius")},"drop-shadow-color":{defaultValue:"rgba(0, 0, 0, 0.5)",setter:this.setFilterValue.bind(this,"drop-shadow-color"),getter:this.getFilterValue.bind(this,"drop-shadow-color"),unsetter:this.unsetFilterValue.bind(this,"drop-shadow-color")}})},parseCSSFilter:function(){this.filter={};var t=this.block.getStyleWrapper().css("filter")||"";if(t.length)for(var e=t.split(SL.editor.blocks.plugin.Filter.CSS_FILTER_NAME_REGEX),i=0;i<e.length;i++){var n=e[i],o=e[i+1];if(/(blur|drop\-shadow)/gi.test(n)&&"string"==typeof o){o=o.trim().replace(/^\(|\)$/g,"").replace(/(rgba?|hsl|hsla)\([^\)]*/gi,function(t){return t.replace(/\s/g,"")});if("blur"===n)this.filter["blur-radius"]=o;else if("drop-shadow"===n){var r=o.split(" ");4===r.length&&3===(o.match(/\d+[a-zA-Z]+/g)||[]).length&&(/^\d/.test(r[0])&&/^\d/.test(r[1])?(this.filter["drop-shadow-x"]=r[0],this.filter["drop-shadow-y"]=r[1],this.filter["drop-shadow-radius"]=r[2],this.filter["drop-shadow-color"]=r[3]):/^[A-Za-z]/.test(r[0])&&(this.filter["drop-shadow-color"]=r[0],this.filter["drop-shadow-x"]=r[1],this.filter["drop-shadow-y"]=r[2],this.filter["drop-shadow-radius"]=r[3]))}}}},writeCSSFilter:function(){var t=this.currentFilterToString();t.length>0?this.block.createStyleWrapper().css("filter",t):(this.block.getStyleWrapper().css("filter",""),this.block.removeStyleWrapper())},currentFilterToString:function(){var t=[];return this.block.hasBlurFilter()&&t.push("blur("+this.filter["blur-radius"]+")"),this.block.hasDropShadowFilter()&&(t.push("drop-shadow("+this.filter["drop-shadow-x"]+" "+this.filter["drop-shadow-y"]+" "+this.filter["drop-shadow-radius"]+" "+this.filter["drop-shadow-color"]+")"),t.push("opacity(100%)")),t.join(" ")},setFilterValue:function(t,e){this.filter[t]=e,this.writeCSSFilter()},getFilterValue:function(t){return this.filter[t]},unsetFilterValue:function(t){delete this.filter[t],this.writeCSSFilter()},destroy:function(){delete this.block.properties.filter,delete this.block.hasFilter,delete this.block.hasBlurFilter,delete this.block.hasDropShadowFilter}}),SL.editor.blocks.plugin.Filter.CSS_FILTER_NAME_REGEX=/(blur|brightness|contrast|drop-shadow|grayscale|hue-rotate|invert|opacity|saturate|sepia)/gi,SL("editor.blocks.plugin").HTML=Class.extend({init:function(t){this.block=t,this.block.editHTML=function(){SL.popup.open(SL.components.popup.CodeEditor,{title:"Edit HTML",mode:"text/html",value:this.contentElement.html()}).saved.add(function(t){this.setCustomHTML(t)}.bind(this))}.bind(t),this.block.setCustomHTML=function(t){this.contentElement.attr("data-has-custom-html",""),this.contentElement.html(t)}.bind(t),this.block.setHTML=function(t){this.contentElement.html(t)}.bind(t),this.block.hasCustomHTML=function(){return this.contentElement.get(0).hasAttribute("data-has-custom-html")}.bind(t)},destroy:function(){delete this.block.editHTML,delete this.block.setCustomHTML,delete this.block.hasCustomHTML}}),SL("editor.blocks.plugin").Link=Class.extend({init:function(t){this.block=t,this.block.setLinkURL=function(t){if("string"==typeof t){!1===this.isLinked()&&this.changeContentElementType("a");var e=this.getAnchorElement();e.attr("href",t),"_self"!==e.attr("target")&&e.attr("target","_blank"),/^#\/\d/.test(t)&&e.removeAttr("target")}else this.getAnchorElement().removeAttr("href target"),this.changeContentElementType(this.options.contentElementType);"function"==typeof this.onLinkChanged&&this.onLinkChanged(t)}.bind(t),this.block.getLinkURL=function(){return this.getAnchorElement().attr("href")}.bind(t),this.block.isLinked=function(){return this.getAnchorElement().is("a")}.bind(t),this.block.getAnchorElement=function(){return this.options.contentElementTypeImmutable?this.getStyleWrapper():this.contentElement}.bind(t),this.block.properties.link={href:{setter:this.block.setLinkURL,getter:this.block.getLinkURL,isset:this.block.isLinked}}},destroy:function(){delete this.block.properties.link,delete this.block.setLinkURL,delete this.block.getLinkURL,delete this.block.getAnchorElement,delete this.block.isLinked}}),SL("editor.blocks").Shape=SL.editor.blocks.Base.extend({init:function(t){this._super("shape",t),this.plug(SL.editor.blocks.plugin.Link)},setup:function(){for(var t in this._super(),this.properties.attribute["data-shape-type"]={defaultValue:"rect",options:[{value:"rect"},{value:"circle"},{value:"diamond"},{value:"octagon"},{value:"triangle-up"},{value:"triangle-down"},{value:"triangle-left"},{value:"triangle-right"},{value:"arrow-up"},{value:"arrow-down"},{value:"arrow-left"},{value:"arrow-right"}]},SL.editor.util.SVG.SYMBOLS)this.properties.attribute["data-shape-type"].options.push({value:"symbol-"+t});this.properties.attribute["data-shape-stretch"]={defaultValue:!0},this.properties.attribute["data-shape-fill-color"]={defaultValue:"#000000"},this.properties.attribute["data-shape-stroke-color"]={},this.properties.attribute["data-shape-stroke-width"]={type:"number",unit:"px",decimals:0,minValue:1,maxValue:50,defaultValue:0},this.properties.attribute["data-shape-corner-radius"]={type:"number",unit:"px",decimals:0,minValue:0,maxValue:200,defaultValue:0,unsetWhenDefault:!0},this.repaintProperties=["attribute.data-shape-type","attribute.data-shape-stretch","attribute.data-shape-fill-color","attribute.data-shape-stroke-color","attribute.data-shape-stroke-width","attribute.data-shape-corner-radius"]},setDefaults:function(){this._super(),this.resize({width:300,height:300}),this.set({"attribute.data-shape-type":this.getPropertyDefault("attribute.data-shape-type"),"attribute.data-shape-fill-color":this.getPropertyDefault("attribute.data-shape-fill-color"),"attribute.data-shape-stretch":this.getPropertyDefault("attribute.data-shape-stretch")})},paint:function(){var t=this.get("attribute.data-shape-type"),e=this.get("attribute.data-shape-fill-color"),i=this.get("attribute.data-shape-stroke-color"),n=this.get("attribute.data-shape-stroke-width"),o=this.get("attribute.data-shape-corner-radius"),r=this.get("attribute.data-shape-stretch"),s=this.getDOMDimensions(),a=s.width,l=s.height;r||(a=l=Math.min(a,l));var c=SL.editor.blocks.Shape.shapeFromType(t,a,l,this.getSVGShapeElement());if(c){var h=this.hasStroke(),u=this.supportsStroke(c),d=this.getSVGElement();d.setAttribute("width","100%"),d.setAttribute("height","100%"),d.setAttribute("preserveAspectRatio",r?"none":"xMidYMid");var p,f=d.querySelector("defs clipPath"),g=f&&f.hasAttribute("id")?f.getAttribute("id"):null,m=d.querySelectorAll("defs");if(m.length&&[].slice.call(m).forEach(function(t){d.removeChild(t)}),this.supportsCornerRadius(c)&&(c.setAttribute("rx",o),c.setAttribute("ry",o)),c.removeAttribute("clip-path"),u&&h){var v;v=g&&!document.getElementById(g)?g:SL.util.string.uniqueID("shape-mask-");var b=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"defs"),y=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"clipPath"),S=$(c).clone().get(0);S.removeAttribute("class"),y.setAttribute("id",v),y.appendChild(S),b.appendChild(y),d.appendChild(b),c.setAttribute("clip-path","url(#"+v+")")}if(c.setAttribute("class","shape-element"),e?c.setAttribute("fill",e):c.removeAttribute("fill"),u&&i?c.setAttribute("stroke",i):c.removeAttribute("stroke"),u&&n?c.setAttribute("stroke-width",2*n):c.removeAttribute("stroke-width"),d.appendChild(c),/^symbol\-/.test(t)){if(!(p=c.getAttribute("data-viewbox"))||!1===/[0-9.]+ [0-9.]+ [0-9.]+ [0-9.]+/.test(p)){var k=SL.editor.util.SVG.boundingBox(c);p=[k.x,k.y,k.width,k.height].join(" "),c.setAttribute("data-viewbox",p)}}else p=[0,0,Math.round(a)||32,Math.round(l)||32].join(" ");d.setAttribute("viewBox",p)}},resize:function(){var t=this._super.apply(this,arguments);return t&&this.paint(),t},toggleStroke:function(){this.hasStroke()?this.unset(["attribute.data-shape-stroke-color","attribute.data-shape-stroke-width"]):this.set({"attribute.data-shape-stroke-color":"#000000","attribute.data-shape-stroke-width":1}),this.paint()},hasStroke:function(){return this.isset("attribute.data-shape-stroke-color")||this.isset("attribute.data-shape-stroke-width")},supportsStroke:function(t){return/rect|circle|ellipse|polygon/gi.test((t||this.getSVGShapeElement()).nodeName)},supportsCornerRadius:function(t){return"rect"===(t||this.getSVGShapeElement()).nodeName},getSVGElement:function(){var t=this.contentElement.find("svg").get(0);return t||((t=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg")).setAttribute("xmlns",SL.editor.util.SVG.NAMESPACE),t.setAttribute("version","1.1"),this.contentElement.append(t)),t},getSVGShapeElement:function(){return this.getSVGElement().querySelector(".shape-element")},createThumbnail:function(t){var e=this.getSVGElement().cloneNode(!0),i=this.measure();return i=SL.util.math.fitWithin(i.width,i.height,t.width,t.height),e.setAttribute("width",i.width),e.setAttribute("height",i.height),e},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.ShapeType,SL.editor.components.toolbars.options.ShapeStretch,SL.editor.components.toolbars.options.ShapeFillColor,SL.editor.components.toolbars.options.ShapeCornerRadius,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderSVG,SL.editor.components.toolbars.groups.Link,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},onPropertyChanged:function(t){this._super.apply(this,arguments),t.some(function(t){return-1!==this.repaintProperties.indexOf(t)}.bind(this))&&this.paint()}}),SL.editor.blocks.Shape.shapeFromType=function(t,e,i,n){return e=e||32,i=i||32,/^symbol\-/.test(t)?SL.editor.util.SVG.symbol(t.replace(/^symbol\-/,""),n):"rect"===t?SL.editor.util.SVG.rect(e,i,n):"circle"===t?SL.editor.util.SVG.ellipse(e,i,n):"diamond"===t?SL.editor.util.SVG.polygon(e,i,4,n):"octagon"===t?SL.editor.util.SVG.polygon(e,i,8,n):"triangle-up"===t?SL.editor.util.SVG.triangleUp(e,i,n):"triangle-down"===t?SL.editor.util.SVG.triangleDown(e,i,n):"triangle-left"===t?SL.editor.util.SVG.triangleLeft(e,i,n):"triangle-right"===t?SL.editor.util.SVG.triangleRight(e,i,n):"arrow-up"===t?SL.editor.util.SVG.arrowUp(e,i,n):"arrow-down"===t?SL.editor.util.SVG.arrowDown(e,i,n):"arrow-left"===t?SL.editor.util.SVG.arrowLeft(e,i,n):"arrow-right"===t?SL.editor.util.SVG.arrowRight(e,i,n):void 0},SL("editor.blocks").Snippet=SL.editor.blocks.Base.extend({init:function(t){this._super("snippet",$.extend({},t)),this.plug(SL.editor.blocks.plugin.HTML)},bind:function(){this._super(),this.onEditingKeyUp=this.onEditingKeyUp.bind(this),this.onEditingKeyDown=this.onEditingKeyDown.bind(this),this.onEditingInput=this.onEditingInput.bind(this)},blur:function(){this._super(),this.disableEditing()},setDefaults:function(){this._super(),this.resize({width:SL.editor.blocks.Snippet.DEFAULT_WIDTH,height:SL.editor.blocks.Snippet.DEFAULT_HEIGHT})},resizeToFitContent:function(){this.domElement.css("width","auto");var t=Math.min(this.domElement.get(0).offsetWidth,SL.view.getSlideSize().width);(0===t||isNaN(t))&&(t=SL.editor.blocks.Snippet.DEFAULT_WIDTH),this.domElement.css("width",t),this.domElement.css("height","auto");var e=Math.min(this.domElement.get(0).offsetHeight,SL.view.getSlideSize().height);(0===e||isNaN(e))&&(e=SL.editor.blocks.Snippet.DEFAULT_HEIGHT),this.domElement.css("height",e)},getContextMenuOptions:function(){return this.isEditingText()?[]:this._super()},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.TextAlign,SL.editor.components.toolbars.options.TextSize,SL.editor.components.toolbars.options.LineHeight,SL.editor.components.toolbars.options.LetterSpacing,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.TextColor,SL.editor.components.toolbars.options.BackgroundColor,SL.editor.components.toolbars.options.Padding,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},enableEditing:function(){this.isEditingText()||(this.contentElement.attr("contenteditable",""),this.domElement.addClass("is-editing"),this.contentElement.on("keyup",this.onEditingKeyUp),this.contentElement.on("keydown",this.onEditingKeyDown),this.contentElement.on("input",this.onEditingInput),this.editor=CKEDITOR.inline(this.contentElement.get(0),{allowedContent:!0}),this.editor.on("instanceReady",function(){this.editor.focus();var t=this.editor.createRange();t.moveToElementEditEnd(this.editor.editable()),t.select()}.bind(this)))},disableEditing:function(){this.contentElement.removeAttr("contenteditable").blur(),this.domElement.removeClass("is-editing"),this.contentElement.off("keyup",this.onEditingKeyUp),this.contentElement.off("keydown",this.onEditingKeyDown),this.contentElement.off("input",this.onEditingInput),this.editor&&(this.editor.destroy(),this.editor=null),SL.editor.controllers.Blocks.afterBlockTextSaved(this.contentElement)},isEditingText:function(){return this.domElement.hasClass("is-editing")},toggleAttributeWhen:function(t,e){e?this.contentElement.attr(t,""):this.contentElement.removeAttr(t)},onDoubleClick:function(t){this._super(t),SL.view.isEditing()&&this.enableEditing()},onKeyDown:function(t){this._super(t),13===t.keyCode?this.isEditingText()||SL.util.isTypingEvent(t)?t.metaKey&&this.disableEditing():(t.preventDefault(),this.enableEditing()):27===t.keyCode&&(t.preventDefault(),this.disableEditing())},onEditingKeyUp:function(){SL.editor.controllers.Blocks.afterBlockTextInput()},onEditingKeyDown:function(){SL.editor.controllers.Blocks.afterBlockTextInput()},onEditingInput:function(){setTimeout(function(){SL.editor.controllers.Blocks.afterBlockTextInput()},1)},onPropertyChanged:function(t){this._super.apply(this,arguments),-1!==t.indexOf("style.letter-spacing")&&this.toggleAttributeWhen("data-has-letter-spacing",this.isset("style.letter-spacing")),-1!==t.indexOf("style.line-height")&&this.toggleAttributeWhen("data-has-line-height",this.isset("style.line-height"))}}),SL.editor.blocks.Snippet.DEFAULT_WIDTH=300,SL.editor.blocks.Snippet.DEFAULT_HEIGHT=300,SL("editor.blocks").Table=SL.editor.blocks.Base.extend({init:function(t){this._super("table",$.extend({minWidth:100,verticalResizing:!1},t)),t&&t.rows&&this.setRows(t.rows)},setup:function(){this._super(),this.tableSizeChanged=new signals.Signal,this.tableHeaderChanged=new signals.Signal,this.properties.attribute["data-table-cols"]={type:"number",decimals:0,minValue:1,maxValue:10,defaultValue:3},this.properties.attribute["data-table-rows"]={type:"number",decimals:0,minValue:1,maxValue:18,defaultValue:3},this.properties.attribute["data-table-padding"]={type:"number",unit:"px",decimals:0,minValue:0,maxValue:30,defaultValue:5},this.properties.attribute["data-table-has-header"]={defaultValue:!0},this.properties.attribute["data-table-border-width"]={type:"number",unit:"px",decimals:0,minValue:0,maxValue:20,defaultValue:1},this.properties.attribute["data-table-border-color"]={},this.repaintProperties=["attribute.data-table-cols","attribute.data-table-rows","attribute.data-table-padding","attribute.data-table-has-header","attribute.data-table-border-color","attribute.data-table-border-width","style.font-size"]},bind:function(){this._super(),this.onEditingKeyUp=this.onEditingKeyUp.bind(this),this.onEditingKeyDown=this.onEditingKeyDown.bind(this),this.onEditingInput=this.onEditingInput.bind(this),this.onCellFocused=this.onCellFocused.bind(this),this.onCellMouseOver=this.onCellMouseOver.bind(this)},blur:function(){this._super(),this.isEditingText()&&this.disableEditing()},setDefaults:function(){this._super(),this.resize({width:SL.editor.blocks.Table.DEFAULT_WIDTH,height:SL.editor.blocks.Table.DEFAULT_HEIGHT})},getContextMenuOptions:function(){return[{label:"Insert row above",callback:this.onInsertRowAbove.bind(this),filter:function(){return this.getTableRowCount()<this.getPropertySettings("attribute.data-table-rows").maxValue}.bind(this)},{label:"Insert row below",callback:this.onInsertRowBelow.bind(this),filter:function(){return this.getTableRowCount()<this.getPropertySettings("attribute.data-table-rows").maxValue}.bind(this)},{label:"Insert column left",callback:this.onInsertColLeft.bind(this),filter:function(){return this.getTableColCount()<this.getPropertySettings("attribute.data-table-cols").maxValue}.bind(this)},{label:"Insert column right",callback:this.onInsertColRight.bind(this),filter:function(){return this.getTableColCount()<this.getPropertySettings("attribute.data-table-cols").maxValue}.bind(this)},{type:"divider"},{label:"Delete row",callback:this.onDeleteRow.bind(this),filter:function(){return this.getTableRowCount()>this.getPropertySettings("attribute.data-table-rows").minValue}.bind(this)},{label:"Delete column",callback:this.onDeleteCol.bind(this),filter:function(){return this.getTableColCount()>this.getPropertySettings("attribute.data-table-cols").minValue}.bind(this)}]},getToolbarOptions:function(){
return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.groups.TableSize,SL.editor.components.toolbars.options.TableHasHeader,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.TablePadding,SL.editor.components.toolbars.options.TableBorderWidth,SL.editor.components.toolbars.options.TableBorderColor,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.TextAlign,SL.editor.components.toolbars.options.TextSize,SL.editor.components.toolbars.options.TextColor,SL.editor.components.toolbars.options.BackgroundColor,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},getTableElement:function(){var t=this.contentElement.find("table");0===t.length&&(t=$("<table>").appendTo(this.contentElement));var e=t.find("tbody");return 0===e.length&&(e=$("<tbody>").appendTo(t)),t},setTableHTML:function(t){this.getTableElement().find("tbody").html(t),this.afterTableSizeChanged()},getTableRowCount:function(){return this.getTableElement().find("tr").length},getTableColCount:function(){return this.getTableElement().find("tr").first().find("td, th").length},getTableBorderColor:function(){return this.getTableElement().find("td, th").css("border-top-color")},resize:function(){var t=this._super.apply(this,arguments);return this.paint(),t},paint:function(){this._super.apply(this,arguments);var t=this.getTableElement(),e=this.get("attribute.data-table-rows"),i=this.get("attribute.data-table-cols"),n=e-t.find("tr").length;if(n>0)for(var o=0;o<n;o++)t.append("<tr></tr>");else n<0&&t.find("tr:gt("+(e-1)+")").remove();for(var r=[],s=0;s<e;s++)r.push([]);t.find("tr").each(function(t,n){var o=$(n);o.find("td, th").each(function(n){var o=1,s=1;if(this.hasAttribute("rowspan")&&0===(o=parseInt(this.getAttribute("rowspan"),10))&&(o=e-t),this.hasAttribute("colspan")&&(s=parseInt(this.getAttribute("colspan"),10)),s>1||o>1)for(var a=t;a<Math.min(t+o,e);a++)for(var l=n;l<Math.min(n+s,i);l++)a===t&&l===n||(r[a][l]=!0)});var s=r[t].reduce(function(t,e){return!0===e?t+1:t},0),a=i-s-o.find("td, th").length;if(a>0)for(var l=0;l<a;l++)this.backfill($("<td></td>").appendTo(o));else if(a<0){var c=i-s-1;o.find("td:gt("+c+"), th:gt("+c+")").remove()}}.bind(this)),this.get("attribute.data-table-has-header")?t.find("tr").first().find("td").changeElementType("th"):t.find("tr").first().find("th").changeElementType("td"),t.find("td, th").css({padding:this.isset("attribute.data-table-padding")?this.get("attribute.data-table-padding"):"","border-width":this.isset("attribute.data-table-border-width")?this.get("attribute.data-table-border-width"):"","border-color":this.isset("attribute.data-table-border-color")?this.get("attribute.data-table-border-color"):""}),t.find("td:last-child, th:last-child").css("width",""),this.refreshMinWidth(),this.paintResizeHandles(),this.transform&&this.transform.isVisible()&&this.transform.sync()},paintResizeHandles:function(){var t=[],e=this.getTableElement(),i=Math.floor(this.get("attribute.data-table-border-width")/2);e.find("tr").first().find("td:not(:last), th:not(:last)").each(function(e,n){var o=this.contentElement.find('.sl-table-column-resizer[data-column-index="'+e+'"]');0===o.length&&((o=$('<div class="editing-ui sl-table-column-resizer" data-column-index="'+e+'"></div>')).on("vmousedown",this.onResizeHandleMouseDOwn.bind(this)),o.on("dblclick",this.onResizeHandleDoubleClick.bind(this)),o.appendTo(this.contentElement)),o.css("left",n.offsetLeft+n.offsetWidth+i),t.push(e)}.bind(this)),this.contentElement.find(".sl-table-column-resizer").each(function(){-1===t.indexOf(parseInt(this.getAttribute("data-column-index"),10))&&$(this).remove()})},onResizeHandleMouseDOwn:function(t){t.preventDefault();var e=this.getTableElement(),i=$(t.currentTarget),n=parseInt(i.attr("data-column-index"),10),o=e.find("td:eq("+n+"), th:eq("+n+")").first(),r=this.domElement.offset().left,s=o.position().left,a=s+SL.editor.blocks.Table.MIN_COL_WIDTH,l=this.measure().transformed.width;i.addClass("is-dragging"),l-=this.getMinWidthFromCells(e.find("tr:first-child td:gt("+n+"), th:gt("+n+")"));var c=function(t){var i=n+1;e.find("td:nth-child("+i+"), th:nth-child("+i+")").css({width:Math.round(Math.max(Math.min(t.clientX-r,l),a)-s)}),this.paintResizeHandles()}.bind(this),h=function(){i.removeClass("is-dragging"),$(document).off("vmousemove",c),$(document).off("vmouseup",h)}.bind(this);$(document).on("vmousemove",c),$(document).on("vmouseup",h)},onResizeHandleDoubleClick:function(t){var e=parseInt($(t.currentTarget).attr("data-column-index"),10);this.getTableElement().find("td:eq("+e+"), th:eq("+e+")").css("width",""),this.paintResizeHandles()},enableEditing:function(t){if(!this.isEditingText()){this.domElement.addClass("is-editing"),this.contentElement.on("keyup",this.onEditingKeyUp),this.contentElement.on("keydown",this.onEditingKeyDown),this.contentElement.on("input",this.onEditingInput);var e=this.contentElement.find("td, th");e.wrapInner("<div contenteditable>"),e.find("[contenteditable]").on("mouseover",this.onCellMouseOver).on("focus",this.onCellFocused),t=t||this.contentElement.find("td, th").first(),this.enableEditingOfCell(t,!0),t.find(">[contenteditable]").focus()}this.paint()},enableEditingOfCell:function(t,e){if(t){var i=t.find(">[contenteditable]").first(),n=i.data("ckeditor");n||(n=CKEDITOR.inline(i.get(0),this.getEditorOptions(t)),i.data("ckeditor",n),e&&n.on("instanceReady",function(){SL.util.selection.moveCursorToEnd(i.get(0))}.bind(this)),SL.editor.controllers.Capabilities.isTouchEditor()&&window.scrollTo(0,Math.max(t.offset().top-100,0)))}},disableEditing:function(){this.domElement.removeClass("is-editing"),this.contentElement.off("keyup",this.onEditingKeyUp),this.contentElement.off("keydown",this.onEditingKeyDown),this.contentElement.off("input",this.onEditingInput),this.getTableElement().find("td>[contenteditable], th>[contenteditable]").each(function(t,e){var i=$(e);i.data("ckeditor")&&(i.data("ckeditor").destroy(),i.data("ckeditor","")),e.parentNode.innerHTML=e.innerHTML}),this.contentElement.find("td, th").off("mouseover",this.onCellMouseOver).off("focus",this.onCellFocused).blur(),SL.util.selection.clear(),this.invalidateMeasurements(),this.paint(),SL.editor.controllers.Blocks.afterBlockTextSaved(this.contentElement)},isEditingText:function(){return this.domElement.hasClass("is-editing")},enableBackfill:function(){this.backfillData=[],this.getTableElement().find("tr").each(function(t,e){$(e).find("td, th").each(function(e,i){this.backfillData[e]=this.backfillData[e]||[],this.backfillData[e][t]=i.innerHTML}.bind(this))}.bind(this))},disableBackfill:function(){this.backfillData=null},backfill:function(t){if(this.backfillData&&this.backfillData.length){var e=t.index(),i=t.parent().index();if(this.backfillData[e]){var n=this.backfillData[e][i];n&&t.html(n)}}},setRows:function(t){var e=0;t.forEach(function(t){e=Math.max(t.length,e)}),this.set({"attribute.data-table-rows":t.length,"attribute.data-table-cols":e}),this.getTableElement().find("tr").each(function(e){$(this).find("th, td").each(function(i){$(this).text(t[e][i]||"")})})},getCellAtPoint:function(t,e){var i;return this.contentElement.find("td, th").each(function(n,o){var r=o.getBoundingClientRect();t>r.left&&t<r.right&&e>r.top&&e<r.bottom&&(i=o)}.bind(this)),i},getRowAtPoint:function(t,e){return $(this.getCellAtPoint(t,e)).parents("tr").get(0)},getEditorOptions:function(t){var e={enterMode:CKEDITOR.ENTER_BR,autoParagraph:!1,allowedContent:{"strong em u s del ins":{styles:"text-align"}},floatSpaceDockedOffsetX:-this.get("attribute.data-table-padding"),floatSpaceDockedOffsetY:this.get("attribute.data-table-padding")};return t.is("th")?e.toolbar=[["Italic","Underline","Strike"]]:e.toolbar=[["Bold","Italic","Underline","Strike"]],e},afterTableSizeChanged:function(){this.set({"attribute.data-table-rows":this.getTableElement().find("tr").length,"attribute.data-table-cols":this.getTableElement().find("tr").first().find("td, th").length}),this.transform&&this.transform.isVisible()&&this.transform.sync(),this.tableSizeChanged.dispatch()},refreshMinWidth:function(){this.options.minWidth=this.getMinWidthFromCells(this.getTableElement().find("tr:first-child td, tr:first-child th"))},getMinWidthFromCells:function(t){var e=0;return t.each(function(){"string"==typeof this.style.width&&this.style.width.length?e+=parseInt(this.style.width,10):e+=SL.editor.blocks.Table.MIN_COL_WIDTH}),e},destroy:function(){this.isEditingText()&&this.disableEditing(),this.tableSizeChanged.dispose(),this.tableSizeChanged=null,this.tableHeaderChanged.dispose(),this.tableHeaderChanged=null,this._super()},onDoubleClick:function(t){this._super(t),SL.view.isEditing()&&this.enableEditing($(this.getCellAtPoint(t.clientX,t.clientY)))},onCellMouseOver:function(t){var e=$(t.currentTarget).parent();e.length&&this.enableEditingOfCell(e)},onCellFocused:function(t){var e=$(t.currentTarget).parent();if(e.length){var i="number"==typeof this.lastTabTime&&Date.now()-this.lastTabTime<100;this.enableEditingOfCell(e,i)}},onKeyDown:function(t){this._super(t),13===t.keyCode?this.isEditingText()||SL.util.isTypingEvent(t)?t.metaKey&&this.disableEditing():(t.preventDefault(),this.enableEditing()):27===t.keyCode?(t.preventDefault(),this.disableEditing()):9===t.keyCode&&(this.lastTabTime=Date.now())},onEditingKeyUp:function(){SL.editor.controllers.Blocks.afterBlockTextInput()},onEditingKeyDown:function(){SL.editor.controllers.Blocks.afterBlockTextInput()},onEditingInput:function(){setTimeout(function(){SL.editor.controllers.Blocks.afterBlockTextInput()},1)},onPropertyChanged:function(t){if(this._super.apply(this,arguments),t.some(function(t){return-1!==this.repaintProperties.indexOf(t)}.bind(this))&&(this.paint(),this.invalidateMeasurements()),-1!==t.indexOf("style.color")){var e=this.contentElement.get(0);e.style.display="none",e.offsetHeight,e.style.display=""}-1!==t.indexOf("attribute.data-table-has-header")&&this.tableHeaderChanged.dispatch()},onContextMenuShown:function(t){var e=$(this.getCellAtPoint(t.clientX,t.clientY));e.length&&(e.addClass("context-menu-is-open"),this.isEditingText()&&this.disableEditing())},onContextMenuHidden:function(){this.getTableElement().find(".context-menu-is-open").removeClass("context-menu-is-open")},onInsertRowAbove:function(t){var e=$(this.getRowAtPoint(t.clientX,t.clientY));if(e.length){var i=e.clone();i.children().empty(),0===e.index()&&(e.find("th").changeElementType("td"),i.find("td").changeElementType("th")),e.before(i),this.afterTableSizeChanged(),SL.editor.controllers.History.pushLatest()}},onInsertRowBelow:function(t){var e=$(this.getRowAtPoint(t.clientX,t.clientY));e.length&&(e.after("<tr>"),this.afterTableSizeChanged(),SL.editor.controllers.History.pushLatest())},onDeleteRow:function(t){var e=$(this.getRowAtPoint(t.clientX,t.clientY));e.length&&(e.remove(),this.afterTableSizeChanged(),SL.editor.controllers.History.pushLatest())},onInsertColLeft:function(t){var e=$(this.getCellAtPoint(t.clientX,t.clientY));if(e.length){var i=e.index();-1!==i&&(this.getTableElement().find("td:nth-child("+(i+1)+")").before("<td>"),this.getTableElement().find("th:nth-child("+(i+1)+")").before("<th>"),this.afterTableSizeChanged()),SL.editor.controllers.History.pushLatest()}},onInsertColRight:function(t){var e=$(this.getCellAtPoint(t.clientX,t.clientY));if(e.length){var i=e.index();-1!==i&&(this.getTableElement().find("td:nth-child("+(i+1)+")").after("<td>"),this.getTableElement().find("th:nth-child("+(i+1)+")").after("<th>"),this.afterTableSizeChanged()),SL.editor.controllers.History.pushLatest()}},onDeleteCol:function(t){var e=$(this.getCellAtPoint(t.clientX,t.clientY));if(e.length){var i=e.index();-1!==i&&(this.getTableElement().find("td:nth-child("+(i+1)+"), th:nth-child("+(i+1)+")").remove(),this.afterTableSizeChanged()),SL.editor.controllers.History.pushLatest()}}}),SL.editor.blocks.Table.DEFAULT_WIDTH=800,SL.editor.blocks.Table.DEFAULT_HEIGHT=400,SL.editor.blocks.Table.MIN_COL_WIDTH=40,SL("editor.blocks").Text=SL.editor.blocks.Base.extend({init:function(t){this._super("text",$.extend({verticalResizing:!1,contentElementTypeImmutable:!0,placeholderTag:"p",placeholderText:"Text"},t)),this.plug(SL.editor.blocks.plugin.HTML),this.plug(SL.editor.blocks.plugin.Link),this.readDefaultContent(),this.injectDefaultContent()},bind:function(){this._super(),this.onEditingKeyUp=this.onEditingKeyUp.bind(this),this.onEditingKeyDown=this.onEditingKeyDown.bind(this),this.onEditingInput=this.onEditingInput.bind(this),this.onEditingFocusOut=this.onEditingFocusOut.bind(this)},blur:function(){this._super(),this.isEditingText()&&this.disableEditing()},setDefaults:function(){this._super(),this.resize({width:SL.editor.blocks.Text.DEFAULT_WIDTH})},readDefaultContent:function(){this.contentElement.attr("data-placeholder-tag")?this.options.placeholderTag=this.contentElement.attr("data-placeholder-tag"):this.contentElement.attr("data-placeholder-tag",this.options.placeholderTag),this.contentElement.attr("data-placeholder-text")?this.options.placeholderText=this.contentElement.attr("data-placeholder-text"):this.contentElement.attr("data-placeholder-text",this.options.placeholderText)},injectDefaultContent:function(){var t=this.getDefaultContent();""===this.contentElement.text().trim()&&t&&(this.hasPlugin(SL.editor.blocks.plugin.HTML)&&this.hasCustomHTML()||this.contentElement.html(t))},clearDefaultContent:function(){this.contentElement.html().trim()===this.getDefaultContent()&&this.contentElement.html(this.getDefaultContent(!0))},getDefaultContent:function(t){return this.options.placeholderTag&&this.options.placeholderText?t?"<"+this.options.placeholderTag+">&nbsp;</"+this.options.placeholderTag+">":"<"+this.options.placeholderTag+">"+this.options.placeholderText+"</"+this.options.placeholderTag+">":""},getTextValue:function(){return this.contentElement.text()},getLabel:function(){var t=this.contentElement.prop("innerText").slice(0,50).trim().split("\n")[0];return t||""},paint:function(){if(this.domElement.find(".sl-block-content-preview").remove(),this.isEditingText()||!SL.deck.util.containsInlineMath(this.contentElement.get(0))||SL.editor.controllers.Mode.isActive("fragment"))this.domElement.hasClass("has-preview")&&(this.domElement.removeClass("has-preview"),this.syncPairs());else{var t=$('<div class="editing-ui sl-block-content-preview inline visible-in-preview">').append(this.contentElement.html()).appendTo(this.contentElement);SL.deck.util.renderInlineMath(t.get(0)),this.domElement.addClass("has-preview"),this.syncZ(),this.syncPairs()}},externalizeLinks:function(){SL.util.openLinksInTabs(this.contentElement)},resize:function(){var t=this._super.apply(this,arguments);return this.transform&&this.transform.isResizing()&&this.syncPairs(),this.syncOverflow(),t},getContextMenuOptions:function(){return this.isEditingText()?[]:this._super()},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.TextAlign,SL.editor.components.toolbars.options.TextSize,SL.editor.components.toolbars.options.LineHeight,SL.editor.components.toolbars.options.LetterSpacing,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.TextColor,SL.editor.components.toolbars.options.BackgroundColor,SL.editor.components.toolbars.options.Padding,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Link,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},focus:function(){this._super()},enableEditing:function(){if(!this.isEditingText()){this.syncOverflow(),this.contentElement.attr("contenteditable",""),this.domElement.addClass("is-editing"),this.contentElement.on("keyup",this.onEditingKeyUp),this.contentElement.on("keydown",this.onEditingKeyDown),this.contentElement.on("input",this.onEditingInput),this.contentElement.on("focusout",this.onEditingFocusOut),this.paint(),this.clearDefaultContent();var t={};SL.editor.controllers.Capabilities.isTouchEditor()&&(this.contentElement.focus(),t.toolbar=[["Format"],["NumberedList","BulletedList","-","Blockquote"]],window.scrollTo(0,Math.max(this.contentElement.offset().top-60,0))),this.hasPlugin(SL.editor.blocks.plugin.HTML)&&this.hasCustomHTML()&&(t.allowedContent=!0),t.contentsLangDirection=!0===SLConfig.deck.rtl?"rtl":"ui",this.isLinked()&&(t.removePlugins="elementspath,contextmenu,link");var e=SL.view.getCurrentTheme();if(e&&e.hasPalette()){var i=e.get("palette");i=(i=i.join(",")).replace(/#/g,""),t.colorButton_colors=i}this.editor=CKEDITOR.inline(this.contentElement.get(0),t),this.editor.on("instanceReady",function(){this.contentElement.html(this.contentElement.html().trim()),this.editor.focus();var t=this.editor.createRange();t.moveToElementEditEnd(this.editor.editable()),t.select()}.bind(this)),this.editor.on("afterPaste",function(){this.isLinked()&&this.contentElement.find("a").contents().unwrap()}.bind(this))}},disableEditing:function(){this.contentElement.removeAttr("contenteditable").blur(),this.domElement.removeClass("is-editing"),this.contentElement.off("keyup",this.onEditingKeyUp),this.contentElement.off("keydown",this.onEditingKeyDown),this.contentElement.off("input",this.onEditingInput),this.contentElement.off("focusout",this.onEditingFocusOut),this.externalizeLinks(),this.editor&&(this.editor.destroy(),this.editor=null),this.injectDefaultContent(),this.paint(),this.invalidateMeasurements(),this.transform&&this.transform.isVisible()&&this.transform.sync(),SL.editor.controllers.Blocks.afterBlockTextSaved(this.contentElement),SL.editor.controllers.History.pushLatest()},syncPairs:function(){if(!this.destroyed&&!this.isRotated()){var t=this.measure().transformed;this.pairings.forEach(function(e){"bottom"===e.direction&&e.block.move({y:t.bottom})}),this._super()}},syncOverflow:function(){this.domElement.toggleClass("is-text-overflowing",this.contentElement.prop("scrollHeight")>SL.view.getSlideSize().height)},isEditingText:function(){return this.domElement.hasClass("is-editing")},toggleAttributeWhen:function(t,e){e?this.contentElement.attr(t,""):this.contentElement.removeAttr(t)},onDoubleClick:function(t){this._super(t),SL.view.isEditing()&&this.enableEditing()},onKeyDown:function(t){this._super(t),13===t.keyCode?this.isEditingText()||SL.util.isTypingEvent(t)?t.metaKey&&this.disableEditing():(t.preventDefault(),this.enableEditing()):27===t.keyCode&&(t.preventDefault(),this.disableEditing())},onEditingKeyUp:function(){this.invalidateMeasurements(),this.syncPairs(),this.syncOverflow(),SL.editor.controllers.Blocks.afterBlockTextInput()},onEditingKeyDown:function(){SL.editor.controllers.Blocks.afterBlockTextInput()},onEditingInput:function(){setTimeout(function(){SL.editor.controllers.Blocks.afterBlockTextInput()},1)},onEditingFocusOut:function(){SL.editor.controllers.Capabilities.isTouchEditor()&&setTimeout(function(){this.isEditingText()&&0===$(document.activeElement).closest(".cke").length&&this.disableEditing()}.bind(this),1)},onPropertyChanged:function(t){this._super.apply(this,arguments);var e=-1!==t.indexOf("style.letter-spacing"),i=-1!==t.indexOf("style.line-height"),n=-1!==t.indexOf("style.font-size"),o=-1!==t.indexOf("style.padding"),r=-1!==t.indexOf("style.border");e&&this.toggleAttributeWhen("data-has-letter-spacing",this.isset("style.letter-spacing")),i&&this.toggleAttributeWhen("data-has-line-height",this.isset("style.line-height")),(e||i||n||o||r)&&(this.invalidateMeasurements(),this.syncPairs(),this.transform&&this.transform.isVisible()&&this.transform.sync()),this.syncOverflow()},onLinkChanged:function(){this.isLinked()&&this.contentElement.find("a").contents().unwrap()}}),SL.editor.blocks.Text.DEFAULT_WIDTH=600,SL("editor.blocks").Video=SL.editor.blocks.Base.extend({init:function(t){this._super("video",$.extend({minWidth:30,minHeight:30},t)),this.videoStateChanged=new signals.Signal,this.hasSource()&&(this.isProcessing()?this.loadMediaModel().then(this.checkProcessingStatus,function(t){404===t.status&&this.clear()}.bind(this)):this.getVideoElement().on("error",function(){this.loadingFailed=!0,this.paint()}.bind(this)))},setup:function(){this._super(),this.properties.video={src:{setter:this.setVideoURL.bind(this),getter:this.getVideoURL.bind(this)},controls:{defaultValue:!0,setter:this.setControls.bind(this),getter:this.getControls.bind(this)},muted:{defaultValue:!1,setter:this.setMuted.bind(this),getter:this.getMuted.bind(this)},autoplay:{defaultValue:!1,setter:this.setAutoplay.bind(this),getter:this.getAutoplay.bind(this)},loop:{defaultValue:!1,setter:this.setLoop.bind(this),getter:this.getLoop.bind(this)}},this.properties.attribute["data-media-id"]={type:"string"},this.properties.attribute["data-video-thumb"]={type:"string"},this.properties.attribute["data-video-transcoding-src"]={type:"string"}},bind:function(){this._super(),this.onUploadCompleted=this.onUploadCompleted.bind(this),this.onUploadFailed=this.onUploadFailed.bind(this),this.onProcessingCompleted=this.onProcessingCompleted.bind(this),this.onProcessingFailed=this.onProcessingFailed.bind(this),this.checkProcessingStatus=this.checkProcessingStatus.bind(this)},setDefaults:function(){this._super(),this.resize({width:640,height:360}),this.set({"video.controls":this.properties.video.controls.defaultValue,"video.muted":this.properties.video.muted.defaultValue,"video.autoplay":this.properties.video.autoplay.defaultValue,"video.loop":this.properties.video.loop.defaultValue}),this.options.insertedFromToolbar&&(this.options.introDelay=300,this.browse())},getContextMenuOptions:function(){return this.isEmpty()?this._super():[{label:"Use video as slide background",callback:this.turnIntoSlideBackground.bind(this)},{type:"divider"}].concat(this._super())},getToolbarOptions:function(){return this.toolbarOptions||(this.toolbarOptions=[SL.editor.components.toolbars.options.Video,SL.editor.components.toolbars.options.VideoControls,SL.editor.components.toolbars.options.VideoAutoplay,SL.editor.components.toolbars.options.VideoMuted,SL.editor.components.toolbars.options.VideoLoop,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.Rotation,SL.editor.components.toolbars.options.Opacity,SL.editor.components.toolbars.options.Blur,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.groups.DropShadow,SL.editor.components.toolbars.groups.BorderCSS,SL.editor.components.toolbars.groups.Animation].concat(this._super())),this.toolbarOptions},setVideoURL:function(t){var e=this.getVideoElement();""===t?(e.off("loadedmetadata, error"),e.attr("src",""),e.attr("poster",""),this.loading=!1,this.loadingFailed=!1,this.paint(),this.videoStateChanged.dispatch()):SL.util.string.isIframeVideoURL(t)?SL.editor.controllers.Blocks.replace(this,{type:"iframe",afterInit:function(e){e.set({"iframe.src":SL.util.string.formatIframeSource(t),"iframe.autoplay":this.get("video.autoplay")})}.bind(this)}):(this.loading=!0,this.loadingFailed=!1,this.paint(),this.videoStateChanged.dispatch(),e.attr("src",t),this.isset("attribute.data-video-thumb")&&e.attr("poster",this.get("attribute.data-video-thumb")),e.off("loadedmetadata").on("loadedmetadata",function(){e.off("loadedmetadata, error"),this.loading=!1,this.syncAspectRatio(),this.paint(),this.videoStateChanged.dispatch()}.bind(this)),e.off("error").on("error",function(){SL.notify("Failed to load video","negative"),e.off("loadedmetadata, error"),this.loading=!1,this.loadingFailed=!0,this.paint(),this.videoStateChanged.dispatch()}.bind(this)))},getVideoURL:function(){return this.getVideoElement().attr("src")},isEmpty:function(){return!this.isset("video.src")},setControls:function(t){!0===t?this.getVideoElement().attr("controls",""):this.getVideoElement().removeAttr("controls")},getControls:function(){return this.getVideoElement().get(0).hasAttribute("controls")},setMuted:function(t){!0===t?this.getVideoElement().attr("muted",""):this.getVideoElement().removeAttr("muted")},getMuted:function(){return this.getVideoElement().get(0).hasAttribute("muted")},setAutoplay:function(t){!0===t?this.getVideoElement().attr("data-autoplay",""):this.getVideoElement().removeAttr("data-autoplay")},getAutoplay:function(){return this.getVideoElement().get(0).hasAttribute("data-autoplay")},setLoop:function(t){!0===t?this.getVideoElement().attr("loop",""):this.getVideoElement().removeAttr("loop")},getLoop:function(){return this.getVideoElement().get(0).hasAttribute("loop")},replacePosterURL:function(t){this.set("attribute.data-video-thumb",t),this.isset("attribute.data-video-thumb")&&this.getVideoElement().attr("poster",this.get("attribute.data-video-thumb"))},setMediaModel:function(t){this.model=t,this.model.processingCompleted.add(this.onProcessingCompleted),this.model.processingFailed.add(this.onProcessingFailed),this.model.isUploaded()?this.onUploadCompleted():(this.model.uploadCompleted.add(this.onUploadCompleted),this.model.uploadFailed.add(this.onUploadFailed),this.paint(),this.videoStateChanged.dispatch())},loadMediaModel:function(){return this.model||(this.model=new SL.models.Video({id:this.get("attribute.data-media-id")}),this.model.processingCompleted.add(this.onProcessingCompleted),this.model.processingFailed.add(this.onProcessingFailed)),this.model.load()},checkProcessingStatus:function(){this.isProcessing()&&this.model.isProcessed()&&this.onProcessingCompleted()},getVideoElement:function(){var t=this.contentElement.find("video");return 0===t.length&&(t=$("<video>").appendTo(this.contentElement)).attr("playsinline",""),t},isLoading:function(){return!!this.loading},isUploading:function(){return!(!this.model||!this.model.isWaitingToUpload()&&!this.model.isUploading())},isProcessing:function(){var t=this.get("attribute.data-video-transcoding-src");return!!("string"==typeof t&&t.length>0)},hasSource:function(){var t=this.get("video.src")||this.get("attribute.data-video-transcoding-src");return!!("string"==typeof t&&t.length>0)},hasLoadedMetadata:function(){return this.getVideoElement().get(0).readyState>0},hasLoadingFailed:function(){return this.loadingFailed},isThumbnailReady:function(){return!this.isProcessing()&&this.isset("attribute.data-video-thumb")},getNaturalSize:function(){var t=this.getVideoElement();return t.length?{width:t.prop("videoWidth"),height:t.prop("videoHeight")}:null},getAspectRatio:function(t){var e=this.getNaturalSize(t);return e?e.width/e.height:this._super()},syncAspectRatio:function(){if(this.getNaturalSize()){var t=this.measure();this.resize({width:t.width,height:t.height,center:!0})}},paint:function(){this.domElement.find(".sl-block-placeholder, .sl-block-overlay-warning, .media-progress").remove(),this.isLoading()||this.isUploading()||this.isProcessing()?(this.contentElement.append(['<div class="editing-ui sl-block-overlay media-progress">','<span class="spinner"></span>',"</div>"].join("")),this.isUploading()?this.contentElement.find(".media-progress").append('<br><span class="label">Uploading</span>'):this.isProcessing()&&this.contentElement.find(".media-progress").append('<br><span class="label">Processing</span>'),SL.util.html.generateSpinners()):this.hasLoadingFailed()?(this.contentElement.append(['<div class="editing-ui sl-block-overlay sl-block-overlay-warning">','<div class="overlay-content">Failed to load media.<br><button class="button white media-retry-button" style="margin-top: 10px;">Retry</button></div>',"</div>"].join("")),this.domElement.find(".media-retry-button").on("click",function(){this.setVideoURL(this.getVideoURL())}.bind(this))):this.hasSource()||this.showPlaceholder(),this.syncZ()},browse:function(){var t=SL.popup.open(SL.components.medialibrary.MediaLibrary,{select:SL.models.Media.VIDEO,selectExternal:!0});t.selected.addOnce(this.setMediaModel.bind(this)),t.selectedExternal.addOnce(this.setVideoURL.bind(this))},clear:function(){this.model=null,this.set("video.src",""),this.unset(["attribute.data-media-id","attribute.data-video-thumb","attribute.data-video-transcoding-src"]),this.paint(),this.videoStateChanged.dispatch()},turnIntoSlideBackground:function(){var t=Reveal.getCurrentSlide();SL.util.deck.removeSlideBackground(t,["size","position"]),t.setAttribute("data-background-video",this.get("video.src")),this.isset("attribute.data-video-thumb")&&t.setAttribute("data-background-video-thumb",this.get("attribute.data-video-thumb")),Reveal.syncSlide(t),SL.view.slideMenu.triggerBackgrounds(),this.destroy(),SL.editor.controllers.History.pushLatest()},destroy:function(){this.model&&(this.model.uploadCompleted.remove(this.onUploadCompleted),this.model.uploadFailed.remove(this.onUploadFailed),this.model.processingCompleted.remove(this.onProcessingCompleted),this.model.processingFailed.remove(this.onProcessingFailed),this.model=null),this.videoStateChanged&&(this.videoStateChanged.dispose(),this.videoStateChanged=null),this._super.apply(this,arguments)},onUploadCompleted:function(){this.unset("video.src"),this.set({"attribute.data-media-id":this.model.get("id"),"attribute.data-video-thumb":this.model.get("thumb_url"),"attribute.data-video-transcoding-src":this.model.get("url")}),this.paint(),this.videoStateChanged.dispatch(),this.checkProcessingStatus()},onUploadFailed:function(){this.clear()},onProcessingCompleted:function(){var t=this.get("attribute.data-video-transcoding-src");this.unset("attribute.data-video-transcoding-src"),this.set("video.src",t),this.videoStateChanged.dispatch()},onProcessingFailed:function(){this.clear()},onDoubleClick:function(){this.browse()}}),SL("editor.components").Colorpicker=Class.extend({init:function(t){this.editor=t,this.config={},this.render(),this.bind()},render:function(){this.domElement=$('<div class="sl-colorpicker">'),this.arrowElement=$('<div class="sl-colorpicker-arrow">').appendTo(this.domElement),this.apiElement=$('<div class="sl-colorpicker-api">').appendTo(this.domElement)},bind:function(){this.onEyeDropperClicked=this.onEyeDropperClicked.bind(this),this.onChooseClicked=this.onChooseClicked.bind(this),this.onResetClicked=this.onResetClicked.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.onDocumentMouseDown=this.onDocumentMouseDown.bind(this),this.onContainerScrolled=$.throttle(this.layout.bind(this),16)},renderColorpicker:function(){this.hasRenderedColorPicker||(this.hasRenderedColorPicker=!0,this.apiElement.spectrum({flat:!0,allowEmpty:!0,showInput:!0,showButtons:!1,showInitial:!0,showPalette:!0,showPaletteOnly:!0,togglePaletteOnly:!0,showSelectionPalette:!0,hideAfterPaletteSelect:!0,maxSelectionSize:10,togglePaletteMoreText:"More options",togglePaletteLessText:"Fewer options",preferredFormat:"hex",localStorageKey:"sl-colors",className:"sl-colorpicker-spectrum",move:function(t){this.config.changeCallback(this.config.alpha?t.toRgbString():t.toHexString(),!0)}.bind(this),change:function(t){this.config.changeCallback(this.config.alpha?t.toRgbString():t.toHexString(),!0)}.bind(this),hide:function(){this.hide()}.bind(this)}),this.togglePaletteButton=this.domElement.find(".sp-palette-toggle"),this.togglePaletteButton.on("mouseup",this.onMoreLessToggleClicked.bind(this)),SL.util.device.supportsEyeDropperAPI()&&this.togglePaletteButton.clone().removeClass("sp-palette-toggle").addClass("sp-eyedropper icon i-eyedropper").attr("data-tooltip","Eye dropper").html("").on("click",this.onEyeDropperClicked).insertBefore(this.togglePaletteButton),this.resetButton=this.togglePaletteButton.clone().removeClass("sp-palette-toggle").addClass("sp-use-default icon i-undo").attr("data-tooltip","Reset to default color").html("").on("click",this.onResetClicked).insertBefore(this.togglePaletteButton)),this.domElement.find(".sl-colorpicker-buttons").remove(),this.domElement.append(['<div class="sl-colorpicker-buttons">','<button class="sl-colorpicker-choose button s grey">'+this.config.chooseText+"</button>","</div>"].join("")),this.resetButton.toggle(!this.isInline()&&this.config.canReset),this.domElement.find(".sl-colorpicker-choose").on("click",this.onChooseClicked),this.apiElement.spectrum("option","palette",this.getColorPalettePresets(this.config.alpha)),this.apiElement.spectrum("option","showAlpha",!!this.config.alpha),this.apiElement.spectrum("option","cancelText",this.config.cancelText),
this.apiElement.spectrum("option","cancelClassName",this.config.cancelClassName),this.apiElement.spectrum("option","chooseText",this.config.chooseText),this.apiElement.spectrum("option","chooseClassName",this.config.chooseClassName),this.config.color&&this.apiElement.spectrum("set",this.config.color),this.apiElement.spectrum("reflow")},layout:function(){if(this.isInline())this.domElement.css({left:"",top:""}),this.arrowElement.css({left:"",top:""});else{var t=10,e=6,i=this.domElement.get(0).offsetWidth,n=this.domElement.get(0).offsetHeight,o=this.config.anchor.offset(),r=this.config.anchor.outerWidth(),s=this.config.anchor.outerHeight(),a=o.left+this.config.offsetX,l=o.top+this.config.offsetY;switch(this.config.alignment){case"t":a+=(r-i)/2,l-=n+t;break;case"b":a+=(r-i)/2,l+=s+t;break;case"l":a-=i+t,l+=(s-n)/2;break;case"r":a+=r+t,l+=(s-n)/2}switch(a=Math.min(Math.max(a,t),window.innerWidth-i-t),l=Math.min(Math.max(l,t),window.innerHeight-n-t),this.config.alignment){case"t":arrowX=o.left-a+r/2,arrowY=n;break;case"b":arrowX=o.left-a+r/2,arrowY=-e;break;case"l":arrowX=i,arrowY=o.top-l+s/2;break;case"r":arrowX=-e,arrowY=o.top-l+s/2}this.domElement.css({left:a,top:l}),this.arrowElement.css({left:arrowX,top:arrowY}),this.arrowElement.toggle(arrowY>t&&arrowY<n-t),this.domElement.attr("data-alignment",this.config.alignment)}},show:function(t){if(!t.anchor)throw"Can not show color picker without anchor.";this.config=$.extend({container:document.body,alignment:"l",offsetX:0,offsetY:0,alpha:!1,inline:!1,canReset:!0,resetText:"Use default",chooseText:"Done",resetCallback:SL.util.noop,changeCallback:SL.util.noop,hiddenCallback:SL.util.noop,resizedCallback:SL.util.noop},t),this.domElement.appendTo(this.config.container),this.domElement.toggleClass("inline",this.isInline()),this.renderColorpicker(),this.layout(),this.isInline()||($(window).on("resize",this.onWindowResize),$(document).on("mousedown",this.onDocumentMouseDown),this.config.anchor.closest(".toolbar-list").on("scroll",this.onContainerScrolled))},hide:function(){this.isInline()||(this.saveCurrentColorToPalette(),this.domElement.detach(),$(window).off("resize",this.onWindowResize),$(document).off("mousedown",this.onDocumentMouseDown),this.config.anchor&&this.config.anchor.closest(".toolbar-list").off("scroll",this.onContainerScrolled))},detach:function(){this.domElement.detach()},toggle:function(t){this.isVisible()&&!this.isInline()?this.hide():this.show(t)},isVisible:function(){return this.domElement.parent().length>0},isVisibleForAnchor:function(t){return!!(this.config&&this.config.anchor&&this.config.anchor.is(t)&&this.isVisible())},isInline:function(){return this.config.inline},setColor:function(t){this.apiElement.spectrum("set",t),this.apiElement.spectrum("reflow")},getColor:function(){return this.apiElement.spectrum("get")},saveCurrentColorToPalette:function(){this.apiElement.spectrum("saveCurrentSelection")},getColorPalettePresets:function(t){if(this.hasCustomPalette()){var e=[SL.view.getCurrentTheme().get("palette").concat()];return t&&e[0].push("transparent"),e}var i=["rgb(0, 0, 0)","rgb(34, 34, 34)","rgb(68, 68, 68)","rgb(102, 102, 102)","rgb(136, 136, 136)","rgb(170, 170, 170)","rgb(204, 204, 204)","rgb(238, 238, 238)","rgb(255, 255, 255)"],n=["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(168, 39, 107)"],o=["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"];return t&&i.push("transparent"),[i,n,o]},hasCustomPalette:function(){var t=SL.view.getCurrentTheme();return t&&t.hasPalette()},destroy:function(){this.domElement.remove()},onResetClicked:function(t){this.config.resetCallback(),this.hide(),t.preventDefault()},onChooseClicked:function(t){this.saveCurrentColorToPalette(),this.hide(),t.preventDefault()},onEyeDropperClicked:function(t){this.eyedropper||(this.eyedropper=new EyeDropper),this.eyedropper.open().then(function(t){this.setColor(t.sRGBHex),this.config.changeCallback(t.sRGBHex,!0),this.hide()}.bind(this))["catch"](function(){}),t.preventDefault()},onMoreLessToggleClicked:function(){setTimeout(function(){this.layout(),this.config.resizedCallback()}.bind(this),1)},onDocumentMouseDown:function(t){var e=$(t.target);0===e.closest(this.domElement).length&&0===e.closest(this.config.anchor).length&&this.hide()},onWindowResize:function(){this.layout()}}),SL("editor.components").Dock=Class.extend({init:function(t){this.options=t||{},this.expanded=!1,this.toggled=new signals.Signal,this.pages={},this.visiblePages=[],this.render(),this.bind()},render:function(){this.domElement=$('<div class="sl-dock"></div>'),this.domElement.appendTo(".page-wrapper")},bind:function(){SL.current_user.settings.watch("editor_fixed_notes",function(t){t?this.show("notes").focus():this.hide("notes")}.bind(this))},createPage:function(t,e){var i=this.pages[t];return i||((i=new e).appendTo(this.domElement),this.pages[t]=i),this.visiblePages.push({type:t,instance:i}),i},show:function(t){var e=SL.editor.components.dock[SL.editor.components.Dock.PAGE_TYPES[t].factoryName];if(e){var i=this.createPage(t,e);return this.expand(),i.show(),i}return null},hide:function(t){this.visiblePages=this.visiblePages.filter(function(e){return e.type!==t||(e.instance.hide(),!1)}),0===this.visiblePages.length&&this.collapse()},expand:function(){this.visiblePages.length>0&&!this.isExpanded()&&($("html").addClass("show-dock"),this.expanded=!0,this.toggled.dispatch())},collapse:function(){this.isExpanded()&&($("html").removeClass("show-dock"),this.expanded=!1,this.visiblePages.forEach(function(t){t.instance.isVisible()&&t.instance.hide()}),this.visiblePages.length=0,this.toggled.dispatch())},isExpanded:function(){return this.expanded}}),SL("editor.components").Dock.PAGE_TYPES={notes:{factoryName:"Notes"}},SL("editor.components.dock").Base=Class.extend({init:function(t){this.options=$.extend({type:null,title:null,subtitle:null,optional:!0},t),this.domElement=$('<div class="sl-dock-page"></div>'),this.domElement.attr("data-type",this.options.type)},render:function(){this.innerElement=$('<div class="sl-dock-inner"></div>').appendTo(this.domElement),this.renderHeader()},renderHeader:function(){this.options.title||this.options.subtitle||this.options.optional?this.headerElement=this.headerElement?this.headerElement.empty():$('<div class="sl-dock-header"></div>').prependTo(this.innerElement):this.headerElement&&this.headerElement.remove(),this.options.title&&(this.titleElement=$('<h3 class="title">').html(this.options.title).appendTo(this.headerElement)),this.options.subtitle&&(this.subtitleElement=$('<h4 class="subtitle">').html(this.options.subtitle).appendTo(this.headerElement))},appendTo:function(t){this.domElement.appendTo(t)},show:function(){this.visible=!0,this.innerElement||this.render()},hide:function(){this.visible=!1},isVisible:function(){return this.visible}}),SL("editor.components.dock").Notes=SL.editor.components.dock.Base.extend({init:function(){this._super({type:"notes",title:"Speaker Notes"}),this.onSlideChanged=this.onSlideChanged.bind(this),this.onNotesInput=$.throttle(this.onNotesInput.bind(this),1e3),this.renderHeader=this.renderHeader.bind(this)},render:function(){this._super.apply(this,arguments),this.notesElement=$('<textarea class="sl-dock-notes-value input-field">').appendTo(this.innerElement),this.notesElement.attr("placeholder","Write speaker notes for this slide..."),this.notesElement.attr("maxlength",SL.config.SPEAKER_NOTES_MAXLENGTH)},renderHeader:function(){this.options.subtitle=!0===SL.current_deck.get("share_notes")?SL.locale.get("NOTES_PUBLIC"):SL.locale.get("NOTES_PRIVATE"),this._super.apply(this,arguments),this.undockButton=$('<button class="button undock-button black-30">Undock <span class="undock-icon"></span></button>').appendTo(this.headerElement),this.undockButton.on("vclick",this.onUndockClicked.bind(this))},show:function(){this._super.apply(this,arguments),Reveal.isReady()?this.loadNotesForCurrentSlide():Reveal.addEventListener("ready",this.loadNotesForCurrentSlide.bind(this)),this.notesElement.on("input",this.onNotesInput),Reveal.addEventListener("slidechanged",this.onSlideChanged),SL.editor.controllers.Markup.slidesChanged.add(this.onSlideChanged),SL.current_deck.watch("share_notes",this.renderHeader),this.renderHeader()},hide:function(){this._super.apply(this,arguments),this.notesElement.off("input",this.onNotesInput),Reveal.removeEventListener("slidechanged",this.onSlideChanged),SL.editor.controllers.Markup.slidesChanged.remove(this.onSlideChanged),SL.current_deck.unwatch("share_notes",this.renderHeader)},focus:function(){this.notesElement.focus()},loadNotesForCurrentSlide:function(){SL.util.deck.afterSlidesChanged(),this.currentSlideID=$(Reveal.getCurrentSlide()).attr("data-id"),this.currentNotes=SLConfig.deck.notes[this.currentSlideID],this.notesElement.val(this.currentNotes).scrollTop(0)},saveNotes:function(){var t=this.notesElement.val();this.currentSlideID&&this.currentNotes!==t&&(SLConfig.deck.notes[this.currentSlideID]=t,SLConfig.deck.dirty=!0)},onUndockClicked:function(){SL.current_user.settings.set("editor_fixed_notes",!1),SL.current_user.settings.save(["editor_fixed_notes"])},onSlideChanged:function(){this.saveNotes(),this.loadNotesForCurrentSlide()},onNotesInput:function(){this.saveNotes()}}),SL("editor.components").Sidebar=Class.extend({init:function(t){this.options=t||{},this.sidebarElement=$(".sidebar"),this.sidebarPrimary=this.sidebarElement.find(".primary"),this.sidebarSecondary=this.sidebarElement.find(".secondary"),this.sidebarHeader=this.sidebarElement.find(".global-header"),this.sidebarScrollShadowTop=this.sidebarElement.find(".scroll-shadow-top"),this.sidebarScrollShadowBottom=this.sidebarElement.find(".scroll-shadow-bottom"),this.panelElement=$(".sidebar-panel"),this.saveButton=this.sidebarElement.find(".button.save"),this.previewButton=this.sidebarElement.find(".button.preview"),this.undoButton=this.sidebarElement.find(".button.undo"),this.exportButton=this.sidebarElement.find(".button.export"),this.importButton=this.sidebarElement.find(".button.import"),this.publishButton=this.sidebarElement.find(".button.publish"),this.settingsButton=this.sidebarElement.find(".button.settings"),this.revisionsButton=this.sidebarElement.find(".button.revisions"),this.medialibraryButton=this.sidebarElement.find(".button.medialibrary"),this.arrangeButton=this.sidebarElement.find(".button.arrange"),this.styleButton=this.sidebarElement.find(".button.style"),this.shareButton=this.sidebarElement.find(".button.share"),this.presentButton=this.sidebarElement.find(".button.present"),this.previewButton&&this.previewButton.attr("data-tooltip",SL.keyboard.getEditorShortcut("EDITOR_PREVIEW").tooltip),this.presentButton&&this.presentButton.attr("data-tooltip",SL.keyboard.getEditorShortcut("EDITOR_PRESENT").tooltip),this.undoButton&&this.undoButton.attr("data-tooltip",SL.keyboard.getEditorShortcut("EDITOR_UNDO").tooltip),this.arrangeButton&&this.arrangeButton.attr("data-tooltip",SL.keyboard.getEditorShortcut("ARRANGE_SLIDES").tooltip),this.currentPanel=null,this.createSignals(),this.render(),this.bind(),this.layout(),this.updatePublishButton(),this.updateUndoButton(),this.updatePresentButton(),SL.editor.controllers.Capabilities.canExport()||this.exportButton.hide(),SL.editor.controllers.Capabilities.canShareDeck()||this.shareButton.hide(),SL.editor.controllers.Capabilities.canChangeStyles()||this.styleButton.hide(),SL.editor.controllers.Capabilities.canSetVisibility()||this.publishButton.hide()},bind:function(){this.saveButton.on("vclick",this.onSaveClicked.bind(this)),this.previewButton&&this.previewButton.on("vclick",this.onPreviewClicked.bind(this)),this.undoButton&&this.undoButton.on("vclick",this.onUndoClicked.bind(this)),this.exportButton&&this.exportButton.on("vclick",this.onExportClicked.bind(this)),this.importButton&&this.importButton.on("vclick",this.onImportClicked.bind(this)),this.settingsButton.on("vclick",this.onSettingsClicked.bind(this)),this.revisionsButton.on("vclick",this.onRevisionsClicked.bind(this)),this.medialibraryButton.on("vclick",this.onMediaLibraryClicked.bind(this)),this.publishButton.on("vclick",this.onPublishClicked.bind(this)),this.arrangeButton.on("vclick",this.onArrangeClicked.bind(this)),this.styleButton.on("vclick",this.onStyleClicked.bind(this)),this.shareButton.on("vclick",this.onShareClicked.bind(this)),this.presentButton.on("vclick",this.onPresentClicked.bind(this)),this.panelElement.on("vclick",this.onPanelElementClicked.bind(this)),this.sidebarSecondary.on("scroll",this.layout.bind(this)),this.settingsPanel.onclose.add(this.close.bind(this,!0)),this.exportPanel.onclose.add(this.close.bind(this,!0)),this.importPanel.onclose.add(this.close.bind(this,!0)),this.revisionsPanel.onclose.add(this.close.bind(this,!0)),this.stylePanel.onclose.add(this.close.bind(this,!0)),$(window).on("resize",this.layout.bind(this)),SL.editor.controllers.History.changed.add(this.updateUndoButton.bind(this)),SL.editor.controllers.URL.changed.add(this.updatePresentButton.bind(this))},createSignals:function(){this.saveClicked=new signals.Signal,this.previewClicked=new signals.Signal},render:function(){this.revisionsPanel=new SL.editor.components.sidebar.Revisions,this.settingsPanel=new SL.editor.components.sidebar.Settings,this.exportPanel=new SL.editor.components.sidebar.Export,this.importPanel=new SL.editor.components.sidebar.Import,this.stylePanel=new SL.editor.components.sidebar.Style,this.renderStyleOptions(),this.renderMoreOptions()},renderStyleOptions:function(){SL.editor.controllers.Capabilities.canUseCSSEditor()&&!SL.editor.controllers.Capabilities.isTouchEditor()&&new SL.components.Menu({anchor:this.styleButton,anchorSpacing:10,alignment:"r",minWidth:180,showOnHover:!0,showOnHoverCondition:function(){return!this.styleButton.hasClass("active")}.bind(this),options:[{label:"Style options",icon:"brush",callback:function(){this.toggle("style")}.bind(this)},{label:"CSS editor",icon:"file-css",callback:function(){SL.editor.controllers.Mode.change("css")}.bind(this)}]})},renderMoreOptions:function(){var t=[{label:"Help & feedback",icon:"question-mark",url:"http://help.slides.com/knowledgebase",urlTarget:"_blank"},{label:"Make a copy of this deck",icon:"fork",callback:function(){SL.analytics.trackEditor("duplicate_deck"),SL.editor.controllers.API.forkDeck()}.bind(this)},{label:"View content summary",icon:"table",callback:function(){SL.analytics.trackEditor("view_content_summary"),this.showContentSummary()}.bind(this)}];SL.editor.controllers.Capabilities.canDeleteDeck()&&t.push({label:"Delete deck",icon:"trash",callback:function(){SL.analytics.trackEditor("delete_deck"),SL.editor.controllers.API.deleteDeck()}.bind(this)}),this.moreOptionsElement=this.sidebarElement.find(".more-options"),this.moreOptions=new SL.components.Menu({anchor:this.moreOptionsElement,anchorSpacing:10,alignment:"r",showOnHover:!0,options:t})},showContentSummary:function(){var t=[];t.push(["Slides",Reveal.getTotalSlides()]),t.push(["Words",$('.sl-block[data-block-type="text"]').text().match(/\S+/g).length]);var e=document.querySelectorAll('.sl-block[data-block-type="image"]').length+document.querySelectorAll(".reveal section[data-background-image]").length;e>0&&t.push(["Images",e]);var i=document.querySelectorAll('.sl-block[data-block-type="video"]').length+document.querySelectorAll(".reveal section[data-background-video]").length;i>0&&t.push(["Videos",i]),t=t.map(function(t){return"<td>"+t.join("</td><td>")+"</td>"}),SL.prompt({anchor:this.moreOptionsElement,alignment:"r",type:"custom",title:"Content summary",className:"content-summary",html:['<table class="sl-table" style="min-width: 250px;">',"<tr>","<th>Name</th>","<th>Count</th>","</tr>","<tr>",t.join("</tr><tr>"),"</tr>","</table>"].join(""),confirmButton:!0})},layout:function(){var t=window.innerHeight-(this.sidebarPrimary.outerHeight(!0)+this.sidebarHeader.outerHeight(!0));this.sidebarSecondary.css("max-height",t);var e=this.sidebarSecondary.scrollTop(),i=this.sidebarSecondary.prop("scrollHeight"),n=this.sidebarSecondary.outerHeight(),o=i>n,r=e/(i-n);this.sidebarScrollShadowBottom.css({opacity:o?1-r:0,bottom:this.sidebarHeader.outerHeight()}),this.sidebarScrollShadowTop.css({opacity:o?r:0,top:this.sidebarSecondary.offset().top})},open:function(t){var e;switch(SL.editor.controllers.Mode.clear(),t){case"settings":e=this.settingsPanel;break;case"export":e=this.exportPanel;break;case"import":e=this.importPanel;break;case"style":e=this.stylePanel;break;case"revisions":e=this.revisionsPanel}e===this.currentPanel?(this.setActiveButton(t),this.panelElement.addClass("visible"),SL.analytics.trackEditor("open_"+t+"_panel")):this.close().then(function(){this.panelElement.addClass("visible"),this.currentPanel=e,this.currentPanel.open(),this.setActiveButton(t),SL.analytics.trackEditor("open_"+t+"_panel")}.bind(this))},close:function(t){return new Promise(function(e){this.currentPanel?this.currentPanel&&this.currentPanel.hasUnsavedChanges()&&!t?this.currentPanel.promptUnsavedChanges().then(function(){this.currentPanel.save().then(function(){this.currentPanel.close(),this.afterClose(),e()}.bind(this))}.bind(this),function(){this.currentPanel.close(),this.afterClose(),e()}.bind(this)):(this.currentPanel.close(),this.afterClose(),e()):(this.afterClose(),e())}.bind(this))},afterClose:function(){this.currentPanel=null,this.setActiveButton(null),this.panelElement.removeClass("visible")},toggle:function(t){this.isExpanded(t)?this.close():this.open(t)},setActiveButton:function(t){t?(this.sidebarElement.addClass("has-active-panel"),this.sidebarSecondary.find(".active").removeClass("active"),this.sidebarSecondary.find(".button."+t).addClass("active")):(this.sidebarElement.removeClass("has-active-panel"),this.sidebarSecondary.find(".active").removeClass("active"))},isExpanded:function(t){return t?this.panelElement.find("."+t).hasClass("visible"):this.panelElement.hasClass("visible")},updateSaveButton:function(t,e){this.saveButton.attr({"class":"button save "+(t||""),"data-tooltip":e||""})},updatePublishButton:function(){var t=this.publishButton.find(".icon");SL.current_deck.get("visibility")===SL.models.Deck.VISIBILITY_SELF?t.removeClass("i-unlock-stroke").addClass("i-lock-stroke"):SL.current_deck.get("visibility")===SL.models.Deck.VISIBILITY_TEAM?t.removeClass("i-lock-stroke").addClass("i-unlock-stroke"):SL.current_deck.get("visibility")===SL.models.Deck.VISIBILITY_ALL&&t.removeClass("i-lock-stroke").addClass("i-unlock-stroke"),SL.current_deck.get("visibility")===SL.models.Deck.VISIBILITY_SELF||SL.current_user.privileges.privateDecks()?this.publishButton.attr("data-tooltip","Visibility"):this.publishButton.attr("data-tooltip","<strong>This presentation is public.</strong><br>You need a paid account to save <br>privately. Click to learn more.")},updateArrangeButton:function(t){"arranging"===t?this.setActiveButton("arrange"):this.setActiveButton(null)},updateUndoButton:function(){this.undoButton&&this.undoButton.toggleClass("disabled",!SL.editor.controllers.History.canUndo())},updatePresentButton:function(){this.presentButton&&SLConfig.deck.slug&&this.presentButton.attr("href",SL.routes.DECK_LIVE(SLConfig.deck.user.username,SLConfig.deck.slug)+"?context=editing")},onSaveClicked:function(t){t.preventDefault(),this.saveClicked.dispatch()},onPreviewClicked:function(t){t.preventDefault(),this.previewClicked.dispatch()},onUndoClicked:function(t){t.preventDefault(),SL.editor.controllers.History.undo(),SL.analytics.trackEditor("sidebar_undo_clicked")},onExportClicked:function(){var t=$(".reveal .slides").children().map(function(){var t=$(this).clone();return t.find("section").add(t).each(function(){var t=$.map(this.attributes,function(t){return t.name}),e=$(this);$.each(t,function(t,i){e.removeAttr(i)})}),t.wrap("<div>").parent().html()}).toArray().join("");return t='<div class="slides">'+t+"</div>",$(".sidebar .export textarea").text(SL.util.html.indent(t)),this.toggle("export"),!1},onImportClicked:function(){return this.toggle("import"),!1},onArrangeClicked:function(){return this.close().then(function(){SL.editor.controllers.Mode.toggle("arrange")}),!1},onSettingsClicked:function(){return this.toggle("settings"),!1},onRevisionsClicked:function(){return this.toggle("revisions"),!1},onMediaLibraryClicked:function(){return SL.popup.open(SL.components.medialibrary.MediaLibrary),!1},onStyleClicked:function(){return this.toggle("style"),!1},onShareClicked:function(){return SL.popup.open(SL.components.decksharer.DeckSharer,{deck:SL.current_deck}),!1},onPresentClicked:function(){SL.analytics.trackEditor("sidebar_present_clicked")},onPublishClicked:function(t){if(t.preventDefault(),SL.current_user.privileges.privateDecks()||SL.current_deck.get("visibility")===SL.models.Deck.VISIBILITY_SELF){var e=new SL.components.prompts.DeckVisibility(SL.current_deck,{anchor:$(t.currentTarget),alignment:"r",persistVisibility:!1});e.show(),e.visibilitySelected.add(function(t){SL.current_deck.set("visibility",t),SL.view.saveVisibility(),this.updatePublishButton()}.bind(this)),SL.analytics.trackEditor("visibility_menu_opened",{visibility:SL.current_deck.get("visibility")})}else window.location="/pricing",SL.analytics.trackEditor("click_upgrade_link",{source:"visibility button"})},onPanelElementClicked:function(t){t.target==this.panelElement.get(0)&&this.close()}}),SL("editor.components.sidebar").Base=Class.extend({init:function(){this.onWindowResize=this.onWindowResize.bind(this),this.onDocumentKeyDown=this.onDocumentKeyDown.bind(this),this.onSaveClicked=this.onSaveClicked.bind(this),this.onCancelClicked=this.onCancelClicked.bind(this),this.onCloseClicked=this.onCloseClicked.bind(this),this.strings={unsavedChangesWarning:"You have unsaved changes."},this.render(),this.bind(),this.createSignals()},render:function(){this.bodyElement=this.domElement.find(".panel-body"),this.footerElement=this.domElement.find(".panel-footer"),this.bodyElement.addClass("sl-scrollable"),this.scrollShadow=new SL.components.ScrollShadow({parentElement:this.domElement,contentElement:this.bodyElement,footerElement:this.footerElement,shadowSize:25,resizeContent:!1})},bind:function(){this.domElement.find(".save").on("click",this.onSaveClicked),this.domElement.find(".cancel").on("click",this.onCancelClicked),this.domElement.find(".close").on("click",this.onCloseClicked)},createSignals:function(){this.onclose=new signals.Signal},open:function(){this.domElement.addClass("visible"),this.layout(),$(window).on("resize",this.onWindowResize),$(document).on("keydown",this.onDocumentKeyDown)},close:function(){this.domElement.removeClass("visible"),$(window).off("resize",this.onWindowResize),$(document).off("keydown",this.onDocumentKeyDown)},layout:function(){this.scrollShadow.sync()},save:function(){return Promise.resolve()},promptUnsavedChanges:function(){return new Promise(function(t,e){SL.prompt({title:this.strings.unsavedChangesWarning,type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Discard</h3>",className:"negative",callback:e},{html:"<h3>Save changes</h3>",selected:!0,className:"positive",callback:t}]})}.bind(this))},hasUnsavedChanges:function(){return!1},updateSelection:function(){},applySelection:function(){},onSaveClicked:function(){this.save().then(function(){this.onclose.dispatch()}.bind(this))},onCancelClicked:function(){this.onclose.dispatch()},onCloseClicked:function(){this.onclose.dispatch()},onDocumentKeyDown:function(){},onWindowResize:function(){this.layout()}}),SL("editor.components.sidebar").ExportPDF=Class.extend({init:function(t){this.domElement=t,this.downloadButton=this.domElement.find(".download-pdf-button"),this.downloadButton.on("vclick",this.onDownloadClicked.bind(this)),this.downloadButtonLabel=this.domElement.find(".download-pdf-button .label"),this.downloadButtonLoader=Ladda.create(this.downloadButton.get(0)),this.marginButton=this.domElement.find(".download-pdf-margin"),this.marginButton.on("vclick",this.onMarginClicked.bind(this)),this.optionsButton=this.domElement.find(".download-pdf-more-options"),this.optionsButton.on("vclick",this.onOptionsClicked.bind(this)),this.onPoll=this.onPoll.bind(this),this.onPollTimeout=this.onPollTimeout.bind(this),this.exportID=null,this.pollJob=new SL.helpers.PollJob({interval:1e3,timeout:SL.config.EXPORT_PDF_TIMEOUT}),this.pollJob.polled.add(this.onPoll),this.pollJob.ended.add(this.onPollTimeout),this.heightChanged=new signals.Signal,this.setIsLoading(!1),this.exportOptions={slideNumber:SL.current_user.settings.has("export_slide_number")?SL.current_user.settings.get("export_slide_number"):SL.current_deck.get("slide_number"),slideNotes:SL.current_user.settings.has("export_slide_notes")?SL.current_user.settings.get("export_slide_notes"):SL.current_deck.get("slide_notes"),separateFragments:SL.current_user.settings.get("export_separate_fragments")},this.setMargin=this.setMargin.bind(this),this.setMargin(SL.config.DEFAULT_EXPORT_MARGIN)},startExport:function(){this.exportXHR&&this.exportXHR.abort(),this.exportXHR=$.ajax({url:SL.endpoints.EXPORT_START(SLConfig.deck.id),type:"POST",context:this,data:{"export":{export_type:"pdf",margin:this.marginValue,slide_number:this.exportOptions.slideNumber,slide_notes:this.exportOptions.slideNotes,print_separate_fragments:this.exportOptions.separateFragments}}}).done(function(t){this.exportID=t.id,this.exportXHR=null,this.pollJob.start()}.bind(this)).fail(function(){this.setIsLoading(!1),SL.notify(SL.locale.get("EXPORT_PDF_ERROR"),"negative")}.bind(this))},setIsLoading:function(t){t?(this.downloadButtonLabel.text(SL.locale.get("EXPORT_PDF_BUTTON_WORKING")),this.downloadButtonLoader&&this.downloadButtonLoader.start()):(this.downloadButtonLabel.text(SL.locale.get("EXPORT_PDF_BUTTON")),this.downloadButtonLoader&&this.downloadButtonLoader.stop())},showPreviousExport:function(t){if("string"==typeof t&&t.length){this.previousExport&&(this.previousExport.remove(),this.previousExport=null);var e=(SLConfig.deck.slug||"deck")+".pdf";this.previousExport=$('<p class="recent-export">Recent: <a href="'+t+'" download="'+e+'" target="_blank">'+e+"</a></p>").appendTo(this.domElement),$("html").addClass("editor-exported-pdf-successfully"),this.heightChanged.dispatch()}},setMargin:function(t){this.marginValue=parseFloat(t),("number"!=typeof this.marginValue||isNaN(this.marginValue))&&(this.marginValue=SL.config.DEFAULT_EXPORT_MARGIN);var e=0===this.marginValue?"None":Math.round(100*this.marginValue)+"%";this.marginButton.find(".value").remove(),this.marginButton.append('<span class="value">'+e+"</span>")},onDownloadClicked:function(){this.setIsLoading(!0),this.startExport(),SL.analytics.trackEditor("download_pdf")},onMarginClicked:function(){var t=[0,.05,.1,.15,.2].map(function(t){return{value:t,title:0===t?"None":Math.round(100*t)+"%",selected:t===this.marginValue}},this);SL.prompt({anchor:this.marginButton,title:"Page Margin",subtitle:"The amount of space between your content and the page edge.",type:"list",alignment:"t",data:t,optional:!0,cancelButton:!0,maxWidth:250}).confirmed.add(this.setMargin)},onOptionsClicked:function(){var t=[{value:"slideNumber",title:"Print slide numbers",selected:this.exportOptions.slideNumber},{value:"slideNotes",title:"Print speaker notes",selected:this.exportOptions.slideNotes},{value:"separateFragments",title:"Print fragments on separate pages",selected:this.exportOptions.separateFragments}];SL.prompt({anchor:this.optionsButton,title:"Export Options",type:"list",listType:"multiselect",alignment:"t",data:t,optional:!0,minWidth:280,confirmLabel:"Done"}).confirmed.add(this.onOptionsChanged.bind(this))},onOptionsChanged:function(t){var e=[];"boolean"==typeof t.slideNumber&&(SL.current_user.settings.set("export_slide_number",t.slideNumber),e.push("export_slide_number")),"boolean"==typeof t.slideNotes&&(SL.current_user.settings.set("export_slide_notes",t.slideNotes),e.push("export_slide_notes")),"boolean"==typeof t.separateFragments&&(SL.current_user.settings.set("export_separate_fragments",t.separateFragments),e.push("export_separate_fragments")),e.length&&SL.current_user.settings.save(e),this.exportOptions=$.extend(this.exportOptions,t)},onPoll:function(){this.pdfStatusXHR&&this.pdfStatusXHR.abort(),this.pdfStatusXHR=$.get(SL.endpoints.EXPORT_STATUS(SLConfig.deck.id,this.exportID)).done(function(t){if("string"==typeof t.url&&t.url.length){var e=$('<iframe style="display: none;">');e.appendTo(document.body),e.attr("src",t.url),setTimeout(e.remove,1e3),this.showPreviousExport(t.url),this.setIsLoading(!1),this.pollJob.stop()}}.bind(this))},onPollTimeout:function(){this.setIsLoading(!1),SL.notify(SL.locale.get("EXPORT_PDF_ERROR"),"negative")}}),SL("editor.components.sidebar").ExportPPT=Class.extend({init:function(t){this.domElement=t,this.downloadButton=this.domElement.find(".download-ppt-button"),this.downloadButton.on("click",this.onDownloadClicked.bind(this)),this.downloadButtonLabel=this.domElement.find(".download-ppt-button .label"),this.downloadButtonLoader=Ladda.create(this.downloadButton.get(0)),this.onPoll=this.onPoll.bind(this),this.onPollTimeout=this.onPollTimeout.bind(this),this.exportID=null,this.pollJob=new SL.helpers.PollJob({interval:1e3,timeout:SL.config.EXPORT_PPT_TIMEOUT}),this.pollJob.polled.add(this.onPoll),this.pollJob.ended.add(this.onPollTimeout),this.heightChanged=new signals.Signal,this.setIsLoading(!1)},startExport:function(){this.exportXHR&&this.exportXHR.abort(),this.exportXHR=$.ajax({url:SL.endpoints.EXPORT_START(SLConfig.deck.id),type:"POST",context:this,data:{"export":{export_type:"ppt"}}}).done(function(t){this.exportID=t.id,this.exportXHR=null,this.pollJob.start()}.bind(this)).fail(function(){this.setIsLoading(!1),SL.notify(SL.locale.get("EXPORT_PPT_ERROR"),"negative")}.bind(this))},setIsLoading:function(t){t?(this.downloadButtonLabel.text(SL.locale.get("EXPORT_PPT_BUTTON_WORKING")),this.downloadButtonLoader&&this.downloadButtonLoader.start()):(this.downloadButtonLabel.text(SL.locale.get("EXPORT_PPT_BUTTON")),this.downloadButtonLoader&&this.downloadButtonLoader.stop())},showPreviousExport:function(t){if("string"==typeof t&&t.length){this.previousExport&&(this.previousExport.remove(),this.previousExport=null);var e=(SLConfig.deck.slug||"deck")+".pptx";this.previousExport=$('<p class="recent-export">Recent: <a href="'+t+'" download="'+e+'" target="_blank">'+e+"</a></p>").appendTo(this.domElement),$("html").addClass("editor-exported-ppt-successfully"),this.heightChanged.dispatch()}},onDownloadClicked:function(){this.setIsLoading(!0),this.startExport(),SL.analytics.trackEditor("download_ppt")},onPoll:function(){this.pptStatusXHR&&this.pptStatusXHR.abort(),this.pptStatusXHR=$.get(SL.endpoints.EXPORT_STATUS(SLConfig.deck.id,this.exportID)).done(function(t){if("string"==typeof t.url&&t.url.length&&1==t.ppt_complete){var e=$('<iframe style="display: none;">');e.appendTo(document.body),e.attr("src",t.url),setTimeout(e.remove,1e3),this.showPreviousExport(t.url),this.setIsLoading(!1),this.pollJob.stop()}}.bind(this))},onPollTimeout:function(){this.setIsLoading(!1),SL.notify(SL.locale.get("EXPORT_PPT_ERROR"),"negative")}}),SL("editor.components.sidebar").ExportZIP=Class.extend({init:function(t){this.domElement=t,this.downloadButton=this.domElement.find(".download-zip-button"),this.downloadButton.on("click",this.onDownloadClicked.bind(this)),this.downloadButtonLabel=this.domElement.find(".download-zip-button .label"),this.downloadButtonLoader=Ladda.create(this.downloadButton.get(0)),this.onPoll=this.onPoll.bind(this),this.onPollTimeout=this.onPollTimeout.bind(this),this.exportID=null,this.pollJob=new SL.helpers.PollJob({interval:1e3,timeout:SL.config.EXPORT_ZIP_TIMEOUT}),this.pollJob.polled.add(this.onPoll),this.pollJob.ended.add(this.onPollTimeout),
this.heightChanged=new signals.Signal,this.setIsLoading(!1)},startExport:function(){this.exportXHR&&this.exportXHR.abort(),this.exportXHR=$.ajax({url:SL.endpoints.EXPORT_START(SLConfig.deck.id),type:"POST",context:this,data:{"export":{export_type:"zip"}}}).done(function(t){this.exportID=t.id,this.exportXHR=null,this.pollJob.start()}.bind(this)).fail(function(){this.setIsLoading(!1),SL.notify(SL.locale.get("EXPORT_ZIP_ERROR"),"negative")}.bind(this))},setIsLoading:function(t){t?(this.downloadButtonLabel.text(SL.locale.get("EXPORT_ZIP_BUTTON_WORKING")),this.downloadButtonLoader&&this.downloadButtonLoader.start()):(this.downloadButtonLabel.text(SL.locale.get("EXPORT_ZIP_BUTTON")),this.downloadButtonLoader&&this.downloadButtonLoader.stop())},showPreviousExport:function(t){if("string"==typeof t&&t.length){this.previousExport&&(this.previousExport.remove(),this.previousExport=null);var e=(SLConfig.deck.slug||"deck")+".zip";this.previousExport=$('<p class="recent-export">Recent: <a href="'+t+'" download="'+e+'" target="_blank">'+e+"</a></p>").appendTo(this.domElement),$("html").addClass("editor-exported-zip-successfully"),this.heightChanged.dispatch()}},onDownloadClicked:function(){this.setIsLoading(!0),this.startExport(),SL.analytics.trackEditor("download_zip")},onPoll:function(){this.zipStatusXHR&&this.zipStatusXHR.abort(),this.zipStatusXHR=$.get(SL.endpoints.EXPORT_STATUS(SLConfig.deck.id,this.exportID)).done(function(t){if("string"==typeof t.url&&t.url.length){var e=$('<iframe style="display: none;">');e.appendTo(document.body),e.attr("src",t.url),setTimeout(e.remove,1e3),this.showPreviousExport(t.url),this.setIsLoading(!1),this.pollJob.stop()}}.bind(this))},onPollTimeout:function(){this.setIsLoading(!1),SL.notify(SL.locale.get("EXPORT_ZIP_ERROR"),"negative")}}),SL("editor.components.sidebar").Export=SL.editor.components.sidebar.Base.extend({init:function(){this.domElement=$(".sidebar-panel .export"),this.bodyElement=this.domElement.find(".panel-body"),this.htmlOutputElement=this.domElement.find(".deck-html-contents"),this.cssOutputElement=this.domElement.find(".deck-css-contents"),this.revealConfigElement=this.domElement.find(".deck-reveal-config"),this.downloadRevealElement=this.domElement.find(".section.download-reveal"),this.downloadRevealGenerator=this.domElement.find(".reveal-export-generator"),this.downloadHTMLButton=this.domElement.find(".download-html-button"),this.downloadPDFElement=this.domElement.find(".section.download-pdf"),this.downloadPPTElement=this.domElement.find(".section.download-ppt"),this.downloadZIPElement=this.domElement.find(".section.download-zip"),this.printElement=this.domElement.find(".section.print"),this.printButton=this.domElement.find(".section.print .print-button"),this.downloadPDFElement.length&&(this.pdf=new SL.editor.components.sidebar.ExportPDF(this.downloadPDFElement),this.pdf.heightChanged.add(this.layout.bind(this))),this.downloadPPTElement.length&&(this.ppt=new SL.editor.components.sidebar.ExportPPT(this.downloadPPTElement),this.ppt.heightChanged.add(this.layout.bind(this))),this.downloadZIPElement.length&&(this.zip=new SL.editor.components.sidebar.ExportZIP(this.downloadZIPElement),this.zip.heightChanged.add(this.layout.bind(this))),SL.util.device.isChrome()||(this.printElement.remove(),this.printButton=null),this.setupSecondaryOptions(),this.setupDropbox(),this._super()},setupSecondaryOptions:function(){let t=!1,e=this.domElement.find(".toggle-secondary-options"),i=()=>{this.bodyElement.find(".secondary-option").toggleClass("hidden",!t),e.text(t?"Fewer export options":"More export options")};e.length&&(e.on("vclick",()=>{t=!t,i()}),i())},setupDropbox:function(){SL.editor.controllers.Capabilities.canSyncToDropbox()?(this.dropboxElement=this.domElement.find(".section.dropbox"),this.dropboxContents=this.dropboxElement.find(".contents"),this.dropboxPollGoal=null,this.onDropboxPoll=this.onDropboxPoll.bind(this),this.onDropboxPollTimeout=this.onDropboxPollTimeout.bind(this),this.dropboxPollJob=new SL.helpers.PollJob({interval:2e3,timeout:3e5}),this.dropboxPollJob.polled.add(this.onDropboxPoll),this.dropboxPollJob.ended.add(this.onDropboxPollTimeout)):this.domElement.find(".section.dropbox").remove()},bind:function(){this._super(),this.downloadRevealGenerator&&this.downloadRevealGenerator.on("click",this.generateRevealExport.bind(this)),this.downloadHTMLButton&&this.downloadHTMLButton.on("click",this.onDownloadHTMLClicked.bind(this)),this.revealConfigElement&&this.revealConfigElement.on("click",this.onRevealConfigClicked.bind(this)),this.htmlOutputElement&&this.htmlOutputElement.on("click",this.onHTMLOutputClicked.bind(this)),this.cssOutputElement&&this.cssOutputElement.on("click",this.onCSSOutputClicked.bind(this)),this.printButton&&this.printButton.on("click",this.onPrintClicked.bind(this)),this.domElement.find(".upgrade-button").on("click",function(){SL.analytics.trackEditor("click_upgrade_link",{source:"export panel"})})},open:function(){this._super(),this.syncRevealExport(),this.checkDropboxStatus(),this.checkOnlineContent()},close:function(){this._super(),this.dropboxStatusXHR&&this.dropboxStatusXHR.abort(),this.dropboxPollJob&&(this.dropboxPollJob.stop(),this.dropboxPollGoal=null)},checkOnlineContent:function(){this.bodyElement.find(".section.online-content-warning").remove(),$('.reveal .slides [data-block-type="iframe"]').length&&this.bodyElement.prepend(['<div class="section online-content-warning">',"There are iframes in this presentation. Since iframes load content from other servers they won't work without an internet connection, even if you export your deck.","</div>"].join(""))},syncRevealExport:function(){SL.view.isDeveloperMode()?this.downloadRevealElement.show().removeClass("is-generated"):(this.downloadRevealElement.hide().removeClass("is-generated"),this.cssOutputElement.length&&this.cssOutputElement.val(""))},generateRevealExport:function(){if(this.downloadRevealElement.addClass("is-generated"),this.htmlOutputElement.length){var t=SL.view.getCurrentTheme(),e=['<div class="'+("theme-font-"+t.get("font"))+" "+("theme-color-"+t.get("color"))+'" style="width: 100%; height: 100%;">','<div class="reveal">','<div class="slides">',SL.editor.controllers.Serialize.getDeckAsString({removeSlideIds:!0,removeBlockIds:!0,removeTextPlaceholders:!0}),"</div>","</div>","</div>"].join("");this.htmlOutputElement.val(SL.util.html.indent(e))}if(this.revealConfigElement.length){var i=Reveal.getConfig(),n=["width: "+i.width,"height: "+i.height,'transition: "'+i.transition+'"','backgroundTransition: "'+i.backgroundTransition+'"',"center: false"];i.loop&&n.push("loop: "+i.loop),this.revealConfigElement.val(n.join(",\n")).css("height","auto").attr("rows",n.length)}this.cssOutputElement.length&&(this.cssOutputElement.val("Loading..."),$.ajax({url:SL.config.ASSET_URLS["offline-v2.css"],context:this}).fail(function(){this.cssOutputElement.val("Failed to load CSS...")}).done(function(t){var e=$("#user-css-output").html()||"",i=$("#theme-css-output").html()||"";this.cssOutputElement.val(["<style>",t,i,e,"</style>"].join("\n"))}))},checkDropboxStatus:function(){this.dropboxElement&&0!==this.dropboxElement.length&&(this.dropboxStatusXHR&&this.dropboxStatusXHR.abort(),this.dropboxStatusXHR=$.get(SL.endpoints.SERVICES_USER).done(function(t){var e="string"==typeof this.dropboxPollGoal;t&&t.dropbox_connected?(this.dropboxContents.html('<p>Your changes are automatically saved to Dropbox. <a href="http://help.slides.com/knowledgebase/articles/229620" target="_blank">Learn more.</a></p><button class="button negative disconnect-dropbox l">Disconnect</button>'),this.dropboxContents.find(".disconnect-dropbox").on("click",this.onDropboxDisconnectClicked.bind(this)),e&&"connected"===this.dropboxPollGoal?(this.dropboxPollJob.stop(),this.dropboxPollGoal=null,$.ajax({type:"POST",url:SL.endpoints.DROPBOX_SYNC_DECK(SLConfig.deck.id),data:{}})):SL.view.hasSavedThisSession()||(this.dropboxContents.append('<button class="button outline sync-dropbox l">Sync now</button>'),this.dropboxContents.find(".sync-dropbox").on("click",this.onDropboxSyncClicked.bind(this))),this.layout()):(this.dropboxContents.html('<p>Connect with Dropbox to automatically sync your work. Decks in your Dropbox folder can be viewed offline. <a href="http://help.slides.com/knowledgebase/articles/229620" target="_blank">Learn more.</a></p><button class="button connect-dropbox l">Connect Dropbox</button>'),this.dropboxContents.find("button").on("click",this.onDropboxConnectClicked.bind(this)),e&&"disconnected"===this.dropboxPollGoal&&(this.dropboxPollJob.stop(),this.dropboxPollGoal=null),this.layout()),this.dropboxStatusXHR=null}.bind(this)))},onDropboxConnectClicked:function(){this.dropboxPollGoal="connected",this.dropboxPollJob.start(),SL.util.openPopupWindow(SL.endpoints.DROPBOX_CONNECT(),"Sync with Dropbox",1024,650)},onDropboxDisconnectClicked:function(){this.dropboxPollGoal="disconnected",this.dropboxPollJob.start(),window.open(SL.endpoints.DROPBOX_DISCONNECT())},onDropboxSyncClicked:function(){$.ajax({type:"POST",url:SL.endpoints.DROPBOX_SYNC_DECK(SLConfig.deck.id),data:{}}).done(function(){SL.notify("Dropbox sync started")}).fail(function(){SL.notify("Dropbox sync failed","negative")})},onDropboxPoll:function(){this.checkDropboxStatus()},onDropboxPollTimeout:function(){},onDownloadHTMLClicked:function(){window.open(SL.endpoints.EXPORT_DECK(SLConfig.deck.user.username,SLConfig.deck.slug||SLConfig.deck.id)),SL.analytics.trackEditor("download_html")},onHTMLOutputClicked:function(){this.htmlOutputElement.select()},onCSSOutputClicked:function(){this.cssOutputElement.select()},onRevealConfigClicked:function(){this.revealConfigElement.select()},onPrintClicked:function(t){const e=["print-pdf","print-and-close","margin=0","pdfSeparateFragments="+(SL.current_user.settings.get("export_separate_fragments")||!1).toString()];SL.util.openPopupWindow(SL.current_deck.getURL({view:"print"})+"?"+e.join("&"),"Print deck",600,400),t.preventDefault()}}),SL("editor.components.sidebar").ImportFile=Class.extend({init:function(t,e){this.panel=t,this.options=$.extend({importType:"pdf",browseButtonLabel:"Select PDF/PPT file",analyticsEventPrefix:"import_pdf_ppt"},e),this.importCompleted=new signals.Signal,this.render(),this.bind(),this.reset()},render:function(){this.domElement=$(".sidebar-panel .import .import-from-file"),this.browseButton=this.domElement.find(".import-from-file-button")},bind:function(){this.onFileInputChange=this.onFileInputChange.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this)},reset:function(){this.hideOverlay(),this.stopTimeout(),this.createFileInput()},createFileInput:function(){this.browseFileInput&&(this.browseFileInput.remove(),this.browseFileInput.off("change",this.onFileInputChange)),this.browseButton.off("click"),this.browseButton.removeClass("disabled"),this.browseButton.text(this.options.browseButtonLabel),this.browseFileInput=$('<input class="file-input" type="file">').appendTo(this.browseButton),this.browseFileInput.on("change",this.onFileInputChange)},onFileInputChange:function(t){t.preventDefault();var e=this.browseFileInput.get(0).files[0];if(e){if(!this.validateFileType(e))return SL.notify("Invalid file type"),void this.createFileInput();if(!this.validateFileSize(e))return SL.notify("We only support imports up to <strong>"+SL.util.math.bytesToMegabytes(SL.config.MAX_IMPORT_UPLOAD_SIZE,!0)+" MB.</strong>","negative"),void this.createFileInput();SL.analytics.trackEditor(this.options.analyticsEventPrefix+"_file_selected");var i=e.name||"untitled";i=(i=i.trim()).replace(/\s/g,"-").replace(/[^a-zA-Z0-9-_\.]*/g,""),this.enterProcessingState(),$.ajax({type:"POST",url:SL.endpoints.FILE_IMPORT_NEW,data:{deck_id:SLConfig.deck.id,filename:i},context:this}).fail(function(){SL.notify("Failed to upload, please try again","negative"),this.hideOverlay()}).done(function(t){this.uploadFile(t.id,t.upload_url)})}else SL.notify("Failed to upload, please try again","negative")},validateFileType:function(t){return t&&(""===t.type||t.type.match(/powerpoint|presentationml|pdf/))},validateFileSize:function(t){return"number"!=typeof t.size||t.size<SL.config.MAX_IMPORT_UPLOAD_SIZE},uploadFile:function(t,e){var i=this.browseFileInput.get(0).files[0];if("string"!=typeof e||e.length<3)return SL.notify("Invalid upload URL, try reopening the imports page","negative"),void this.createFileInput();SL.analytics.trackEditor(this.options.analyticsEventPrefix+"_upload_started");var n=new SL.helpers.FileUploader({file:i,method:"PUT",external:!0,formdata:!1,contentType:!0,endpoint:e,timeout:9e5});n.succeeded.add(function(){n.destroy(),this.createFileInput(),this.startTimeout(),SL.analytics.trackEditor(this.options.analyticsEventPrefix+"_upload_complete"),$.ajax({type:"PUT",url:SL.endpoints.FILE_IMPORT_UPLOADED(t),data:{"import":{upload_complete:!0,import_type:this.options.importType}},context:this}).fail(function(){this.hideOverlay(),SL.notify("An error occurred while processing your file","negative")}).done(function(){SL.analytics.trackEditor(this.options.analyticsEventPrefix+"_upload_complete_sent")})}.bind(this)),n.progressed.add(function(t){this.setProgress(25*t)}.bind(this)),n.failed.add(function(){n.destroy(),this.createFileInput(),this.hideOverlay(),SL.notify("An error occurred while uploading your file","negative")}.bind(this)),n.upload()},showOverlay:function(t,e){this.overlay||(this.overlay=$('<div class="import-overlay">').appendTo(document.body),this.overlayInner=$('<div class="import-overlay-inner">').appendTo(this.overlay),this.overlayHeader=$('<div class="import-overlay-header">').appendTo(this.overlayInner),this.overlayBody=$('<div class="import-overlay-body">').appendTo(this.overlayInner),this.overlayFooter=$('<div class="import-overlay-footer">').appendTo(this.overlayInner),SL.helpers.StreamEditor.singleton().messageReceived.add(this.onSocketMessage),setTimeout(function(){this.overlay.addClass("visible")}.bind(this),1)),this.overlayInner.attr("data-state",t),this.overlayHeader.html("<h3>"+e+"</h3>"),this.overlayBody.empty(),this.overlayFooter.empty()},hideOverlay:function(){this.overlay&&(this.overlay.remove(),this.overlay=null,this.stopTimeout(),SL.helpers.StreamEditor.singleton().messageReceived.remove(this.onSocketMessage))},enterProcessingState:function(){this.showOverlay("processing","Processing import"),this.overlayBody.html(['<div class="progress">','<div class="progress-text">Uploading</div>','<div class="progress-spinner spinner" data-spinner-color="#333"></div>','<div class="progress-inner">','<div class="progress-text">Uploading</div>',"</div>","</div>"].join("")),SL.util.html.generateSpinners()},enterErrorState:function(t){t=t||{},this.showOverlay("error","Something went wrong..."),this.overlayBody.html(['<div class="error">','<p class="error-text">'+(t.message||"Sorry about that. We're looking into it.")+"</p>","</div>"].join("")),this.overlayFooter.html(['<button class="button l light-grey cancel-button">Close</button>'].join("")),this.overlayFooter.find(".cancel-button").on("click",this.hideOverlay.bind(this)),SL.util.html.generateSpinners()},enterMeasuringState:function(t){if(t.output&&t.output.length>0){this.importWidth=null,this.importHeight=null;var e=t.output.slice(0,3),i=function(){var n=e.shift();if(!n)return!1;this.getImageResolution(n).then(function(e){this.importWidth=e.width,this.importHeight=e.height,this.enterFinishedState(t)}.bind(this),function(){!1===i()&&(this.stopTimeout(),this.enterErrorState({message:"Unable to detect slide width/height. Please try again."}))}.bind(this))}.bind(this);i()}else this.stopTimeout(),this.enterErrorState({message:"No slides were returned from the server"})},enterFinishedState:function(t){SL.analytics.trackEditor(this.options.analyticsEventPrefix+"_import_complete"),this.stopTimeout(),this.showOverlay("finished","Finished"),this.overlayBody.html(['<p>The following <strong><span class="slide-count"></span> slides</strong> will be added.</p>','<div class="preview"></div>','<div class="options">','<div class="sl-checkbox outline">','<input id="import-append-checkbox" value="" type="checkbox">','<label for="import-append-checkbox" data-tooltip="Append the imported content after your existing slides instead of replacing them." data-tooltip-maxwidth="300">Append slides</label>',"</div>",'<div class="sl-checkbox outline transition-checkbox">','<input id="import-remove-transitions-checkbox" value="" type="checkbox" checked>','<label for="import-remove-transitions-checkbox" data-tooltip="Disables the standard slide transition. This typically looks better for imported slides." data-tooltip-maxwidth="300">Turn off transitions</label>',"</div>","</div>"].join("")),this.overlayFooter.html(['<button class="button l light-grey cancel-button">Cancel</button>','<button class="button l positive confirm-button">Import</button>'].join(""));var e=Reveal.getTotalSlides()>1;e&&this.overlayBody.find("#import-append-checkbox").prop("checked",!0),"none"===SLConfig.deck.transition&&this.overlayBody.find(".transition-checkbox").hide();var i=this.overlayBody.find(".preview"),n=function(){this.overlayBody.find(".slide-count").text(i.find(".preview-slide").not(".excluded").length)}.bind(this);t.output.forEach(function(t){var e=$('<div class="preview-slide">');e.attr({"data-background-image":t,"data-background-image-original":t}),e.appendTo(i),e.on("click",function(){e.hasClass("excluded")?e.removeClass("excluded").html(""):e.addClass("excluded").html('<div class="preview-slide-excluded-overlay"><span class="icon i-denied"></span></div>'),n()}.bind(this))}.bind(this)),i.on("scroll",this.loadVisiblePreviewThumbs.bind(this)),this.loadVisiblePreviewThumbs(),n();var o=function(){var t=this.overlayBody.find("#import-remove-transitions-checkbox").is(":checked"),e=this.importWidth,n=this.importHeight;if(e&&n){var o=SL.util.deck.getSlideSize(),r=o.width,s=o.height;if(!this.isAppending()){r=Math.max(r,SL.config.DEFAULT_SLIDE_WIDTH),s=Math.max(s,SL.config.DEFAULT_SLIDE_HEIGHT);var a=Math.min(r/e,s/n);r=Math.round(e*a),s=Math.round(n*a),SLConfig.deck.width=r,SLConfig.deck.height=s,SLConfig.deck.margin=0,Reveal.configure({width:SLConfig.deck.width,height:SLConfig.deck.height,margin:SLConfig.deck.margin})}t&&(SLConfig.deck.transition="none",Reveal.configure({transition:SLConfig.deck.transition}));var l=i.find(".preview-slide").not(".excluded").map(function(){return"<section>"+SL.data.templates.generateFullSizeImageBlock($(this).attr("data-background-image-original"),e,n,r,s,!0)+"</section>"});SL.editor.controllers.Markup.importSlides(l,!this.isAppending()),SL.view.layout(),this.hideOverlay(),this.importCompleted.dispatch()}else SL.notify("Unable to detect slide width/height. Please try a new import.","negative")}.bind(this);this.overlayFooter.find(".cancel-button").on("click",this.hideOverlay.bind(this)),this.overlayFooter.find(".confirm-button").on("click",function(t){e&&!this.isAppending()?SL.prompt({anchor:$(t.currentTarget),title:"Existing slides will be overwritten by your import.",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Continue</h3>",selected:!0,className:"positive",callback:o}]}):o()}.bind(this))},getImageResolution:function(t){return new Promise(function(e,i){var n=new Image;n.addEventListener("load",function(){e({width:n.naturalWidth,height:n.naturalHeight})}),n.addEventListener("error",function(){i()}),n.setAttribute("src",t)})},loadVisiblePreviewThumbs:function(){var t=this.overlayBody.find(".preview");if(t.length){var e=t.scrollTop(),i=e+t.outerHeight(),n=t.find(".preview-slide").first().outerHeight();t.find(".preview-slide").not(".loaded").each(function(t,o){var r=o.offsetTop;r+n>e&&r<i&&((o=$(o)).css("background-image",'url("'+o.attr("data-background-image")+'")'),o.addClass("loaded"))})}},setProgress:function(t){this.overlayBody.find(".progress-inner").css("width",Math.round(t)+"%")},startTimeout:function(){clearTimeout(this.importTimeout),this.importTimeout=setTimeout(function(){SL.notify("Timed out while trying to import. Please try again.","negative"),this.hideOverlay()}.bind(this),SL.config.IMPORT_SOCKET_TIMEOUT)},stopTimeout:function(){clearTimeout(this.importTimeout)},isAppending:function(){return this.overlayBody.find("#import-append-checkbox").is(":checked")},onSocketMessage:function(t){if(t){var e=t.type.split(":")[0],i=t.type.split(":")[1];"import"===e&&("complete"===i?this.enterMeasuringState(t):"error"===i?this.enterErrorState(t):(this.startTimeout(),this.overlayBody.find(".progress-text").text(t.message),this.setProgress(25+75*t.progress)))}}}),SL("editor.components.sidebar").ImportReveal=Class.extend({init:function(t){this.panel=t,this.domElement=$(".sidebar-panel .import .import-from-reveal"),this.importInput=this.domElement.find(".import-input"),this.importStatus=this.domElement.find(".import-status"),this.importStatusText=this.domElement.find(".import-status .text"),this.importStatusIcon=this.domElement.find(".import-status .icon"),this.importStatusProceed=this.domElement.find(".import-status .proceed"),this.importCompleted=new signals.Signal,this.bind()},bind:function(){this.importInput.on("input",this.onInputChange.bind(this)),this.importStatusProceed.on("click",this.onImportConfirmed.bind(this))},reset:function(){this.importInput.val(""),this.importStatus.removeClass("visible")},validate:function(){var t,e,i=$.trim(this.importInput.val());if(i.length>2){try{t=$(i)}catch(o){e="Failed to read HTML, make sure it's valid"}if(t&&((t=t.not("meta, script, link, style")).find("meta, script, link, style").remove(),t.is(".slides")&&(t=$("<div>").append(t)),0===t.find(".slides>section").length&&(e="Couldn't find any sections inside of .slides"),0===t.find(".slides").length&&(e="Couldn't find a .slides container")),this.importStatus.addClass("visible"),!e){var n=t.find(".slides section").length;return this.importStatus.attr("data-state","success"),this.importStatusText.html("Ready to import <strong>"+n+"</strong> slides."),this.importStatusIcon.removeClass("i-bolt").addClass("i-checkmark"),t.find(".slides>section")}this.importStatus.attr("data-state","error"),this.importStatusText.html(e),this.importStatusIcon.removeClass("i-checkmark").addClass("i-bolt")}else this.importStatus.removeClass("visible");return null},onInputChange:function(){this.validate()},onImportConfirmed:function(t){var e=this.validate();e&&e.length&&SL.prompt({anchor:$(t.currentTarget),title:SL.locale.get("DECK_IMPORT_HTML_CONFIRM"),type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Import</h3>",selected:!0,className:"positive",callback:function(){SL.editor.controllers.Markup.importSlides(e,!0),this.reset(),this.importCompleted.dispatch()}.bind(this)}]})}}),SL("editor.components.sidebar").ImportZIP=SL.editor.components.sidebar.ImportFile.extend({init:function(t){this._super(t,{importType:"zip",browseButtonLabel:"Select ZIP file",analyticsEventPrefix:"import_zip"})},render:function(){this.domElement=$(".sidebar-panel .import .import-from-zip"),this.browseButton=this.domElement.find(".import-from-file-button")},validateFileType:function(t){return t&&(""===t.type||t.type.match(/zip/))},enterMeasuringState:function(t){this.enterFinishedState(t)},enterFinishedState:function(){SL.analytics.trackEditor(this.options.analyticsEventPrefix+"_import_complete"),this.stopTimeout(),SL.helpers.PageLoader.show({message:"Import complete. Refreshing editor..."}),SL.editor.controllers.Revisions.getLatestVersionID(function(t){var e="?importSource=zip";void 0!==t&&(e+="&importRollbackID="+t),window.location=SL.routes.DECK_EDIT(SL.current_deck.get("user").username,SL.current_deck.get("slug"))+e},1)}}),SL("editor.components.sidebar").Import=SL.editor.components.sidebar.Base.extend({init:function(){this.domElement=$(".sidebar-panel .import"),this._super()},setupFileImport:function(){this.importFile?this.importFile.reset():(this.importFile=new SL.editor.components.sidebar.ImportFile(this),this.importFile.importCompleted.add(this.onImportCompleted.bind(this)),SL.helpers.StreamEditor.singleton().connect())},setupZIPImport:function(){this.importZIP?this.importZIP.reset():(this.importZIP=new SL.editor.components.sidebar.ImportZIP(this),this.importZIP.importCompleted.add(this.onImportCompleted.bind(this)))},setupRevealImport:function(){this.importReveal?this.importReveal.reset():(this.importReveal=new SL.editor.components.sidebar.ImportReveal(this),this.importReveal.importCompleted.add(this.onImportCompleted.bind(this)))},open:function(){SL.view.isNewDeck()?SL.view.save(function(){this.setupFileImport(),this.setupZIPImport()}.bind(this)):(this.setupFileImport(),this.setupZIPImport()),this.setupRevealImport(),this._super()},close:function(){this._super()},onImportCompleted:function(){this.close(),this.onclose.dispatch()}}),SL("editor.components.sidebar").Revisions=SL.editor.components.sidebar.Base.extend({init:function(){this.domElement=$(".sidebar-panel .revisions"),this.listElement=this.domElement.find(".version-list"),this.panelBody=this.domElement.find(".panel-body"),this._super()},bind:function(){this._super(),this.onPanelScroll=this.onPanelScroll.bind(this),this.onPanelScroll=$.debounce(this.onPanelScroll,200)},reset:function(){this.loadedAllPages=!1,this.loading=!1,this.page=1,this.listElement.empty(),this.domElement.attr("data-state","loading")},open:function(){this.reset(),clearTimeout(this.loadTimeout),this.panelBody.on("scroll",this.onPanelScroll),this.load(),this._super()},close:function(){this._super(),clearTimeout(this.loadTimeout),this.panelBody.off("scroll",this.onPanelScroll)},load:function(){this.loading||this.loadedAllPages||(this.loading=!0,$.ajax({url:SL.endpoints.GET_DECK_VERSIONS(SLConfig.deck.id),data:{page:this.page},context:this}).done(function(t){this.addVersions(t.results),this.layout(),0===t.results.length&&(this.loadedAllPages=!0)}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR")),this.domElement.attr("data-state","error"),this.layout()}).always(function(){this.loading=!1,this.page+=1}))},addVersions:function(t){t.forEach(this.addVersion.bind(this)),SL.view.parseTimes(),this.listElement.find("li").length>0?this.domElement.attr("data-state","populated"):this.domElement.attr("data-state","empty")},addVersion:function(t){var e=$("<li>").appendTo(this.listElement),i=$('<span class="text">').appendTo(e);i.append(moment(t.created_at).format("MMM DD, hh:mm a")),i.append(' <time class="ago de-em" datetime="'+t.created_at+'"></time>');var n=$('<div class="actions">').appendTo(e);$('<button class="button light-grey restore" data-tooltip="Restore" data-tooltip-delay="500"><span class="icon i-undo"></button>').appendTo(n).on("click",this.onRestoreClicked.bind(this,t));var o=$('<a class="button light-grey preview" data-tooltip="Preview" data-tooltip-delay="500"><span class="icon i-eye"></span></a>').appendTo(n);o.attr({href:SL.endpoints.PREVIEW_DECK_VERSION(SLConfig.deck.user.username,SLConfig.deck.slug||SLConfig.deck.id,t.content_uuid),target:"_blank"}),o.on("click",this.onPreviewClicked.bind(this,t,o))},onPreviewClicked:function(t,e,i){var n=e.attr("href"),o=SL.popup.open(SL.components.popup.Revision,{revisionURL:n,revisionTimeAgo:moment(t.created_at).fromNow()});o.restoreRequested.add(this.onRestoreClicked.bind(this,t)),o.externalRequested.add(this.onExternalClicked.bind(this,n)),SL.analytics.trackEditor("revision_preview"),i.preventDefault()},onRestoreClicked:function(t,e){SL.prompt({anchor:$(e.currentTarget),title:SL.locale.get("DECK_RESTORE_CONFIRM",{time:moment(t.created_at).fromNow()}),type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Restore</h3>",selected:!0,className:"negative",callback:this.onRestoreConfirmed.bind(this,t)}]}),e.preventDefault()},onRestoreConfirmed:function(t){SL.editor.controllers.Revisions.restore(t.id).fail(this.layout.bind(this))},onExternalClicked:function(t,e){window.open(t),e.preventDefault()},onPanelScroll:function(){this.panelBody.scrollTop()/(this.panelBody.prop("scrollHeight")-this.panelBody.outerHeight())>.8&&this.load()}}),SL("editor.components.sidebar").Settings=SL.editor.components.sidebar.Base.extend({init:function(){this.domElement=$(".sl-deck-settings"),this.rtlToggle=this.domElement.find('.sl-checkbox input[value="rtl"]'),this.loopToggle=this.domElement.find('.sl-checkbox input[value="should_loop"]'),this.shuffleToggle=this.domElement.find('.sl-checkbox input[value="shuffle"]'),this.upsizingEnabledToggle=this.domElement.find('.sl-checkbox input[value="upsizing_enabled"]'),this.commentsEnabledToggle=this.domElement.find('.sl-checkbox input[value="comments_enabled"]'),this.forkingEnabledToggle=this.domElement.find('.sl-checkbox input[value="forking_enabled"]'),this.shareNotesToggle=this.domElement.find('.sl-checkbox input[value="share_notes"]'),this.slideNumberToggle=this.domElement.find('.sl-checkbox input[value="slide_number"]'),this.titleInput=this.domElement.find("#deck-input-title"),this.descriptionInput=this.domElement.find("#deck-input-description"),this.slug=this.domElement.find(".slug"),this.slugInput=this.domElement.find("#deck-input-slug"),this.slugPrefix=this.domElement.find(".slug .text-prefix"),this.autoSlideInput=this.domElement.find("#deck-input-autoslide"),this.navigationModeInput=this.domElement.find("#deck-input-navigation_mode"),this.renderResolutonOption(),this.renderMarginOption(),this.renderAutoSlideOption(),this.sizePreview=new SL.components.DeckSizePreview,this.sizePreview.domElement.insertBefore(this.domElement.find(".unit.autoslide")),this._super(),this.strings.unsavedChangesWarning="You have unsaved settings."},renderResolutonOption:function(){this.resolutionInput=new SL.components.Resolution({title:"Presentation size",values:SL.config.SLIDE_SIZES}),this.resolutionInput.domElement.insertBefore(this.domElement.find(".unit.autoslide")),this.resolutionInput.changed.add(this.onResolutionChanged.bind(this));var t="http://help.slides.com/knowledgebase/articles/774057-presentation-size",e="This is the size that your deck is edited at. When viewed, it will automatically scale to fit any display size while maintaing the original aspect ratio.<br><br>Click for more info.";this.resolutionInput.getSizeUnit().prepend('<a href="'+t+'" target="_blank" class="icon i-info info-icon" data-tooltip="'+e+'" data-tooltip-maxwidth="275"></a>')},renderMarginOption:function(){this.marginUnit=$(['<div class="unit">',"<label>Margin</label>","</div>"].join("")),this.resolutionInput.appendUnit(this.marginUnit),this.marginInput=new SL.components.Range({minValue:0,maxValue:30,unit:"%",width:"100%"}),this.marginInput.appendTo(this.marginUnit),this.marginInput.changed.add(this.onMarginChanged.bind(this));var t="The amount of spacing between your slide content and the viewport edge. Note that you need to <strong>preview</strong> to see the effect of this setting.";this.marginUnit.prepend('<span class="icon i-info info-icon" data-tooltip="'+t+'" data-tooltip-maxwidth="275"></span>')},renderAutoSlideOption:function(){var t="Turns on automatic progression through all slides in the deck. Auto-slide can also be configured per-slide in the slide settings.";this.domElement.find(".unit.autoslide").prepend('<span class="icon i-info info-icon" data-tooltip="'+t+'" data-tooltip-maxwidth="275"></span>');var e='<option value="0">Off</option>';SL.config.AUTO_SLIDE_OPTIONS.forEach(function(t){e+='<option value="'+1e3*t+'">'+t+" seconds</option>"}),this.autoSlideInput.html(e)},bind:function(){this._super(),this.domElement.find(".sl-checkbox input").on("change",this.onToggleChange.bind(this)),this.navigationModeInput.on("change",this.onNavigationModeChange.bind(this)),this.titleInput.on("input",this.onTitleInput.bind(this)),this.slugInput.on("input",this.onSlugInput.bind(this)),this.slugInput.on("focus",this.onSlugFocus.bind(this)),this.slugInput.on("blur",this.onSlugBlur.bind(this)),this.descriptionInput.on("keypress",this.onDescriptionKeyPress.bind(this))},open:function(){this._super(),this.deckData=JSON.parse(JSON.stringify(SLConfig.deck)),this.updateSelection(),this.titleInput.val(SL.util.unescapeHTMLEntities(this.deckData.title||"")),this.slugInput.val(this.deckData.slug),this.descriptionInput.val(SL.util.unescapeHTMLEntities(this.deckData.description||"")),this.autoSlideInput.val(this.deckData.auto_slide_interval||0),this.navigationModeInput.val(this.deckData.navigation_mode||"default"),this.slugPrefix.text(window.location.host+"/"+SLConfig.current_user.username+"/"),this.deckData=this.getSaveData(),this.scrollShadow.sync()},close:function(){this._super(),this.hasUnsavedChanges()&&(this.deckData=JSON.parse(JSON.stringify(SLConfig.deck)),this.updateSelection(),this.applySelection())},save:function(){var t=this.getSaveData();return t.title||delete t.title,t.slug||delete t.slug,
SL.current_deck.setAll(t),SLConfig.deck.dirty=!0,SL.analytics.trackEditor("setting_saved"),$("html").toggleClass("rtl",SLConfig.deck.rtl),this.checkIfSizeChanged(this.deckData.width,this.deckData.height,t.width,t.height),this._super()},checkIfSizeChanged:function(t,e,i,n){"number"==typeof t&&"number"==typeof e&&(i===t&&n===e||(1===Reveal.getTotalSlides()&&SL.editor.controllers.Blocks.getCurrentBlocks().length<3?this.centerContent(t,e,i,n):SL.prompt({title:"The presentation size changed. Would you like to center all slide content within the available space?",subtitle:"From "+t+"x"+e+" to "+i+"x"+n,type:"select",maxWidth:450,data:[{html:"<h3>Dismiss</h3>"},{html:"<h3>Center content</h3>",selected:!0,className:"positive",callback:function(){this.centerContent(t,e,i,n),this.undoNotification=new SL.components.UndoNotification("Content was centered")}.bind(this)}]})))},centerContent:function(t,e,i,n){var o=t-i,r=e-n;SL.util.toArray(document.querySelectorAll(".reveal section .sl-block")).forEach(function(t){var e=parseFloat(t.style.left),i=parseFloat(t.style.top);isNaN(e)||isNaN(i)||(t.style.left=e-o/2+"px",t.style.top=i-r/2+"px")}),SL.editor.controllers.Blocks.invalidateBlockMeasurements(),SL.editor.controllers.History.pushLatest()},getSaveData:function(){var t=this.titleInput.val(),e=this.slugInput.val(),i=this.descriptionInput.val(),n=this.resolutionInput.getValue();return{title:t,slug:e,description:i?i.replace(/\n/g," "):"",rtl:this.rtlToggle.is(":checked"),shuffle:this.shuffleToggle.is(":checked"),should_loop:this.loopToggle.is(":checked"),comments_enabled:this.commentsEnabledToggle.is(":checked"),forking_enabled:this.forkingEnabledToggle.is(":checked"),share_notes:this.shareNotesToggle.is(":checked"),slide_number:this.slideNumberToggle.is(":checked"),upsizing_enabled:this.upsizingEnabledToggle.is(":checked"),auto_slide_interval:parseInt(this.autoSlideInput.val(),10)||0,navigation_mode:this.navigationModeInput.val()||"default",width:n.width,height:n.height,margin:this.marginInput.getValue()/100}},hasUnsavedChanges:function(){var t=this.getSaveData();for(var e in t)if(t[e]!==this.deckData[e])return!0;return!1},updateSelection:function(){this.rtlToggle.prop("checked",this.deckData.rtl),this.loopToggle.prop("checked",this.deckData.should_loop),this.shuffleToggle.prop("checked",this.deckData.shuffle),this.commentsEnabledToggle.prop("checked",this.deckData.comments_enabled),this.forkingEnabledToggle.prop("checked",this.deckData.forking_enabled),this.shareNotesToggle.prop("checked",this.deckData.share_notes),this.slideNumberToggle.prop("checked",this.deckData.slide_number),this.resolutionInput.setValue(this.deckData.width,this.deckData.height),this.marginInput.setValue(100*this.deckData.margin),this.upsizingEnabledToggle.prop("checked","boolean"!=typeof this.deckData.upsizing_enabled||this.deckData.upsizing_enabled),this.navigationModeInput.val(this.deckData.navigation_mode),this.sizePreview.setValue(this.deckData.width,this.deckData.height,this.deckData.margin)},applySelection:function(){var t=this.resolutionInput.getValue(),e=this.marginInput.getValue()/100;Reveal.configure({width:t.width,height:t.height,margin:e,rtl:this.rtlToggle.is(":checked"),loop:this.loopToggle.is(":checked"),slideNumber:this.slideNumberToggle.is(":checked"),navigationMode:this.navigationModeInput.val()}),this.sizePreview.setValue(t.width,t.height,e),SL.view.layout()},generateSlug:function(){if(this.deckIsPrivate()&&this.slugIsUnchanged()||this.slugWasManuallyCleared){var t=this.titleInput.val(),e=SL.util.string.slug(t);this.slugInput.val(e)}},deckIsPrivate:function(){return SLConfig.deck.visibility===SL.models.Deck.VISIBILITY_SELF},slugIsUnchanged:function(){return(SLConfig.deck.slug||"")===(SL.util.string.slug(SLConfig.deck.title)||"")},onToggleChange:function(){this.applySelection()},onNavigationModeChange:function(){this.applySelection()},onTitleInput:function(){this.generateSlug()},onDescriptionKeyPress:function(t){if(13==t.keyCode)return!1},onSlugInput:function(){this.slugWasManuallyCleared=""===this.slugInput.val()},onSlugFocus:function(){SL.tooltip.show("Changing the URL of your deck will break existing links to it.",{anchor:this.slugInput,alignment:"r",maxwidth:220})},onSlugBlur:function(){SL.tooltip.hide(),this.slugInput.val(SL.util.string.slug(this.slugInput.val()))},onResolutionChanged:function(){this.sizePreview.expandUnlessManuallyClosed(),this.applySelection()},onMarginChanged:function(){this.sizePreview.expandUnlessManuallyClosed(),this.applySelection()}}),SL("editor.components.sidebar").Style=SL.editor.components.sidebar.Base.extend({init:function(){this.domElement=$(".sidebar-panel .style"),this._super(),this.strings.unsavedChangesWarning="You have unsaved style changes"},bind:function(){this._super(),this.domElement.find(".edit-style").on("click",this.onAdvancedStylesCLicked.bind(this))},scroll:function(){this.domElement.find(".panel-body").scrollTop(0),$(".page-wrapper").scrollTop(0)},open:function(){this._super(),this.themeoptions?this.themeoptions.populate(SL.models.Theme.fromDeck(SLConfig.deck)):(this.themeoptions=new SL.components.ThemeOptions({center:!1,rollingLinks:!1,supportsCustomFonts:!0,fonts:SL.config.THEME_FONTS,colors:SL.config.THEME_COLORS,themes:SL.current_user.getThemes(),model:SL.models.Theme.fromDeck(SLConfig.deck),container:this.domElement.find(".panel-body")}),this.themeoptions.changed.add(this.onThemeOptionsChanged.bind(this))),this.scroll(),this.layout()},close:function(){this._super(),this.hasUnsavedChanges()&&SL.helpers.ThemeController.paint(SL.view.getCurrentTheme(),{center:!1,js:!1,width:SLConfig.deck.width,height:SLConfig.deck.height}),SL.view.layout()},save:function(){var t=SL.view.getCurrentTheme(),e=this.themeoptions.getTheme(),i=t.get("id")==e.get("id"),n=(t.get("js")||"")==(e.get("js")||"");return new Promise(function(t){i||n?(this.saveData(),t()):this.promptReload()}.bind(this))},saveData:function(){$.extend(SLConfig.deck,this.getSaveData()),SLConfig.deck.dirty=!0,Reveal.configure({center:!1,rolling_links:SLConfig.deck.rolling_links,transition:SLConfig.deck.transition,backgroundTransition:SLConfig.deck.background_transition}),SL.editor.controllers.Thumbnail.invalidate(),SL.editor.controllers.Contrast.sync(),SL.view.onThemeChanged()},getSaveData:function(){var t=this.themeoptions.getTheme();return{theme_id:t.get("id"),width:t.get("width"),height:t.get("height"),theme_font:t.get("font"),theme_color:t.get("color"),center:t.get("center"),rolling_links:t.get("rolling_links"),transition:t.get("transition"),background_transition:t.get("background_transition")}},hasUnsavedChanges:function(){var t=this.getSaveData();for(var e in t)if(t[e]!==SLConfig.deck[e])return!0;return!1},promptReload:function(){SL.prompt({title:"The editor needs to reload to apply your changes.",alignment:"t",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Continue</h3>",className:"positive",callback:this.saveAndReload.bind(this)}]})},saveAndReload:function(){this.saveData(),SL.view.save(function(){window.location.reload()}),SL.prompt({title:'Saving and reloading...<div class="spinner centered-horizontally" data-spinner-color="#777"></div>',alignment:"t",optional:!1,options:[]}),SL.util.html.generateSpinners()},onAdvancedStylesCLicked:function(){SL.analytics.trackEditor("open_css_editor"),SL.editor.controllers.Mode.change("css")},onThemeOptionsChanged:function(){this.layout(),SL.view.layout()}}),SL("editor.components").SlideMenu=Class.extend({init:function(t,e){this.editor=t,this.options=$.extend({background:!0,removeSlide:!0,customClasses:!0,fragment:!0,notes:!0,html:!0,settings:!0},e),this.render(),this.bind(),this.syncRemoveSlide(),this.syncNotesButton()},render:function(){this.domElement=$('<div class="sl-slide-menu"></div>').appendTo($(".projector")),this.listElement=$("<ul></ul>").appendTo(this.domElement),this.renderOptions()},configure:function(t){this.options=$.extend(this.options,t),this.renderOptions()},renderOptions:function(){this.settingsElement&&this.settingsElement.remove(),this.autoAnimateElement&&this.autoAnimateElement.remove(),this.backgroundElement&&this.backgroundElement.remove(),this.fragmentElement&&this.fragmentElement.remove(),this.notesElement&&this.notesElement.remove(),this.htmlElement&&this.htmlElement.remove(),this.customClassesElement&&this.customClassesElement.remove(),this.removeSlideElement&&this.removeSlideElement.remove(),this.options.settings&&(this.settingsElement=this.renderOption("settings",'<span class="icon i-cog"></span>',SL.keyboard.getEditorShortcut("SLIDE_SETTINGS").tooltip),this.settingsElement.on("vclick",this.onSettingsClicked.bind(this)));var t='\t\t\t<svg width="50px" height="50px" viewBox="0 0 50 50" version="1.1" xmlns="http://www.w3.org/2000/svg">\t\t\t\t<circle cx="17" cy="25" r="10" fill="rgba(120,120,120,1)"></circle>\t\t\t\t<circle cx="25" cy="25" r="10" fill="rgba(200,200,200,1)"></circle>\t\t\t\t<circle cx="33" cy="25" r="10" fill="rgba(255,255,255,1)"></circle>\t\t\t</svg>\t\t';if(this.autoAnimateElement=this.renderOption("auto-animate",t,SL.keyboard.getEditorShortcut("AUTO_ANIMATE").tooltip),this.autoAnimateElement.on("vclick",this.onAutoAnimateClicked.bind(this)),this.options.background){var e=['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36">','<rect stroke="#fff" stroke-width="2" x="9" y="11" width="18" height="14" fill="transparent"></rect>','<rect x="12" y="14" width="12" height="8" fill="rgba(255,255,255,0.5)"></rect>',"</svg>"].join("");this.backgroundElement=this.renderOption("background",e,"Slide background"),this.backgroundElement.on("vclick",this.onBackgroundClicked.bind(this))}this.options.notes&&(this.notesElement=this.renderOption("notes",'<span class="icon i-book-alt2"></span>',SL.keyboard.getEditorShortcut("SPEAKER_NOTES").tooltip),this.notesElement.on("vclick",this.onNotesClicked.bind(this))),this.options.fragment&&(this.fragmentElement=this.renderOption("fragment",'<span class="icon i-bolt"></span>',SL.keyboard.getEditorShortcut("FRAGMENT_MODE").tooltip),this.fragmentElement.on("vclick",this.onFragmentClicked.bind(this))),this.options.html&&(this.htmlElement=this.renderOption("html",'<span class="icon i-file-xml"></span>',SL.keyboard.getEditorShortcut("SLIDE_EDIT_HTML").tooltip),this.htmlElement.on("vclick",this.onHTMLClicked.bind(this))),this.options.customClasses&&(this.customClassesElement=this.renderOption("custom-classes",'<span class="icon i-star"></span>',"Slide classes"),this.customClassesElement.on("vclick",this.onCustomClassesClicked.bind(this)),this.syncCustomClasses()),this.options.removeSlide&&(this.removeSlideElement=this.renderOption("remove-slide",'<span class="icon i-trash"></span>',SL.keyboard.getEditorShortcut("REMOVE_SLIDE").tooltip),this.removeSlideElement.on("vclick",this.onRemoveSlideClicked.bind(this)))},renderOption:function(t,e,i){var n=$("<li></li>");return e&&n.append(e),n.attr({"class":"slide-option "+t,"data-tooltip":i,"data-tooltip-alignment":"rl"}),n.appendTo(this.listElement),n},bind:function(){SL.editor.controllers.Markup.slidesChanged.add(this.syncRemoveSlide.bind(this)),SL.current_user.settings.watch("editor_fixed_notes",this.onFixedNotesSettingChanged.bind(this)),this.syncWithSlide=this.syncWithSlide.bind(this),SL.editor.controllers.Markup.slidesChanged.add(this.syncWithSlide),SL.editor.controllers.Mode.get("fragment").deactivated.add(this.syncWithSlide),SL.editor.controllers.Mode.get("arrange").deactivated.add(this.syncWithSlide),Reveal.addEventListener("ready",this.syncWithSlide),Reveal.addEventListener("slidechanged",$.debounce(this.syncWithSlide,200))},collapse:function(){this.backgroundPrompt&&this.backgroundPrompt.destroy()},hasOpenPanel:function(){return!1},showOverflowWarning:function(){this.overflowWarning||SL.editor.controllers.Capabilities.isTouchEditor()||(this.overflowWarning=$('<div class="overflow-warning"><span class="icon i-info"></span></div>'),this.overflowWarning.attr({"class":"overflow-warning","data-tooltip":"Some of your content is placed outside the safe area (dashed line) and may not be visible on all display sizes.","data-tooltip-maxwidth":300,"data-tooltip-alignment":"l"})),this.overflowWarning&&0===this.overflowWarning.parent().length&&this.overflowWarning.appendTo(this.domElement)},hideOverflowWarning:function(){this.overflowWarning&&this.overflowWarning.remove()},syncWithSlide:function(){var t=Reveal.getCurrentSlide();if(t){if(this.notesElement&&this.notesElement.toggleClass("is-set",!!SLConfig.deck.notes[t.getAttribute("data-id")]),this.backgroundElement&&this.backgroundElement.toggleClass("is-set",t.hasAttribute("data-background")||t.hasAttribute("data-background-color")||t.hasAttribute("data-background-image")||t.hasAttribute("data-background-video")||t.hasAttribute("data-background-iframe")),this.settingsElement){var e=SL.editor.controllers.Markup.isSlideHidden(t);this.settingsElement.toggleClass("is-set",t.hasAttribute("id")||t.hasAttribute("data-autoslide")||t.hasAttribute("data-transition")||t.hasAttribute("data-background-transition")||e),e?(this.settingsElement.attr("data-tooltip",SL.keyboard.getEditorShortcut("SLIDE_SETTINGS").tooltip+'<br><span class="dimmed">This slide is only visible<br> inside the editor.</span>'),this.settingsElement.find(".icon").removeClass("i-cog").addClass("i-visibility_off")):(this.settingsElement.attr("data-tooltip",SL.keyboard.getEditorShortcut("SLIDE_SETTINGS").tooltip),this.settingsElement.find(".icon").removeClass("i-visibility_off").addClass("i-cog"))}this.autoAnimateElement&&this.autoAnimateElement.toggleClass("is-set",SL.editor.controllers.AutoAnimate.isEnabled(t)),this.fragmentElement&&this.fragmentElement.toggleClass("is-set",t.querySelectorAll(".fragment").length>0)}},syncRemoveSlide:function(){this.removeSlideElement&&this.removeSlideElement.toggleClass("disabled",document.querySelectorAll(".reveal .slides section").length<2)},syncNotesButton:function(){this.notesElement&&(this.notesElement.toggle(!SL.current_user.settings.get("editor_fixed_notes")||!SL.editor.controllers.Capabilities.canDockNotes()),this.notesPrompt&&this.notesPrompt.destroy())},syncCustomClasses:function(){this.customClassesElement.toggleClass("disabled",0===this.getCustomClasses().length)},getCustomClasses:function(){var t=SL.util.string.getCustomClassesFromLESS(SL.current_deck.get("css_input")),e=this.editor.getCurrentTheme();return e&&(t=t.concat(SL.util.string.getCustomClassesFromLESS(e.get("less")))),t},triggerNotes:function(){if(!this.notesPrompt){SL.util.deck.afterSlidesChanged();var t=$(Reveal.getCurrentSlide()).attr("data-id");this.notesPrompt=new SL.components.prompts.Notes({anchor:this.notesElement,alignment:"lr",data:{value:SLConfig.deck.notes[t]}}),this.notesPrompt.show(),this.notesPrompt.confirmed.add(function(e){SLConfig.deck.notes[t]=e,SLConfig.deck.dirty=!0,SL.analytics.trackEditor("saved_notes")}),this.notesPrompt.destroyed.add(function(){this.notesPrompt=null,this.syncWithSlide()}.bind(this))}},triggerHTML:function(){SL.popup.open(SL.components.popup.EditSlideHTML,{title:"Edit Slide HTML",mode:"text/html",slide:Reveal.getCurrentSlide()}).saved.add(function(t){SL.editor.controllers.Markup.writeHTMLToCurrentSlide(t),$(Reveal.getCurrentSlide()).find("style").each(function(){SL.util.prefixSelectorsInStyle(this,".reveal ")}),Reveal.syncSlide(Reveal.getCurrentSlide())}.bind(this)),SL.analytics.trackEditor("edit_slide_html")},triggerCustomClasses:function(){if(!this.customClassesPrompt){var t=this.getCustomClasses();if(t.length){var e=$(Reveal.getCurrentSlide()),i=t.map(function(t){return{value:t,selected:e.hasClass(t),callback:function(t){e.toggleClass(t),Reveal.sync()}}});this.customClassesPrompt=SL.prompt({anchor:this.customClassesElement,alignment:"lr",title:"Slide classes",type:"list",data:i,listType:"multiselect",optional:!0}),this.customClassesPrompt.destroyed.add(function(){this.customClassesPrompt=null}.bind(this))}}},triggerBackgrounds:function(){this.backgroundPrompt||(this.backgroundPrompt=new SL.components.prompts.SlideBackground({anchor:this.backgroundElement,slide:Reveal.getCurrentSlide(),alignment:"lr"}),this.backgroundPrompt.show(),this.backgroundPrompt.destroyed.add(function(){this.backgroundPrompt=null,this.syncWithSlide()}.bind(this)))},triggerSettings:function(){this.settingsPrompt||(this.settingsPrompt=new SL.components.prompts.SlideSettings({anchor:this.settingsElement,slide:Reveal.getCurrentSlide(),alignment:"lr"}),this.settingsPrompt.show(),this.settingsPrompt.destroyed.add(function(){this.settingsPrompt=null,this.syncWithSlide()}.bind(this))),SL.analytics.trackEditor("show_slide_settings")},triggerRemoveSlide:function(){this.removeSlideElement.hasClass("disabled")||(SL.editor.controllers.Blocks.blur(),SL.prompt({anchor:this.removeSlideElement,title:SL.locale.get("DECK_DELETE_SLIDE_CONFIRM"),alignment:"lr",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Remove</h3>",selected:!0,className:"negative",callback:function(){SL.editor.controllers.Markup.removeCurrentSlide()}.bind(this)}]}))},triggerAutoAnimate:function(){var t=Reveal.getCurrentSlide();SL.editor.controllers.AutoAnimate.enable(t,{warnBeforeRemovingAnimations:!0,popoutAnchor:this.autoAnimateElement,popoutAlignment:"lr"}).then(function(){this.syncWithSlide(),this.autoAnimatePrompt=new SL.components.prompts.AutoAnimate({slide:t,anchor:this.autoAnimateElement,alignment:"lr"}),this.autoAnimatePrompt.show(),this.autoAnimatePrompt.destroyed.add(function(){this.autoAnimatePrompt=null,this.syncWithSlide(),this.showAutoAnimateTutorial(t)}.bind(this))}.bind(this))},showAutoAnimateTutorial:function(t){SL.util.getQuery().tutorial&&SL.current_user.settings.set("auto_animate_tutorial_completed",!1),SL.editor.controllers.AutoAnimate.isEnabled(t)&&!SL.current_user.settings.get("auto_animate_tutorial_completed")&&(SL.current_user.settings.set("auto_animate_tutorial_completed",!0),SL.current_user.settings.save(["auto_animate_tutorial_completed"]),1===SL.editor.controllers.AutoAnimate.getAllAutoAnimatedSlides().length&&new SL.components.prompts.PreviewMedia(SL.editor.controllers.AutoAnimate.getAutoAnimateHelpPromptOptions({anchor:$(".duplicate-horizontal-slide"),alignment:"l",title:"Adding your first Auto-Animation",mediaTiming:"#t=5"})).show())},setAlignment:function(t){this.alignment!==t&&(this.alignment=t,this.domElement.attr("data-alignment",t))},getWidth:function(){return this.width||(this.width=this.domElement.width()),this.width},getHeight:function(){return this.height||(this.height=this.domElement.height()),this.height},onRemoveSlideClicked:function(t){this.triggerRemoveSlide(),t.preventDefault()},onSettingsClicked:function(t){t.preventDefault(),this.triggerSettings()},onAutoAnimateClicked:function(t){t.preventDefault(),this.triggerAutoAnimate()},onFragmentClicked:function(t){t.preventDefault(),SL.editor.controllers.Mode.change("fragment")},onBackgroundClicked:function(t){t.preventDefault(),this.triggerBackgrounds()},onHTMLClicked:function(t){t.preventDefault(),SL.editor.controllers.Blocks.blur(),this.triggerHTML()},onNotesClicked:function(t){t.preventDefault(),this.triggerNotes()},onCustomClassesClicked:function(t){t.preventDefault(),this.triggerCustomClasses()},onFixedNotesSettingChanged:function(){this.syncNotesButton(),SL.current_user.settings.get("editor_fixed_notes")||this.triggerNotes()}}),SL("editor.components").Toolbars=Class.extend({init:function(t){this.editor=t,this.stack=[],this.render(),this.show(),this.push(new SL.editor.components.toolbars.Add)},render:function(){this.domElement=$('<div class="toolbars">').appendTo(document.body),this.innerElement=$('<div class="toolbars-inner">').appendTo(this.domElement),this.footerElement=$('<div class="toolbars-footer"></div>').appendTo(this.domElement),SL.current_user.isPaid()?SL.current_user.isLite()&&!SL.current_user.isEnterprise()?this.footerElement.append('<a class="pricing-link upgrade-button" data-tooltip="You\'re using Slides Lite.<br>Click to learn more about our plans." href="/pricing">Lite</a>'):SL.current_user.isPro()&&!SL.current_user.isEnterprise()&&this.footerElement.append('<a class="pricing-link upgrade-button" data-tooltip="You\'re using Slides Pro.<br>Click to learn more about our plans." href="/pricing">Pro</a>'):this.footerElement.append('<a class="pricing-link upgrade-button emphasize" data-tooltip="Gain access to offline presenting, private sharing, PDF exports and more.<br>Click to learn all about our plans." data-tooltip-maxwidth="270" href="/pricing">Upgrade</a>'),this.footerElement.find(".upgrade-button").on("click",function(){SL.analytics.trackEditor("click_upgrade_link",{source:"footer"})}),this.footerElement.append('<div class="option editor-settings" data-tooltip="Editor settings"><span class="icon i-equalizer"></span></div>'),this.footerElement.find(".option.editor-settings").on("click",this.onSettingsClicked)},show:function(){this.domElement.addClass("visible")},hide:function(){this.domElement.removeClass("visible")},push:function(t){this.stack.push(t),t.appendTo(this.innerElement),this.layout(),SL.util.skipCSSTransitions(this.innerElement,1)},pop:function(){this.stack.length>1&&this.stack.pop().destroyAfter(1e3),this.layout()},replace:function(t){for(;this.stack.length>1;)this.stack.pop().destroyAfter(1e3);this.push(t)},get:function(t){return this.stack[this.stack.length-1+(t||0)]},clear:function(){if(this.stack.length>1){for(;this.stack.length>1;)this.stack.pop().destroyAfter(1e3);this.layout()}},sync:function(){this.stack.forEach(function(t){t.sync()})},layout:function(){for(var t=0,e=this.stack.length;t<e;t++)t<e-1&&this.stack[t].collapse();var i=this.get();this.domElement.find(".toolbar").removeClass("visible"),i.domElement.addClass("visible")},getToolbarMeasurements:function(){var t=this.innerElement.position(),e={x:t.left,y:t.top,width:this.innerElement.width(),height:this.innerElement.height()};return e.bottom=e.y+e.height,e.right=e.x+e.width,e},getMutualOptions:function(t){var e=t[0].getToolbarOptions().filter(function(e){return t.slice(1).every(function(t){return t.getToolbarOptions().some(function(t){return e instanceof Array&&t instanceof Array?e.every(function(e,i){return e===t[i]}):e===t})},this)},this);return[SL.editor.components.toolbars.options.Image,SL.editor.components.toolbars.options.ImageInlineSVG,SL.editor.components.toolbars.options.Video,SL.editor.components.toolbars.options.Code,SL.editor.components.toolbars.options.MathInput,SL.editor.components.toolbars.options.IframeSRC,SL.editor.components.toolbars.groups.TableSize,SL.editor.components.toolbars.options.TableHasHeader,SL.editor.components.toolbars.options.ImageActions,SL.editor.components.toolbars.options.GroupTitle,SL.editor.components.toolbars.options.BlockAlignHorizontal,SL.editor.components.toolbars.options.BlockAlignVertical].forEach(function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}),e[0]===SL.editor.components.toolbars.options.Divider&&e.shift(),e[e.length-1]===SL.editor.components.toolbars.options.Divider&&e.pop(),e},hasOpenPanel:function(){return this.stack.some(function(t){return t.hasOpenPanel()})},collapse:function(){this.stack.forEach(function(t){t.collapse()})},onSettingsClicked:function(t){this.settingsPrompt=SL.prompt({anchor:t.currentTarget,type:"custom",title:"Editor Settings",minWidth:210,className:"sl-editor-settings-prompt",html:['<div class="editor-option sl-checkbox flush-left">','<input id="editor-settings-grid" type="checkbox">','<label for="editor-settings-grid" data-tooltip="Display a grid behind the slide to help with alignment." data-tooltip-delay="0" data-tooltip-alignment="r" data-tooltip-maxwidth="220">Grid</label>',"</div>",'<div class="editor-option sl-checkbox flush-left">','<input id="editor-settings-grid-on-top" type="checkbox">','<label for="editor-settings-grid-on-top" data-tooltip="Place the grid on top of your content to make it easier to align overlapping content." data-tooltip-delay="0" data-tooltip-alignment="r" data-tooltip-maxwidth="220">Grid in foreground</label>',"</div>",'<div class="editor-option sl-checkbox flush-left">','<input id="editor-settings-snap" type="checkbox">','<label for="editor-settings-snap" data-tooltip="Snap dragged blocks to the grid, slide edges and other blocks." data-tooltip-delay="0" data-tooltip-alignment="r" data-tooltip-maxwidth="220">Snap</label>',"</div>",'<div class="editor-option sl-checkbox flush-left">','<input id="editor-settings-developer-mode" type="checkbox">','<label for="editor-settings-developer-mode" data-tooltip="Turn on developer-friendly features:<br>- Per slide HTML editor.<br>- Access to full deck HTML, for exporting to reveal.js.<br>- Add class names to any focused block. Makes it easy to target content with custom CSS." data-tooltip-delay="0" data-tooltip-alignment="r" data-tooltip-maxwidth="340">Developer mode</label>',"</div>"].join("")});var e=this.settingsPrompt.getDOMElement().find("#editor-settings-grid"),i=this.settingsPrompt.getDOMElement().find("#editor-settings-grid-on-top"),n=function(){!1===e.prop("checked")?i.attr("disabled",""):i.removeAttr("disabled")};e.prop("checked",SL.current_user.settings.get("editor_grid")),e.on("change",function(t){SL.current_user.settings.set("editor_grid",t.currentTarget.checked),SL.current_user.settings.save(["editor_grid"]),SL.editor.controllers.Grid.refresh(),SL.analytics.trackEditor("toggle_grid"),n()}),i.prop("checked",SL.current_user.settings.get("editor_grid_on_top")),i.on("change",function(t){SL.current_user.settings.set("editor_grid_on_top",t.currentTarget.checked),SL.current_user.settings.save(["editor_grid_on_top"]),SL.editor.controllers.Grid.refresh(),SL.analytics.trackEditor("toggle_grid_on_top")});var o=this.settingsPrompt.getDOMElement().find("#editor-settings-snap");o.prop("checked",SL.current_user.settings.get("editor_snap")),o.on("change",function(t){SL.current_user.settings.set("editor_snap",t.currentTarget.checked),SL.current_user.settings.save(["editor_snap"]),SL.analytics.trackEditor("toggle_snap")});var r=this.settingsPrompt.getDOMElement().find("#editor-settings-developer-mode");r.prop("checked",SL.current_user.settings.get("developer_mode")),r.on("change",function(t){SL.current_user.settings.set("developer_mode",t.currentTarget.checked),SL.current_user.settings.save(["developer_mode"]),SL.view.slideMenu.configure({html:t.currentTarget.checked}),SL.analytics.trackEditor("toggle_developer_mode")}),n()}}),SL("editor.components.toolbars").Base=Class.extend({init:function(){this.render()},render:function(){this.domElement=$('<div class="toolbar">'),this.listElement=$('<div class="toolbar-list">').appendTo(this.domElement),this.scrollShadow=new SL.components.ScrollShadow({parentElement:this.domElement,contentElement:this.listElement,style:"dark-background",shadowSize:25,resizeContent:!1})},appendTo:function(t){this.domElement.appendTo(t),this.scrollShadow.sync()},collapse:function(){this.getAllOptions().forEach(function(t){"object"==typeof t.panel&&t.panel.hide()})},sync:function(){this.getAllOptions().forEach(function(t){"function"==typeof t.sync&&t.sync()})},move:function(t,e){this.domElement.css({left:t,top:e}),this.scrollShadow.sync()},measure:function(){var t=this.domElement.position();return{x:t.left,y:t.top,width:this.domElement.outerWidth(),height:this.domElement.outerHeight()}},hasOpenPanel:function(){return this.getAllOptions().some(function(t){return!("object"!=typeof t.panel||!t.panel.isVisible())})},showEyeDropperForFirstColor:function(){var t=!1;return SL.util.device.supportsEyeDropperAPI()&&(t=this.options.some(function(t){if(t instanceof SL.editor.components.toolbars.options.Color&&!t.isHidden())return t.showEyeDropper(),!0})),t},getAllOptions:function(){var t=[];return"object"==typeof this.options&&this.options.length&&(t=t.concat(this.options),this.options.forEach(function(e){"object"==typeof e.options&&e.options.length&&(t=t.concat(e.options))})),t},destroyAfter:function(t){this.collapse(),clearTimeout(this.destroyTimeout),"number"==typeof t&&(this.destroyTimeout=setTimeout(this.destroy.bind(this),t))},destroy:function(){this.domElement.remove(),this.scrollShadow.destroy()}}),SL("editor.components.toolbars").AddSnippet=SL.editor.components.toolbars.Base.extend({init:function(){this._super()},render:function(){this._super(),this.domElement.attr("data-type","add"),this.sync()},sync:function(){this._super();var t=SL.view.getCurrentTheme();if(t){var e=t.get("snippets");e&&!e.isEmpty()&&e.forEach(function(t){var e=$('<div class="toolbar-add-snippet-option">');e.text(t.get("title")),e.appendTo(this.listElement),e.on("vclick",this.onSnippetClicked.bind(this,t))}.bind(this))}},insert:function(t,e){SL.editor.controllers.Blocks.add({type:"snippet",parent:t,afterInit:function(t){t.setCustomHTML(e),t.resizeToFitContent()}})},onSnippetClicked:function(t){var e=$(Reveal.getCurrentSlide());if(t.templateHasVariables()){SL.popup.open(SL.components.popup.InsertSnippet,{snippet:t}).snippetInserted.add(function(t){this.insert(e,t)}.bind(this))}else{var i=t.get("template").replace(SL.models.ThemeSnippet.TEMPLATE_SELECTION_TAG,"");this.insert(e,i)}}}),SL("editor.components.toolbars").Add=SL.editor.components.toolbars.Base.extend({init:function(){this._super()},render:function(){this._super(),this.domElement.attr("data-type","add");var t=SL.editor.controllers.Capabilities.canUploadVideo();SL.config.BLOCKS.forEach(function(e){if(!e.hidden){var i=$(['<div class="toolbar-add-block-option" data-block-type="'+e.type+'">','<span class="toolbar-add-block-option-icon toolbar-block-icon icon i-'+e.icon+'"></span>','<span class="toolbar-add-block-option-label">'+(e.toolbarLabel||e.label)+"</span>","</div>"].join(""));"video"===e.type&&!1===t?(i.addClass("not-available-on-plan"),i.attr("data-tooltip","<strong>Video uploads require a paid account.</strong><br>Click for upgrade options."),i.on("vclick",function(){window.open(SL.routes.PRICING)})):"drawing"===e.type?i.on("vclick",function(){SL.editor.controllers.Mode.toggle("draw")}):this.bindOption(i,e),i.appendTo(this.listElement)}}.bind(this)),this.renderSnippets()},renderSnippets:function(){this.snippetsOptions=$(['<div class="toolbar-add-block-option">','<span class="toolbar-add-block-option-icon toolbar-block-icon icon i-document-alt-stroke"></span>','<span class="toolbar-add-block-option-label">Snippet</span>',"</div>"].join("")),this.snippetsOptions.on("vclick",function(){SL.view.toolbars.push(new SL.editor.components.toolbars.AddSnippet)}.bind(this))},sync:function(){this._super();var t=SL.view.getCurrentTheme();t&&t.get("snippets")&&!t.get("snippets").isEmpty()?this.snippetsOptions.appendTo(this.listElement):this.snippetsOptions.detach()},bindOption:function(t,e){function i(){l||(SL.editor.controllers.Blocks.add({type:e.type,blockOptions:{insertedFromToolbar:!0}}),SL.editor.controllers.History.pushLatest(),SL.analytics.trackEditor("insert_block",{block_type:e.type}))}function n(t){a=!0,l=!1,s=t.clientX,$(document).on("mousemove",o),$(document).on("mouseup",r),t.preventDefault()}function o(t){if(a&&!l&&t.clientX-s>10){l=!0;var i=SL.editor.controllers.Blocks.add({type:e.type,silent:!0,center:!1}),n=$(".reveal .slides").offset(),o=i.measure().transformed;i.move({x:t.clientX-n.left-o.width/2,y:t.clientY-n.top-o.height/2}),i.onMouseDown(t),SL.analytics.trackEditor("insert_block_via_drag",{block_type:e.type})}t.preventDefault()}function r(){$(document).off("mousemove",o),$(document).off("mouseup",r),a=!1,l=!1}var s=0,a=!1,l=!1;t.on("vclick",i),SL.editor.controllers.Capabilities.isTouchEditor()||t.on("mousedown",n)}}),SL("editor.components.toolbars").Edit=SL.editor.components.toolbars.Base.extend({init:function(t){this.block=t,this.options=[],this.onOptionHeightChanged=this.onOptionHeightChanged.bind(this),this._super()},render:function(){this._super(),this.domElement.attr("data-type","edit"),this.renderOptions()},renderOptions:function(){this.isGroup=this.block.isGroup(),this.isGroup&&(this.renderOption(SL.editor.components.toolbars.options.GroupTitle),this.renderOption(SL.editor.components.toolbars.options.Divider),this.renderMutualOptionsForGroupedBlocks());var t=SL.editor.controllers.AutoAnimate.isEnabled(Reveal.getCurrentSlide());this.block.getToolbarOptions().forEach(function(e){t&&e===SL.editor.components.toolbars.groups.Animation?this.isGroup||this.renderOption(SL.editor.components.toolbars.groups.AutoAnimate):this.renderOption(e)},this),SL.editor.controllers.Capabilities.canUseCSSEditor()&&SL.view.isDeveloperMode()&&this.renderOption(SL.editor.components.toolbars.options.ClassName)},renderMutualOptionsForGroupedBlocks:function(){var t=this.block.getToolbarOptions().concat([SL.editor.components.toolbars.options.Rotation]),e=this.block.getNestedBlocks(),i=SL.view.toolbars.getMutualOptions(e).filter(function(e){
return e===SL.editor.components.toolbars.options.Divider||-1===t.indexOf(e)});i.length&&(i.push(SL.editor.components.toolbars.options.Divider),i.forEach(function(t){this.renderOption(t,e)},this))},renderOption:function(t,e){if(!(t instanceof Array)){e instanceof SL.editor.blocks.Base||e instanceof Array||(e=this.blocks||this.block);var i=new t(e);return i.appendTo(this.listElement),i.changed&&i.changed.add(this.sync.bind(this)),i.heightChanged&&i.heightChanged.add(this.onOptionHeightChanged),this.options.push(i),i}var n=$('<div class="toolbar-option-row">').appendTo(this.listElement);t.forEach(function(t){this.renderOption(t,e).appendTo(n)}.bind(this))},sync:function(){this._super.apply(this,arguments),this.isGroup&&this.block.paint()},appendTo:function(){this._super.apply(this,arguments),this.sync()},onOptionHeightChanged:function(){this.syncShadowTimeout=setTimeout(this.scrollShadow.sync,300)},destroy:function(){for(clearTimeout(this.syncShadowTimeout);this.options.length;)this.options.pop().destroy();this._super()}}),SL("editor.components.toolbars").EditMultiple=SL.editor.components.toolbars.Edit.extend({init:function(t){this.blocks=t,this._super()},render:function(){this._super(),this.domElement.attr("data-type","edit-multiple")},renderOptions:function(){var t=[SL.editor.components.toolbars.options.BlockAlignHorizontal,SL.editor.components.toolbars.options.BlockAlignVertical,SL.editor.components.toolbars.options.BlockLayout],e=SL.view.toolbars.getMutualOptions(this.blocks);e.length&&(t.push(SL.editor.components.toolbars.options.Divider),t=t.concat(e));var i=SL.editor.controllers.AutoAnimate.isEnabled(Reveal.getCurrentSlide()),n=this.blocks.some(function(t){return t.isGroup()});t.forEach(function(t){i&&t===SL.editor.components.toolbars.groups.Animation?n||this.renderOption(SL.editor.components.toolbars.groups.AutoAnimate):this.renderOption(t)},this)},isTargetingBlocks:function(t){return this.blocks.length===t.length&&this.blocks.every(function(e){return t.indexOf(e)>-1})}}),SL("editor.components.toolbars").Fragment=SL.editor.components.toolbars.Base.extend({init:function(){this.blocks=SL.editor.controllers.Blocks.getCurrentBlocks(),this._super()},render:function(){this._super(),this.domElement.attr("data-type","fragment")},getListElement:function(){return this.listElement}}),SL("editor.components.toolbars.groups").Base=Class.extend({init:function(t,e){t instanceof Array?(this.block=t[0],this.blocks=t):(this.block=t,this.blocks=[t]),this.config=$.extend({label:"Group",items:[],behavior:"toggleable"},e),this.options=[],this.onOptionHeightChanged=this.onOptionHeightChanged.bind(this),this.heightChanged=new signals.Signal,this.render(),this.bind()},render:function(){this.domElement=$('<div class="toolbar-option toolbar-group">'),this.config.type&&this.domElement.attr("data-group-type",this.config.type),this.domElement.attr("data-group-behavior",this.config.behavior),"toggleable"===this.config.behavior?(this.triggerElement=$('<button class="toolbar-group-trigger"></button>').appendTo(this.domElement),this.triggerElement.append('<span class="label">'+this.config.label+"</span>"),this.triggerElement.append('<span class="checkbox icon i-checkmark"></span>'),this.optionsElement=$('<div class="toolbar-group-options">').appendTo(this.domElement),this.optionsInnerElement=$('<div class="toolbar-group-options-inner">').appendTo(this.optionsElement)):"expanded"===this.config.behavior?(this.triggerElement=$('<button class="toolbar-group-title"></button>').appendTo(this.domElement),this.triggerElement.append('<span class="label">'+this.config.label+"</span>"),this.optionsElement=$('<div class="toolbar-group-options">').appendTo(this.domElement),this.optionsInnerElement=$('<div class="toolbar-group-options-inner">').appendTo(this.optionsElement),this.renderOptions(),this.syncOptions()):(this.optionsInnerElement=$('<div class="toolbar-group-inner">').appendTo(this.domElement),this.renderOptions(),this.syncOptions())},renderOptions:function(){"function"==typeof this.config.items&&(this.config.items=this.config.items()),this.config.items.forEach(this.renderOption.bind(this))},renderOption:function(t){var e;if(!(t instanceof Array))return(e=t.factory?new t.factory(this.blocks,t.config):new t(this.blocks)).appendTo(this.optionsInnerElement),e.heightChanged&&"toggleable"===this.config.behavior&&e.heightChanged.add(this.onOptionHeightChanged),this.options.push(e),e;var i=$('<div class="toolbar-option-row">').appendTo(this.optionsInnerElement);t.forEach(function(t){this.renderOption(t).appendTo(i)}.bind(this))},getOption:function(t){var e=this.options.filter(function(e){return e.getType()===t});return e.length?e[0]:null},getOptions:function(){return this.options},bind:function(){this.domElement.find(".toolbar-group-trigger").on("vclick",this.onTriggerClicked.bind(this)).on("keydown",this.onTriggerKeyDown.bind(this))},appendTo:function(t){this.domElement.appendTo(t)},sync:function(){this.expand()},syncOptions:function(){},syncHeight:function(){if(this.isExpanded()){var t=this.optionsInnerElement.prop("scrollHeight")+2;return this.optionsElement.height(t),t}},trigger:function(){},expand:function(){if("toggleable"===this.config.behavior){0===this.options.length?this.renderOptions():this.options.forEach(function(t){"function"==typeof t.readFromBlock&&t.readFromBlock()}),this.syncOptions(),this.domElement.addClass("expanded");var t=this.syncHeight();if("number"==typeof this.lastClickTime&&Date.now()-this.lastClickTime<1e3){var e=this.domElement.closest(".toolbar-list"),i=e.prop("offsetHeight"),n=this.optionsElement.get(0).getBoundingClientRect();n.top+t>i&&e.animate({scrollTop:e.get(0).scrollTop+(n.top+t)-i},300)}this.heightChanged.dispatch()}},collapse:function(){var t=this.isExpanded();this.domElement.removeClass("expanded"),this.optionsElement.height(0),t&&this.heightChanged.dispatch()},isExpanded:function(){return this.domElement.hasClass("expanded")},isTargetingMultipleBlocks:function(){return this.blocks&&this.blocks.length>1},onTriggerClicked:function(t){this.lastClickTime=Date.now(),t.preventDefault(),this.trigger()},onTriggerKeyDown:function(t){13!==t.keyCode&&32!==t.keyCode||(t.stopImmediatePropagation(),this.onTriggerClicked(t))},onOptionHeightChanged:function(){this.syncHeight(),this.heightChanged.dispatch()},destroy:function(){for(;this.options.length;){var t=this.options.pop();t.heightChanged&&t.heightChanged.remove(this.onOptionHeightChanged),t.destroy()}this.heightChanged.dispose(),this.domElement.remove()}}),SL("editor.components.toolbars.groups").Animation=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"animation",label:"Animation",items:[SL.editor.components.toolbars.options.AnimationTrigger,SL.editor.components.toolbars.options.AnimationTriggerID,SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.AnimationType,SL.editor.components.toolbars.options.TransformOrigin,SL.editor.components.toolbars.options.TransitionDuration,SL.editor.components.toolbars.options.TransitionDelay,SL.editor.components.toolbars.options.AnimationPreview]},e)),this.onAnimationTypeChanged=this.onAnimationTypeChanged.bind(this),this.onAnimationTriggerChanged=this.onAnimationTriggerChanged.bind(this)},renderOptions:function(){this._super.apply(this,arguments),this.animationTriggerIDOption=this.getOption("animation-trigger-id"),this.transformOriginOption=this.getOption("transform-origin"),this.block.watch("attribute.data-animation-type",this.onAnimationTypeChanged),this.block.watch("attribute.data-animation-trigger",this.onAnimationTriggerChanged)},sync:function(){this.block.isset("attribute.data-animation-type")?this.expand():this.collapse()},syncOptions:function(){this._super.apply(this,arguments);var t=this.block.get("attribute.data-animation-trigger");this.animationTriggerIDOption&&(this.animationTriggerIDOption.domElement.toggle(this.hasInteractiveAnimationTrigger()&&this.animationTriggerIDOption.getItems().length>1),this.animationTriggerIDOption.setLabel("click"===t?"Click target":"Hover target")),this.transformOriginOption&&this.transformOriginOption.domElement.toggle(/scale/gi.test(this.block.get("attribute.data-animation-type"))&&this.blocks.every(function(t){return!1===t.isGroup()}))},trigger:function(){this.block.isset("attribute.data-animation-type")?this.blocks.forEach(function(t){t.unset(["attribute.data-animation-type","attribute.data-animation-trigger","attribute.data-animation-trigger-id","style.transition-duration","style.transition-delay"])},this):(this.blocks.forEach(function(t){t.set("attribute.data-animation-type",t.getPropertySettings("attribute.data-animation-type").options[0].value),t.isset("style.transition-duration")||t.set("style.transition-duration",this.getDefaultDuration()),t.isset("style.transition-delay")||t.set("style.transition-delay",this.getDefaultDelay()),t.isFragment()&&t.removeFragment()},this),SL.deck.Animation.sync(),SL.analytics.trackEditor("toolbar_add_animation")),this.sync()},hasInteractiveAnimationTrigger:function(){return/click|hover/gi.test(this.block.get("attribute.data-animation-trigger"))},getDefaultDuration:function(){return SL.util.math.limitDecimals(SL.config.DEFAULT_SLIDE_TRANSITION_DURATION/1e3*.75,4)},getDefaultDelay:function(){return/^(none|fade)$/gi.test(SL.current_deck.get("transition"))?0:SL.util.math.limitDecimals(SL.config.DEFAULT_SLIDE_TRANSITION_DURATION/1e3*.75,4)},destroy:function(){this.block&&(this.block.unwatch("attribute.data-animation-type",this.onAnimationTypeChanged),this.block.unwatch("attribute.data-animation-trigger",this.onAnimationTriggerChanged)),this._super.apply(this,arguments)},onAnimationTypeChanged:function(){this.sync()},onAnimationTriggerChanged:function(){this.sync();var t=this.hasInteractiveAnimationTrigger();t?this.blocks.forEach(function(t){t.get("style.transition-delay")===this.getDefaultDelay()&&t.set("style.transition-delay",0)}.bind(this)):this.blocks.forEach(function(t){0===t.get("style.transition-delay")&&t.set("style.transition-delay",this.getDefaultDelay())}.bind(this)),t&&!this.block.isset("attribute.data-animation-trigger-id")&&(this.blocks.forEach(function(t){t.set("attribute.data-animation-trigger-id",t.getPropertySettings("attribute.data-animation-trigger-id").defaultValue)}),this.animationTriggerIDOption.domElement.is(":visible")&&this.animationTriggerIDOption.showPanel())}}),SL("editor.components.toolbars.groups").AutoAnimate=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"auto-animate",label:"Auto-Animate",behavior:"expanded",items:this.getItems.bind(this)},e))},getItems:function(){var t=[SL.editor.components.toolbars.options.AutoAnimateDuration,SL.editor.components.toolbars.options.AutoAnimateDelay,SL.editor.components.toolbars.options.AutoAnimateEasing];return this.isTargetingMultipleBlocks()||t.push(SL.editor.components.toolbars.options.Divider,SL.editor.components.toolbars.options.BlockName),t},render:function(){this._super.apply(this,arguments),this.resetButton=$('<span class="reset-button clickable icon i-undo" data-tooltip="Reset Auto-Animate values"></span>'),this.resetButton.appendTo(this.triggerElement)},bind:function(){this._super.apply(this,arguments),this.resetButton.on("vclick",this.setDefaultValues.bind(this))},setDefaultValues:function(){this.getOption("auto-animate-delay").setDefaultValue(),this.getOption("auto-animate-duration").setDefaultValue(),this.getOption("auto-animate-easing").setDefaultValue()}}),SL("editor.components.toolbars.groups").BorderCSS=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"border-css",label:"Border",items:[SL.editor.components.toolbars.options.BorderStyle,SL.editor.components.toolbars.options.BorderWidth,SL.editor.components.toolbars.options.BorderRadius,SL.editor.components.toolbars.options.BorderColor]},e))},sync:function(){var t=this.block.get("style.border-style");t&&"none"!==t?this.expand():this.collapse()},trigger:function(){this.block.isset("style.border-style")?this.blocks.forEach(function(t){t.unset(["style.border-style","style.border-radius"])}):this.blocks.forEach(function(t){t.set("style.border-style","solid"),t.isset("style.border-width")||t.set("style.border-width",1),t.isset("style.border-color")||t.set("style.border-color","#000000")}),this.sync()}}),SL("editor.components.toolbars.groups").BorderSVG=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"border-svg",label:"Border",items:[SL.editor.components.toolbars.options.ShapeStrokeWidth,SL.editor.components.toolbars.options.ShapeStrokeColor]},e))},sync:function(){this.block.supportsStroke()?(this.domElement.show(),this.block.hasStroke()?(this.expand(),this.options.forEach(function(t){t.readFromBlock()})):this.collapse()):this.domElement.hide()},trigger:function(){this.blocks.forEach(function(t){t.toggleStroke()},this),this.sync()}}),SL("editor.components.toolbars.groups").CodeLineNumbers=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"code-line-numbers",label:"Line Numbers",items:[SL.editor.components.toolbars.options.CodeLineHighlights]},e))},sync:function(){this.block.isset("code.line-numbers")?this.expand():this.collapse()},trigger:function(){this.block.isset("code.line-numbers")?this.blocks.forEach(function(t){t.set("code.line-numbers",null)}.bind(this)):this.blocks.forEach(function(t){t.set("code.line-numbers","")}.bind(this)),this.sync()}}),SL("editor.components.toolbars.groups").DropShadow=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"drop-shadow",label:"Shadow"},e))},render:function(){this._super.apply(this,arguments),this.renderOption([{factory:SL.editor.components.toolbars.options.Stepper,config:{label:"X",property:"filter.drop-shadow-x",progressbar:!1}},{factory:SL.editor.components.toolbars.options.Stepper,config:{label:"Y",property:"filter.drop-shadow-y",progressbar:!1}}]),this.renderOption({factory:SL.editor.components.toolbars.options.Stepper,config:{label:"Radius",property:"filter.drop-shadow-radius"}}),this.renderOption({factory:SL.editor.components.toolbars.options.Color,config:{label:"Color",alpha:!0,property:"filter.drop-shadow-color"}})},sync:function(){this.block.hasDropShadowFilter()?this.expand():this.collapse()},trigger:function(){if(this.block.hasDropShadowFilter())this.blocks.forEach(function(t){t.unset(["filter.drop-shadow-x","filter.drop-shadow-y","filter.drop-shadow-radius","filter.drop-shadow-color"])});else{var t=this.block.getPropertySettings("filter.drop-shadow-color");this.blocks.forEach(function(e){e.set({"filter.drop-shadow-x":0,"filter.drop-shadow-y":0,"filter.drop-shadow-radius":5,"filter.drop-shadow-color":t.defaultValue})})}this.sync()}}),SL("editor.components.toolbars.groups").Link=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"link",label:"link",items:[SL.editor.components.toolbars.options.LinkType,SL.editor.components.toolbars.options.LinkURL]},e))},renderOptions:function(){this._super.apply(this,arguments),this.linkTypeOption=this.getOption("link-type"),this.linkTypeOption.changed.add(this.sync.bind(this)),this.linkURLOption=this.getOption("link-url")},sync:function(){this.block.isLinked()?this.expand():this.collapse()},syncOptions:function(){this._super.apply(this,arguments),this.linkURLOption.domElement.toggle(this.linkTypeOption.isURL())},trigger:function(){this.block.isLinked()?this.blocks.forEach(function(t){t.setLinkURL(null)}.bind(this)):(this.blocks.forEach(function(t){t.setLinkURL("")}.bind(this)),this.linkTypeOption&&this.linkTypeOption.readFromBlock()),this.sync(),this.isExpanded()&&!SL.editor.controllers.Capabilities.isTouchEditor()&&this.linkURLOption&&"function"==typeof this.linkURLOption.focus&&setTimeout(function(){this.linkURLOption.focus()}.bind(this),200)}}),SL("editor.components.toolbars.groups").TableSize=SL.editor.components.toolbars.groups.Base.extend({init:function(t,e){this._super(t,$.extend({type:"table-size",behavior:"seamless",items:[SL.editor.components.toolbars.options.TableCols,SL.editor.components.toolbars.options.TableRows]},e)),this.setupBackfill(),this.setupPreview()},sync:function(){this._super(),this.refreshPreview()},setupBackfill:function(){this.options.forEach(function(t){t.changeStarted.add(this.refreshBackfill.bind(this)),t.changeEnded.add(this.refreshBackfill.bind(this))}.bind(this))},refreshBackfill:function(){this.options.some(function(t){return t.isChanging()}.bind(this))?this.blocks.forEach(function(t){t.enableBackfill()}.bind(this)):this.blocks.forEach(function(t){t.disableBackfill()}.bind(this))},setupPreview:function(){this.canvasElement=$('<canvas class="table-preview"></canvas>').appendTo(this.domElement),this.canvas=this.canvasElement.get(0),this.canvasContext=this.canvas.getContext("2d"),this.refreshPreview=this.refreshPreview.bind(this),this.block.tableSizeChanged.add(this.refreshPreview),this.block.tableHeaderChanged.add(this.refreshPreview),this.options.forEach(function(t){t.changed.add(this.refreshPreview)}.bind(this))},refreshPreview:function(){var t=Math.round(this.domElement.width()),e=Math.round(.6*t);this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",t*=2,e*=2,this.canvas.width=t,this.canvas.height=e,this.canvasContext.clearRect(0,0,t,e);for(var i=this.block.get("attribute.data-table-cols"),n=this.block.get("attribute.data-table-rows"),o=this.block.get("attribute.data-table-has-header"),r=4,s=t/i,a=e/n,l=0;l<i;l++)for(var c=0;c<n;c++)this.canvasContext.fillStyle=o&&0===c?"#555":"#444",this.canvasContext.fillRect(l*s+r/2,c*a+r/2,s-r,a-r)},destroy:function(){this.block.tableSizeChanged&&this.block.tableSizeChanged.remove(this.refreshPreview),this.options.forEach(function(t){t.changed.remove(this.refreshPreview)}.bind(this)),this._super()}}),SL("editor.components.toolbars.options").Base=Class.extend({init:function(t,e){t instanceof Array?(this.block=t[0],this.blocks=t):(this.block=t,this.blocks=[t]),this.config=e||{},this.config.tagName="string"==typeof this.config.tagName?this.config.tagName:"div",this.config.clickEvent="string"==typeof this.config.clickEvent?this.config.clickEvent:"vclick",this.property=this.getPropertySettings(),this.render(),this.bind()},render:function(){this.domElement=$("<"+this.config.tagName+' class="toolbar-option"></'+this.config.tagName+">"),this.config.type&&this.domElement.attr("data-option-type",this.config.type),this.config.tooltip&&this.setTooltip(this.config.tooltip),this.renderLabel(),this.config.description&&this.domElement.append('<h5 class="toolbar-option-description">'+this.config.description+"</h5>")},renderLabel:function(){var t;this.config.label&&(this.labelElement?this.labelElement.empty():this.labelElement=$('<h4 class="toolbar-option-label"></h4>').appendTo(this.domElement),this.labelElement.html(this.config.label),this.config.helpTooltip&&((t=this.config.helpTooltipLink?$('<a class="toolbar-option-help" href="'+this.config.helpTooltipLink+'" target="_blank">'):$('<div class="toolbar-option-help">')).attr({"data-tooltip":this.config.helpTooltip,"data-tooltip-alignment":"r","data-tooltip-maxwidth":240}),t.html("?"),t.appendTo(this.labelElement)))},setLabel:function(t){this.config.label=t,this.renderLabel()},setTooltip:function(t,e){e=$.extend({delay:1e3,maxwidth:200,alignment:"auto"},e),this.domElement.attr({"data-tooltip":t,"data-tooltip-delay":e.delay,"data-tooltip-maxwidth":e.maxwidth,"data-tooltip-alignment":e.alignment})},bind:function(){this.config.shortcut&&Mousetrap.bind(this.config.shortcut,function(t){t.preventDefault(),this.trigger()}.bind(this)),this.domElement.on(this.config.clickEvent,this.onClicked.bind(this))},appendTo:function(t){this.domElement.appendTo(t)},destroy:function(){this.domElement.remove()},getType:function(){return this.config.type},getPropertySettings:function(){return this.block&&"string"==typeof this.config.property?this.block.getPropertySettings(this.config.property):null},isHidden:function(){return this.hidden||!1},onClicked:function(t){$(t.target).is(".toolbar-option-help, .toolbar-option-description a")||t.preventDefault()}}),SL("editor.components.toolbars.options").Value=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){this._super(t,e),this.changed=new signals.Signal,this.value=this.getDefaultValue(),this.config.watchBlock&&this.block.watch(this.config.property,this.onPropertyChanged)},bind:function(){this._super(),this.onPropertyChanged=this.onPropertyChanged.bind(this)},appendTo:function(t){this._super(t),this.readFromBlock()},readFromBlock:function(){this.setValue(this.block.get(this.config.property))},writeToBlock:function(){"number"==typeof this.writeToBlockTimeout&&(clearTimeout(this.writeToBlockTimeout),delete this.writeToBlockTimeout),this.isWritingToBlock=!0,this.setBlockValue(this.getValue()),this.isWritingToBlock=!1},setBlockValue:function(t){this.blocks.forEach(function(e){e.set(this.config.property,t)},this)},writeToBlockAfter:function(t){"undefined"==typeof this.writeToBlockTimeout?(this.writeToBlock(),this.writeToBlockTimeout=setTimeout(function(){delete this.writeToBlockTimeout}.bind(this),t||300)):(clearTimeout(this.writeToBlockTimeout),this.writeToBlockTimeout=setTimeout(this.writeToBlock.bind(this),t||300))},setValue:function(t,e){this.value=t,e&&(this.writeToBlock(),this.changed.dispatch(this.value))},getValue:function(){return this.value},setDefaultValue:function(){this.setValue(this.getDefaultValue(),!0)},getDefaultValue:function(){return this.property.defaultValue},getUnit:function(){return this.property.unit?this.property.unit:""},onPropertyChanged:function(){this.isWritingToBlock||this.readFromBlock()},destroy:function(){"number"==typeof this.writeToBlockTimeout&&this.writeToBlock(),this.config.watchBlock&&this.block&&this.block.unwatch(this.config.property,this.onPropertyChanged),this.changed.dispose(),this._super()}}),SL("editor.components.toolbars.options").Button=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){this._super(t,$.extend({tagName:"button"},e))},render:function(){this._super(),this.domElement.addClass("toolbar-button"),this.config.title?this.domElement.text(this.config.title):this.config.icon&&this.domElement.html('<span class="icon i-'+this.config.icon+'"></span>')}}),SL("editor.components.toolbars.options").Checkbox=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"checkbox",tagName:"button"},e))},render:function(){this._super(),this.domElement.addClass("toolbar-checkbox"),this.checkboxElement=$('<span class="checkbox icon i-checkmark">'),this.checkboxElement.appendTo(this.domElement)},setValue:function(t,e){this.domElement.toggleClass("checked",t),this._super(t,e)},getValue:function(){return this.domElement.hasClass("checked")},onClicked:function(t){this._super(t),this.setValue(!this.getValue(),!0)}}),SL("editor.components.toolbars.options").Color=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"color",alpha:!1},e))},render:function(){this._super(),this.domElement.addClass("toolbar-color"),this.triggerElement=$('<button class="toolbar-color-trigger"></button>'),this.triggerElement.appendTo(this.domElement),this.triggerInnerElement=$('<div class="toolbar-color-trigger-inner"></div>'),this.triggerInnerElement.appendTo(this.triggerElement)},bind:function(){this._super(),this.domElement.on("vclick",this.onTriggerClicked.bind(this)),this.domElement.on("keydown",this.onTriggerKeyDown.bind(this))},readFromBlock:function(){this._super(),this.syncTriggerUI()},setValue:function(t,e){this._super(t,e),this.syncTriggerUI()},syncTriggerUI:function(){var t=this.getTriggerColor();this.triggerElement.toggleClass("transparent",tinycolor(t).getAlpha()<1),this.triggerInnerElement.css("background-color",t)},getTriggerColor:function(){return this.value},getColorpickerConfig:function(){return{anchor:this.domElement,alignment:"r",alpha:this.config.alpha,color:this.getValue(),changeCallback:this.setValue.bind(this),resetCallback:this.onResetClicked.bind(this)}},showEyeDropper:function(){SL.util.device.supportsEyeDropperAPI()&&(this.eyedropper||(this.eyedropper=new EyeDropper),this.eyedropper.open().then(function(t){this.setValue(t.sRGBHex,!0)}.bind(this))["catch"](function(){}))},onPanelShown:function(){this.readFromBlock(),this.domElement.addClass("is-active")},onPanelHidden:function(){this._super.apply(this,arguments),this.pickerWrapper.spectrum("saveCurrentSelection"),this.domElement.removeClass("is-active")},onTriggerClicked:function(t){t.preventDefault(),SL.view.colorpicker.toggle(this.getColorpickerConfig())},onTriggerKeyDown:function(t){13!==t.keyCode&&32!==t.keyCode||(t.stopImmediatePropagation(),this.onTriggerClicked(t))},onResetClicked:function(){this.setValue(this.getDefaultValue()||"",!0),this.readFromBlock(),SL.view.colorpicker.hide()},destroy:function(){SL.view.colorpicker.isVisibleForAnchor(this.triggerElement)&&SL.view.colorpicker.hide(),this.eyedropper=null,this._super()}}),SL("editor.components.toolbars.options").Direction=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"direction",multiselect:!1,directions:{tl:{id:"tl",value:"0% 0%"},t:{id:"t",value:"50% 0%"},tr:{id:"tr",value:"100% 0%"},l:{id:"l",value:"0% 50%"},c:{id:"c",value:"50% 50%"},r:{id:"r",value:"100% 50%"},bl:{id:"bl",value:"0% 100%"},b:{id:"b",value:"50% 100%"},br:{id:"br",value:"100% 100%"}}},e))},getItems:function(){var t=this.config.directions;return[[t.tl,t.t,t.tr],[t.l,t.c,t.r],[t.bl,t.b,t.br]]},render:function(){this._super(),this.domElement.addClass("toolbar-direction"),this.directionsElement=$('<div class="direction-list"></div>'),this.directionsElement.appendTo(this.domElement);var t=this.getItems().map(function(t){return'<div class="direction-row">'+t.map(function(t){return'<button class="direction-item" data-direction="'+t.id+'" data-value="'+t.value+'"></button>'}).join("")+"</div>"}).join("");this.directionsElement.append(t)},bind:function(){this._super(),this.directionsElement.on("vclick",this.onDirectionClicked.bind(this))},setValue:function(t){this.selectDirection(t),this._super(t)},selectDirection:function(t){this.config.multiselect?this.directionsElement.find('[data-value="'+t+'"]').toggleClass("selected"):(this.directionsElement.find(".selected").removeClass("selected"),this.directionsElement.find('[data-value="'+t+'"]').addClass("selected"))},getValue:function(){return this.directionsElement.find(".selected").attr("data-value")},onDirectionClicked:function(t){var e=$(t.target).closest(".direction-item");e.length&&(this.selectDirection(e.attr("data-value")),this.writeToBlock())}}),SL("editor.components.toolbars.options").Easing=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"easing",panelType:"easing",panelClassName:null,panelWidth:480,panelHeight:"auto",panelMaxHeight:300,panelAlignment:"r",value:0,items:SL.config.EASING_EQUATIONS},e))},render:function(){this._super(),this.domElement.addClass("toolbar-select"),this.triggerElement=$('<button class="toolbar-select-trigger"></button>'),this.triggerElement.appendTo(this.domElement),this.triggerLabel=$('<span class="toolbar-select-trigger-label"></span>').appendTo(this.triggerElement),this.triggerIcon=$('<span class="toolbar-select-trigger-icon icon i-chevron-right"></span>').appendTo(this.triggerElement)},renderPanel:function(){this.panel=new SL.editor.components.toolbars.util.Panel({type:this.config.panelType,className:this.config.panelClassName,anchor:this.triggerElement,hitArea:this.domElement,keydown:this.onKeyDown.bind(this),maxHeight:this.config.panelMaxHeight,width:this.config.panelWidth,height:this.config.panelHeight,alignment:this.config.panelAlignment}),this.panel.shown.add(this.onPanelShown.bind(this)),this.panel.hidden.add(this.onPanelHidden.bind(this)),this.easingList=new SL.components.EasingList({className:"spacing-around"}),this.easingList.appendTo(this.panel.contentElement),this.easingList.selectionChanged.add(function(t){this.setValue(t,!0)}.bind(this))},bind:function(){this._super(),this.onTriggerKeyDown=this.onTriggerKeyDown.bind(this),this.triggerElement.on("vmousedown",this.onTriggerClicked.bind(this)),this.triggerElement.on("keydown",this.onTriggerKeyDown)},setValue:function(t,e){this.hasValue(t)&&(this._super(t,e),this.displaySelectedValue(),this.easingList&&this.easingList.setValue(t)),e&&this.panel&&this.panel.hide()},hasValue:function(t){return this.config.items.some(function(e){return e.value===t})},displaySelectedValue:function(){this.triggerLabel.text(this.getTitleByValue(this.value)),this.triggerElement.attr("data-value",this.value)},showPanel:function(){this.renderPanel(),this.panel.show()},getTitleByValue:function(t){var e=null;return this.config.items.forEach(function(i){i.value===t&&(e=i.title)}),e},getDefaultValue:function(){return this.config.items[0].value},onPanelShown:function(){this.triggerElement.off("keydown",this.onTriggerKeyDown)},onPanelHidden:function(){this.triggerElement.on("keydown",this.onTriggerKeyDown)},onTriggerClicked:function(t){t.preventDefault(),this.panel?this.panel.toggle():this.showPanel(),this.easingList.setValue(this.value),this.easingList.focus()},onTriggerKeyDown:function(t){13!==t.keyCode&&32!==t.keyCode||(t.stopImmediatePropagation(),this.onTriggerClicked(t))},onKeyDown:function(t){if(13===t.keyCode||32===t.keyCode)this.panel&&this.panel.isVisible()&&(this.easingList.selectFocusedElement(),this.panel.hide());else{if(9===t.keyCode)return!0;27===t.keyCode&&this.panel.hide()}return!1},destroy:function(){this.panel&&(this.panel.destroy(),this.panel=null),this.easingList&&(this.easingList.destroy(),this.easingList=null),this._super()}}),SL("editor.components.toolbars.options").Multi=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){this._super(t,$.extend({type:"multi",wrap:null,items:[]},e))},getItems:function(){return"function"==typeof this.config.items?this.config.items():this.config.items},render:function(){this._super();var t=this.getItems();this.domElement.addClass("toolbar-multi"),this.domElement.attr("data-number-of-items",t.length),this.innerElement=$('<div class="toolbar-multi-inner">').appendTo(this.domElement),"number"==typeof this.config.wrap&&this.innerElement.attr("data-wrap",this.config.wrap),t.forEach(function(t){var e=$('<button class="toolbar-multi-item" data-value="'+t.value+'"></button>');"string"==typeof t.icon?(e.append('<span class="icon i-'+t.icon+'"></span>'),"number"==typeof t.iconScale&&e.find(".icon").css("font-size",100*t.iconScale+"%")):e.html(t.title),t.tooltip&&e.attr("data-tooltip",t.tooltip),e.appendTo(this.innerElement)}.bind(this))},bind:function(){this._super(),this.domElement.find(".toolbar-multi-item").on("vclick",this.onListItemClicked.bind(this))},trigger:function(){},getItemByValue:function(t){return this.domElement.find('.toolbar-multi-item[data-value="'+t+'"]')},onListItemClicked:function(t){var e=$(t.currentTarget).attr("data-value");e&&this.trigger(e)}}),SL("editor.components.toolbars.options").Radio=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"radio",items:[]},e))},getItems:function(){return"function"==typeof this.config.items?this.config.items():this.config.items},render:function(){this._super(),this.domElement.addClass("toolbar-radio"),this.domElement.attr("data-number-of-items",this.getItems().length),this.innerElement=$('<div class="toolbar-radio-inner">').appendTo(this.domElement);var t=0;this.getItems().forEach(function(e){var i=$(['<button class="toolbar-radio-item" data-value="'+e.value+'">',e.icon?'<span class="icon i-'+e.icon+'"></span>':e.title,"</button>"].join(""));e.title&&(t+=e.title.length),e.tooltip&&i.attr("data-tooltip",e.tooltip),i.appendTo(this.innerElement)}.bind(this)),this.innerElement.toggleClass("s-text",t>12)},bind:function(){this._super(),this.domElement.find(".toolbar-radio-item").on("vclick",this.onListItemClicked.bind(this))},setValue:function(t,e){this.hasValue(t)&&(this.domElement.find(".toolbar-radio-item").removeClass("selected"),this.domElement.find('.toolbar-radio-item[data-value="'+t+'"]').first().addClass("selected"),this._super(t,e))},hasValue:function(t){return this.getItems().some(function(e){return e.value===t})},onListItemClicked:function(t){var e=$(t.currentTarget).attr("data-value");e&&this.setValue(e,!0)}}),SL("editor.components.toolbars.options").Range=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){
this._super(t,$.extend({type:"range"},e))},render:function(){this._super(),this.domElement.addClass("toolbar-range"),this.rangeElement=$('<div class="range">'),this.rangeElement.appendTo(this.domElement),this.rangeProgressElement=$('<div class="range-progress">').appendTo(this.rangeElement),this.rangeNumericElement=$('<div class="range-numeric">').appendTo(this.rangeElement)},bind:function(){this._super(),this.changed=new signals.Signal,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.rangeElement.on("vmousedown",this.onMouseDown)},setValue:function(t,e){t=Math.max(Math.min(t,this.property.maxValue),this.property.minValue),this.rangeProgressElement.css("width",this.valueToPercent(t)+"%"),this._super(t,e),this.rangeNumericElement.text(this.getValue().toFixed(this.property.decimals)+this.getUnit())},getValue:function(){var t=this.percentToValue(parseInt(this.rangeProgressElement.get(0).style.width,10)),e=Math.pow(10,this.property.decimals);return Math.round(t*e)/e},valueToPercent:function(t){var e=(t-this.property.minValue)/(this.property.maxValue-this.property.minValue)*100;return Math.max(Math.min(e,100),0)},percentToValue:function(t){return this.property.minValue+t/100*(this.property.maxValue-this.property.minValue)},onMouseDown:function(t){t.preventDefault(),$(document).on("vmousemove",this.onMouseMove),$(document).on("vmouseup",this.onMouseUp),this.onMouseMove(t),this.rangeElement.addClass("is-scrubbing")},onMouseMove:function(t){var e=t.clientX-this.rangeElement.offset().left;this.setValue(this.percentToValue(e/this.rangeElement.width()*100),!0),this.writeToBlock()},onMouseUp:function(){$(document).off("vmousemove",this.onMouseMove),$(document).off("vmouseup",this.onMouseUp),this.rangeElement.removeClass("is-scrubbing")}}),SL("editor.components.toolbars.options").Select=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"select",panelType:"select",panelClassName:null,panelWidth:"anchor-width",panelHeight:"auto",panelMaxHeight:300,panelAlignment:"r",value:0,items:[],itemsCacheable:!0},e)),this.keySearchString="",this.keySearchTimeout},getItems:function(){var t="function"==typeof this.config.items?this.config.items():this.config.items;return this.config.itemsCacheable&&(this.config.items=t),t},render:function(){this._super(),this.domElement.addClass("toolbar-select"),this.triggerElement=$('<button class="toolbar-select-trigger"></button>'),this.triggerElement.appendTo(this.domElement),this.triggerLabel=$('<span class="toolbar-select-trigger-label"></span>').appendTo(this.triggerElement),this.triggerIcon=$('<span class="toolbar-select-trigger-icon icon i-chevron-right"></span>').appendTo(this.triggerElement)},renderPanel:function(){this.panel=new SL.editor.components.toolbars.util.Panel({type:this.config.panelType,className:this.config.panelClassName,anchor:this.triggerElement,hitArea:this.domElement,keydown:this.onKeyDown.bind(this),maxHeight:this.config.panelMaxHeight,width:this.config.panelWidth,height:this.config.panelHeight,alignment:this.config.panelAlignment}),this.panel.shown.add(this.onPanelShown.bind(this)),this.panel.hidden.add(this.onPanelHidden.bind(this)),this.getItems().forEach(this.renderItem.bind(this)),this.getListElements().on("vclick mouseup",this.onListItemClicked.bind(this))},renderItem:function(t){var e;(e="header"===t.type?$('<div class="toolbar-select-header"></div>'):$('<div class="toolbar-select-item" data-value="'+t.value+'"></div>')).append(t.title||t.value),t.thumbnailElement?$('<span class="thumbnail"></span>').append(t.thumbnailElement).appendTo(e):"string"==typeof t.subtitle&&$('<span class="subtitle"></span>').append(t.subtitle).appendTo(e),e.appendTo(this.panel.contentElement)},bind:function(){this._super(),this.onTriggerKeyDown=this.onTriggerKeyDown.bind(this),this.triggerElement.on("vmousedown",this.onTriggerClicked.bind(this)),this.triggerElement.on("keydown",this.onTriggerKeyDown)},setValue:function(t,e){this.hasValue(t)&&(this._super(t,e),this.displaySelectedValue(),this.getListElements().removeClass("selected"),this.getListElements().filter('[data-value="'+this.value+'"]').first().addClass("selected")),e&&this.panel&&this.panel.hide()},hasValue:function(t){return this.getItems().some(function(e){return e.value===t})},displaySelectedValue:function(){this.triggerLabel.text(this.getTitleByValue(this.value)),this.triggerElement.attr("data-value",this.value)},clearFocus:function(){this.getListElements().removeClass("focused")},focusDefault:function(){var t=this.getListElements(),e=t.filter(".focused"),i=t.filter(".selected");0===e.length&&(i.length?i.addClass("focused"):t.first().addClass("focused"))},focusItem:function(t){t&&t.length&&(this.getListElements().removeClass("focused"),t.addClass("focused")),this.scrollIntoView()},clearFocus:function(){this.getListElements().removeClass("focused")},focusStep:function(t){this.focusDefault();var e=this.getListElements().filter(".focused");this.focusItem(t<0?e.prev():e.next()),this.scrollIntoView()},focusByTitle:function(t){var e=this.getListElements().filter(function(e,i){return 0===i.textContent.toLowerCase().indexOf(t.toLowerCase())});e.length&&this.focusItem(e.first())},scrollIntoView:function(){var t=this.getListElements(),e=t.filter(".focused"),i=t.filter(".selected");e.length?SL.util.dom.scrollIntoViewIfNeeded(e.get(0)):i.length&&SL.util.dom.scrollIntoViewIfNeeded(i.get(0))},showPanel:function(){this.renderPanel(),this.panel.show()},getTitleByValue:function(t){var e=null;return this.getItems().forEach(function(i){i.value===t&&(e=i.title)}),e},getDefaultValue:function(){return this.getItems()[0].value},getListElements:function(){return this.panel?this.panel.contentElement.find(".toolbar-select-item"):$()},getListElementByValue:function(t){return this.getListElements().filter('[data-value="'+t+'"]').first()},onListItemClicked:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$(t.currentTarget).attr("data-value");e&&this.setValue(e,!0)},onPanelShown:function(){this.getListElements().removeClass("selected"),this.getListElementByValue(this.getValue()).addClass("selected"),this.scrollIntoView(),this.clearFocus(),this.triggerElement.off("keydown",this.onTriggerKeyDown)},onPanelHidden:function(){this.triggerElement.on("keydown",this.onTriggerKeyDown)},onTriggerClicked:function(t){t.preventDefault(),this.panel?this.panel.toggle():this.showPanel()},onTriggerKeyDown:function(t){13!==t.keyCode&&32!==t.keyCode||(t.stopImmediatePropagation(),this.onTriggerClicked(t))},onKeyDown:function(t){if(38===t.keyCode||9===t.keyCode&&t.shiftKey)this.focusStep(-1);else if(40===t.keyCode||9===t.keyCode)this.focusStep(1);else if(13===t.keyCode||32===t.keyCode){var e=this.getListElements().filter(".focused").attr("data-value");e?this.setValue(e,!0):this.panel&&this.panel.isVisible()&&this.panel.hide()}else if(27===t.keyCode)this.panel.hide();else{if(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return!0;var i=String.fromCharCode(t.keyCode);i.match(/[A-Z0-9#\+]/i)&&(clearTimeout(this.keySearchTimeout),this.keySearchTimeout=setTimeout(function(){this.keySearchString=""}.bind(this),500),this.keySearchString+=i,this.focusByTitle(this.keySearchString))}return!1},destroy:function(){this.panel&&(this.panel.destroy(),this.panel=null),this._super()}}),SL("editor.components.toolbars.options").SelectLineType=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({panelWidth:75,panelMaxHeight:430,panelAlignment:"b"},e))},renderItem:function(t){var e=$('<div class="toolbar-select-item" data-value="'+t.value+'">');e.appendTo(this.panel.contentElement),this.createPreviewSVG(e,t.value,59,40)},displaySelectedValue:function(){this.triggerElement.find("svg").remove(),this.createPreviewSVG(this.triggerElement,this.value,46,36)},createPreviewSVG:function(t,e,i,n){var o=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg");o.setAttribute("xmlns",SL.editor.util.SVG.NAMESPACE),o.setAttribute("version","1.1"),o.setAttribute("width",i),o.setAttribute("height",n),o.setAttribute("viewBox","0 0 "+i+" "+n),o.setAttribute("preserveAspectRatio","xMidYMid"),SL.editor.blocks.Line.generate(o,{interactive:!1,startType:"line-start-type"===this.config.type?e:null,endType:"line-end-type"===this.config.type?e:null,color:"#333333",width:4,x1:0,y1:n/2,x2:i,y2:n/2}),t.append(o)}}),SL("editor.components.toolbars.options").SplitText=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this.rowOptionsTemplate=['<div class="input-row-options">','<div class="input-row-remove" data-tooltip-delay="500" data-tooltip="Remove step"><span class="icon i-close"></span></div>','<div class="input-row-drag" data-tooltip-delay="500" data-tooltip="Drag to rearrange" data-tooltip-alignment="r"><span class="icon i-menu"></span></div>',"</div>"].join(""),this._super(t,$.extend({type:"text",delimiter:null,maxlength:255,placeholder:"",addRowLabel:null,writeDelay:null},e)),this.heightChanged=new signals.Signal},render:function(){this._super(),this.domElement.addClass("toolbar-split-text"),this.inputRows=$('<div class="input-rows"></div>').appendTo(this.domElement),"string"==typeof this.config.addRowLabel&&$('<button class="toolbar-button"></button>').text(this.config.addRowLabel).on("vclick",this.onAddRowClicked.bind(this)).appendTo(this.domElement),this.createRow()},bind:function(){this._super(),this.inputRows.on("input",".toolbar-text-input",this.onInputChange.bind(this)),this.inputRows.on("focus",".toolbar-text-input",this.onInputFocus.bind(this)),this.inputRows.on("blur",".toolbar-text-input",this.onInputBlur.bind(this)),this.inputRows.on("keydown",".toolbar-text-input",this.onInputKeyDown.bind(this)),this.inputRows.on("vclick",".input-row-remove",this.onRemoveRowClicked.bind(this)),this.inputRows.on("vmousedown",".input-row-drag",this.onDragRowMouseDown.bind(this)),this.onDragRowMouseMove=this.onDragRowMouseMove.bind(this),this.onDragRowMouseUp=this.onDragRowMouseUp.bind(this)},createRow:function(t){var e=$('<div class="input-row"></div>'),i=$("<input />").attr({"class":"toolbar-text-input",maxlength:this.config.maxlength});return"string"==typeof t&&i.val(t),e.append(i),e.append(this.rowOptionsTemplate),e.appendTo(this.inputRows),this.afterRowsChanged(),e},removeRow:function(t){this.getTotalRows()>1?($(t).closest(".input-row").remove(),this.afterRowsChanged()):this.getFirstInput().value=""},removeAllRows:function(){this.inputRows.find(".input-row").remove(),this.createRow()},afterRowsChanged:function(){var t=this.getAllInputs();1===t.length?t[0].setAttribute("placeholder",this.config.placeholder):t.forEach(function(t,e){t.setAttribute("placeholder","Step "+(e+1))},this)},getAllRows:function(){return this.inputRows.find(".input-row:not(.input-row-ghost)").toArray()},getTotalRows:function(){return this.getAllRows().length},getAllInputs:function(){return this.inputRows.find(".input-row:not(.input-row-ghost) .toolbar-text-input").toArray()},getFirstInput:function(){return this.getAllInputs()[0]},focus:function(){this.getFirstInput().focus()},setValue:function(t){for(var e=this.getAllInputs(),i=t.replace(/\s/g,"").split(this.config.delimiter),n=0;n<Math.max(i.length,e.length);n++)if("string"==typeof i[n]){var o=e[n];o?o.value=i[n]:this.createRow(i[n])}else this.removeRow(e[n]);this._super(t)},getValue:function(){return this.getAllInputs().map(function(t){return t.value.replace(/\s/g,"")}).join(this.config.delimiter)},onInputChange:function(){"number"==typeof this.config.writeDelay?this.writeToBlockAfter(this.config.writeDelay):this.writeToBlock()},onInputFocus:function(){},onInputBlur:function(){},onInputKeyDown:function(t){if(13===t.keyCode)this.createRow().insertAfter($(t.target).closest(".input-row")).find("input").focus(),this.writeToBlock(),this.heightChanged.dispatch(),t.preventDefault();else if(8===t.keyCode){if(""===(i=$(t.target).closest(".input-row")).find(".toolbar-text-input").val()){var e=i.prev();0===e.length&&(e=i.next()),e.find(".toolbar-text-input").focus(),this.removeRow(i),this.writeToBlock(),this.heightChanged.dispatch(),t.preventDefault()}}else if(38===t.keyCode&&(t.metaKey||t.ctrlKey)){(i=$(t.target).closest(".input-row")).prev().insertAfter(i),t.preventDefault()}else if(40===t.keyCode&&(t.metaKey||t.ctrlKey)){(i=$(t.target).closest(".input-row")).next().insertBefore(i),t.preventDefault()}else if(38===t.keyCode){(i=$(t.target).closest(".input-row")).prev()&&i.prev().find(".toolbar-text-input").focus(),t.preventDefault()}else if(40===t.keyCode){var i;(i=$(t.target).closest(".input-row")).next()&&i.next().find(".toolbar-text-input").focus(),t.preventDefault()}},onAddRowClicked:function(){this.createRow().find("input").focus(),this.writeToBlock(),this.heightChanged.dispatch()},onRemoveRowClicked:function(t){this.removeRow($(t.target).closest(".input-row")),this.writeToBlock(),this.heightChanged.dispatch()},onDragRowMouseDown:function(t){$(document).on("vmousemove",this.onDragRowMouseMove),$(document).on("vmouseup",this.onDragRowMouseUp);var e=$(t.target).closest(".input-row");this.dragData={},this.dragData.offsetY=e.position().top,this.dragData.startY=t.clientY,this.dragData.rowHeight=e.outerHeight(),this.dragData.rows=this.getAllRows(),this.dragData.minY=this.dragData.rows[0].offsetTop,this.dragData.maxY=this.dragData.rows[this.dragData.rows.length-1].offsetTop,this.dragGhost=e.clone().appendTo(this.inputRows),this.dragGhost.addClass("input-row-ghost"),this.dragTarget=e,this.dragTarget.addClass("dragging"),this.domElement.addClass("dragging"),this.onDragRowMouseMove(t)},onDragRowMouseMove:function(t){var e=this.dragData.offsetY+(t.clientY-this.dragData.startY);e=Math.max(e,this.dragData.minY),e=Math.min(e,this.dragData.maxY);var i=Math.round(e/this.dragData.rowHeight);i=Math.max(i,0),i=Math.min(i,this.dragData.rows.length);var n=$(this.dragData.rows[i]);n.length&&!n.is(this.dragTarget)&&(this.dragTarget.index()>i?n.before(this.dragTarget):n.after(this.dragTarget),this.dragData.rows=this.getAllRows(),this.afterRowsChanged()),this.dragGhost.css("transform","translateY("+e+"px)")},onDragRowMouseUp:function(){this.domElement.removeClass("dragging"),this.dragTarget.removeClass("dragging"),this.dragTarget=null,this.dragGhost.remove(),this.dragGhost=null,this.dragData=null,this.writeToBlock(),$(document).off("vmousemove",this.onDragRowMouseMove),$(document).off("vmouseup",this.onDragRowMouseUp)},destroy:function(){$(document).off("vmousemove",this.onDragRowMouseMove),$(document).off("vmouseup",this.onDragRowMouseUp),this.heightChanged&&this.heightChanged.dispose(),this._super.apply(this,arguments)}}),SL("editor.components.toolbars.options").Stepper=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"stepper",progressbar:!0,loop:!1,fadeDefaultValue:!1,inlineLabel:!0},e)),this.valueRange=this.property.maxValue-this.property.minValue,this.stepSize=this.valueRange<1?this.valueRange/200:1,this.property.stepSize&&(this.stepSize=this.property.stepSize),this.changing=!1,this.focused=!1,this.mouseDownValue=0,this.mouseDownX=0},render:function(){this._super(),this.domElement.addClass("toolbar-stepper"),this.stepperElement=$('<div class="stepper">'),this.stepperElement.appendTo(this.domElement),this.config.fadeDefaultValue&&this.stepperElement.addClass("fade-default-value"),this.config.progressbar&&(this.progressbar=$('<div class="stepper-progress">').appendTo(this.stepperElement)),this.numberInput=$('<input type="text" class="stepper-number">').appendTo(this.stepperElement),this.labelElement&&!0===this.config.inlineLabel&&this.labelElement.prependTo(this.stepperElement),!this.property.unit&&!this.property.toolbarUnit||this.property.unitHidden||this.stepperElement.attr("data-unit",this.property.unit||this.property.toolbarUnit)},bind:function(){this._super(),this.changeStarted=new signals.Signal,this.changeEnded=new signals.Signal,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.stepperElement.on("vmousedown",this.onMouseDown),this.numberInput.on("input",this.onInput.bind(this)),this.numberInput.on("keydown",this.onInputKeyDown.bind(this)),this.numberInput.on("focus",this.onInputFocused.bind(this)),this.numberInput.on("blur",this.onInputBlurred.bind(this))},setValue:function(t,e,i){if(isNaN(t)&&(t=this.value),this.value=t,this.config.loop&&(this.value<this.property.minValue&&(this.value=this.property.maxValue+this.value%(this.property.maxValue-this.property.minValue)),this.value>this.property.minValue&&(this.value=this.property.minValue+this.value%(this.property.maxValue-this.property.minValue))),this.value=Math.max(Math.min(this.value,this.property.maxValue),this.property.minValue),this.value=this.roundValue(this.value),!i){var n=this.value;this.property.decimals>0&&(n=n.toFixed(this.property.decimals)),this.numberInput.val(n)}if(this.progressbar){var o=this.valueToPercent(this.value)/100;this.progressbar.css("transform","scaleX("+o+")")}this.stepperElement.toggleClass("is-default-value",t===this.getDefaultValue()),this._super(this.value,e)},roundValue:function(t){var e=Math.pow(10,this.property.decimals);return Math.round(t*e)/e},valueToPercent:function(t){var e=(t-this.property.minValue)/(this.property.maxValue-this.property.minValue)*100;return Math.max(Math.min(e,100),0)},isChanging:function(){return this.changing},isFocused:function(){return this.focused},onChangeStart:function(){this.isChanging()||(this.stepperElement.addClass("is-changing"),this.changing=!0,this.changeStarted.dispatch())},onChangeEnd:function(){this.isChanging()&&(this.stepperElement.removeClass("is-changing"),this.changing=!1,this.changeEnded.dispatch())},onMouseDown:function(t){var e=this.numberInput.is(":focus");if(!e||!SL.editor.controllers.Capabilities.isTouchEditor()){if(!e){var i=$(document.activeElement);i.closest(".toolbar-option").length>0&&i.blur(),t.preventDefault()}$(document).on("vmousemove",this.onMouseMove),$(document).on("vmouseup",this.onMouseUp),this.mouseDownX=t.clientX,this.mouseDownValue=this.getValue(),this.onChangeStart()}},onMouseMove:function(t){var e=t.clientX-this.mouseDownX;(Math.abs(e)>1||this.stepperElement.hasClass("is-scrubbing"))&&(this.stepperElement.addClass("is-scrubbing"),1===this.stepSize&&this.valueRange<15?e*=.25:1===this.stepSize&&this.valueRange<30?e*=.5:1===this.stepSize&&this.valueRange>150&&(e*=1.5),this.setValue(this.mouseDownValue+e*this.stepSize,!0),this.writeToBlock())},onMouseUp:function(t){$(document).off("vmousemove",this.onMouseMove),$(document).off("vmouseup",this.onMouseUp),!1===this.stepperElement.hasClass("is-scrubbing")?this.onClick(t):this.onChangeEnd(),this.stepperElement.removeClass("is-scrubbing"),t.preventDefault()},onClick:function(){this.numberInput.focus()},onInput:function(){this.setValue(parseFloat(this.numberInput.val()),!0,!0),this.writeToBlock()},onInputKeyDown:function(t){var e=0;38===t.keyCode?e=this.stepSize:40===t.keyCode&&(e=-this.stepSize),e&&(t.shiftKey&&(e*=10),this.setValue(this.getValue()+e,!0),this.writeToBlock(),t.preventDefault())},onInputFocused:function(){this.focused=!0,this.numberInput.select(),this.onChangeStart()},onInputBlurred:function(){this.focused=!1,this.onChangeEnd(),this.setValue(this.getValue(),!0)},destroy:function(){this.changeStarted.dispose(),this.changeEnded.dispose(),this._super()}}),SL("editor.components.toolbars.options").Text=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,$.extend({type:"text",multiline:!1,expandable:!1,maxlength:255,placeholder:"",editorTitle:"Edit",editorMode:null,writeDelay:null},e))},render:function(){this._super(),this.domElement.addClass("toolbar-text"),this.config.multiline?(this.inputElement=$("<textarea></textarea>"),this.config.expandable&&(this.expandElement=$('<div class="expand-button icon i-fullscreen"></div>'),this.expandElement.appendTo(this.domElement))):this.inputElement=$("<input />"),this.inputElement.attr({"class":"toolbar-text-input",maxlength:this.config.maxlength,placeholder:this.config.placeholder}),this.inputElement.appendTo(this.domElement)},bind:function(){this._super(),this.inputElement.on("input",this.onInputChange.bind(this)),this.expandElement&&this.expandElement.on("vclick",this.onExpandClicked.bind(this))},focus:function(){this.inputElement.focus()},expand:function(){this.editor||(this.editor=SL.popup.open(SL.components.popup.CodeEditor,{title:this.config.editorTitle,mode:this.config.editorMode,value:this.getValue()}),this.editor.saved.add(function(t){this.setValue(t),this.writeToBlock(),this.editor=null}.bind(this)),this.editor.closed.add(function(){this.editor=null}.bind(this)))},destroy:function(){this.editor&&(this.editor.destroy(),this.editor=null),this._super()},setValue:function(t){this.inputElement.val(t),this._super(t)},getValue:function(){return this.inputElement.val()},onInputChange:function(){"number"==typeof this.config.writeDelay?this.writeToBlockAfter(this.config.writeDelay):this.writeToBlock()},onExpandClicked:function(){this.expand()}}),SL("editor.components.toolbars.options").Toggle=SL.editor.components.toolbars.options.Value.extend({init:function(t,e){this._super(t,e)},render:function(){this._super(),this.domElement.addClass("toolbar-toggle")},bind:function(){this._super()},setValue:function(t,e){this.domElement.attr("data-value",t),this._super(t,e)},onClicked:function(t){t.preventDefault(),this.setValue(!this.getValue(),!0)}}),SL("editor.components.toolbars.options").AnimationPreview=SL.editor.components.toolbars.options.Button.extend({init:function(t,e){this._super(t,$.extend({title:"Preview"},e))},onClicked:function(t){this._super(t),SL.deck.Animation.preview(this.blocks.map(function(t){return t.contentElement.get(0)}))}}),SL("editor.components.toolbars.options").AnimationTriggerID=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"animation-trigger-id",label:"Trigger element",property:"attribute.data-animation-trigger-id",panelWidth:200,panelMaxHeight:500,panelClassName:"trigger-ids",items:this.generateItemList.bind(this)},e)),this.onBlockMouseEnter=this.onBlockMouseEnter.bind(this),this.onBlockMouseLeave=this.onBlockMouseLeave.bind(this),this.onBlockMouseDown=this.onBlockMouseDown.bind(this)},generateItemList:function(){var t=[],e=1===this.blocks.length;return t.push({value:"self",title:"Self"}),SL.editor.controllers.Blocks.sortByOrderOfAppearance(null,{recursive:!0}).forEach(function(i){if(!e||this.block.getID()!==i.getID()){var n=i.getType(),o={value:i.getID()};if(o.title=SL.editor.controllers.Blocks.getBlockDefinitionByType(n).label,"function"==typeof i.createThumbnail)o.thumbnailElement=i.createThumbnail({width:26,height:26});else{var r="function"==typeof i.getLabel?i.getLabel():null;"string"==typeof r&&/\w{1,}/gi.test(r)&&(o.subtitle=r)}t.push(o)}}.bind(this)),t},renderPanel:function(){this._super.apply(this,arguments),this.panel.getContentElement().on("mouseleave",this.onPanelMouseOut.bind(this)),this.getListElements().on("mouseenter",this.onItemMouseOver.bind(this))},focusItem:function(t){this._super(t),this.highlightBlock(t.attr("data-value"))},resetHighlight:function(){this.panel.isVisible()&&this.highlightBlock(this.getValue())},highlightBlock:function(t){if(t){this.highlightElement||(this.highlightElement=$('<div class="sl-block-highlight editing-ui"></div>')),"self"===t&&(t=this.block.getID());var e=SL.editor.controllers.Blocks.getBlockByID(t);if(e){var i=e.measure();this.highlightElement.css({transform:e.getCSSTransform(),left:i.x,top:i.y,width:i.width,height:i.height}).appendTo(Reveal.getCurrentSlide())}}},removeHighlight:function(){this.highlightElement&&this.highlightElement.remove()},onItemMouseOver:function(t){this.highlightBlock($(t.currentTarget).attr("data-value"))},onPanelMouseOut:function(){this.resetHighlight()},onPanelShown:function(){this._super.apply(this,arguments),this.resetHighlight(),$(".reveal section.present").on("mouseenter",".sl-block",this.onBlockMouseEnter),$(".reveal section.present").on("mouseleave",".sl-block",this.onBlockMouseLeave),$(".reveal section.present").on("mousedown touchstart",".sl-block",this.onBlockMouseDown),$("html").addClass("pulse-all-blocks")},onPanelHidden:function(){this._super.apply(this,arguments),this.removeHighlight(),$(".reveal section.present").off("mouseenter",".sl-block",this.onBlockMouseEnter),$(".reveal section.present").off("mouseleave",".sl-block",this.onBlockMouseLeave),$(".reveal section.present").off("mousedown touchstart",".sl-block",this.onBlockMouseDown),$("html").removeClass("pulse-all-blocks")},onBlockMouseEnter:function(t){var e=$(t.currentTarget).attr("data-block-id");e===this.block.getID()&&(e="self"),e&&this.focusItem(this.getListElementByValue(e))},onBlockMouseLeave:function(){this.removeHighlight(),this.clearFocus()},onBlockMouseDown:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=$(t.currentTarget).attr("data-block-id");e===this.block.getID()&&(e="self"),e&&this.setValue(e,!0)},destroy:function(){this.removeHighlight(),$(".reveal section.present").off("mouseenter",".sl-block",this.onBlockMouseEnter),$(".reveal section.present").off("mouseleave",".sl-block",this.onBlockMouseLeave),$(".reveal section.present").off("mousedown touchstart",".sl-block",this.onBlockMouseDown),$("html").removeClass("pulse-all-blocks"),this._super.apply(this,arguments)}}),SL("editor.components.toolbars.options").AnimationTrigger=SL.editor.components.toolbars.options.Radio.extend({init:function(t,e){this._super(t,$.extend({type:"animation-trigger",label:"Trigger",property:"attribute.data-animation-trigger",items:function(){return this.block.getPropertySettings("attribute.data-animation-trigger").options}.bind(this)},e))}}),SL("editor.components.toolbars.options").AnimationType=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"animation-type",label:"Effect",property:"attribute.data-animation-type",items:function(){return this.block.getPropertySettings("attribute.data-animation-type").options}.bind(this)},e))},renderPanel:function(){this._super.apply(this,arguments),this.previewElement=$('<div class="animation-preview"></div>'),this.previewElement.appendTo(this.panel.domElement),this.previewInnerElement=$('<div class="animation-preview-inner"></div>'),this.previewInnerElement.appendTo(this.previewElement),this.panel.getContentElement().on("mouseleave",this.onPanelMouseOut.bind(this)),this.getListElements().on("mouseenter",this.onItemMouseOver.bind(this))},onItemMouseOver:function(t){var e=$(t.currentTarget).attr("data-value");e&&(this.previewElement.addClass("visible"),this.previewInnerElement.attr("data-animation-type",e).css("transition-duration","").removeClass("animate"),setTimeout(function(){this.previewInnerElement.css("transition-duration",this.block.get("style.transition-duration")+"s").addClass("animate")}.bind(this),100))},onPanelMouseOut:function(){this.previewElement.removeClass("visible")}}),SL("editor.components.toolbars.options").AutoAnimateDelay=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"auto-animate-delay",label:"Delay",property:"attribute.data-auto-animate-delay",fadeDefaultValue:!0},e))}}),SL("editor.components.toolbars.options").AutoAnimateDuration=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"auto-animate-duration",label:"Duration",property:"attribute.data-auto-animate-duration",fadeDefaultValue:!0},e))},readFromBlock:function(){this.block.isset(this.config.property)?this.setValue(this.block.get(this.config.property)):this.setValue(this.getDefaultValue())},setBlockValue:function(t){t===this.getDefaultValue()?this.blocks.forEach(function(t){t.unset(this.config.property)},this):this.blocks.forEach(function(e){e.set(this.config.property,t)},this)},getDefaultValue:function(){if("undefined"==typeof this._defaultValue){var t=parseFloat(Reveal.getCurrentSlide().dataset.autoAnimateDuration);isNaN(t)?this._defaultValue=SL.config.AUTO_ANIMATE_DURATION_DEFAULT/1e3:this._defaultValue=t}return this._defaultValue}}),SL("editor.components.toolbars.options").AutoAnimateEasing=SL.editor.components.toolbars.options.Easing.extend({init:function(t,e){this._super(t,$.extend({type:"auto-animate-easing",label:"Easing",property:"attribute.data-auto-animate-easing"},e))},readFromBlock:function(){this.block.isset(this.config.property)?this.setValue(this.block.get(this.config.property)):this.setValue(this.getDefaultValue())},setBlockValue:function(t){t===this.getDefaultValue()?this.blocks.forEach(function(t){t.unset(this.config.property)},this):this.blocks.forEach(function(e){e.set(this.config.property,t)},this)},getDefaultValue:function(){if("undefined"==typeof this._defaultValue){var t=Reveal.getCurrentSlide().dataset.autoAnimateEasing;"string"==typeof t&&t.length>1?this._defaultValue=t:this._defaultValue=SL.config.AUTO_ANIMATE_EASING_DEFAULT}return this._defaultValue}}),SL("editor.components.toolbars.options").Back=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){this._super(t,$.extend({type:"back",icon:"arrow-up",tooltip:"Go back"},e))},onClicked:function(t){this._super(t),SL.view.toolbars.pop()}}),SL("editor.components.toolbars.options").BackgroundColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"background-color",label:"Bg Color",property:"style.background-color",alpha:!0},e))},getColorpickerConfig:function(){var t=this._super.apply(this,arguments),e=tinycolor(this.getValue()).toRgb();return 0===e.r&&0===e.g&&0===e.b&&0===e.a&&(t.color="#000000"),t}}),SL("editor.components.toolbars.options").BlockActions=SL.editor.components.toolbars.options.Multi.extend({init:function(t,e){this._super(t,$.extend({type:"block-actions",label:"Actions",items:function(){var t=[{value:"duplicate",iconScale:1.1,icon:"content_copy",tooltip:SL.keyboard.getEditorShortcut("DUPLICATE").tooltip},{value:"delete",iconScale:1.1,icon:"trash",tooltip:SL.keyboard.getEditorShortcut("DELETE").tooltip},{value:"lock",iconScale:1.1,icon:"lock-stroke"}];return 1===this.blocks.length&&this.block.hasPlugin(SL.editor.blocks.plugin.HTML)&&t.unshift({value:"html",iconScale:1.1,icon:"file-xml",tooltip:"Edit HTML"}),1===this.blocks.length&&this.block.options.horizontalResizing&&this.block.options.verticalResizing&&t.length<4&&t.unshift({value:"expand",iconScale:1.1,icon:"crop_free",tooltip:"Maximize"}),t}.bind(this)},e)),this.syncUI=this.syncUI.bind(this),this.syncUI(),this.block.watch("attribute.data-locked",this.syncUI)},syncUI:function(){var t=this.getItemByValue("lock"),e=this.block.isLocked();t.toggleClass("on",e).attr("data-tooltip",(e?"Unlock":"Lock")+' <span class="keyboard-shortcut">'+SL.keyboard.getEditorShortcut("LOCK").shortcut+"</span>"),t.find(".icon").removeClass("i-lock-stroke i-unlock-stroke").addClass(e?"i-unlock-stroke":"i-lock-stroke")},trigger:function(t){if("html"===t)SL.editor.controllers.Blocks.getFocusedBlocks()[0].editHTML(),SL.analytics.trackEditor("edit_block_html");else if("expand"===t)SL.editor.controllers.Blocks.maximizeBlocks(),SL.analytics.trackEditor("toolbar_expand_block");else if("duplicate"===t)SL.editor.controllers.Blocks.duplicateBlocks(),SL.analytics.trackEditor("toolbar_duplicate_block");else if("delete"===t)SL.editor.controllers.Blocks.removeBlocks(),SL.analytics.trackEditor("toolbar_delete_block");else if("lock"===t){t=!this.block.isLocked();this.blocks.forEach(function(e){e.set("attribute.data-locked",t)}),SL.analytics.trackEditor("toolbar_toggle_lock")}},destroy:function(){this.block.unwatch("attribute.data-locked",this.syncUI),this._super()}}),SL("editor.components.toolbars.options").BlockAlignHorizontal=SL.editor.components.toolbars.options.Multi.extend({init:function(t,e){this._super(t,$.extend({type:"block-align-horizontal",label:"Alignment",items:[{value:"left",icon:"alignleftedges"},{value:"horizontal-center",icon:"alignhorizontalcenters"},{value:"right",icon:"alignrightedges"}]},e))},trigger:function(t){this._super(t);var e=SL.editor.controllers.Blocks.getFocusedBlocks();e.length<2&&this.block.isGroup()?(SL.editor.controllers.Blocks.align(this.block.getBlocks(),t),this.block.paint()):SL.editor.controllers.Blocks.align(e,t)}}),SL("editor.components.toolbars.options").BlockAlignVertical=SL.editor.components.toolbars.options.BlockAlignHorizontal.extend({init:function(t,e){this._super(t,$.extend({type:"block-align-vertical",label:null,items:[{value:"top",icon:"aligntopedges"},{value:"vertical-center",icon:"alignverticalcenters"},{
value:"bottom",icon:"alignbottomedges"}]},e))}}),SL("editor.components.toolbars.options").BlockDepth=SL.editor.components.toolbars.options.Multi.extend({init:function(t,e){this._super(t,$.extend({type:"block-depth",label:"Depth",items:[{value:"back",icon:"chevron-down",iconScale:1.4,tooltip:SL.keyboard.getEditorShortcut("SEND_TO_BACK").tooltip},{value:"front",icon:"chevron-up",iconScale:1.4,tooltip:SL.keyboard.getEditorShortcut("BRING_TO_FRONT").tooltip}]},e))},trigger:function(t){"front"===t?SL.editor.controllers.Blocks.moveBlocksToDepth(SL.editor.controllers.Blocks.getFocusedBlocks(),"front"):"back"===t&&SL.editor.controllers.Blocks.moveBlocksToDepth(SL.editor.controllers.Blocks.getFocusedBlocks(),"back")}}),SL("editor.components.toolbars.options").BlockLayout=SL.editor.components.toolbars.options.Multi.extend({init:function(t,e){this._super(t,$.extend({type:"block-layout",label:"Layout",items:[{value:"row",icon:"ellipsis-h",tooltip:"Row"},{value:"column",icon:"ellipsis-v",tooltip:"Column"}]},e))},trigger:function(t){var e=0,i=SL.prompt({anchor:this.innerElement,alignment:"r",title:"Spacing between each element",type:"range",cancelLabel:"",confirmLabel:"Done",data:{value:e,minValue:0,maxValue:300,unit:"px",width:250}}),n=SL.editor.controllers.Blocks.getFocusedBlocksInVisualOrder({dominantAxis:"row"===t?"x":"y"});SL.editor.controllers.Blocks.layout(n,t,e),i.rangeInput.changed.add(function(i){("number"!=typeof(i=parseFloat(i))||isNaN(i))&&(i=e),SL.editor.controllers.Blocks.layout(n,t,i)}.bind(this))}}),SL("editor.components.toolbars.options").BlockName=SL.editor.components.toolbars.options.Text.extend({init:function(t,e){this._super(t,$.extend({type:"block-name",label:"Block Name",property:"attribute.data-name",watchBlock:!0,helpTooltip:"Used to match blocks across slides for auto-animation."},e))}}),SL("editor.components.toolbars.options").Blur=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"blur",label:"Blur",property:"filter.blur-radius"},e))}}),SL("editor.components.toolbars.options").BorderColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"border-color",label:"Color",property:"style.border-color"},e))}}),SL("editor.components.toolbars.options").BorderRadius=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"border-radius",label:"Radius",property:"style.border-radius"},e))}}),SL("editor.components.toolbars.options").BorderStyle=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"border-style",panelType:"line-style",panelWidth:"anchor-width",label:"Style",property:"style.border-style",items:function(){return this.block.getPropertySettings("style.border-style").options}.bind(this)},e))},renderItem:function(t){var e=$('<div class="toolbar-select-item" data-value="'+t.value+'">');e.appendTo(this.panel.contentElement),this.createPreviewSVG(e,t.value,126,40)},displaySelectedValue:function(){this.triggerElement.find("svg").remove(),this.createPreviewSVG(this.triggerElement,this.value,126,36)},createPreviewSVG:function(t,e,i,n){var o=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg");o.setAttribute("xmlns",SL.editor.util.SVG.NAMESPACE),o.setAttribute("version","1.1"),o.setAttribute("width",i),o.setAttribute("height",n),o.setAttribute("viewBox","0 0 "+i+" "+n),o.setAttribute("preserveAspectRatio","xMidYMid"),SL.editor.blocks.Line.generate(o,{interactive:!1,startType:null,endType:null,style:e,color:"#333333",width:4,x1:0,y1:n/2,x2:i,y2:n/2}),t.append(o)}}),SL("editor.components.toolbars.options").BorderWidth=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"border-width",label:"Width",property:"style.border-width"},e))}}),SL("editor.components.toolbars.options").ClassName=SL.editor.components.toolbars.options.Text.extend({init:function(t,e){this._super(t,$.extend({type:"class-name",label:"Class name",property:"attribute.class",helpTooltip:"Adds a class name to the underlying HTML element. Useful for targeting elements with custom CSS."},e))}}),SL("editor.components.toolbars.options").CodeAutoHeight=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"code-autoheight",label:"Automatic Height",property:"attribute.data-code-autoheight"},e))}}),SL("editor.components.toolbars.options").CodeFrame=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"code-frame",label:"Frame",property:"code.frame",items:function(){return this.block.getPropertySettings("code.frame").options}.bind(this),panelType:"code-frame",panelMaxHeight:720},e))}}),SL("editor.components.toolbars.options").CodeLanguage=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"code-language",label:"Language",property:"code.language",items:function(){return this.block.getPropertySettings("code.language").options}.bind(this),panelMaxHeight:600},e))}}),SL("editor.components.toolbars.options").CodeLineHighlights=SL.editor.components.toolbars.options.SplitText.extend({init:function(t,e){this._super(t,$.extend({type:"code-line-highlights",label:"Code highlights",property:"code.line-numbers",delimiter:Reveal.getPlugin("highlight").HIGHLIGHT_STEP_DELIMITER,addRowLabel:"Add highlight step",placeholder:"1,4,10-15",helpTooltip:"A comma separated list of lines to highlight. Line ranges like 10-15 are supported.<br><br>Add multiple highlights to step through them one by one while presenting."},e))},previewStep:function(t){"number"==typeof t&&t>-1&&this.blocks.forEach(function(e){e.previewHighlightStep(t)})},resetPreview:function(){this.blocks.forEach(function(t){t.previewHighlightStep(null)})},onInputFocus:function(t){this.previewStep($(t.target).closest(".input-row").index())},onInputBlur:function(){this.resetPreview()},destroy:function(){this.resetPreview(),this._super.apply(this,arguments)}}),SL("editor.components.toolbars.options").CodeSize=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"code-size",label:"Text Size",property:"style.font-size",progressbar:!1},e))}}),SL("editor.components.toolbars.options").CodeTheme=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"code-theme",label:"Highlight Theme",property:"code.theme",items:function(){return this.block.getPropertySettings("code.theme").options}.bind(this),panelType:"code-theme",panelWidth:180,panelMaxHeight:720},e)),this.startThemePreview=this.startThemePreview.bind(this),this.stopThemePreview=this.stopThemePreview.bind(this)},onPanelShown:function(){this._super(),this.getListElements().on("mouseenter",this.startThemePreview),this.getListElements().on("mouseleave",this.stopThemePreview)},onPanelHidden:function(){this._super(),this.stopThemePreview(),this.getListElements().off("mouseenter",this.startThemePreview),this.getListElements().off("mouseleave",this.stopThemePreview)},startThemePreview:function(t){this.previewing=!0;var e=t.currentTarget.getAttribute("data-value");this.blocks.forEach(function(t){t.startThemePreview(e)},this)},stopThemePreview:function(){this.previewing&&(this.previewing=!1,this.blocks.forEach(function(t){t.stopThemePreview()},this))},destroy:function(){this.getListElements().off("mouseenter",this.startThemePreview),this.getListElements().off("mouseleave",this.stopThemePreview),!0===this.previewing&&this.stopThemePreview(),this._super()}}),SL("editor.components.toolbars.options").CodeWrap=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"code-wrap",label:"Word wrap",property:"attribute.data-code-wrap"},e))}}),SL("editor.components.toolbars.options").Code=SL.editor.components.toolbars.options.Text.extend({init:function(t,e){this._super(t,$.extend({type:"code",label:"Code",property:"code.value",placeholder:"Paste code to syntax highlight...",multiline:!0,expandable:!0,maxlength:1e7,editorTitle:"Edit Code"},e))},bind:function(){this._super(),this.block&&(this.onEditingRequested=this.onEditingRequested.bind(this),this.block.editingRequested.add(this.onEditingRequested))},destroy:function(){this.block&&this.block.editingRequested.remove(this.onEditingRequested),this._super()},expand:function(){var t=this.block.getCodeLanguageDefinition();t&&"string"==typeof t.mime?(this.config.editorMode=t.mime,this.config.editorTitle="Edit "+t.title):(this.config.editorMode=null,this.config.editorTitle="Edit Code"),this._super.apply(this,arguments)},onEditingRequested:function(){this.expand()}}),SL("editor.components.toolbars.options").Divider=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){this._super(t,$.extend({type:"divider"},e)),this.domElement.addClass("toolbar-divider")}}),SL("editor.components.toolbars.options").GroupTitle=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){var i=SL.editor.controllers.Blocks.getFocusedBlocks()[0].getNestedBlocks().length;this._super(t,$.extend({type:"group-title",label:'<strong>Group</strong><span class="align-right">'+i+SL.util.string.pluralize(" block","s",i>1)+"</span>"},e))}}),SL("editor.components.toolbars.options").HTML=SL.editor.components.toolbars.options.Button.extend({init:function(t,e){this._super(t,$.extend({title:"Edit HTML",property:"html.value"},e))},onClicked:function(t){this._super(t),this.block.editHTML()}}),SL("editor.components.toolbars.options").IframeAutoplay=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"iframe-autoplay",label:"Autoplay",property:"iframe.autoplay"},e)),this.updateVisibility()},bind:function(){this._super(),this.block&&(this.updateVisibility=this.updateVisibility.bind(this),this.block.iframeSourceChanged.add(this.updateVisibility))},setValue:function(t,e){this._super(t,e)},updateVisibility:function(){var t=this.block.get("iframe.src");t&&(/^.*(youtube\.com\/embed\/)/.test(t)||/^.*(player\.vimeo.com\/)/.test(t))?this.domElement.show():this.domElement.hide()},destroy:function(){this.block&&!this.block.destroyed&&this.block.iframeSourceChanged.remove(this.updateVisibility),this._super()}}),SL("editor.components.toolbars.options").IframePreload=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"iframe-preload",label:"Preload",property:"attribute.data-preload"},e)),this.setTooltip("Load the iframe a few slides before it becomes visible. Not suitable for autoplaying content.",{alignment:"r",maxwidth:220})},setValue:function(t,e){SL.editor.blocks.Iframe.defaultPreload=t,this._super(t,e)}}),SL("editor.components.toolbars.options").IframeSRC=SL.editor.components.toolbars.options.Text.extend({init:function(t,e){this._super(t,$.extend({type:"iframe-src",label:"Iframe Source",property:"iframe.src",placeholder:"URL or <iframe>...",multiline:!0,maxlength:2e3},e))},bind:function(){this._super(),this.block&&(this.onEditingRequested=this.onEditingRequested.bind(this),this.block.editingRequested.add(this.onEditingRequested))},destroy:function(){this.block&&this.block.editingRequested.remove(this.onEditingRequested),this._super()},writeToBlock:function(){var t=this.getValue().trim();SL.util.string.URL_REGEX.test(t)?this.block.set(this.config.property,t):this.block.set(this.config.property,"")},onInputChange:function(){var t=this.getValue(),e=SL.util.string.formatIframeSource(t);e!==t&&this.setValue(e),this.writeToBlock()},onEditingRequested:function(){this.focus()}}),SL("editor.components.toolbars.options").ImageActions=SL.editor.components.toolbars.options.Multi.extend({init:function(t,e){this._super(t,$.extend({type:"image-actions",wrap:2,items:[{value:"crop",icon:"crop",tooltip:"Crop",iconScale:1.2},{value:"rotate-ccw",icon:"rotate_90_degrees_ccw",tooltip:"Rotate 90&ordm;",iconScale:1.2},{value:"alt-text",title:"Alt",tooltip:"Image description (alt text)"},{value:"natural-size",title:"1:1",tooltip:"Set natural size"}]},e)),this.syncUI=this.syncUI.bind(this),this.syncUI(),this.block.watch("image.alt",this.syncUI),this.block.watch("image.crop-rect",this.syncUI),this.block.imageStateChanged.add(this.syncUI)},syncUI:function(){this.domElement.toggle(!this.block.isEmpty()),this.getItemByValue("crop").toggleClass("on",this.block.isCropped()),this.getItemByValue("alt-text").toggleClass("on",this.block.isset("image.alt"));var t=this.getItemByValue("natural-size");t.on("mouseover",function(){var e=this.block.getNaturalSize();t.attr("data-tooltip",SL.locale.get("SET_NATURAL_IMAGE_SIZE",e))}.bind(this))},trigger:function(t){if("crop"===t)this.block.showCropper();else if("rotate-ccw"===t){var e=this.block.get("transform.rotate");e=(e=((e=90*Math.round(e/90))-90)%360)<0?360+e:e,this.block.set("transform.rotate",e)}else if("alt-text"===t){SL.prompt({anchor:this.getItemByValue("alt-text"),title:"Image description",subtitle:"Describe the image contents. This description is used if the image fails to load or if the viewer uses a screen reader.",type:"input",confirmLabel:"Save",alignment:"r",data:{value:this.block.get("image.alt")||"",placeholder:"",width:400}}).confirmed.add(function(t){this.block.set("image.alt",t)}.bind(this))}else"natural-size"===t&&this.block.setNaturalSize()},destroy:function(){this.block.unwatch("image.alt",this.syncUI),this.block.unwatch("image.crop-rect",this.syncUI),this.block.imageStateChanged&&this.block.imageStateChanged.remove(this.syncUI),this._super()}}),SL("editor.components.toolbars.options").ImageInlineSVG=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"image-inline-svg",label:"Inline SVG",property:"attribute.data-inline-svg",watchBlock:!0},e)),this.sync=this.sync.bind(this),this.block.imageURLChanged.add(this.sync)},sync:function(){this.block.isSVG()?this.domElement.show():this.domElement.hide()},destroy:function(){this.block.imageURLChanged&&this.block.imageURLChanged.remove(this.sync),this._super()}}),SL("editor.components.toolbars.options").ImageMaintainAR=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"image-maintain-ar",label:"Retain aspect ratio",property:"attribute.data-maintain-ar"},e))}}),SL("editor.components.toolbars.options").ImageSVGFillColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"image-fill-color",label:"Fill Color",property:"attribute.data-image-fill-color",alpha:!0},e)),this.sync=this.sync.bind(this),this.block.imageURLChanged.add(this.sync)},sync:function(){this.block.isInlineSVG()?(this.hidden=!1,this.domElement.show()):(this.hidden=!0,this.domElement.hide())},destroy:function(){this.block.imageURLChanged&&this.block.imageURLChanged.remove(this.sync),this._super()}}),SL("editor.components.toolbars.options").Image=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){this._super(t,$.extend({type:"image",labe:"Image"},e)),this.syncUI()},render:function(){this._super(),this.domElement.addClass("toolbar-image"),this.innerElement=$('<div class="toolbar-image-inner">').appendTo(this.domElement),this.placeholderElement=$('<div class="toolbar-image-placeholder">').appendTo(this.innerElement),this.labelElement=$('<div class="toolbar-image-label">Select</div>').appendTo(this.innerElement),this.optionsElement=$('<div class="toolbar-image-options"></div>').appendTo(this.innerElement),this.urlElement=$('<div class="toolbar-image-option toolbar-image-url icon i-link" data-tooltip="Image URL"></div>').appendTo(this.optionsElement),this.spinnerElement=$(['<div class="toolbar-image-progress">','<span class="spinner centered"></span>',"</div>"].join("")).appendTo(this.innerElement)},bind:function(){this._super(),this.onMediaLibrarySelection=this.onMediaLibrarySelection.bind(this),this.syncUI=this.syncUI.bind(this),this.block.imageStateChanged.add(this.syncUI),this.innerElement.on("vclick",function(t){if(1===$(t.target).closest(".toolbar-image-url").length)this.onEditURLClicked(t);else{var e=SL.popup.open(SL.components.medialibrary.MediaLibrary,{select:SL.models.Media.IMAGE});e.selected.addOnce(this.onMediaLibrarySelection),e.selectedExternal.addOnce(this.onMediaLibrarySelection)}}.bind(this))},syncUI:function(){if(this.block.hasSource()){var t=this.block.get("image.src");this.innerElement.css("background-image",'url("'+t+'")',""),this.labelElement.text("Replace"),this.placeholderElement.hide(),this.urlElement.toggle(0!==t.search(SL.config.S3_HOST))}else this.innerElement.css("background-image",""),this.labelElement.text("Select"),this.placeholderElement.show(),this.urlElement.show();this.block.isLoading()||this.block.isUploading()?(this.spinnerElement.show(),SL.util.html.generateSpinners()):this.spinnerElement.hide()},onEditURLClicked:function(t){t.preventDefault(),SL.prompt({anchor:this.urlElement,title:"Image URL",type:"input",confirmLabel:"Save",alignment:"r",data:{value:this.block.get("image.src"),placeholder:"http://...",width:400}}).confirmed.add(function(t){this.block.set("image.src",t),this.syncUI()}.bind(this))},onMediaLibrarySelection:function(t){"string"==typeof t?this.block.set("image.src",t):this.block.setMediaModel(t),this.syncUI()},destroy:function(){this.block.imageStateChanged&&this.block.imageStateChanged.remove(this.syncUI),this._super()}}),SL("editor.components.toolbars.options").LetterSpacing=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"letter-spacing",label:"Letter spacing",property:"style.letter-spacing",progressbar:!1},e))}}),SL("editor.components.toolbars.options").LineColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"line-color",label:"Color",property:"attribute.data-line-color"},e))}}),SL("editor.components.toolbars.options").LineEndType=SL.editor.components.toolbars.options.SelectLineType.extend({init:function(t,e){this._super(t,$.extend({type:"line-end-type",panelType:"line-end-type",label:"End",property:"attribute.data-line-end-type",items:function(){return this.block.getPropertySettings("attribute.data-line-end-type").options}.bind(this)},e))}}),SL("editor.components.toolbars.options").LineHeight=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"line-height",label:"Line Height",property:"style.line-height",progressbar:!1},e))}}),SL("editor.components.toolbars.options").LineStartType=SL.editor.components.toolbars.options.SelectLineType.extend({init:function(t,e){this._super(t,$.extend({type:"line-start-type",panelType:"line-start-type",label:"Start",property:"attribute.data-line-start-type",items:function(){return this.block.getPropertySettings("attribute.data-line-start-type").options}.bind(this)},e))}}),SL("editor.components.toolbars.options").LineStyle=SL.editor.components.toolbars.options.BorderStyle.extend({init:function(t,e){this._super(t,$.extend({type:"line-style",panelType:"line-style",panelWidth:"auto",panelAlignment:"b",label:"Line Style",property:"attribute.data-line-style",items:function(){return this.block.getPropertySettings("attribute.data-line-style").options}.bind(this)},e))}}),SL("editor.components.toolbars.options").LineWidth=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"line-width",label:"Thickness",property:"attribute.data-line-width"},e))}}),SL("editor.components.toolbars.options").LinkType=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"link-type",property:"link.href",label:"Target",panelMaxHeight:600,items:this.getLinkTargets()},e))},getLinkTargets:function(){var t=[{value:"url",title:"Website"}],e=$(".reveal .slides section[id]").map(function(){var t=this.getAttribute("id");return{value:"#/"+t,title:t}});return e.length&&(t.push({value:"slide-names",title:"Named slides",type:"header"}),t=t.concat(e.toArray())),t.push({value:"slide-numbers",title:"Slides",type:"header"}),$(".reveal .slides>section").each(function(e,i){var n=i.querySelectorAll("section").length;if(n)for(var o=0;o<n;o++)t.push({value:"#/"+e+"/"+o,title:"Slide "+(e+1)+"."+(o+1)});else t.push({value:"#/"+e,title:"Slide "+(e+1)})}),t},writeToBlock:function(){var t=this.getValue().trim();SL.util.string.URL_REGEX.test(t)||/^#\/[a-zA-Z0-9]/.test(t)?this.blocks.forEach(function(e){e.set(this.config.property,t)},this):this.blocks.forEach(function(t){t.set(this.config.property,"")},this)},readFromBlock:function(){var t=this.block.get(this.config.property);this.hasValue(t)?this.setValue(t):this.setValue("url")},isURL:function(){var t=this.getValue();return!t||"url"===t}}),SL("editor.components.toolbars.options").LinkURL=SL.editor.components.toolbars.options.Text.extend({init:function(t,e){this._super(t,$.extend({type:"link-url",property:"link.href",placeholder:"http://",maxlength:5e3},e))},writeToBlock:function(){var t=this.getValue().trim(),e=/^#\/\d/.test(t),i=/^mailto\:/.test(t);e||i||/\:\/\//.test(t)||(t="http://"+t),SL.util.string.URL_REGEX.test(t)||e||i?this.blocks.forEach(function(e){e.set(this.config.property,t)},this):this.blocks.forEach(function(t){t.set(this.config.property,"")},this)}}),SL("editor.components.toolbars.options").MathColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"math-color",label:"Color",property:"style.color"},e))}}),SL("editor.components.toolbars.options").MathInput=SL.editor.components.toolbars.options.Text.extend({init:function(t,e){this._super(t,$.extend({type:"math",label:"Math",description:'Write math formulas using LaTeX. Also available inline. <a href="http://help.slides.com/knowledgebase/articles/446424" target="_blank">Learn more</a>',property:"math.value",placeholder:"Type/paste LaTeX...",multiline:!0,expandable:!0,maxlength:1e7,writeDelay:500,editorTitle:"Edit LaTeX",editorMode:"text/x-stex"},e))},bind:function(){this._super(),this.block&&(this.onEditingRequested=this.onEditingRequested.bind(this),this.block.editingRequested.add(this.onEditingRequested))},destroy:function(){this.block&&this.block.editingRequested.remove(this.onEditingRequested),this._super()},onEditingRequested:function(){this.expand()}}),SL("editor.components.toolbars.options").MathSize=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"text-size",label:"Scale",property:"style.font-size",progressbar:!1},e))},setValue:function(){this._super.apply(this,arguments),this.measurementsBeforeResize&&this.blocks.forEach(function(t,e){var i=this.measurementsBeforeResize[e];if(i){var n=t.measure().transformed,o=i.x+(i.width-n.width)/2,r=i.y+(i.height-n.height)/2;isNaN(o)||isNaN(r)||t.move({x:o,y:r})}},this)},onChangeStart:function(){this.measurementsBeforeResize=[],this.blocks.forEach(function(t){this.measurementsBeforeResize=t.measure().transformed},this),this._super.apply(this,arguments)},onChangeEnd:function(){this.measurementsBeforeResize=null,this._super.apply(this,arguments)}}),SL("editor.components.toolbars.options").Opacity=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"opacity",label:"Opacity",property:"style.opacity"},e))}}),SL("editor.components.toolbars.options").Padding=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"padding",label:"Padding",property:"style.padding",watchBlock:!0},e))},syncPaddingHint:function(){this.isChanging()||this.isFocused()?this.blocks.forEach(function(t){t.showPaddingHint()},this):this.blocks.forEach(function(t){t.hidePaddingHint()},this)},writeToBlock:function(){this._super.apply(this,arguments),this.syncPaddingHint()},onMouseMove:function(){this._super.apply(this,arguments),this.syncPaddingHint()},onMouseUp:function(){this._super.apply(this,arguments),this.syncPaddingHint()},onInputFocused:function(){this._super.apply(this,arguments),this.syncPaddingHint()},onInputBlurred:function(){this._super.apply(this,arguments),this.syncPaddingHint()}}),SL("editor.components.toolbars.options").Rotation=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"rotation",label:"Rotation",property:"transform.rotate",watchBlock:!0,loop:!0,progressbar:!1},e))}}),SL("editor.components.toolbars.options").ShapeCornerRadius=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"shape-corner-radius",label:"Corner radius",property:"attribute.data-shape-corner-radius"},e))},sync:function(){this.domElement.toggle(this.block.supportsCornerRadius())}}),SL("editor.components.toolbars.options").ShapeFillColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"shape-fill-color",label:"Color",property:"attribute.data-shape-fill-color",alpha:!0},e))}}),SL("editor.components.toolbars.options").ShapeStretch=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"shape-stretch",label:"Stretch to Fill",property:"attribute.data-shape-stretch"},e))}}),SL("editor.components.toolbars.options").ShapeStrokeColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"shape-stroke-color",label:"Color",property:"attribute.data-shape-stroke-color"},e))}}),SL("editor.components.toolbars.options").ShapeStrokeWidth=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"shape-stroke-width",label:"Width",property:"attribute.data-shape-stroke-width"},e))}}),SL("editor.components.toolbars.options").ShapeType=SL.editor.components.toolbars.options.Select.extend({init:function(t,e){this._super(t,$.extend({type:"shape-type",panelType:"shape-type",panelWidth:246,panelMaxHeight:430,label:"Shape",property:"attribute.data-shape-type",items:function(){return this.block.getPropertySettings("attribute.data-shape-type").options}.bind(this)},e))},renderPanel:function(){this._super.apply(this,arguments)},renderItem:function(t){var e=32,i=32,n=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg");n.setAttribute("xmlns",SL.editor.util.SVG.NAMESPACE),n.setAttribute("version","1.1"),n.setAttribute("width",e),n.setAttribute("height",i),n.setAttribute("preserveAspectRatio","xMidYMid");var o=SL.editor.blocks.Shape.shapeFromType(t.value);o.setAttribute("fill","#333333"),n.appendChild(o);var r=$('<div class="toolbar-select-item" data-value="'+t.value+'">');r.append(n),r.appendTo(this.panel.contentElement);var s=SL.editor.util.SVG.boundingBox(o);n.setAttribute("viewBox",[Math.round(s.x)||0,Math.round(s.y)||0,Math.round(s.width)||32,Math.round(s.height)||32].join(" "))},displaySelectedValue:function(){var t=32,e=32,i=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg");i.setAttribute("xmlns",SL.editor.util.SVG.NAMESPACE),i.setAttribute("version","1.1"),i.setAttribute("width",t),i.setAttribute("height",e),i.setAttribute("preserveAspectRatio","xMidYMid");var n=SL.editor.blocks.Shape.shapeFromType(this.value,t,e);n.setAttribute("fill","#ffffff"),i.appendChild(n),this.triggerElement.find("svg").remove(),this.triggerElement.append(i);var o=SL.editor.util.SVG.boundingBox(n);i.setAttribute("viewBox",[Math.round(o.x)||0,Math.round(o.y)||0,Math.round(o.width)||32,Math.round(o.height)||32].join(" "))}}),SL("editor.components.toolbars.options").SVGFillColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"svg-fill-color",label:"Fill Color",property:"svg.fill",alpha:!0},e))}}),SL("editor.components.toolbars.options").TableBorderColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"table-border-color",label:"Border color",property:"attribute.data-table-border-color",alpha:!0},e))},getTriggerColor:function(){return this.block.getTableBorderColor()}}),SL("editor.components.toolbars.options").TableBorderWidth=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"table-border-width",label:"Border width",property:"attribute.data-table-border-width"},e))}}),SL("editor.components.toolbars.options").TableCols=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"table-cols",label:"Cols",property:"attribute.data-table-cols",progressbar:!1},e)),this.onTableSizeChanged=this.onTableSizeChanged.bind(this),this.block.tableSizeChanged.add(this.onTableSizeChanged)},onTableSizeChanged:function(){this.readFromBlock()},destroy:function(){this.block.tableSizeChanged&&this.block.tableSizeChanged.remove(this.onTableSizeChanged),this._super()}}),SL("editor.components.toolbars.options").TableHasHeader=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"table-has-header",label:"Header",property:"attribute.data-table-has-header",tooltip:"The first table row is a header."},e))}}),SL("editor.components.toolbars.options").TablePadding=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"table-padding",label:"Cell padding",property:"attribute.data-table-padding"},e))}}),SL("editor.components.toolbars.options").TableRows=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"table-rows",label:"Rows",property:"attribute.data-table-rows",progressbar:!1},e)),this.onTableSizeChanged=this.onTableSizeChanged.bind(this),this.block.tableSizeChanged.add(this.onTableSizeChanged)},onTableSizeChanged:function(){this.readFromBlock()},destroy:function(){this.block.tableSizeChanged&&this.block.tableSizeChanged.remove(this.onTableSizeChanged),this._super()}}),SL("editor.components.toolbars.options").TextAlign=SL.editor.components.toolbars.options.Radio.extend({init:function(t,e){this._super(t,$.extend({type:"text-align",label:"Text Alignment",property:"style.text-align",items:function(){return this.block.getPropertySettings("style.text-align").options}.bind(this)},e))}}),SL("editor.components.toolbars.options").TextColor=SL.editor.components.toolbars.options.Color.extend({init:function(t,e){this._super(t,$.extend({type:"text-color",label:"Text Color",property:"style.color"},e))}}),SL("editor.components.toolbars.options").TextSize=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"text-size",label:"Text Scale",property:"style.font-size",progressbar:!1},e))}}),SL("editor.components.toolbars.options").TransformOrigin=SL.editor.components.toolbars.options.Direction.extend({init:function(t,e){this._super(t,$.extend({type:"transform-origin",label:"Transform origin",property:"style.transform-origin"},e))}}),SL("editor.components.toolbars.options").TransitionDelay=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"transition-delay",label:"Delay",property:"style.transition-delay",watchBlock:!0},e))}}),SL("editor.components.toolbars.options").TransitionDuration=SL.editor.components.toolbars.options.Stepper.extend({init:function(t,e){this._super(t,$.extend({type:"transition-duration",label:"Duration",property:"style.transition-duration"},e))}}),SL("editor.components.toolbars.options").VideoAutoplay=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"video-autoplay",label:"Autoplay",property:"video.autoplay"},e)),this.onVideoMutedChanged=this.onVideoMutedChanged.bind(this),Reveal.isFirstSlide()&&(this.block.watch("video.muted",this.onVideoMutedChanged),this.onVideoMutedChanged())},onVideoMutedChanged:function(){Reveal.isFirstSlide()&&!this.block.get("video.muted")?(this.domElement.addClass("disabled"),this.setTooltip("Please mute this video to enable autoplay. Videos with sound can not autoplay on the first slide.",{delay:0,alignment:"r",maxwidth:220})):(this.domElement.removeClass("disabled"),this.setTooltip(""))},destroy:function(){this.config.watchBlock&&this.block&&this.block.unwatch("video.muted",this.onVideoMutedChanged),this._super()}}),SL("editor.components.toolbars.options").VideoControls=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"video-controls",label:"Controls",property:"video.controls"},e))}}),SL("editor.components.toolbars.options").VideoLoop=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"video-loop",label:"Loop",property:"video.loop"
},e))}}),SL("editor.components.toolbars.options").VideoMuted=SL.editor.components.toolbars.options.Checkbox.extend({init:function(t,e){this._super(t,$.extend({type:"video-muted",label:"Mute",property:"video.muted"},e))}}),SL("editor.components.toolbars.options").Video=SL.editor.components.toolbars.options.Base.extend({init:function(t,e){this._super(t,$.extend({type:"video",labe:"Video"},e)),this.syncUI()},render:function(){this._super(),this.domElement.addClass("toolbar-video"),this.innerElement=$('<div class="toolbar-video-inner">').appendTo(this.domElement),this.placeholderElement=$('<div class="toolbar-video-placeholder">').appendTo(this.innerElement),this.labelElement=$('<div class="toolbar-video-label">Select</div>').appendTo(this.innerElement),this.urlElement=$('<div class="toolbar-video-url icon i-link" data-tooltip="Video URL"></div>').appendTo(this.innerElement),this.posterElement=$('<div class="toolbar-video-poster icon i-picture" data-tooltip="Replace poster image"></div>').appendTo(this.innerElement),this.spinnerElement=$(['<div class="toolbar-video-progress">','<span class="spinner centered"></span>',"</div>"].join("")).appendTo(this.innerElement)},bind:function(){this._super(),this.onMediaLibrarySelection=this.onMediaLibrarySelection.bind(this),this.onMediaLibraryPosterSelection=this.onMediaLibraryPosterSelection.bind(this),this.syncUI=this.syncUI.bind(this),this.block.videoStateChanged.add(this.syncUI),this.innerElement.on("vclick",function(t){if(1===$(t.target).closest(".toolbar-video-url").length)this.onEditURLClicked(t);else if(1===$(t.target).closest(".toolbar-video-poster").length){SL.popup.open(SL.components.medialibrary.MediaLibrary,{select:SL.models.Media.IMAGE}).selected.addOnce(this.onMediaLibraryPosterSelection)}else{SL.popup.open(SL.components.medialibrary.MediaLibrary,{select:SL.models.Media.VIDEO}).selected.addOnce(this.onMediaLibrarySelection)}}.bind(this))},syncUI:function(){this.block.isThumbnailReady()?(this.innerElement.css("background-image",'url("'+this.block.get("attribute.data-video-thumb")+'")',""),this.placeholderElement.hide()):(this.innerElement.css("background-image",""),this.placeholderElement.show(),this.urlElement.show()),this.block.isLoading()||this.block.isUploading()||this.block.isProcessing()?(this.spinnerElement.show(),SL.util.html.generateSpinners()):this.spinnerElement.hide()},onEditURLClicked:function(t){t.preventDefault(),SL.prompt({anchor:this.urlElement,title:"Video URL",type:"input",confirmLabel:"Save",alignment:"r",data:{value:this.block.get("video.src"),placeholder:"http://...",width:400}}).confirmed.add(function(t){this.block.clear(),this.block.set("video.src",t),this.syncUI()}.bind(this))},onMediaLibrarySelection:function(t){this.block.setMediaModel(t),this.syncUI()},onMediaLibraryPosterSelection:function(t){t.isUploaded()?(this.block.replacePosterURL(t.get("url")),this.syncUI()):t.uploadCompleted.addOnce(function(){this.block&&(this.block.replacePosterURL(t.get("url")),this.syncUI())}.bind(this))},destroy:function(){this.block.videoStateChanged&&this.block.videoStateChanged.remove(this.syncUI),this._super()}}),SL("editor.components.toolbars.util").Panel=Class.extend({init:function(t){this.options=$.extend({anchor:null,hitArea:null,className:null,width:"auto",height:"auto",maxHeight:"none",keydown:!1,offsetX:0,offsetY:0,alignment:"r"},t),this.render(),this.bind(),SL.editor.components.toolbars.util.Panel.INSTANCES.push(this)},render:function(){this.domElement=$('<div class="toolbar-panel">'),this.contentElement=$('<div class="toolbar-panel-content">').appendTo(this.domElement),this.arrowElement=$('<div class="toolbar-panel-arrow">').appendTo(this.domElement),this.contentElement.css({width:this.options.width,height:this.options.height,maxHeight:this.options.maxHeight}),this.domElement.attr("data-alignment",this.options.alignment),"string"==typeof this.options.className&&this.domElement.addClass(this.options.className),"string"==typeof this.options.type&&this.domElement.attr("data-panel-type",this.options.type),"number"==typeof this.options.height&&this.domElement.css("overflow","auto")},bind:function(){this.shown=new signals.Signal,this.hidden=new signals.Signal,this.isVisible=this.isVisible.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this),this.onContainerScrolled=$.throttle(this.layout.bind(this),16)},show:function(){SL.editor.components.toolbars.util.Panel.INSTANCES.forEach(function(t){t!==this&&t.isVisible()&&t.hide()}),this.domElement.appendTo(SL.view.toolbars.domElement),this.layout(),this.shown.dispatch(),"function"==typeof this.options.keydown&&SL.keyboard.keydown(this.options.keydown),$(document).on("click",this.onDocumentClick),this.options.anchor&&this.options.anchor.closest(".toolbar-list").on("scroll",this.onContainerScrolled)},hide:function(){this.domElement.detach(),this.hidden.dispatch(),SL.keyboard.release(this.options.keydown),this.options.anchor&&this.options.anchor.closest(".toolbar-list").off("scroll",this.onContainerScrolled)},toggle:function(){this.isVisible()?this.hide():this.show()},isVisible:function(){return this.domElement.parent().length>0},layout:function(){if(this.options.anchor&&"anchor-width"===this.options.width&&this.domElement.width(this.options.anchor.outerWidth()),this.options.anchor){var t=this.options.anchor.offset(),e=this.options.anchor.outerWidth(),i=this.options.anchor.outerHeight(),n=this.domElement.outerHeight(),o=10,r=t.left+this.options.offsetX-this.domElement.parent().offset().left,s=t.top+this.options.offsetY;if("b"===this.options.alignment?(r+=e/2-this.domElement.outerWidth()/2,s+=i):(s-=(n-i)/2,r+=e),s=Math.max(s,o),s=Math.min(s,window.innerHeight-n-o),this.domElement.css({left:r,top:s}),"b"===this.options.alignment)this.arrowElement.css({left:this.domElement.outerWidth()/2,top:""});else{var a=t.top-s+i/2;this.arrowElement.css({left:"",top:a}),this.arrowElement.toggle(a>o&&a<n-o)}}},getContentElement:function(){return this.contentElement},onDocumentClick:function(t){var e=$(t.target);0===e.closest(this.options.anchor).length&&0===e.closest(this.options.hitArea).length&&0===e.closest(this.domElement).length&&this.hide()},destroy:function(){$(document).off("click",this.onDocumentClick);for(var t=0;t<SL.editor.components.toolbars.util.Panel.INSTANCES.length;t++)SL.editor.components.toolbars.util.Panel.INSTANCES[t]===this&&SL.editor.components.toolbars.util.Panel.INSTANCES.splice(t,1);SL.keyboard.release(this.options.keydown),this.shown.dispose(),this.hidden.dispose(),this.domElement.remove()}}),SL.editor.components.toolbars.util.Panel.INSTANCES=[],SL("editor.controllers").API={forkDeck:function(){SL.helpers.PageLoader.show({message:"Duplicating..."}),$.ajax({type:"POST",url:SL.endpoints.FORK_DECK(SLConfig.deck.id),context:this}).done(function(t){t&&t.deck&&"string"==typeof t.deck.slug?window.location=SL.routes.DECK_EDIT(SL.current_user.get("username"),t.deck.slug):(SL.helpers.PageLoader.hide(),SL.notify(SL.locale.get("GENERIC_ERROR"),"negative"))}).fail(function(t){SL.helpers.PageLoader.hide(),t.responseJSON&&t.responseJSON.deck_limit?SL.components.prompts.showDeckLimitReached()["catch"](function(){SL.notify(SL.locale.get("GENERIC_ERROR"),"negative")}):SL.notify(SL.locale.get("GENERIC_ERROR"),"negative")})},deleteDeck:function(){SL.prompt({title:"You are deleting the full presentation.",subtitle:"Are you sure you want to do this?",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Delete my presentation</h3>",selected:!0,className:"negative",callback:function(){SL.helpers.PageLoader.show({message:"Deleting..."}),$.ajax({type:"POST",url:SL.endpoints.TRASH_DECK(SLConfig.deck.id),data:{},context:this}).done(function(){window.location=SL.current_user.getProfileURL()}).fail(function(){SL.notify(SL.locale.get("DECK_DELETE_ERROR"),"negative"),SL.helpers.PageLoader.hide()})}.bind(this)}]})}},SL("editor.controllers").AutoAnimate={enable:function(t,e){var i=SL.editor.controllers.Blocks.getCurrentBlocks().filter(function(t){return t.hasAnimation()});return SL.editor.controllers.AutoAnimate.isEnabled(t)?(SL.editor.controllers.Blocks.generateNames(),i.forEach(function(t){t.removeAnimation()}),SL.analytics.trackEditor("auto_animate_show_settings"),Promise.resolve()):(e=$.extend({warnBeforeRemovingAnimations:!1,popoutAnchor:null,popoutAlignment:"auto"},e),new Promise(function(n){i.length&&!0===e.warnBeforeRemovingAnimations?SL.prompt({title:i.length+" block "+SL.util.string.pluralize("animation","s",i.length>1)+" on this slide will be turned off.",type:"select",anchor:e.popoutAnchor,alignment:e.popoutAlignment,data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Enable Auto-Animate</h3>",selected:!0,className:"positive",callback:function(){SL.editor.controllers.AutoAnimate.enable(t,{warnBeforeRemovingAnimations:!1}),n()}.bind(this)}]}):(i.forEach(function(t){t.removeAnimation()}),SL.editor.controllers.Blocks.generateNames(),t.setAttribute("data-auto-animate",""),SL.editor.controllers.AutoAnimate.setDefaultSlideAttributes(t),SL.editor.controllers.AutoAnimate.afterAutoAnimateEnabled(t),SL.view.syncOverlayButtons(),n())}))},setDefaultSlideAttributes:function(t){var e=$(t).prevAll("[data-auto-animate]").get(0)||$(t).nextAll("[data-auto-animate]").get(0);if(e){if(e.hasAttribute("data-auto-animate-duration")){var i=parseFloat(e.getAttribute("data-auto-animate-duration"));isNaN(i)||i===SL.config.AUTO_ANIMATE_DURATION_DEFAULT/1e3||t.setAttribute("data-auto-animate-duration",i)}if(e.hasAttribute("data-auto-animate-easing")){var n=e.getAttribute("data-auto-animate-easing");n!==SL.config.AUTO_ANIMATE_EASING_DEFAULT&&t.setAttribute("data-auto-animate-easing",n)}if(e.hasAttribute("data-auto-animate-unmatched")){var o=e.getAttribute("data-auto-animate-unmatched");o!==SL.config.AUTO_ANIMATE_UNMATCHED_DEFAULT&&t.setAttribute("data-auto-animate-unmatched",o)}}},disable:function(t){t.removeAttribute("data-auto-animate"),t.removeAttribute("data-auto-animate-easing"),t.removeAttribute("data-auto-animate-duration"),t.removeAttribute("data-auto-animate-unmatched"),Reveal.sync(),SL.view.syncOverlayButtons()},isEnabled:function(t){return t.hasAttribute("data-auto-animate")},afterAutoAnimateEnabled:function(){var t=SL.editor.controllers.AutoAnimate.getAllAutoAnimatedSlides().length;1===t?SL.analytics.trackEditor("auto_animate_enabled_for_1st_slide"):2===t?SL.analytics.trackEditor("auto_animate_enabled_for_2nd_slide"):SL.analytics.trackEditor("auto_animate_enabled_for_nth_slide")},getAllAutoAnimatedSlides:function(){return document.querySelectorAll("section[data-auto-animate]")},getAutoAnimateHelpPromptOptions:function(t){return $.extend({title:"Adding your first Auto-Animation",subtitle:"1. Duplicate the current slide. <br>2. Make changes, such as moving a block, on the duplicated slide. <br>3. Preview the animation with <strong>"+SL.keyboard.getEditorShortcut("EDITOR_PREVIEW").shortcut+"</strong>.",mediaType:"video",mediaURL:"http://static.slid.es/support/auto-animate-instructions-3.mp4",mediaWidth:1093,mediaHeight:720},t)}},SL("editor.controllers").Blocks={init:function(t){this.editor=t,this.focusChanged=new signals.Signal,this.textSaved=new signals.Signal,this.bind(),this.preprocess(),parseInt(SL.util.getQuery().debug,10)>1&&setTimeout(this.enableDebugMode.bind(this),10)},bind:function(){this.onDocumentMouseDown=this.onDocumentMouseDown.bind(this),this.onDocumentMouseMove=this.onDocumentMouseMove.bind(this),this.onDocumentMouseUp=this.onDocumentMouseUp.bind(this),this.onDocumentKeyDown=this.onDocumentKeyDown.bind(this),this.onDocumentPaste=this.onDocumentPaste.bind(this),this.onTextEditingTouchMove=this.onTextEditingTouchMove.bind(this),this.onTextEditingTouchEnd=this.onTextEditingTouchEnd.bind(this),this.afterBlockTextInput=$.throttle(this.afterBlockTextInput.bind(this),250),$(document).on("vmousedown",this.onDocumentMouseDown),$(document).on("keydown",this.onDocumentKeyDown),$(document).on("paste",this.onDocumentPaste),$(".reveal .slides").on("contextmenu",this.onContextMenu.bind(this))},preprocess:function(){[].slice.call(document.querySelectorAll('reveal .sl-block[data-block-type="code"] pre code[data-line-numbers]')).forEach(function(t){var e=Reveal.getPlugin("highlight").deserializeHighlightSteps(t.getAttribute("data-line-numbers"));if(e.length>1){var i,n=parseInt(t.getAttribute("data-fragment-index"),10);i="number"!=typeof n||isNaN(n)?e.slice(1).map(function(){return'<div class="fragment"></div>'}):e.slice(1).map(function(t,e){return'<div class="fragment" data-fragment-index="'+(n+e)+'"></div>'});var o=document.createElement("div");o.className="editing-ui sl-block-placeholder",o.innerHTML=i.join(""),t.parentNode.parentNode.appendChild(o)}})},sync:function(t,e){t=$(t||Reveal.getCurrentSlide()),e="string"==typeof e?e:".sl-block";var i=[];return t.find(e).toArray().reverse().forEach(function(t){var e=(t=$(t)).data("block-instance");if(e)i.push(e);else{var n=t.attr("data-block-type");n&&i.push(this.add({type:n,element:t}))}},this),i.reverse()},syncNewSlide:function(){var t=this.sync.apply(this,arguments);this.normalizeBlockDepths(t)},add:function(t){"undefined"==typeof t.parent&&(t.parent=Reveal.getCurrentSlide()),"undefined"==typeof t.silent&&(t.silent=!1),"undefined"==typeof t.center&&(t.center=!0),this.blockTypeCollection||(this.blockTypeCollection=new SL.collections.Collection(SL.config.BLOCKS));var e,i=this.blockTypeCollection.getByProperties({type:t.type});if(i)return t.element?(e=new SL.editor.blocks[i.factory]({element:t.element}),t.element.data("block-instance",e),0===t.element.parent().length&&e.appendTo(t.parent)):((e=new SL.editor.blocks[i.factory](t.blockOptions)).appendTo(t.parent),e.setDefaults(),t.afterInit&&"function"==typeof t.afterInit&&t.afterInit(e),t.width&&e.resize({width:t.width}),t.height&&e.resize({height:t.height}),this.place(e,{skipIntro:t.silent||t.skipIntro,center:t.center}),"number"!=typeof t.x&&"number"!=typeof t.y||e.move({x:t.x,y:t.y}),!1===e.isset("attribute.data-name")&&this.generateNames([e]),t.silent||SL.editor.controllers.Blocks.focus(e)),!1===e.hasID()&&this.generateIDs([e]),e.removed.add(function(){e.isFocused()&&(SL.editor.controllers.Blocks.blur(null,!0),SL.editor.controllers.Blocks.afterFocusChange())}),e},replace:function(t,e){var i=t.measure(),n={"transform.rotate":t.get("transform.rotate"),"style.transition-duration":t.get("style.transition-duration"),"style.transition-delay":t.get("style.transition-delay"),"style.opacity":t.get("style.opacity"),"style.z-index":t.get("style.z-index"),"attribute.data-animation-type":t.get("attribute.data-animation-type"),"attribute.class":t.get("attribute.class")},o=this.add($.extend({x:i.x,y:i.y,width:i.width,height:i.height,silent:!0},e));return o.set(n),SL.editor.controllers.Blocks.focus(o),t.destroy(),o},invalidateBlockMeasurements:function(){SL.blockInvalidationID="number"==typeof SL.blockInvalidationID?SL.blockInvalidationID+1:1,SL.editor.controllers.Blocks.getFocusedBlocks().forEach(function(t){t.transform&&"function"==typeof t.transform.sync&&t.transform.sync()})},removeBlocks:function(t){(t=t instanceof Array?t:SL.editor.controllers.Blocks.getFocusedBlocks()).forEach(function(t){t.destroy()}),SL.editor.controllers.History.pushLatest()},maximizeBlocks:function(t){t=t instanceof Array?t:SL.editor.controllers.Blocks.getFocusedBlocks();var e=SL.util.deck.getSlideSize();t.forEach(function(t){t.resize({width:e.width,height:e.height}),t.moveToCenter()}),SL.editor.controllers.History.pushLatest()},centerBlocks:function(t){(t=t instanceof Array?t:SL.editor.controllers.Blocks.getFocusedBlocks()).forEach(function(t){t.moveToCenter()}),SL.editor.controllers.History.pushLatest()},duplicateBlocks:function(t){t=$.extend({silent:!1},t);var e=SL.editor.controllers.Blocks.copy({copyToClipboard:!1});SL.editor.controllers.Blocks.paste(e,{verb:"Duplicated",silent:t.silent}),SL.editor.controllers.History.pushLatest()},groupBlocks:function(t){if((t=t instanceof Array?t:SL.editor.controllers.Blocks.getFocusedBlocks()).length>0){if(t.some(function(t){return!!t.isGroup()&&t.getNestedBlocks().some(function(t){return t.getParentGroups().length>=SL.config.MAX_GROUP_NESTING})}))return void SL.notify("Can't nest groups more than "+SL.config.MAX_GROUP_NESTING+" levels deep","negative");var e,i=t.reduce(function(t,e){return Math.max(t,e.getZ())},SL.editor.controllers.Blocks.MIN_BLOCK_DEPTH),n=SL.editor.controllers.Blocks.getCombinedBounds(t),o={type:"group",x:n.x,y:n.y,silent:!0,skipIntro:!0},r=SL.editor.controllers.Blocks.getOpenGroup();r?(o.parent=r.contentElement,(e=SL.editor.controllers.Blocks.add(o)).addBlocks(t),r.invalidateBlockList(),r.paint()):(o.parent=t[0].domElement.closest("section"),(e=SL.editor.controllers.Blocks.add(o)).addBlocks(t)),e.set("style.z-index",i),SL.editor.controllers.Blocks.moveBlocksToDepth(),SL.editor.controllers.Blocks.focus(e),SL.editor.controllers.History.pushLatest(),SL.analytics.trackEditor("group_blocks")}},ungroupBlocks:function(t){(t=(t=t instanceof Array?t:SL.editor.controllers.Blocks.getFocusedBlocks()).filter(function(t){if(t.isGroup())return t.ungroup(),!0})).length>0&&(SL.editor.controllers.History.pushLatest(),SL.analytics.trackEditor("ungroup_blocks"))},openGroup:function(t){t.domElement.addClass("is-open"),t.contentElement.addClass("is-open")},generateIDs:function(t){(t||SL.editor.controllers.Blocks.getCurrentBlocks()).forEach(function(t){this.uniqueBlockCount=this.uniqueBlockCount?this.uniqueBlockCount+1:1,!1===t.hasID()&&t.setID(CryptoJS.MD5("block-"+t.getType()+"-"+this.uniqueBlockCount+"-"+Date.now()+"-"+Math.round(1e9*Math.random())).toString())},this)},generateNames:function(t){(t||SL.editor.controllers.Blocks.getCurrentBlocks()).forEach(function(t){this.uniqueBlockCount=this.uniqueBlockCount?this.uniqueBlockCount+1:1,!1===t.isset("attribute.data-name")&&t.set("attribute.data-name",t.getType()+"-"+CryptoJS.MD5(this.uniqueBlockCount+"-"+Date.now()).toString().slice(0,6)),t.isGroup()&&SL.editor.controllers.Blocks.generateNames(t.getBlocks())},this)},place:function(t,e){e=e||{},SL.editor.controllers.Blocks.moveBlocksToDepth([t],"front"),e.center&&t.moveToCenter({minY:0}),e.skipIntro||t.runIntro()},focus:function(t,e,i){if(t instanceof Array||(t=[t]),t.length>0){var n=!1;void 0===e&&(e=!1),void 0===i&&(i=!0),t.forEach(function(t){t&&t.nodeName&&(t=$(t).data("block-instance")),t&&"function"==typeof t.focus&&(e?t.isFocused()?t.isFocused()&&i&&(t.blur(),n=!0):(t.focus(),n=!0):t.isFocused()||(SL.editor.controllers.Blocks.blur(null,!0),t.focus(),n=!0))},this),n&&this.afterFocusChange()}},blur:function(t,e){var i=!1;(t||this.getFocusedBlocks()).forEach(function(t){t.blur(),i=!0}),i&&!e&&this.afterFocusChange()},blurBlocksBySlide:function(t){var e=!1;$(t).find(".sl-block").each(function(){var t=$(this).data("block-instance");t&&(t.blur(),e=!0)}),e&&this.afterFocusChange()},afterFocusChange:function(){var t=this.getFocusedBlocks();if(1===t.length&&t[0].getToolbarOptions().length)this.editor.toolbars.get().block!==t[0]&&this.editor.toolbars.replace(new SL.editor.components.toolbars.Edit(t[0]));else if(t.length>1){var e=this.editor.toolbars.get();!1!==e instanceof SL.editor.components.toolbars.EditMultiple&&e.isTargetingBlocks(t)||this.editor.toolbars.replace(new SL.editor.components.toolbars.EditMultiple(t))}else this.editor.toolbars.clear();var i=$(Reveal.getCurrentSlide()),n=i.find(".sl-block-group.is-open");i.find(".sl-block-group, .sl-block-group-content").removeClass("is-open"),i.find(".sl-block.is-focused").parents(".sl-block-group, .sl-block-group-content").addClass("is-open"),n.not(".is-open").toArray().forEach(function(t){var e=$(t).data("block-instance");e&&e.onClosed()}),$("html").toggleClass("multiple-blocks-selected",t.length>1),SL.editor.controllers.Blocks.discoverBlockPairs(),this.focusChanged.dispatch()},afterBlockTextInput:function(){$(".reveal-viewport").scrollLeft(0).scrollTop(0)},afterBlockTextSaved:function(t){this.textSaved.dispatch(t)},copy:function(t){t=$.extend({copyToClipboard:!0},t);var e=SL.editor.controllers.Blocks.getFocusedBlocks(),i="";return e.length&&(i=e.map(function(t){return t.getAsClipboardText()}).join(""),t.copyToClipboard&&SL.util.copyToClipboard(i),SL.analytics.trackEditor("copy_block")),this.lastCopiedBlocksHTML=i,i},cut:function(){var t=SL.editor.controllers.Blocks.getFocusedBlocks(),e="";return t.length&&(e=t.map(function(t){return t.detach(),t.getAsClipboardText()}).join(""),SL.editor.controllers.Blocks.blur(t),SL.util.copyToClipboard(e),SL.analytics.trackEditor("cut_block"),SL.editor.controllers.History.pushLatest(),this.lastCopiedBlocksHTML=e),e},paste:function(t,e){e=$.extend({verb:"Pasted"},e);var i=$(Reveal.getCurrentSlide());if(/sl\-block/gi.test(t)){var n=$(t);if(n&&n.length&&i.length){var o=[];n.each(function(t,e){(e=$(e))&&e.is(".sl-block")&&(e.find(".sl-block").toArray().reverse().forEach(function(t){this.instantiatePastedBlock($(t),i)},this),o.push(this.instantiatePastedBlock(e,i)))}.bind(this));var r=this.getOpenGroup();r?(r.addBlocks(o),SL.editor.controllers.Blocks.blur(null,!0)):SL.editor.controllers.Blocks.blur(),o.length&&(this.migrateBlockRelations($(o.map(function(t){return t.domElement.get(0)}))),!0!==e.silent&&SL.notify(e.verb+" "+o.length+" "+SL.util.string.pluralize("block","s",o.length>1))),o.sort(function(t,e){return t.get("style.z-index")-e.get("style.z-index")}),SL.editor.controllers.Blocks.moveBlocksToDepth(o,"front"),SL.editor.controllers.Blocks.generateNames(o),SL.editor.controllers.Blocks.focus(o,!0),SL.analytics.trackEditor("paste_block"),Reveal.syncSlide(Reveal.getCurrentSlide()),SL.editor.controllers.History.pushLatest()}}},instantiatePastedBlock:function(t,e){var i=t.attr("data-block-id");i&&(t.attr("data-origin-id",i),t.removeAttr("data-block-id"));var n=t.attr("data-name");return n&&e.find("[data-name="+n+"]").length&&t.removeAttr("data-name"),t.find(">.editing-ui").remove(),this.add({type:t.attr("data-block-type"),element:t})},migrateBlockRelations:function(t){var e=t.find("[data-animation-type][data-animation-trigger-id]");if(e.length>0){var i={};t.filter("[data-origin-id]").each(function(){i[this.getAttribute("data-origin-id")]={el:this,id:this.getAttribute("data-block-id")},this.removeAttribute("data-origin-id")}),e.each(function(){var t=i[this.getAttribute("data-animation-trigger-id")];t&&this.setAttribute("data-animation-trigger-id",t.id)})}else t.filter("[data-origin-id]").removeAttr("data-origin-id")},align:function(t,e,i){var n;if(t=t instanceof Array?t:SL.editor.controllers.Blocks.getFocusedBlocks(),"slide"===i){var o=SL.util.deck.getSlideSize();(n={x:0,y:0,width:o.width,height:o.height}).right=n.width,n.bottom=n.height}else n=SL.editor.controllers.Blocks.getCombinedBounds(t);"left"===e?t.forEach(function(t){t.move({x:n.x})}):"horizontal-center"===e?t.forEach(function(t){t.move({x:n.x+(n.width-t.measure().transformed.width)/2})}):"right"===e?t.forEach(function(t){t.move({x:n.right-t.measure().transformed.width})}):"top"===e?t.forEach(function(t){t.move({y:n.y})}):"vertical-center"===e?t.forEach(function(t){t.move({y:n.y+(n.height-t.measure().transformed.height)/2})}):"bottom"===e&&t.forEach(function(t){t.move({y:n.bottom-t.measure().transformed.height})}),SL.editor.controllers.History.pushLatest()},layout:function(t,e,i){("number"!=typeof i||isNaN(i))&&(i=10);var n=0,o=0,r=t.map(function(t){var e=t.measure().transformed;return n+=e.width,o+=e.height,{block:t,measurements:e}});n+=i*(t.length-1),o+=i*(t.length-1);var s=SL.util.deck.getSlideSize();if("column"===e){var a=s.height/2-o/2;r.forEach(function(t){t.block.move({x:s.width/2-t.measurements.width/2,y:a}),a+=t.measurements.height+i})}else if("row"===e){var l=s.width/2-n/2;r.forEach(function(t){t.block.move({x:l,y:s.height/2-t.measurements.height/2}),l+=t.measurements.width+i})}},discoverBlockPairs:function(){var t=this.getCurrentBlocks({excludeLocked:!0,excludeGrouped:!0});t.forEach(function(t){t.unpair()}),t.length<8&&SL.editor.controllers.Blocks.getAdjacentBlocks(t).forEach(function(t){"bottom"!==t.relationship||"text"!==t.blockA.type&&"html"!==t.blockA.type||t.blockA.pair(t.blockB,"bottom")})},moveBlocksToDepth:function(t,e,i,n){if(t=t instanceof Array?t:SL.editor.controllers.Blocks.getFocusedBlocks(),(i=i instanceof Array?i:SL.editor.controllers.Blocks.getCurrentBlocks({excludeGrouped:!0})).sort(function(t,e){return t.get("style.z-index")-e.get("style.z-index")}),t&&"string"==typeof e){var o=[],r=[],s=[];i.forEach(function(i){t.indexOf(i)>-1?"back"===e?o.push(i):"front"===e?s.push(i):r.push(i):r.push(i)}),i=o.concat(r).concat(s)}return n="number"==typeof n?n:SL.editor.controllers.Blocks.MIN_BLOCK_DEPTH,i.forEach(function(i){i.set("style.z-index",n++),i.isGroup()&&(n=SL.editor.controllers.Blocks.moveBlocksToDepth(t,e,i.getBlocks(),n))}),n},normalizeBlockDepths:function(t){SL.editor.controllers.Blocks.moveBlocksToDepth(null,null,t)},repaintBlocks:function(t){(t=t instanceof Array?t:SL.editor.controllers.Blocks.getCurrentBlocks()).forEach(function(t){t.paint()})},enableDebugMode:function(){var t=$("<canvas>").appendTo(".projector");t.css({position:"absolute",top:0,left:0,zIndex:100,pointerEvents:"none"});var e=t.get(0).getContext("2d"),i=function(){var n=SL.util.getRevealSlidesBounds(!0),o=$(".projector").width(),r=$(".projector").height(),s=window.devicePixelRatio||1;t.attr({width:o*s,height:r*s}).css({width:o,height:r}),e.scale(s,s),e.clearRect(0,0,o,r),e.translate(n.x,n.y);var a=SL.editor.controllers.Blocks.getCurrentBlocks();a.sort(function(t,e){return t.get("style.z-index")-e.get("style.z-index")}),a.forEach(function(t){var i=t.measure(),n=t.measure().transformed,o=t.getAnchorPositions();e.fillStyle="rgba(0,255,0,0.4)",e.fillRect(n.x,n.y,n.width,n.height);var r=i.x+i.width/2,s=i.y+i.height/2,a=4;e.lineWidth=1,e.strokeStyle="rgba(0,255,0,1.0)",e.moveTo(r-a,s-a),e.lineTo(r+a,s+a),e.moveTo(r+a,s-a),e.lineTo(r-a,s+a),e.stroke();var l=["z: "+t.getZ(),"p: "+SL.util.math.limitDecimals(i.x,2)+" x "+SL.util.math.limitDecimals(i.y,2),"s: "+SL.util.math.limitDecimals(i.width,2)+" x "+SL.util.math.limitDecimals(i.height,2)],c=12,h=1.4*c;e.save(),e.fillStyle="rgba(255,255,255,1.0)",e.textBaseline="top",e.font=c+"px monospace",e.translate(i.x+i.width/2,i.y+i.height/2),e.rotate(t.getRotation()/180*Math.PI),e.translate(6-i.width/2,6-i.height/2),l.forEach(function(t,i){e.fillText(t,0,i*h)}),e.restore(),e.save(),e.translate(i.x,i.y),e.fillStyle="rgba(255,0,0,1.0)",e.fillRect(o.ne.x-2,o.ne.y-2,4,4),e.fillRect(o.nw.x-2,o.nw.y-2,4,4),e.fillRect(o.se.x-2,o.se.y-2,4,4),e.fillRect(o.sw.x-2,o.sw.y-2,4,4),e.restore()}),requestAnimationFrame(i)};i()},getCombinedBounds:function(t){var e={y:0,right:0,bottom:0,x:0};return t.length&&(e.x=Number.MAX_VALUE,e.y=Number.MAX_VALUE,t.forEach(function(t){var i=t.measure().transformed;e.x=Math.min(e.x,i.x),e.y=Math.min(e.y,i.y),e.right=Math.max(e.right,i.right),e.bottom=Math.max(e.bottom,i.bottom)}.bind(this))),e.width=Math.max(e.right-e.x,0),e.height=Math.max(e.bottom-e.y,0),e.transformed={x:e.x,y:e.y,right:e.right,bottom:e.bottom,width:e.width,height:e.height},e},getFocusedBlocks:function(t){var e=[];return this.getCurrentBlocks(t).forEach(function(t){t.isFocused()&&e.push(t)}),e},getFocusedBlocksInVisualOrder:function(t){var e=$.extend({recursive:!1},t);return this.sortByOrderOfAppearance(this.getFocusedBlocks(t),e)},getCurrentBlocks:function(t){return SL.editor.controllers.Blocks.getBlocksBySlide(Reveal.getCurrentSlide(),t)},getBlocksBySlide:function(t,e){var i=SL.editor.controllers.Blocks.sync(t);return e&&!0===e.excludeLocked&&(i=i.filter(function(t){return!1===t.get("attribute.data-locked")})),e&&!0===e.excludeGrouped&&(i=i.filter(function(t){return!t.isGrouped()})),e&&!0===e.excludeGroups&&(i=i.filter(function(t){return"group"!==t.getType()})),i},getBlockByID:function(t){return this.sync(Reveal.getRevealElement(),'.sl-block[data-block-id="'+t+'"]')[0]},getBlocksByMeasurements:function(t,e){var i=[];return(e=e||this.getCurrentBlocks()).forEach(function(e){var n=e.measure().transformed,o=!0;for(var r in t)t.hasOwnProperty(r)&&t[r]!==n[r]&&(o=!1);o&&i.push(e)}),i},sortByOrderOfAppearance:function(t,e){e=e||{},t=t||SL.editor.controllers.Blocks.getCurrentBlocks({excludeGrouped:!0});var i=function(t){return(t=t.sort(function(t,i){t._tmpMeasurement||(t._tmpMeasurement=t.measure()),i._tmpMeasurement||(i._tmpMeasurement=i.measure());var n=t._tmpMeasurement.x,o=t._tmpMeasurement.y,r=i._tmpMeasurement.x,s=i._tmpMeasurement.y;return"x"===e.dominantAxis?Math.abs(n-r)<10?o<s?-1:1:n<r?-1:1:Math.abs(o-s)<10?n<r?-1:1:o<s?-1:1})).reduce(function(t,n){return delete n._tmpMeasurement,t.push(n),!0===e.recursive&&n.isGroup()?t.concat(i(n.getBlocks())):t},[])};return i(t)},getOpenGroup:function(){return this.getCurrentBlocks().find(function(t){return t.isGroup()&&t.isOpen()})},getAdjacentBlocks:function(t){var e=[];return(t=t||this.getCurrentBlocks()).forEach(function(i){e=e.concat(SL.editor.controllers.Blocks.getAdjacentBlocksTo(i,t))}),e},getAdjacentBlocksTo:function(t,e){var i=4,n=[],o=(e=e||this.getCurrentBlocks(),t.measure().transformed);return e.forEach(function(e){var r=e.measure().transformed,s=SL.util.trig.intersection(o,r);s.height>0&&(Math.abs(o.x-r.right)<i?n.push({relationship:"left",blockA:t,blockB:e}):Math.abs(o.right-r.x)<i&&n.push({relationship:"right",blockA:t,blockB:e})),s.width>0&&(Math.abs(o.y-r.bottom)<i?n.push({relationship:"top",blockA:t,blockB:e}):Math.abs(o.bottom-r.y)<i&&n.push({relationship:"bottom",blockA:t,blockB:e}))}),n},getBlockDefinitionByType:function(t){for(var e=0;e<SL.config.BLOCKS.length;e++){var i=SL.config.BLOCKS[e];if(i.type===t)return i}},onDocumentMouseDown:function(t){if(2===t.button||!1===SL.view.isEditing())return!0;var e=$(t.target).closest(".sl-block"),i=$(t.target).closest(".reveal").length>0;if(isRevealControls=$(t.target).closest(".reveal .controls").length>0,isToolbar=$(t.target).closest(".toolbars").length>0,isBlock=e.length>0,e.is('[data-locked="true"]')&&(this.pressedLockedBlock=e.data("block-instance")),this.mouseDownX=t.clientX,this.mouseDownY=t.clientY,!i||isBlock||isRevealControls)i&&this.pressedLockedBlock&&!isRevealControls?(t.preventDefault(),$(document).on("vmousemove",this.onDocumentMouseMove),$(document).on("vmouseup",this.onDocumentMouseUp)):isToolbar&&this.getFocusedBlocks().forEach(function(t){"function"==typeof t.disableEditing&&t.disableEditing()});else{if(SL.editor.controllers.Capabilities.isTouchEditor())if(this.getFocusedBlocks().some(function(t){return t.isEditingText()}))return this.touchMouseStart={x:t.clientX,y:t.clientY},this.touchMouseMoved=!1,$(document).on("vmousemove",this.onTextEditingTouchMove),$(document).on("vmouseup",this.onTextEditingTouchEnd),!0;t.shiftKey||t.metaKey||(SL.editor.controllers.Blocks.blur(),$(document.activeElement).blur()),t.preventDefault(),$(document).on("vmousemove",this.onDocumentMouseMove),$(document).on("vmouseup",this.onDocumentMouseUp)}},onDocumentMouseMove:function(t){if(this.pressedLockedBlock&&SL.util.trig.distanceBetween({x:this.mouseDownX,y:this.mouseDownY},{x:t.clientX,y:t.clientY})>3){var e=[this.pressedLockedBlock];this.pressedLockedBlock.isGrouped()&&(e=e.concat(this.pressedLockedBlock.getParentGroups())),SL.editor.controllers.Blocks.blur(e),this.pressedLockedBlock=null}if(SL.util.isMultiTouchEvent(t))return!1;var i=t.shiftKey||t.metaKey;SL.editor.controllers.Selection.sync(t.clientX,t.clientY,i)},onDocumentMouseUp:function(){this.pressedLockedBlock=null,SL.editor.controllers.Selection.stop(),$(document).off("vmousemove",this.onDocumentMouseMove),$(document).off("vmouseup",this.onDocumentMouseUp)},onTextEditingTouchMove:function(t){t.clientX===this.touchMouseStart.x&&t.clientY===this.touchMouseStart.y||(this.touchMouseMoved=!0)},onTextEditingTouchEnd:function(){this.touchMouseMoved||SL.editor.controllers.Blocks.blur(),$(document).off("vmousemove",this.onTextEditingTouchMove),$(document).off("vmouseup",this.onTextEditingTouchEnd)},onDocumentKeyDown:function(t){if(!1===SL.view.isEditing())return!0;if(SL.util.isTypingEvent(t))return!0;if(!this.editor.sidebar.isExpanded()){var e=t.metaKey||t.ctrlKey,i=this.getFocusedBlocks(),n=i.length>0&&i[0].isLocked();if(37!==t.keyCode&&38!==t.keyCode&&39!==t.keyCode&&40!==t.keyCode||!i.length||n)if(8!==t.keyCode&&46!==t.keyCode||!i.length||n)if(e&&!t.shiftKey&&65===t.keyCode){var o=SL.editor.controllers.Blocks.getOpenGroup();o?SL.editor.controllers.Blocks.focus(o.getBlocks().filter(function(t){return!t.isLocked()}),!0,!1):SL.editor.controllers.Blocks.focus(this.getCurrentBlocks({excludeLocked:!0,excludeGrouped:!0}),!0,!1),t.preventDefault()}else e&&!t.shiftKey&&67===t.keyCode&&i.length?(SL.editor.controllers.Blocks.copy(),t.preventDefault()):e&&!t.shiftKey&&88===t.keyCode&&i.length?(SL.editor.controllers.Blocks.cut(),
t.preventDefault()):e&&!t.shiftKey&&68===t.keyCode&&i.length?(SL.editor.controllers.Blocks.duplicateBlocks(),t.preventDefault()):e&&!t.shiftKey&&71===t.keyCode&&i.length?(SL.editor.controllers.Blocks.groupBlocks(),t.preventDefault()):e&&t.shiftKey&&71===t.keyCode&&i.length?(SL.editor.controllers.Blocks.ungroupBlocks(),t.preventDefault()):e&&t.shiftKey&&76===t.keyCode&&i.length?(i.forEach(function(t){t.set("attribute.data-locked",!n)}),SL.editor.controllers.History.pushLatest(),t.preventDefault()):t.altKey&&67===t.keyCode&&i.length?(SL.editor.controllers.Blocks.centerBlocks(),t.preventDefault()):t.metaKey&&219===t.keyCode&&i.length?(SL.editor.controllers.Blocks.moveBlocksToDepth(i,"back"),t.preventDefault()):t.metaKey&&221===t.keyCode&&i.length?(SL.editor.controllers.Blocks.moveBlocksToDepth(i,"front"),t.preventDefault()):t.metaKey&&86===t.keyCode?this.hasReceivedPasteEvent||"string"==typeof this.lastCopiedBlocksHTML&&this.lastCopiedBlocksHTML.length&&(clearTimeout(this.manualPasteTimeout),this.manualPasteTimeout=setTimeout(()=>{SL.editor.controllers.Blocks.paste(this.lastCopiedBlocksHTML)},100)):t.metaKey||t.shiftKey||73!==t.keyCode||!i.length||this.editor.toolbars.get().showEyeDropperForFirstColor()&&t.preventDefault();else i.forEach(function(t){t.destroy()}),SL.editor.controllers.History.pushLatest(),t.preventDefault();else{var r,s=t.shiftKey?10:1,a=0,l=0;37===t.keyCode?(a=-s,r="left"):39===t.keyCode?(a=s,r="right"):38===t.keyCode?(l=-s,r="top"):40===t.keyCode&&(l=s,r="bottom"),t.altKey?SL.editor.controllers.Blocks.align(i,r,"slide"):i.forEach(function(t){t.offset({x:a,y:l})})}}},onDocumentPaste:function(t){if(this.hasReceivedPasteEvent=!0,clearTimeout(this.manualPasteTimeout),!1===SL.view.isEditing())return!0;if(SL.util.isTypingEvent(t))return!0;if(this.editor.sidebar.isExpanded())return!0;var e=t.clipboardData.getData("Text");if(e&&"string"==typeof e){var i=!1;if(/sl\-block/gi.test(e))SL.editor.controllers.Blocks.paste(e),i=!0;else if(/<iframe.+src=.+<\/iframe>/gi.test(e)){var n=SL.util.string.formatIframeSource(e).trim();if(SL.util.string.URL_REGEX.test(n)){var o=SL.util.deck.getSlideSize();this.add({type:"iframe",width:Math.round(.75*o.width),height:Math.round(.75*o.width/(16/9)),blockOptions:{url:n}}),i=!0}}i&&(t.preventDefault(),t.stopImmediatePropagation())}},onContextMenu:function(t){if(!1===SL.view.isEditing())return!0;var e=$(t.target).parents(".sl-block:not(.is-open)").last().data("block-instance");if(e){var i=e.getContextMenuOptions();i.length&&(t.preventDefault(),this.contextMenu||(this.contextMenu=new SL.components.ContextMenu({minWidth:150}),this.contextMenu.shown.add(this.onContextMenuShown.bind(this)),this.contextMenu.hidden.add(this.onContextMenuHidden.bind(this))),this.contextMenu.block=e,this.contextMenu.showFor({anchor:e.domElement,options:i},t))}},onContextMenuShown:function(t){this.contextMenu.block&&"function"==typeof this.contextMenu.block.onContextMenuShown&&this.contextMenu.block.onContextMenuShown(t)},onContextMenuHidden:function(){this.contextMenu.block&&"function"==typeof this.contextMenu.block.onContextMenuHidden&&(this.contextMenu.block.onContextMenuHidden(event),this.contextMenu.block=null)}},SL.editor.controllers.Blocks.MIN_BLOCK_DEPTH=10,SL("editor.controllers").Capabilities={TOUCH_EDITOR:!1,TOUCH_EDITOR_SMALL:!1,init:function(){if(!SL.util.device.supportedByEditor())return $(document.body).append('<div class="not-supported"><h2>Not Supported</h2><p>The Slides editor doesn\'t currently support the browser you\'re using. Please consider changing to a different browser, such as <a href="https://www.google.com/chrome">Google Chrome</a> or <a href="https://www.mozilla.org/firefox/">Firefox</a>.</p><a class="skip" href="#">Continue anyway</a></div>'),$(".not-supported .skip").on("click",function(){$(".not-supported").remove()}),!1;SL.editor.controllers.Capabilities.TOUCH_EDITOR=/ipad|iphone|ipod|android/gi.test(navigator.userAgent)&&!!("ontouchstart"in window),SL.editor.controllers.Capabilities.TOUCH_EDITOR_SMALL=SL.editor.controllers.Capabilities.TOUCH_EDITOR&&window.innerWidth>0&&window.innerWidth<1e3,SL.editor.controllers.Capabilities.TOUCH_EDITOR&&($("html").addClass("touch-editor"),SL.editor.controllers.Capabilities.TOUCH_EDITOR_SMALL&&$("html").addClass("touch-editor-small"));var t=SL.current_user.get("id")===SL.current_deck.get("user").id;return this._canExport=!0,this._canPresent=t,this._canShareDeck=t||SL.current_deck.isVisibilityAll()||SL.current_user.isMemberOfCurrentTeam(),this._canDeleteDeck=t,this._canChangeStyles=t||!SL.current_team||!SL.current_team.hasThemes()||SL.current_user.isMemberOfCurrentTeam()||!SL.current_deck.has("theme_id"),this._canUseCSSEditor=SL.current_user.privileges.customCSS(),this._canSetVisibility=t,this._canSetVisibilitySelf=t&&SL.current_user.isPaid(),this._canSetVisibilityTeam=t&&SL.current_user.isEnterprise(),this._canSyncToDropbox=t,this._canDockNotes=!SL.editor.controllers.Capabilities.TOUCH_EDITOR,this._canUploadVideo=SL.current_deck.user.isPaid(),!0},isTouchEditor:function(){return SL.editor.controllers.Capabilities.TOUCH_EDITOR},isTouchEditorSmall:function(){return SL.editor.controllers.Capabilities.TOUCH_EDITOR_SMALL},canExport:function(){return this._canExport},canSyncToDropbox:function(){return this._canSyncToDropbox},canPresent:function(){return this._canPresent},canShareDeck:function(){return this._canShareDeck},canDeleteDeck:function(){return this._canDeleteDeck},canChangeStyles:function(){return this._canChangeStyles},canSetVisibility:function(){return this._canSetVisibility},canSetVisibilitySelf:function(){return this._canSetVisibilitySelf},canSetVisibilityTeam:function(){return this._canSetVisibilityTeam},canUseCSSEditor:function(){return this._canUseCSSEditor},canDockNotes:function(){return this._canDockNotes},canUploadVideo:function(){return this._canUploadVideo}},SL("editor.controllers").Contrast={init:function(){this.contrast=-1,this.sync=this.sync.bind(this),this.bind(),this.sync()},bind:function(){this.changed=new signals.Signal,Reveal.addEventListener("ready",this.sync),Reveal.addEventListener("slidechanged",function(){setTimeout(this.sync,1)}.bind(this)),SL.editor.controllers.Markup.slideRemoved.add(this.sync)},sync:function(){var t=SL.util.deck.getBackgroundContrast();t!==this.contrast&&(this.contrast=t,$("html").attr("data-deck-contrast",Math.round(10*t)),this.changed.dispatch(this.contrast))},get:function(){return-1===this.contrast&&this.sync(),this.contrast}},SL("editor.controllers").DeckImport={TEXT_FORMATS:{h1:"h1",h2:"h2",h3:"h3",pre:"pre",p:"p"},THEME_COLOR_MAP:{"white-blue":"white-blue","black-blue":"black-blue"},THEME_FONT_MAP:{asul:"asul",helvetica:"helvetica",josefine:"josefine",league:"league",merriweather:"merriweather",montserrat:"montserrat",news:"news",opensans:"opensans",palatino:"palatino",quicksand:"quicksand",sketch:"sketch",overpass:"overpass2"},TRANSITION_MAP:{none:"none",fade:"fade",slide:"slide",concave:"concave",convex:"convex"},init:function(t){this.editor=t,this.onImportConfirmed=this.onImportConfirmed.bind(this),this.onImportCanceled=this.onImportCanceled.bind(this),this.importing=!1,SL.util.getQuery().define&&"object"==typeof window.SLDeckDefinition&&t.isNewDeck()&&(this.editor.deckSaved.addOnce(this.onDeckSaved.bind(this)),this.start(SLDeckDefinition))},start:function(t){this.importing||(this.importing=!0,this.domElement=$('<div class="sl-deck-import">'),this.domElement.appendTo($(".projector")),this.domElement.append('<p class="description">You are importing a deck. Please review the content and click below to save it to your account.</p>'),this.controlsButtons=$('<div class="sl-deck-import-buttons">'),this.controlsButtons.appendTo(this.domElement),this.confirmButton=$('<button class="button white l sl-deck-import-confirm">Save deck</button>'),this.confirmButton.on("vclick",this.onImportConfirmed),this.confirmButton.appendTo(this.controlsButtons),this.cancelButton=$('<button class="button outline white l sl-deck-import-cancel">Cancel</button>'),this.cancelButton.on("vclick",this.onImportCanceled),this.cancelButton.appendTo(this.controlsButtons),this.importJSON(t),$("html").addClass("deck-import-open"))},stop:function(){this.importing=!1,this.domElement.remove(),$("html").removeClass("deck-import-open")},importJSON:function(t){SL.helpers.PageLoader.show({message:"Importing..."}),$(".reveal .slides").empty(),t.title&&(SLConfig.deck.title=t.title),t.description&&(SLConfig.deck.description=t.description),t.loop&&(SLConfig.deck.should_loop=t.loop),t["slide-number"]&&(SLConfig.deck.slide_number=t["slide-number"]),"all"===t.visibility?SLConfig.deck.visibility=this.deckVisibility="all":"self"===t.visibility&&SL.editor.controllers.Capabilities.canSetVisibilitySelf()?SLConfig.deck.visibility=this.deckVisibility="self":"team"===t.visibility&&SL.editor.controllers.Capabilities.canSetVisibilityTeam()&&(SLConfig.deck.visibility=this.deckVisibility="team"),"number"==typeof t.width&&(SLConfig.deck.width=t.width,Reveal.configure({width:SLConfig.deck.width})),"number"==typeof t.height&&(SLConfig.deck.height=t.height,Reveal.configure({height:SLConfig.deck.width})),SLConfig.deck.theme_color=this.THEME_COLOR_MAP[t["theme-color"]]||SL.config.DEFAULT_THEME_COLOR,SLConfig.deck.theme_font=this.THEME_FONT_MAP[t["theme-font"]]||SL.config.DEFAULT_THEME_FONT,SLConfig.deck.transition=this.TRANSITION_MAP[t.transition]||SL.config.DEFAULT_THEME_TRANSITION,SLConfig.deck.background_transition=this.TRANSITION_MAP[t["background-transition"]]||SL.config.DEFAULT_THEME_BACKGROUND_TRANSITION,"string"==typeof t.css&&SL.editor.controllers.Capabilities.canUseCSSEditor()&&this.importCSS(t.css),t.slides.forEach(this.importSlideJSON,this),Reveal.sync(),Reveal.slide(0,0),SL.editor.controllers.Markup.afterSlidesChanged(),SL.editor.controllers.History.reset(),this.editor.setupTheme(),SL.deck.util.renderInlineMath(),this.waitForContentToLoad().then(this.afterContentLoaded.bind(this))},importCSS:function(t){less.render(".reveal { "+t+" }").then(function(e){e=SL.util.string.moveCSSImportsToBeginning(e.css),SLConfig.deck.css_input=t,SLConfig.deck.css_output=e,$("#user-css-output").html(e)}.bind(this),function(t){SL.notify("Failed to parse imported CSS: <br>"+t.message)}.bind(this))},importSlideJSON:function(t,e){var i=$("<section>").appendTo($(".reveal .slides"));SL.util.deck.generateIdentifiers(i),t instanceof Array?t.forEach(function(t){this.importSlideJSON(t,i)},this):(t.notes&&(SLConfig.deck.notes[i.attr("data-id")]=t.notes),t["background-color"]&&i.attr("data-background-color",t["background-color"]),t["background-image"]&&i.attr("data-background-image",t["background-image"]),t["background-size"]&&i.attr("data-background-size",t["background-size"]),this.slideBlockCount={},t.blocks&&t.blocks.forEach(function(t){this.importBlockJSON(t,i);var e=t.type;this.slideBlockCount[e]?this.slideBlockCount[e]+=1:this.slideBlockCount[e]=1},this),t.html&&this.importBlockJSON({type:"html",value:t.html},i),"object"==typeof e&&i.appendTo(e))},importBlockJSON:function(t,e){var i=SL.util.deck.getSlideSize(),n={parent:e,silent:!0,width:Math.round(.8*i.width)};switch(t.type){case"html":n.type="text",n.width=.8*i.width,n.afterInit=function(e){e.set("style.text-align",t.align),e.set("style.padding",t.padding),e.setCustomHTML(t.value)};break;case"text":n.type="text",n.width=.8*i.width;var o=this.TEXT_FORMATS[t.format]||(this.slideBlockCount.text>0?"h2":"h1");n.afterInit=function(e){e.set("style.text-align",t.align),e.set("style.padding",t.padding),t.color&&e.set("style.color",t.color);var i=parseInt(t["font-size"],10);i&&!isNaN(i)&&e.set("style.font-size",i),e.setHTML("<"+o+">"+t.value+"</"+o+">")};break;case"iframe":n.type="iframe",n.width=.6*i.width,n.height=.6*i.height,n.afterInit=function(e){e.set("iframe.src",t.value)};break;case"image":n.type="image",n.width=.6*i.width,n.height=.6*i.height,n.afterInit=function(e){e.set("image.src",t.value)};break;case"video":n.type="video",n.width=.6*i.width,n.height=.6*i.height,n.afterInit=function(e){"boolean"==typeof t.controls&&e.set("video.controls",t.controls),"boolean"==typeof t.autoplay&&e.set("video.autoplay",t.autoplay),"boolean"==typeof t.muted&&e.set("video.muted",t.muted),"boolean"==typeof t.loop&&e.set("video.loop",t.loop),e.set("video.src",t.value)};break;case"math":n.type="math",n.width=.6*i.width,n.height=.6*i.height,n.afterInit=function(e){t.value&&e.set("math.value",t.value),t["font-size"]&&e.set("style.font-size",t["font-size"])};break;case"code":n.type="code",n.width=.6*i.width,n.height=.6*i.height,n.afterInit=function(e){t.value&&e.set("code.value",t.value),t.language&&e.set("code.language",t.language),t.theme&&e.set("code.theme",t.theme),t["font-size"]&&e.set("style.font-size",t["font-size"]),"undefined"!=typeof t.frame&&e.set("code.frame",t.frame),"undefined"!=typeof t["line-numbers"]&&e.set("code.line-numbers",t["line-numbers"]),"boolean"==typeof t["word-wrap"]&&e.set("attribute.data-code-wrap",t["word-wrap"])};break;case"table":n.type="table",n.width=.6*i.width,n.height=.6*i.height,n.afterInit=function(e){var i;t.html?(i=$(t.html)).is("table")?i=i.html():i.is("tr")?i=t.html:console.warn("Invalid table block HTML."):t.data&&t.data instanceof Array&&(i=t.data.map(function(t){return"<tr>"+t.map(function(t){return"<td>"+t+"</td>"})+"</tr>"}).join(""));i&&e.setTableHTML(i),t["text-color"]&&e.set("style.color",t["text-color"]),t["border-color"]&&e.set("attribute.data-table-border-color",t["border-color"]),"number"==typeof t["border-width"]&&e.set("attribute.data-table-border-width",t["border-width"]),"number"==typeof t.padding&&e.set("attribute.data-table-padding",t.padding)};break;default:return void console.warn('Unrecognized block type: "'+t.type+'"')}"number"==typeof t.x&&(n.x=t.x),"number"==typeof t.y&&(n.y=t.y),"number"==typeof t.width&&(n.width=t.width),"number"==typeof t.height&&(n.height=t.height),this.importBlockSize(n,t,n.width,n.height);var r=SL.editor.controllers.Blocks.add(n);t["animation-type"]&&(r.set("attribute.data-animation-type",t["animation-type"]),r.set("attribute.data-animation-trigger-id","self")),t["animation-trigger"]&&r.set("attribute.data-animation-trigger",t["animation-trigger"]),t["animation-delay"]&&r.set("style.transition-delay",t["animation-delay"]),t["animation-duration"]&&r.set("style.transition-duration",t["animation-duration"]),"string"==typeof t["class"]&&r.set("attribute.class",t["class"]),"number"!=typeof n.x&&"number"!=typeof n.y||(r._importedWithAbsolutePosition=!0),"number"==typeof n.width&&(r._importedProps=r._importedProps||{},r._importedProps.width=n.width),"number"==typeof n.height&&(r._importedProps=r._importedProps||{},r._importedProps.height=n.height)},importBlockSize:function(t,e,i,n){"number"==typeof i&&(t.width=Math.round("number"==typeof e.width?e.width:i)),"number"==typeof n&&(t.height=Math.round("number"==typeof e.height?e.height:n))},layoutSlide:function(t){t.style.display="block";var e=SL.editor.controllers.Blocks.getBlocksBySlide(t).filter(function(t){return!t._importedWithAbsolutePosition});SL.editor.controllers.Blocks.layout(e,"column"),t.style.display=""},waitForContentToLoad:function(){var t=[];return $(".reveal .slides section").each(function(e,i){i.style.display="block",SL.editor.controllers.Blocks.getBlocksBySlide(i).forEach(function(e){"image"===e.getType()&&e.isLoading()&&t.push(new Promise(function(t){e.imageStateChanged.add(function(){!e.isLoaded()&&e.isLoading()||t()})}))})}.bind(this)),t.push(new Promise(function(t){SL.fonts.loadDeckFont(SLConfig.deck.theme_font,{active:t,inactive:t})||t()})),Promise.all(t)},afterContentLoaded:function(){SL.helpers.PageLoader.hide(),$(".reveal .slides section").each(function(t,e){this.layoutSlide(e),Reveal.sync()}.bind(this))},isImporting:function(){return this.importing},onImportCanceled:function(){this.stop(),SL.analytics.trackEditor("deck_json_import_canceled"),SL.helpers.PageLoader.show({message:"Canceling import..."}),SL.view.redirect(SL.routes.USER(SL.current_user.get("username")),!0)},onImportConfirmed:function(){this.domElement.remove(),this.editor.save()},onDeckSaved:function(){this.isImporting()&&(SL.analytics.trackEditor("deck_json_import_confirmed"),this.stop(),SLConfig.deck.visibility!==this.deckVisibility&&"string"==typeof this.deckVisibility&&(SLConfig.deck.visibility=this.deckVisibility,this.editor.saveVisibility({silent:!0})),SL.notify("This deck has been saved to your account"))}},SL("editor.controllers").Grid={init:function(){this.color="rgba(150, 150, 150, 0.2)",this.paint=this.paint.bind(this),this.bind(),this.render(),setTimeout(function(){SL.editor.controllers.Grid.show()},1)},render:function(){this.domElement=$('<div class="sl-block-grid">'),this.canvasElement=$('<canvas class="sl-block-grid-inner">').appendTo(this.domElement)},bind:function(){SL.editor.controllers.Contrast.changed.add(this.onContrastChange.bind(this))},show:function(){this.isEnabled()&&(this.viewportElement=$(".reveal-viewport"),this.domElement.appendTo($(".projector .reveal")),this.setContrast(SL.editor.controllers.Contrast.get()),this.paint(),$(window).on("resize",this.paint))},hide:function(){this.domElement.remove(),$(window).off("resize",this.paint)},paint:function(){var t=SL.util.getRevealSlideBounds(SL.editor.controllers.Markup.getCurrentSlide(),!0),e=Math.round(window.devicePixelRatio||1),i=t.width*e,n=t.height*e,o=this.getRows(),r=this.getCols(),s=i/r,a=n/o,l=SL.view.getSlideSize({scaled:!0}),c=(this.viewportElement.get(0).offsetWidth-l.width)/2,h=(this.viewportElement.get(0).offsetHeight-l.height)/2;this.canvasElement.attr({width:Math.round(i),height:Math.round(n)}),this.canvasElement.css({left:Math.round(c),top:Math.round(h),width:Math.round(i/e),height:Math.round(n/e)}),this.context||(this.context=this.canvasElement.get(0).getContext("2d")),this.context.clearRect(0,0,i,n);for(var u=1;u<r;u++)this.context.fillStyle=this.color,this.context.fillRect(Math.floor(u*s),0,1*e,n);for(var d=1;d<o;d++)this.context.fillStyle=this.color,this.context.fillRect(0,Math.floor(d*a),i,1*e)},refresh:function(){this.isEnabled()?(this.show(),this.domElement.toggleClass("grid-on-top",!0===SL.current_user.settings.get("editor_grid_on_top"))):this.hide()},getRows:function(){return Math.round(SL.util.deck.getSlideSize().height/70)},getCols:function(){return Math.round(SL.util.deck.getSlideSize().width/80)},setContrast:function(t){this.color=t<.15?"rgba(255, 255, 255, 0.10)":t<.45?"rgba(255, 255, 255, 0.15)":t<.85?"rgba(255, 255, 255, 0.20)":"rgba(150, 150, 150, 0.20)"},isEnabled:function(){return SL.current_user.settings.get("editor_grid")},onContrastChange:function(t){this.setContrast(t),this.isEnabled()&&this.paint()}},SL("editor.controllers").Guides={init:function(){this.debugMode=parseInt(SL.util.getQuery().debug,10)>1,this.guides={h:[],v:[]},this.render()},render:function(){this.domElement=$('<div class="sl-block-guides editing-ui">')},start:function(t,e){if(!1!==this.isEnabled()){this.options=$.extend({snap:!0,action:"move",threshold:6},e),this.revealScale=Reveal.getScale(),this.slideBounds=SL.view.getSlideSize(),this.slideBounds.x=0,this.slideBounds.y=0,this.slideEdges=this.getEdges(this.slideBounds,"slide-bounds");var i=$(".reveal-viewport"),n=(i.width()-this.slideBounds.width*this.revealScale)/2,o=(i.height()-this.slideBounds.height*this.revealScale)/2;if(this.domElement.css({left:Math.round(n),top:Math.round(o)}),this.domElement.appendTo($(".projector .reveal")),this.targetBlocks=t,this.debugMode&&SL.editor.controllers.Blocks.getCurrentBlocks().forEach(function(t){t.domElement.css("outline","")}),this.allBlocks=SL.editor.controllers.Blocks.getCurrentBlocks({excludeGroups:!0}),this.allBlocks=this.allBlocks.filter(function(t){return!(t.isGrouped()&&t.domElement.parents(".sl-block.is-focused").length>0)},this),this.debugMode&&this.allBlocks.forEach(function(t){t.domElement.css("outline","4px solid yellow")}),this.gridLines=[],SL.editor.controllers.Grid.isEnabled()){for(var r=SL.editor.controllers.Grid.getCols(),s=SL.editor.controllers.Grid.getRows(),a=Math.round(this.slideBounds.width/r),l=Math.round(this.slideBounds.height/s),c=1;c<r;c++)this.gridLines.push(this.getCenterEdges({x:c*a,y:0,width:0,height:this.slideBounds.height},"grid-col-"+c,"horizontal"));for(var h=1;h<s;h++)this.gridLines.push(this.getCenterEdges({x:0,y:h*l,width:this.slideBounds.width,height:0},"grid-row-"+h,"vertical"))}var u=this.getTargetBounds();this.targetBlocks.forEach(function(t){var e=t.measure().transformed;t._guideOffsetX=e.x-u.x,t._guideOffsetY=e.y-u.y})}},stop:function(){this.domElement.remove(),this.clearGuideElements(),this.targetBlocks=[],this.debugMode&&SL.editor.controllers.Blocks.getCurrentBlocks().forEach(function(t){t.domElement.css("outline","")})},sync:function(){!1!==this.isEnabled()&&this.targetBlocks.length&&(this.options.snap?(this.findGuides(this.options.threshold),this.enforceGuides(),this.findGuides(1),this.renderGuides()):(this.findGuides(this.options.threshold),this.renderGuides()))},findGuides:function(t){this.guides.h.length=0,this.guides.v.length=0;var e,i=this.getTargetBounds();if("line-anchor"===this.options.action){e=this.getCenterEdges(i,"target-bounds");var n=this.targetBlocks[0];if("line"===n.getType()){var o=this.targetBlocks[0].getGlobalLinePoint(n.getOppositePointID(this.options.direction)),r=this.getCenterEdges({x:o.x,y:o.y,width:0,height:0},"line-anchor-opposite");this.compareEdges(e,r,t)}}else e=this.getEdges(i,"target-bounds","resize"===this.options.action);this.allBlocks.forEach(function(i){var n;-1===this.targetBlocks.indexOf(i)&&(n="line"===i.getType()?this.getLineEdges(i.measure().transformed,i.getID(),i):this.getEdges(i.measure().transformed,i.getID()),this.compareEdges(e,n,t))}.bind(this)),this.gridLines.forEach(function(i){this.compareEdges(e,i,t)}.bind(this)),this.compareEdges(e,this.slideEdges,t),this.guides.h.sort(function(t,e){return t.distance-e.distance}),this.guides.v.sort(function(t,e){return t.distance-e.distance})},compareEdges:function(t,e,i){var n;t.h.forEach(function(t){e.h.forEach(function(e){(n=Math.abs(t.x-e.x))<i&&this.guides.h.push({distance:n,targetEdge:t,compareEdge:e})}.bind(this))}.bind(this)),t.v.forEach(function(t){e.v.forEach(function(e){(n=Math.abs(t.y-e.y))<i&&this.guides.v.push({distance:n,targetEdge:t,compareEdge:e})}.bind(this))}.bind(this))},enforceGuides:function(){if("resize"===this.options.action){var t=this.targetBlocks[0];if(t.transform.isResizingCentered())return;var e={n:0,e:0,s:0,w:0,hc:0,vc:0};this.guides.h=this.guides.h.filter(function(t){return 1==++e[t.targetEdge.direction]}),this.guides.v=this.guides.v.filter(function(t){return 1==++e[t.targetEdge.direction]}),this.guides.h.forEach(function(e){/w|e/.test(this.options.direction)&&this.options.direction.indexOf(e.targetEdge.direction)>-1&&(/w/.test(e.targetEdge.direction)?t.resize({left:e.compareEdge.x,direction:e.targetEdge.direction}):/e/.test(e.targetEdge.direction)&&t.resize({right:e.compareEdge.x,direction:e.targetEdge.direction}))}.bind(this)),this.guides.v.forEach(function(e){/n|s/.test(this.options.direction)&&this.options.direction.indexOf(e.targetEdge.direction)>-1&&(/n/.test(e.targetEdge.direction)?t.resize({top:e.compareEdge.y,direction:e.targetEdge.direction}):/s/.test(e.targetEdge.direction)&&t.resize({bottom:e.compareEdge.y,direction:e.targetEdge.direction}))}.bind(this))}else if("move"===this.options.action)this.guides.h.splice(1),this.guides.v.splice(1),this.guides.h.forEach(function(t){this.targetBlocks.forEach(function(e){e.move({x:t.compareEdge.x+t.targetEdge.offset+e._guideOffsetX})}.bind(this))}.bind(this)),this.guides.v.forEach(function(t){this.targetBlocks.forEach(function(e){e.move({y:t.compareEdge.y+t.targetEdge.offset+e._guideOffsetY})}.bind(this))}.bind(this));else if("line-anchor"===this.options.action){var i=this.targetBlocks[0];this.guides.h.length&&i.setGlobalLinePoint(this.options.direction,this.guides.h[0].compareEdge.x),this.guides.v.length&&i.setGlobalLinePoint(this.options.direction,null,this.guides.v[0].compareEdge.y)}},renderGuides:function(){var t=[],e=this.getTargetBounds();this.guides.h.forEach(function(i){t.push(this.renderGuide(i,e))}.bind(this)),this.guides.v.forEach(function(i){t.push(this.renderGuide(i,e))}.bind(this)),this.clearGuideElements(t)},renderGuide:function(t,e){var i=t.targetEdge,n=t.compareEdge,o=$('[data-guide-id="'+n.id+'"]');0===o.length&&(o=$('<div data-guide-id="'+n.id+'">').appendTo(this.domElement));var r={top:Math.min(n.bounds.y,e.y)*this.revealScale,right:Math.max(n.bounds.x+n.bounds.width,e.x+e.width)*this.revealScale,bottom:Math.max(n.bounds.y+n.bounds.height,e.y+e.height)*this.revealScale,left:Math.min(n.bounds.x,e.x)*this.revealScale};if("number"==typeof n.y){var s="s"===i.direction?-1:0;o.addClass("guide-h"),o.css({top:Math.floor((n.y+s)*this.revealScale),left:r.left,width:r.right-r.left})}else{var a="e"===i.direction?-1:0;o.addClass("guide-v"),o.css({left:Math.floor((n.x+a)*this.revealScale),top:r.top,height:r.bottom-r.top})}return n.id},getEdges:function(t,e,i){var n={h:[{id:e+"-h1",bounds:t,x:t.x,offset:0,direction:"w"},{id:e+"-h2",bounds:t,x:t.x+t.width/2,offset:-t.width/2,direction:"hc"},{id:e+"-h3",bounds:t,x:t.x+t.width,offset:-t.width,direction:"e"}],v:[{id:e+"-v1",bounds:t,y:t.y,offset:0,direction:"n"},{id:e+"-v2",bounds:t,y:t.y+t.height/2,offset:-t.height/2,direction:"vc"},{id:e+"-v3",bounds:t,y:t.y+t.height,offset:-t.height,direction:"s"}]};return!0===i&&(n.h.splice(1,1),n.v.splice(1,1)),n},getCenterEdges:function(t,e,i){var n={h:[],v:[]},o={id:e+"-v2",bounds:t,y:t.y+t.height/2,offset:-t.height/2,direction:e},r={id:e+"-h2",bounds:t,x:t.x+t.width/2,offset:-t.width/2,direction:e};return i&&"vertical"!==i||n.v.push(o),i&&"horizontal"!==i||n.h.push(r),n},getLineEdges:function(t,e,i){var n={h:[],v:[]},o=[i.getGlobalLinePoint("p1"),i.getGlobalLinePoint("p2")];return o.push({x:t.x+(Math.max(o[0].x,o[1].x)-Math.min(o[0].x,o[1].x))/2,y:t.y+(Math.max(o[0].y,o[1].y)-Math.min(o[0].y,o[1].y))/2}),o.forEach(function(t,i){var o={x:t.x,y:t.y,width:0,height:0};n.v.push({id:e+"-v"+i,bounds:o,y:o.y,offset:0,direction:e}),n.h.push({id:e+"-h"+i,bounds:o,x:o.x,offset:0,direction:e})}),n},getTargetBounds:function(){if(this.options&&"line-anchor"===this.options.action&&this.targetBlocks.length&&"line"===this.targetBlocks[0].getType()){var t=this.targetBlocks[0].getGlobalLinePoint(this.options.direction);return{x:t.x,y:t.y,width:1,height:1}}return SL.editor.controllers.Blocks.getCombinedBounds(this.targetBlocks)},clearGuideElements:function(t){var e=this.domElement.find(".guide-v, .guide-h");t&&t.length&&(e=e.filter(function(e,i){return-1===t.indexOf(i.getAttribute("data-guide-id"))})),e.remove()},isEnabled:function(){return!!SL.editor.controllers.Capabilities.isTouchEditor()||SL.current_user.settings.get("editor_snap")}},SL("editor.controllers").History={MAX_SIZE:100,MAX_FREQUENCY:1500,MODE_RESTING:1,MODE_UNDOING:2,MODE_REDOING:3,init:function(){this.reset(),this.changed=new signals.Signal,this.undid=new signals.Signal,this.redid=new signals.Signal},reset:function(){this.past=[],this.future=[],this.mode=SL.editor.controllers.History.MODE_RESTING,this.lastPushTime=-1},push:function(t,e){if(e=e||{},Date.now()-this.lastPushTime>SL.editor.controllers.History.MAX_FREQUENCY||e.skipTimeLimit){this.lastPushTime=Date.now();var i={data:t,indices:Reveal.getIndices()};i.focusedBlocks=SL.editor.controllers.Blocks.getFocusedBlocks().map(function(t){return t.getID()});var n=SL.editor.controllers.Mode.get();n&&(i.mode=n.id,i.modeState=n.getState());var o=this.past[this.past.length-1],r=this.future[this.future.length-1],s=!o||i.data!==o.data,a=!r||i.data!==r.data;if(e.includeModeChanges&&o&&(s=s||i.mode!==o.mode),e.includeModeChanges&&r&&(a=a||i.mode!==r.mode),s&&a){this.future.length&&this.past.push(this.future.pop());var l=this.past[this.past.length-1];!l||l.indices.h===i.indices.h&&l.indices.v===i.indices.v||this.past.push($.extend({},l,{indices:i.indices})),this.future.length=0,this.past.push(i),this.mode=SL.editor.controllers.History.MODE_RESTING,this.changed.dispatch()}for(;this.past.length>SL.editor.controllers.History.MAX_SIZE;)this.past.shift()}},undo:function(t){t=t||{};var e=this.past.pop();return e&&this.mode!==SL.editor.controllers.History.MODE_UNDOING&&(this.future.push(e),e=this.past.pop()),e&&(this.mode=SL.editor.controllers.History.MODE_UNDOING,this.future.push(e),this.lastPushTime=Date.now(),t.ignoreMode&&((e=JSON.parse(JSON.stringify(e))).mode=null),this.undid.dispatch(e),this.changed.dispatch()),e},redo:function(t){t=t||{};var e=this.future.pop();return e&&this.mode!==SL.editor.controllers.History.MODE_REDOING&&(this.past.push(e),e=this.future.pop()),e&&(this.mode=SL.editor.controllers.History.MODE_REDOING,this.past.push(e),this.lastPushTime=Date.now(),t.ignoreMode&&((e=JSON.parse(JSON.stringify(e))).mode=null),this.redid.dispatch(e),this.changed.dispatch()),e},canUndo:function(){return this.past.length>1||1===this.past.length&&this.deckHasChanged()},canRedo:function(){return this.future.length>0},deckHasChanged:function(){return this.past[this.past.length-1].data!==SL.editor.controllers.Serialize.getDeckAsString()},pushLatest:function(t){SL.editor.controllers.History.push(SL.editor.controllers.Serialize.getDeckAsString(),$.extend({skipTimeLimit:!0},t))},getLatestState:function(){return this.past[this.past.length-1]}},SL("editor.controllers").Markup={init:function(t){this.editor=t,this.slidesChanged=new signals.Signal,this.slideRemoved=new signals.Signal},getCurrentSlide:function(){return $(Reveal.getCurrentSlide())},getCurrentHorizontalSlide:function(){var t=$(Reveal.getCurrentSlide());return t.parent("section.stack").length&&(t=t.parent("section.stack")),t},getFocusedSlide:function(){return $(".reveal .slides .present[contenteditable]:focus")},addHorizontalSlide:function(t){t=t||"<section></section>";var e=SLConfig.deck.rtl?"past":"future",i=$(t);if(i.is("section")){var n=i.get(0);SL.editor.controllers.Blocks.blur(),i.addClass(e),i.insertAfter(this.getCurrentHorizontalSlide()),Reveal.slide(),Reveal.sync(),SL.editor.controllers.Blocks.syncNewSlide(i);var o=n.hasAttribute("data-auto-animate");return o&&n.removeAttribute("data-auto-animate"),SLConfig.deck.rtl?Reveal.navigateLeft():Reveal.navigateRight(),o&&n.setAttribute("data-auto-animate",""),this.afterTemplateInserted(i),this.afterSlidesChanged(),this.persistSlideNotes(n),i}},addVerticalSlide:function(t){t=t||"<section></section>";var e=this.getCurrentHorizontalSlide();e.hasClass("stack")||(e=e.wrap('<section class="present">').parent()).addClass("stack");var i=$(t);if(i.is("section")){var n=Reveal.getIndices();SL.editor.controllers.Blocks.blur(),i.addClass("future");var o=e.find("section.present");return o.length?i.insertAfter(o):e.append(i),Reveal.slide(n.h,n.v),SL.editor.controllers.Blocks.syncNewSlide(i),this.editor.navigateToSlide(i.get(0)),this.editor.navigateToSlide(i.get(0)),Reveal.sync(),this.afterTemplateInserted(i),this.afterSlidesChanged(),this.persistSlideNotes(i.get(0)),i}},replaceCurrentSlide:function(t){return this.replaceSlide(Reveal.getCurrentSlide(),t)},replaceSlide:function(t,e){e=e||"<section></section>",t=$(t||Reveal.getCurrentSlide());var i=$(e);if(i.is("section"))return i.addClass("present"),t.replaceWith(i),Reveal.slide(),Reveal.sync(),SL.editor.controllers.Blocks.sync(),this.afterTemplateInserted(i),SL.util.deck.afterSlidesChanged(),i},mergeHorizontalSlides:function(t,e){t.length&&e.length&&(stack=t.wrap('<section class="present">').parent(),stack.addClass("stack"),stack.append(e),SL.editor.controllers.Blocks.sync(),Reveal.sync(),SL.util.deck.afterSlidesChanged())},unwrapEmptyStacks:function(){$(".reveal .slides section.stack").each(function(){var t=$(this);1===t.find(">section").length?t.find(">section").first().unwrap():0===t.find(">section").length&&t.remove()})},removeCurrentSlide:function(){var t=Reveal.getIndices();$(".reveal .slides .present .present").remove().length>0?1===$(".reveal .slides .present>section").length&&$(".reveal .slides .present>section:eq(0)").unwrap():$(".reveal .slides>section").length>1&&$(".reveal .slides>.present").remove(),Reveal.slide(t.h,t.v),Reveal.sync(),this.afterSlidesChanged(),this.slideRemoved.dispatch(),SL.analytics.trackEditor("remove_slide")},toggleSlideHidden:function(t,e,i){var n=SL.editor.controllers.Markup.isSlideHidden(t);return("boolean"==typeof i?i:!n)?(t.setAttribute("data-visibility","hidden"),n||this.afterSlidesChanged(),!1!==e&&SL.notify(SL.locale.get("SLIDE_VISIBILITY_OFF")),!0):(t.removeAttribute("data-visibility"),n&&this.afterSlidesChanged(),!1!==e&&SL.notify(SL.locale.get("SLIDE_VISIBILITY_ON")),!1)},isSlideHidden:function(t){return"hidden"===t.getAttribute("data-visibility")},hasHiddenSlides:function(){
return document.querySelectorAll('section[data-visibility="hidden"]').length>0},isEmptyDeck:function(){return 1===Reveal.getTotalSlides()&&SL.editor.controllers.Markup.isEmptySlide(Reveal.getCurrentSlide())},isEmptySlide:function(t){var e=["data-background-image","data-background-video","data-background-iframe"].some(function(e){return t.hasAttribute(e)});return 0===t.childElementCount&&!e},persistSlideNotes:function(t){if(t&&t.getAttribute){var e=t.getAttribute("data-id"),i=t.getAttribute("data-notes");e&&i&&(SLConfig.deck.notes[e]=i,t.removeAttribute("data-notes"))}},writeHTMLToCurrentSlide:function(t){Reveal.getCurrentSlide().innerHTML=t,SL.util.html.trimCode(Reveal.getCurrentSlide()),SL.editor.controllers.Blocks.sync(),SL.editor.controllers.Blocks.discoverBlockPairs()},replaceHTML:function(t,e){var i="object"==typeof(e=e||{}).state?e.state:Reveal.getState();Reveal.getSlidesElement().innerHTML=t,Reveal.setState(i),Reveal.sync(),SL.editor.controllers.Blocks.sync(),this.afterSlidesChanged(e)},insertAfter:function(t,e){t=$(t),e=$(e||Reveal.getCurrentSlide()),t&&t.length&&e.length&&(e.after(t),Reveal.sync(),Reveal.slide(),SL.editor.controllers.Blocks.sync(),Reveal.next(),this.afterSlidesChanged())},importSlides:function(t,e){if((t=$(t))&&t.length){var i=$(Reveal.getSlidesElement());e&&i.empty(),t.each(function(t,e){this.importSlide(e,i)}.bind(this)),Reveal.sync(),Reveal.slide(0,0),SL.editor.controllers.Blocks.sync(),this.afterSlidesChanged()}},importSlide:function(t,e){if(t=$(t),(e=$(e)).append(t),t.css("display","block"),t.removeAttr("data-markdown"),t.find(">section").length)t.find(">section").each(function(e,i){this.importSlide(i,t)}.bind(this));else{var i=[],n=[];t.children().each(function(){var t=$(this);if(t.is(".sl-block"))i.push(t.remove().prop("outerHTML"));else if("absolute"===t.css("position")){var e=t.position(),o={width:t.outerWidth(),x:e.left,y:e.top};t.css({position:"relative",top:"",right:"",bottom:"",left:""}),o.html=t.prop("outerHTML"),n.push(o),t.remove()}}),n.push({html:t.html(),width:SL.util.deck.getSlideSize().width}),t.empty(),n.forEach(function(e){if(e.html.trim().length>0)SL.editor.controllers.Blocks.add({type:"text",parent:t,silent:!0,width:e.width,x:e.x,y:e.y,afterInit:function(t){t.setCustomHTML(e.html)}})}),i.forEach(function(e){t.append(e)})}t.css("display",""),SL.util.deck.generateIdentifiers(t);var o=t.attr("data-id"),r=t.find("aside.notes");if(r.length){var s=r.text().trim().substr(0,SL.config.SPEAKER_NOTES_MAXLENGTH);s&&s.length>1&&(SLConfig.deck.notes[o]=s,r.remove())}},afterTemplateInserted:function(t){SL.editor.controllers.Blocks.migrateBlockRelations(t.find(".sl-block")),SL.data.templates.layoutTemplate(t),SL.editor.controllers.Blocks.invalidateBlockMeasurements(),SL.editor.controllers.AutoAnimate.isEnabled(t.get(0))&&SL.editor.controllers.AutoAnimate.afterAutoAnimateEnabled(t.get(0))},afterSlidesChanged:function(t){SL.util.deck.afterSlidesChanged(),this.slidesChanged.dispatch(),t&&t.skipHistory||SL.editor.controllers.History.pushLatest()}},SL("editor.controllers").Media={init:function(){this.setupDragAndDrop(),this.setupPasteFromClipboard()},canDragAndDrop:function(){return!SL.popup.isOpen(SL.components.medialibrary.MediaLibrary)},setupDragAndDrop:function(){var t=$(['<div class="drag-and-drop-instructions">','<div class="inner">',"Drop to insert media","</div>","</div>"].join(""));SL.draganddrop.subscribe({onDragOver:function(){t.appendTo(document.body)}.bind(this),onDragOut:function(){t.remove()}.bind(this),onDrop:function(e){t.remove();var i=e.originalEvent.dataTransfer.files[0];if(i)if(SL.current_user.hasStorageLimit()&&SL.current_user.isExceedingStorageLimit())SL.notify("You have reached the storage limit for your current plan.",{optional:!1,buttons:[{label:"Dismiss",className:"black-30"},{label:"View upgrade options",callback:function(){window.location=SL.routes.PRICING}}]});else if(/(image|video).*/.test(i.type)){var n=SL.models.Media.getTypeFromContentType(i.type),o=SL.models.Media.create({type:n},null,i);o.upload(),SL.editor.controllers.Blocks.add({type:n.toLowerCase(),parent:$(SL.editor.controllers.Markup.getCurrentSlide())}).setMediaModel(o)}else{var r=SL.util.math.bytesToMegabytes(SL.current_user.get("image_upload_limit"),!0),s=SL.util.math.bytesToMegabytes(SL.current_user.get("video_upload_limit"),!0);SL.notify("Invalid file. We support <strong>PNG</strong>, <strong>JPG</strong>, <strong>GIF</strong> and <strong>SVG</strong> images up to <strong>"+r+" MB</strong> and videos up to <strong>"+s+" MB</strong>.","negative")}}.bind(this)})},setupPasteFromClipboard:function(){$(document).on("paste",function(t){if(setTimeout(function(){$("img[src^=webkit-fake-url]").remove()},1),!SL.util.isTyping()){var e=t.clipboardData.getData("text/plain");if("string"==typeof e&&e.length)if(!0===/^<svg/.test(e))this.uploadImageFromSVGString(e);else if(!1===/<\//g.test(e)){var i=e.split("\n"),n=0;(i=i.map(function(t){var e=t.split("\t");return n=Math.max(e.length,n),e})).length>1&&n>1&&this.insertTableFromClipboard(i)}}}.bind(this)),$(document).pasteImageReader(function(t){SL.util.isTyping()||t&&t.file&&t.dataURL&&this.uploadImageBlob(t.file,"pasted-from-clipboard.png")}.bind(this))},insertTableFromClipboard:function(t){var e=SL.editor.controllers.Blocks.getFocusedBlocks();if(1===e.length&&"table"===e[0].getType())e[0].setRows(t);else SL.editor.controllers.Blocks.add({type:"table",blockOptions:{rows:t}})},uploadImageBlob:function(t,e,i){if(t&&e&&t.type.match(/image.*/)){var n=SL.models.Media.create({type:SL.models.Media.IMAGE.type},null,t,e);n.upload(),i=$.extend({type:"image",parent:$(SL.editor.controllers.Markup.getCurrentSlide())},i),SL.editor.controllers.Blocks.add(i).setMediaModel(n)}},uploadImageFromSVGString:function(t){const e=document.createElement("div");e.innerHTML=t;const i=e.children[0];if(document.body.appendChild(e),i.hasAttribute("xmlns")&&i.hasAttribute("width")&&i.hasAttribute("height")){let e,n=parseInt(i.getAttribute("width"),10),o=parseInt(i.getAttribute("height"),10);if(!isNaN(n)&&!isNaN(o)){const t=SL.util.deck.getSlideSize();if(n>t.width||o>t.height){const i=SL.util.math.fitWithin(n,o,t.width,t.height);e={width:Math.round(i.width),height:Math.round(i.height)}}else e={width:n,height:o}}const r=new Blob([t],{type:"image/svg+xml"}),s="paste-from-clipboard.svg",a=new File([r],s,{lastModified:new Date,type:"image/svg+xml"});this.uploadImageBlob(a,s,e)}}},SL("editor.controllers").Migration={init:function(){this.migrateEditorSettings(),this.disableBlockTranslation()},migrateEditorSettings:function(){var t="editorSnap",e="editorGrid",i=SL.settings.getValue(e),n=SL.settings.getValue(t);"boolean"!=typeof i&&"boolean"!=typeof n||(SL.settings.removeValue([e,t]),SL.current_user.settings.set("editor_grid",i),SL.current_user.settings.set("editor_snap",n),SL.current_user.settings.save(["editor_grid","editor_snap"]))},disableBlockTranslation:function(){$('.sl-block[data-block-type="math"]:not(.notranslate) .sl-block-content,.sl-block[data-block-type="code"]:not(.notranslate) .sl-block-content').addClass("notranslate")}},SL("editor.controllers").Mode={init:function(t,e){for(var i in this.editor=t,this.modes=e,this.modeActivated=new signals.Signal,this.modeDeactivated=new signals.Signal,this.modes)this.modes[i].activated.add(this.onModeActivated.bind(this,i)),this.modes[i].deactivated.add(this.onModeDeactivated.bind(this,i))},clear:function(){var t=this.get($("html").attr("data-mode"));t&&t.isActive()&&t.deactivate()},change:function(t){this.clear();var e=this.get(t);e&&this.editor.sidebar.close().then(function(){e.activate()}.bind(this))},toggle:function(t){var e=this.get(t);if(e&&e.isActive())e.deactivate();else if(e){var i=$("html").attr("data-mode");i&&i!==t&&(currentMode=this.get(i),currentMode&&currentMode.isActive()&&currentMode.deactivate()),this.editor.sidebar.close().then(function(){e.activate()}.bind(this))}},get:function(t){return t||(t=$("html").attr("data-mode")),this.modes[t]?this.modes[t]:null},isActive:function(t){return!!this.modes[t]&&this.modes[t].isActive()},onModeActivated:function(t){SL.editor.controllers.Blocks.blur(),this.modeActivated.dispatch(t)},onModeDeactivated:function(t){Reveal.configure({keyboard:this.editor.getRevealKeyboardConfig(),slideNumber:SLConfig.deck.slide_number,minScale:SL.editor.controllers.Capabilities.isTouchEditor()?.4:SL.config.EDITOR_MIN_SCALE}),setTimeout(Reveal.layout,1),this.editor.layout(),this.modeDeactivated.dispatch(t)}},SL("editor.controllers").Onboarding={init:function(){this.ended=new signals.Signal,this.visible=!1,this.onTutorialSkipped=this.onTutorialSkipped.bind(this),this.onTutorialFinished=this.onTutorialFinished.bind(this),SL.util.getQuery().tutorial?this.start():SL.current_user.get("editor_tutorial_completed")||SL.util.device.IS_PHONE||SL.util.device.IS_TABLET||this.start()},start:function(){this.visible=!0;var t=[this.step0,this.step1,this.step2];this.hasTextBlock()&&t.push(this.step3,this.step4),t.push(this.step5,this.step6,this.step7,this.step8),this.tutorial=new SL.components.Tutorial({context:this,steps:t}),this.tutorial.skipped.add(this.onTutorialSkipped),this.tutorial.finished.add(this.onTutorialFinished),this.tutorial.step(0),$("html").addClass("onboarding-open")},stop:function(){this.visible=!1,$.ajax({url:SL.endpoints.UPDATE_USER,type:"PUT",context:this,data:{user:{editor_tutorial_completed:!0}}}),this.tutorial.destroy(),this.ended.dispatch(),$("html").removeClass("onboarding-open")},isVisible:function(){return this.visible},getTextBlock:function(){return $(Reveal.getCurrentSlide()).find('.sl-block[data-block-type="text"]').first()},hasTextBlock:function(){return this.getTextBlock().length>0},onTutorialSkipped:function(){this.stop(),SL.analytics.trackEditor("onboarding_skipped")},onTutorialFinished:function(){var t=$(".sl-templates");t.length&&t.data("instance")&&(t.css("background",""),t.data("instance").hide()),this.stop(),SL.analytics.trackEditor("onboarding_finished")},step0:{forwards:function(){var t="<h3>Meet the Slides editor</h3><p>Click <b>Next</b> to take a quick tour.</p>";this.tutorial.message(t,{anchor:$(".sl-tutorial-controls-inner"),alignment:"t",maxWidth:450})}},step1:{forwards:function(){var t;t=SL.current_user.isPaid()?"<h3>Top Level Options</h3><p>Set the <b>presentation title, privacy, theme and arrange slides</b> from here. You can also manage importing and exporting</p>":"<h3>Top Level Options</h3><p>Set the <b>presentation title, privacy, theme and arrange slides</b> from here.</p>",this.tutorial.cutout($(".sidebar")),this.tutorial.message(t,{anchor:$(".sidebar"),alignment:"r"})},backwards:function(){this.tutorial.clearCutout(),this.tutorial.clearMessage()}},step2:{forwards:function(){this.tutorial.cutout($(".toolbars")),this.tutorial.message("<h3>Add New Content</h3><p>Click on any of these to add a <b>block</b> of content to the current slide.</p>",{anchor:$(".toolbars"),alignment:"r"})},backwards:function(){this.tutorial.clearCutout(),this.tutorial.clearMessage()}},step3:{forwards:function(){this.tutorial.cutout(this.getTextBlock()),this.tutorial.message("<h3>Example Text Block</h3><p>Single-click to focus or double-click to edit text.</p>",{anchor:this.getTextBlock(),alignment:"b"})},backwards:function(){this.tutorial.clearCutout(),this.tutorial.clearMessage()}},step4:{forwards:function(){this.tutorial.cutout($(".toolbars")),this.tutorial.message("<h3>Block Options</h3><p>Options for the selected block. For text blocks this includes <b>alignment, color, size</b> and more.</p>",{anchor:$(".toolbars"),alignment:"r"}),SL.editor.controllers.Blocks.focus(SL.editor.controllers.Blocks.getCurrentBlocks()[0])},backwards:function(){this.tutorial.clearCutout(),this.tutorial.clearMessage(),SL.editor.controllers.Blocks.blur()}},step5:{forwards:function(){SL.editor.controllers.Blocks.blur(),this.tutorial.cutout($(".sl-slide-menu"),{padding:4}),this.tutorial.message("<h3>Slide Options</h3><p>Options for the current slide, such as <b>background color/image and speaker notes</b>.</p>",{anchor:$(".sl-slide-menu"),alignment:$(".sl-slide-menu").offset().left<window.innerWidth/2?"r":"l"})},backwards:function(){this.tutorial.clearCutout(),this.tutorial.clearMessage()}},step6:{forwards:function(){this.tutorial.cutout($(".add-horizontal-slide"),{padding:4}),this.tutorial.message("<h3>Adding a Slide</h3><p>Click the plus button to add a new slide.</p>",{anchor:$(".add-horizontal-slide"),alignment:"l"})},backwards:function(){this.tutorial.clearCutout(),this.tutorial.clearMessage()}},step7:{forwards:function(){$(".add-horizontal-slide").click(),$(".sl-templates").css("background","transparent"),this.tutorial.cutout($(".sl-templates-inner")),this.tutorial.message('<h3>Choose a Template</h3><p>When adding a new slide you get to choose from templates. You can save your own templates in the "'+SL.locale.get("TEMPLATE_PERSONAL_TEMPLATES_LABEL")+'" tab.</p>',{anchor:$(".sl-templates-inner"),alignment:"l"})},backwards:function(){var t=$(".sl-templates");t.length&&(t.css("background",""),t.data("instance").hide()),this.tutorial.clearCutout(),this.tutorial.clearMessage()}},step8:{forwards:function(){var t=$(".sl-templates");t.length&&(t.css("background",""),t.data("instance").hide());var e=$(".sl-collab-menu-item:visible").first();this.tutorial.cutout(e,{padding:4}),this.tutorial.message("<h3>Collaborate</h3><p>Invite others to edit or leave feedback on your presentation.</p>",{anchor:e,alignment:"tl"})},backwards:function(){this.tutorial.clearCutout(),this.tutorial.clearMessage()}}},SL("editor.controllers").Revisions={restore:function(t){return SL.analytics.trackEditor("revision_restore"),SL.helpers.PageLoader.show({message:"Restoring..."}),$.ajax({type:"post",url:SL.endpoints.RESTORE_DECK_VERSION(SLConfig.deck.id,t),context:this}).done(function(t){t&&"string"==typeof t.slug?window.location=SL.routes.DECK_EDIT(SLConfig.deck.user.username,t.slug||SLConfig.deck.id):window.location.reload()}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR")),SL.helpers.PageLoader.hide()})},rollback:function(){$.ajax({url:SL.endpoints.GET_DECK_VERSIONS(SLConfig.deck.id),data:{page:1},context:this}).done(function(t){t.results.length&&SL.editor.controllers.Revisions.restore(t.results[0].id)}).fail(function(){SL.notify(SL.locale.get("GENERIC_ERROR"))})},getLatestVersionID:function(t,e){e=e||0,$.ajax({url:SL.endpoints.GET_DECK_VERSIONS(SLConfig.deck.id),data:{page:1},context:this}).done(function(i){i.results.length&&i.results[e]?t(i.results[e].id):t(undefined)}).fail(function(){t(undefined),SL.notify(SL.locale.get("GENERIC_ERROR"))})}},SL("editor.controllers").Selection={init:function(){this.selecting=!1,this.domElement=$('<div class="sl-block-selection editing-ui">'),this.syncFocus=$.throttle(this.syncFocus.bind(this),50)},start:function(t,e,i){if(!this.selecting){this.selecting=!0;var n=$(".projector");this.domElement.appendTo(n);var o=n.offset();this.offsetX=-o.left,this.offsetY=-o.top,this.startX=t+this.offsetX,this.startY=e+this.offsetY;SL.editor.controllers.Markup.getCurrentSlide();this.currentTargets=SL.editor.controllers.Blocks.getCurrentBlocks({excludeLocked:!0,excludeGrouped:!0}),this.currentTargets=this.currentTargets.map(function(t){return t.isGroup()?{block:t,hitTargets:t.getBlocks()}:{block:t,hitTargets:[t]}}),this.initiallyFocusedBlocks=[],i&&(this.initiallyFocusedBlocks=SL.editor.controllers.Blocks.getFocusedBlocks());var r=$(".reveal-viewport");this.slideScale=Reveal.getScale(),this.slideBounds=SL.view.getSlideSize(),this.slideBounds.x=(r.width()-this.slideBounds.width*this.slideScale)/2,this.slideBounds.y=(r.height()-this.slideBounds.height*this.slideScale)/2,this.sync(t,e)}},sync:function(t,e){if(this.selecting){var i={width:t+this.offsetX-this.startX,height:e+this.offsetY-this.startY};i.x=this.startX+Math.min(i.width,0),i.y=this.startY+Math.min(i.height,0),i.width=Math.abs(i.width),i.height=Math.abs(i.height),this.domElement.css({left:i.x,top:i.y,width:i.width,height:i.height}),0===i.width&&0===i.height||(i.x=(i.x-this.slideBounds.x)/this.slideScale,i.y=(i.y-this.slideBounds.y)/this.slideScale,i.width/=this.slideScale,i.height/=this.slideScale,i.width=Math.max(i.width,1),i.height=Math.max(i.height,1),this.syncFocus(i))}else this.start.apply(this,arguments)},syncFocus:function(t){var e=[],i=[];this.currentTargets.forEach(function(n){var o=this.initiallyFocusedBlocks.length&&-1!==this.initiallyFocusedBlocks.indexOf(n.block);n.hitTargets.some(function(e){return e.hitTest(t)})?o?i.push(n.block):e.push(n.block):o?e.push(n.block):i.push(n.block)}.bind(this)),e.length&&SL.editor.controllers.Blocks.focus(e,!0,!1),i.length&&SL.editor.controllers.Blocks.blur(i)},stop:function(){this.selecting=!1,this.domElement.remove()}},SL("editor.controllers").Serialize={slideCache:{},init:function(){setInterval(function(){delete SL.editor.controllers.Serialize.slideCache,SL.editor.controllers.Serialize.slideCache={}},18e4)},getDeckAsString:function(t){var e=SL.util.html.muteSources($(".reveal .slides").html()),i=$("<div>");i.get(0).innerHTML=e,i.find(">.backgrounds").remove(),i.find(".editing-ui").remove();var n=i.find(">section").map(function(e,i){if((i=$(i)).hasClass("stack")){var n=i.find(">section").map(function(e,i){return this.formatSlideForSave(i,t).get(0).outerHTML}.bind(this)).toArray().join("");return i=this.formatSlideForSave(i.empty(),t),"<section "+$.map(i.get(0).attributes,function(t){return t.name+'="'+t.value+'"'}).join(" ")+">"+n+"</section>"}return this.formatSlideForSave(i,t).get(0).outerHTML}.bind(this)).toArray().join(""),o=SL.util.html.unmuteSources(n);return o=o.trim()},getSlideAsString:function(t,e){e=$.extend({inner:!1},e),(t=$(t)).find("section").length&&(t=t.find("section").first());var i=SL.util.html.muteSources(t.prop("outerHTML"));return t=$(i),t=this.formatSlideForSave(t,e),SL.util.html.unmuteSources(t.prop(e.inner?"innerHTML":"outerHTML"))},getFirstSlideAsString:function(t){return this.getSlideAsString($(".reveal .slides section").first(),t)},formatSlideForSave:function(t,e){e=$.extend({exclude:null,templatize:!1,removeSlideIds:!1,removeBlockIds:!1,removeTextPlaceholders:!1,lazy:!0},e);var i=(t=$(t)).get(0),n=i.outerHTML+JSON.stringify(e),o=SL.editor.controllers.Serialize.slideCache[n];if(o&&o.length)return o;if((e.templatize||e.removeSlideIds)&&t.removeAttr("data-id"),e.templatize?t.find("[data-block-id]").each(function(){this.setAttribute("data-origin-id",this.getAttribute("data-block-id")),this.removeAttribute("data-block-id")}):e.removeBlockIds&&t.find("[data-block-id]").removeAttr("data-block-id"),e.removeTextPlaceholders&&(t.find("[data-placeholder-tag]").removeAttr("data-placeholder-tag"),t.find("[data-placeholder-text]").removeAttr("data-placeholder-text")),e.exclude&&t.find(e.exclude).remove(),SL.util.html.removeAttributes(t,function(t){return/(style|contenteditable|hidden|aria-hidden|data\-index\-.|data\-previous\-indexv|data\-fragment)/gi.test(t)}),SL.util.html.trimCode(t),t.removeClass(SL.config.RESERVED_SLIDE_CLASSES.join(" ")),""===i.getAttribute("class")&&i.removeAttribute("class"),i.hasAttribute("data-auto-animate")&&""!==i.getAttribute("data-auto-animate")&&i.setAttribute("data-auto-animate",""),t.find("[data-auto-animate-target]").removeAttr("data-auto-animate-target"),t.find(".fragment").removeClass("visible disabled current-fragment"),e.lazy){var r=SL.util.html.ATTR_SRC_SILENCED;t.find("iframe["+r+"], img["+r+"], video["+r+"], audio["+r+"]").each(function(){this.setAttribute("data-src",this.getAttribute(SL.util.html.ATTR_SRC_SILENCED)),this.removeAttribute(SL.util.html.ATTR_SRC_SILENCED)})}return t.find(".navigate-up, .navigate-right, .navigate-down, .navigate-left, .navigate-next, .navigate-prev").removeClass("enabled"),t.find(".editing-ui, .math-output").remove(),t.find("grammarly-btn").remove(),t.find("*:not(iframe)").contents().each(function(){8===this.nodeType&&$(this).remove()}),t.find("a[data-cke-saved-href]").each(function(){this.removeAttribute("data-cke-saved-href")}),t.find(".sl-block, .sl-block-content").each(function(t,e){e=$(e),SL.util.html.removeClasses(e,function(t){return/(is\-focused|is\-editing|is\-open(\-nested|target)?|has\-preview|^visible|is\-text\-overflowing|is\-cropping|is\-panning|^cke_|intro\-.|animate|animation\-trigger)/gi.test(t)}),SL.util.html.removeAttributes(e,function(t){return/(contenteditable|tabindex|spellcheck|role|title|aria\-.)/gi.test(t)})}),t.find('.sl-block[data-block-type="table"]').each(function(t,e){(e=$(e)).find("table .context-menu-is-open").removeClass("context-menu-is-open"),e.find('table [class=""]').removeAttr("class"),e.find('table [style=""]').removeAttr("style"),e.find("td [contenteditable], th [contenteditable]").each(function(t,e){e.parentNode.innerHTML=e.innerHTML})}),t.find('.sl-block[data-block-type="image"] img').css("display",""),SL.editor.controllers.Serialize.slideCache[n]=t,t}},SL("editor.controllers").Thumbnail={init:function(){this.invalidated=!1},generate:function(){$.ajax({type:"POST",url:SL.endpoints.THUMBNAIL_DECK(SLConfig.deck.id)}),this.invalidated=!1},invalidate:function(){this.invalidated=!0},isInvalidated:function(){return this.invalidated}},SL("editor.controllers").URL={init:function(){this.changed=new signals.Signal,this.xFrameCache={},setTimeout(this.read.bind(this),1)},read:function(){var t=SL.util.getQuery();"settings"===t.l?SL.view.sidebar.open("settings"):"comments"===t.l&&SL.view.collaboration&&SL.view.collaboration.expand()},write:function(){window.history&&"function"==typeof window.history.replaceState&&window.history.replaceState(null,SLConfig.deck.title,SL.routes.DECK_EDIT(SLConfig.deck.user.username,SLConfig.deck.slug)),this.changed.dispatch()},isBlockedByXFrameOptions:function(t){return new Promise(function(e,i){if(SL.util.string.URL_REGEX.test(t))if(this.xFrameCache[t]=this.xFrameCache[t]||{},"yes"===this.xFrameCache[t].blocked)e(!0);else if("no"===this.xFrameCache[t].blocked)e(!1);else if("pending"===this.xFrameCache[t].blocked)this.xFrameCache[t].promise.then(e,i);else{var n=$.ajax({url:SL.endpoints.CHECK_URL,data:{url:t},context:this}).done(function(i){/SAMEORIGIN|DENY/i.test(i["X-Frame-Options"])?(this.xFrameCache[t].blocked="yes",e(!0)):(this.xFrameCache[t].blocked="no",e(!1))}).fail(function(){this.xFrameCache[t].blocked="no",e(!1)});this.xFrameCache[t]={status:"pending",promise:n}}else e(!1)}.bind(this))},getLivePresentURL:function(){return SL.routes.DECK_LIVE(SLConfig.deck.user.username,SLConfig.deck.slug)+"?context=editing"}},SL("editor").Editor=SL.views.Base.extend({init:function(){if(this._super(),SL.editor.controllers.Capabilities.init(),SLConfig.deck.theme_font=SLConfig.deck.theme_font||SL.config.DEFAULT_THEME_FONT,SLConfig.deck.theme_color=SLConfig.deck.theme_color||SL.config.DEFAULT_THEME_COLOR,SLConfig.deck.transition=SLConfig.deck.transition||SL.config.DEFAULT_THEME_TRANSITION,SLConfig.deck.background_transition=SLConfig.deck.background_transition||SL.config.DEFAULT_THEME_BACKGROUND_TRANSITION,SLConfig.deck.visibility=SLConfig.deck.visibility||SL.models.Deck.VISIBILITY_ALL,this.setupPromises=[],this.state={editing:!0,saving:!1,unsaved:!1,newDeck:!SLConfig.deck.id},this.deckSaved=new signals.Signal,this.query=SL.util.getQuery(),this.isNewDeck()){var t=!1;if(SL.current_user.privileges.themes()&&"string"==typeof this.query.theme_id){var e=parseInt(this.query.theme_id,10);isNaN(e)||(SLConfig.deck.theme_id=e,t=!0)}if(!t){var i=this.query.theme_color;"string"==typeof i&&SL.config.THEME_COLORS.some(function(e){return e.id===i&&(SLConfig.deck.theme_color=i,t=!0,!0)})}t||SL.current_user.privileges.themes()&&SL.current_user.hasDefaultTheme()&&(SLConfig.deck.theme_id=SL.current_user.getDefaultTheme().get("id"))}this.savedDeck=JSON.parse(JSON.stringify(SLConfig.deck)),SL.helpers.PageLoader.show();var n=SL.current_user.getThemes().getByProperties({id:SLConfig.deck.theme_id});n?SL.current_user.isMemberOfCurrentTeam()?n.load().always(this.setup.bind(this)):n.load(SL.endpoints.DECK_THEME(SLConfig.deck.id)).always(this.setup.bind(this)):this.setup()},setup:function(){SL.util.skipCSSTransitions($(".page-wrapper"),1e3),!1===SL.fonts.isReady()&&this.setupPromises.push(new Promise(function(t){SL.fonts.ready.add(t)})),SL.keyboard.keydown(this.onDocumentKeyDown.bind(this)),this.setupAddSlideButtons(),this.setupControllers(),this.setupComponents(),this.setupReveal(),this.setupTheme(),this.setupWYSIWYG(),this.setupActivityMonitor(),this.setupScrollPrevention(),this.preloadWYSIWYG(),this.changeInterval=setInterval(this.checkChanges.bind(this),SL.config.UNSAVED_CHANGES_INTERVAL),this.restartAutoSaveInterval(),$("html").toggleClass("is-new",this.isNewDeck()),$("html").toggleClass("rtl",SLConfig.deck.rtl),this.setCSSVariables(),this.bind(),this.enableEditing(),this.setupCollaboration(),setTimeout(function(){this.setupDefaultContent(),this.layout(),SL.editor.controllers.DeckImport.init(this),SL.editor.controllers.Onboarding.init(this),SLConfig.deck.data=SL.editor.controllers.Serialize.getDeckAsString(),this.firstSlideData=SL.editor.controllers.Serialize.getFirstSlideAsString(),this.toolbars.sync(),this.setupImport(),SL.editor.controllers.Onboarding.isVisible()?SL.editor.controllers.Onboarding.ended.addOnce(this.afterOnboarding.bind(this)):this.afterOnboarding()}.bind(this),1);var t=Promise.resolve();1===this.setupPromises.length?t=this.setupPromises[0]:this.setupPromises.length>1&&(t=Promise.all(this.setupPromises)),t.then(function(){SL.util.deck.afterSlidesChanged(),SL.helpers.PageLoader.hide(),$("html").addClass("editor-loaded-successfully")})},afterOnboarding:function(){SL.data.templates.getDeckTemplateSlides().length>0&&SL.editor.controllers.Markup.isEmptyDeck()&&this.showFirstSlideSelector()},setupAddSlideButtons:function(){this.addHorizontalSlideButton=$(".add-horizontal-slide"),this.duplicateHorizontalSlideButton=$(".duplicate-horizontal-slide"),this.addVerticalSlideButton=$(".add-vertical-slide");var t=[];t.push("&bull; Shift+click for blank"),t.push("&bull; "+SL.util.getMetaKeyName()+"+click to duplicate"),this.addHorizontalSlideButton.attr("data-tooltip","Add new slide<br>"+t.join("<br>")),this.addVerticalSlideButton.attr("data-tooltip","Add vertical slide<br>"+t.join("<br>"))},setupControllers:function(){SL.editor.controllers.Serialize.init(this),SL.editor.controllers.Blocks.init(this),SL.editor.controllers.Media.init(this),SL.editor.controllers.History.init(this),SL.editor.controllers.Markup.init(this),SL.editor.controllers.Contrast.init(this),SL.editor.controllers.Migration.init(this),SL.editor.controllers.Selection.init(this),SL.editor.controllers.Guides.init(this),SL.editor.controllers.Grid.init(this),SL.editor.controllers.URL.init(this),SL.editor.controllers.Mode.init(this,{css:new SL.editor.modes.CSS(this),draw:new SL.editor.modes.Draw(this),arrange:new SL.editor.modes.Arrange(this),preview:new SL.editor.modes.Preview(this),fragment:new SL.editor.modes.Fragment(this)}),SL.session.enforce()},setupComponents:function(){this.dock=new SL.editor.components.Dock,this.sidebar=new SL.editor.components.Sidebar,this.toolbars=new SL.editor.components.Toolbars(this),this.colorpicker=new SL.editor.components.Colorpicker,this.slideMenu=new SL.editor.components.SlideMenu(this,{html:this.isDeveloperMode(),fragment:!SL.editor.controllers.Capabilities.isTouchEditorSmall()}),this.templates=new SL.components.Templates,SL.editor.controllers.Capabilities.canDockNotes()&&SL.current_user.settings.get("editor_fixed_notes")&&this.dock.show("notes",!0),this.dock.toggled.add(function(){Reveal.sync(),this.layout()}.bind(this))},setupCollaboration:function(){this.collaboration=new SL.components.collab.Collaboration({container:document.body,editor:!0,coverPage:!0}),SLConfig.deck.collaborative&&(this.setupPromises.push(new Promise(function(t){this.collaboration.loaded.add(t)}.bind(this))),this.collaboration.load())},setupReveal:function(){this.query.minScale&&!isNaN(parseFloat(this.query.minScale))&&(SL.config.EDITOR_MIN_SCALE=parseFloat(this.query.minScale));var t={controls:!0,controlsTutorial:!1,controlsBackArrows:"visible",hideInactiveCursor:!1,showHiddenSlides:!0,progress:!1,history:!1,center:!1,touch:!1,overview:!1,fragments:!1,embedded:!0,help:!1,pause:!1,autoSlide:!1,mouseWheel:!1,rollingLinks:!1,autoPlayMedia:!1,autoAnimate:!1,autoAnimateMatcher:SL.deck.AutoAnimate.matcher,focusBodyOnPageVisibilityChange:!1,width:SLConfig.deck.width,height:SLConfig.deck.height,margin:SLConfig.deck.margin,minScale:SL.config.EDITOR_MIN_SCALE,maxScale:SL.config.EDITOR_MAX_SCALE,keyboard:this.getRevealKeyboardConfig(),keyboardCondition:function(){return!!SL.editor.controllers.Mode.get("preview").isActive()||!SL.popup.isOpen()&&!SL.prompt.isOpen()&&!this.sidebar.isExpanded()&&0===SL.editor.controllers.Blocks.getFocusedBlocks().length}.bind(this),rtl:SLConfig.deck.rtl,loop:SLConfig.deck.should_loop,slideNumber:SLConfig.deck.slide_number,navigationMode:SLConfig.deck.navigation_mode,transition:SLConfig.deck.transition,backgroundTransition:SLConfig.deck.background_transition,highlight:{highlightOnLoad:!1,escapeHTML:!1},plugins:[RevealHighlight]};SL.editor.controllers.Capabilities.isTouchEditor()&&(t.margin=.05),SL.editor.controllers.Capabilities.isTouchEditorSmall()&&(t.margin=.12),SL.deck.Controller.init({mode:SL.deck.Controller.MODE_EDITING}),Reveal.initialize(t),Reveal.addEventListener("ready",function(){SL.editor.controllers.Blocks.sync(),SL.editor.controllers.Blocks.discoverBlockPairs(),this.syncOverlayButtons()}.bind(this)),Reveal.addEventListener("slidechanged",function(t){t.previousSlide&&SL.editor.controllers.Blocks.blurBlocksBySlide(t.previousSlide),SL.editor.controllers.Blocks.sync(),SL.editor.controllers.Blocks.discoverBlockPairs(),this.syncOverlayButtons(),this.checkOverflow()}.bind(this))},setupTheme:function(){var t=SL.current_user.getThemes().getByProperties({id:SLConfig.deck.theme_id});t?(SLConfig.deck.transition=t.get("transition"),SLConfig.deck.backgroundTransition=t.get("background_transition"),this.isNewDeck()&&(SLConfig.deck.width=t.get("width"),SLConfig.deck.height=t.get("height"))):t=SL.models.Theme.fromDeck(SLConfig.deck),SL.helpers.ThemeController.paint(t,{center:!1,width:SLConfig.deck.width,height:SLConfig.deck.height}),this.syncPageBackground()},setupWYSIWYG:function(){CKEDITOR.timestamp="16062022",CKEDITOR.on("dialogDefinition",function(t){t.data.definition.resizable=CKEDITOR.DIALOG_RESIZE_NONE}),CKEDITOR.on("instanceReady",function(t){t.editor.on("paste",function(t){t.data&&"html"===t.data.type&&(t.data.dataValue=t.data.dataValue.replace(/(font\-size|line\-height):\s?\d+(px|em|pt|%)?;/gi,"")),SL.view.layout(),setTimeout(SL.view.layout.bind(SL.view),1)},null,null,9)}),CKEDITOR.disableAutoInline=!0,CKEDITOR.config.floatSpaceDockedOffsetY=1,CKEDITOR.config.title=!1},preloadWYSIWYG:function(){var t=$("<p>").hide().appendTo(document.body),e=CKEDITOR.inline(t.get(0));e&&e.on("instanceReady",function(){e.destroy(),t.remove()}.bind(this))},setupDefaultContent:function(){this.isNewDeck()&&SL.editor.controllers.Markup.replaceCurrentSlide(SL.data.templates.getNewDeckTemplate().get("html"))},setupActivityMonitor:function(){SL.activity.register(1e4,function(){this.isNewDeck()||this.hasShownOutdatedMessage||$.ajax({url:SL.endpoints.GET_DECK(SL.current_deck.get("id")),type:"GET",context:this}).done(function(t){var e=SL.current_deck.get("data_updated_at"),i=t.data_updated_at,n="number"==typeof e&&!isNaN(e),o="number"==typeof i&&!isNaN(i);n&&o&&i>e&&(SL.popup.openOne(SL.components.popup.DeckOutdated),this.hasShownOutdatedMessage=!0,SL.analytics.trackEditor("warning_newer_deck_on_server"))}.bind(this))}.bind(this))},setupScrollPrevention:function(){SL.editor.controllers.Capabilities.isTouchEditor()||setInterval(function(){0===document.body.scrollTop&&0===document.body.scrollLeft||(document.body.scrollTop=0,document.body.scrollLeft=0)},1e3)},setupImport:function(){"zip"===this.query.importSource&&(SL.editor.controllers.Markup.importSlides($(".reveal .slides").html(),!0),this.save(),this.query.importRollbackID&&SL.notify("<h4>Import completed successfully</h4>If you're unhappy with the result you can roll back to the previous version of the deck.",{optional:!1,buttons:[{label:"Undo import",className:"white",callback:function(){SL.editor.controllers.Revisions.restore(this.query.importRollbackID)}},{label:"Keep import",className:"positive",callback:function(){window.history&&"function"==typeof window.history.replaceState&&window.history.replaceState(null,document.title,window.location.pathname)}}]}))},bind:function(){$(window).on("keyup",this.onWindowKeyUp.bind(this)),$(window).on("beforeunload",this.onWindowBeforeUnload.bind(this)),$(window).on("resize orientationchange",this.onWindowResize.bind(this)),
this.duplicateHorizontalSlideButton.on("vclick",this.onDuplicateHorizontalSlideClicked.bind(this)),this.addHorizontalSlideButton.on("vclick",this.onAddHorizontalSlideClicked.bind(this)),this.addVerticalSlideButton.on("vclick",this.onAddVerticalSlideClicked.bind(this)),$(".preview-controls-exit").on("vclick",this.onExitPreviewClicked.bind(this)),this.sidebar.saveClicked.add(this.save.bind(this)),this.sidebar.previewClicked.add(this.onEnterPreviewClicked.bind(this)),this.layout=this.layout.bind(this),this.onUndoOrRedo=this.onUndoOrRedo.bind(this),this.onSaveTimeout=this.onSaveTimeout.bind(this),SL.editor.controllers.History.undid.add(this.onUndoOrRedo),SL.editor.controllers.History.redid.add(this.onUndoOrRedo),this.setCSSVariables=this.setCSSVariables.bind(this),SL.current_deck.watch("width",this.setCSSVariables),SL.current_deck.watch("height",this.setCSSVariables)},layout:function(){var t=this.getSlideSize({scaled:!0}),e=$(".reveal-viewport"),i=e.width(),n=e.height(),o=this.slideMenu.getWidth(),r=this.slideMenu.getHeight(),s=0,a="r",l=(i+t.width)/2,c={left:l,top:(n-t.height)/2};this.collaboration&&(s=this.collaboration.getCollapsedWidth()),c.left=Math.min(c.left,i-o-s),c.left=Math.max(c.left,l-o),c.left===l-o&&(c.top<SL.config.EDITOR_FLOATING_ACTION_RADIUS||c.top+r>n/2-SL.config.EDITOR_FLOATING_ACTION_RADIUS/2)&&(c.left=(i-t.width)/2-o,c.left=Math.max(c.left,10),a="l"),c.left=Math.round(c.left),c.top=Math.round(Math.max(c.top,0)),this.slideMenu.domElement.css(c),this.slideMenu.setAlignment(a);var h=$(".reveal").get(0);(h&&0!==h.scrollTop||0!==h.scrollLeft)&&(h.scrollTop=0,h.scrollLeft=0),SL.editor.controllers.Capabilities.isTouchEditor()||$(document.body).css("minWidth",Math.floor(this.getSidebarWidth()+Reveal.getConfig().width*SL.config.EDITOR_MIN_SCALE)),SL.editor.controllers.Grid.refresh();var u=Reveal.getScale();$(".reveal").toggleClass("scaled-75",u<.7).toggleClass("scaled-50",u<.5)},checkChanges:function(){if(!this.isSaving()){var t=SL.editor.controllers.Serialize.getDeckAsString();SL.pointer.isDown()||SL.editor.controllers.History.push(t);var e=t!==SLConfig.deck.data,i=SLConfig.deck.dirty;this.state.unsaved=!(!e&&!i),this.hasUnsavedChanges()?this.sidebar.updateSaveButton("disabled","Click to save"):this.sidebar.updateSaveButton("disabled is-saved","Latest changes are saved")}this.state.unsaved&&this.checkOverflow()},checkAutoSave:function(){!this.hasUnsavedChanges()||SL.pointer.isDown()||SL.editor.controllers.DeckImport.isImporting()||this.save()},checkOverflow:function(){var t=2,e=SL.editor.controllers.Blocks.getCurrentBlocks().filter(function(t){return-1===["shape","drawing","line"].indexOf(t.getType())}),i=SL.editor.controllers.Blocks.getCombinedBounds(e),n=SL.util.deck.getSlideSize();i.y<-t||i.x<-t||i.right>n.width+t||i.bottom>n.height+t?(SL.editor.controllers.Markup.getCurrentSlide().addClass("overflowing"),this.slideMenu.showOverflowWarning()):(SL.editor.controllers.Markup.getCurrentSlide().removeClass("overflowing"),this.slideMenu.hideOverflowWarning())},save:function(t){this.isSaving()||(this.state.saving=!0,clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(this.onSaveTimeout,SL.config.DECK_SAVE_TIMEOUT),this.sidebar.updateSaveButton("disabled is-saving","Saving changes"),this.isNewDeck()?this.createDeck(t):this.updateDeck(t))},getSaveData:function(t){var e={deck:{width:SLConfig.deck.width,height:SLConfig.deck.height,margin:SLConfig.deck.margin,title:SL.util.unescapeHTMLEntities((SLConfig.deck.title||SL.config.DECK_TITLE_DEFAULT).substr(0,SL.config.DECK_TITLE_MAXLENGTH)),description:SL.util.unescapeHTMLEntities(SLConfig.deck.description),data:SL.util.string.trim(t),css_input:SLConfig.deck.css_input,css_output:SLConfig.deck.css_output,comments_enabled:SLConfig.deck.comments_enabled,forking_enabled:SLConfig.deck.forking_enabled,auto_slide_interval:SLConfig.deck.auto_slide_interval,upsizing_enabled:SLConfig.deck.upsizing_enabled,transition:SLConfig.deck.transition,background_transition:SLConfig.deck.background_transition,theme_font:SLConfig.deck.theme_font,theme_color:SLConfig.deck.theme_color,shuffle:SLConfig.deck.shuffle,should_loop:SLConfig.deck.should_loop,rtl:SLConfig.deck.rtl,share_notes:SLConfig.deck.share_notes,slide_number:SLConfig.deck.slide_number,navigation_mode:SLConfig.deck.navigation_mode,notes:JSON.stringify(SLConfig.deck.notes),rolling_links:!1,center:!1},version:SL.editor.Editor.VERSION};return SLConfig.deck.slug!==this.savedDeck.slug&&(e.deck.custom_slug=SLConfig.deck.slug),SL.current_user.hasThemes()&&(e.deck.theme_id=SLConfig.deck.theme_id),e},createDeck:function(t){var e=SL.editor.controllers.Serialize.getDeckAsString();if(!SLConfig.deck.title){var i=$(Reveal.getSlide(0)).find("h1").text().trim();i&&!1===/^(untitled|title\stext)$/gi.test(i)&&(SLConfig.deck.title=i.substr(0,SL.config.DECK_TITLE_MAXLENGTH))}var n={type:"POST",url:SL.endpoints.CREATE_DECK(SLConfig.current_user.username),context:this,data:this.getSaveData(e)};$.ajax(n).done(function(i){$.extend(SLConfig.deck,i),SLConfig.deck.data_updated_at=i.data_updated_at,SLConfig.deck.data=e,SLConfig.deck.dirty=!1,$("html").removeClass("is-new"),this.state.newDeck=!1,SL.editor.controllers.URL.write(),SL.editor.controllers.Thumbnail.generate(),this.onSaveSuccess(t,i)}).fail(function(e){this.onSaveError(t,e)}).always(function(){this.onSaveFinished(t)})},updateDeck:function(t){var e=SL.editor.controllers.Serialize.getDeckAsString(),i={type:"PUT",url:SL.endpoints.UPDATE_DECK(this.savedDeck?this.savedDeck.id:SLConfig.deck.id),context:this,data:this.getSaveData(e)};$.ajax(i).done(function(i){i&&i.deck&&(i.deck.slug&&(SLConfig.deck.slug=i.deck.slug,SL.editor.controllers.URL.write()),SLConfig.deck.data_updated_at=i.deck.data_updated_at),SLConfig.deck.data=e,SLConfig.deck.dirty=!1;var n=SL.editor.controllers.Serialize.getFirstSlideAsString();(this.firstSlideData!==n||SL.editor.controllers.Thumbnail.isInvalidated())&&(this.firstSlideData=n,SL.editor.controllers.Thumbnail.generate()),this.onSaveSuccess(t,i)}).fail(function(e){this.onSaveError(t,e)}).always(function(){this.onSaveFinished(t)})},onSaveSuccess:function(t,e){this.savedDeck=JSON.parse(JSON.stringify(SLConfig.deck)),e&&e.deck&&e.deck.sanitize_messages&&e.deck.sanitize_messages.length&&SL.notify(e.deck.sanitize_messages[0],"negative"),this.unableToSaveWarning&&this.unableToSaveWarning.hide(),t&&t.apply(null,[!0]),this.deckSaved.dispatch()},onSaveError:function(t,e){401===e.status&&SL.session.check(),this.unableToSaveWarning||(this.unableToSaveWarning=new SL.components.RetryNotification(SL.locale.get("DECK_SAVE_ERROR"),{type:"negative"}),this.unableToSaveWarning.destroyed.add(function(){this.unableToSaveWarning=null}.bind(this)),this.unableToSaveWarning.retryClicked.add(function(){this.unableToSaveWarning.destroy(),this.save()}.bind(this))),this.hasUnsavedChanges()&&this.unableToSaveWarning.startCountdown(this.getAutoSaveInterval()),t&&t.apply(null,[!1])},onSaveFinished:function(){this.state.saving=!1,clearTimeout(this.saveTimeout),this.checkChanges(),this.restartAutoSaveInterval(),$("html").addClass("editor-saved-successfully")},onSaveTimeout:function(){SLConfig.deck.dirty=!0,this.state.saving=!1,clearTimeout(this.saveTimeout)},hasSavedThisSession:function(){return $("html").hasClass("editor-saved-successfully")},saveVisibility:function(t){if(t=t||{},this.isNewDeck()){var e=SL.current_deck.get("visibility");return this.save(function(){SL.current_deck.set("visibility",e),this.saveVisibility(t)}.bind(this)),!1}var i={type:"POST",url:SL.endpoints.PUBLISH_DECK(SL.current_deck.get("id")),context:this,data:{visibility:SL.current_deck.get("visibility")}};$.ajax(i).done(function(e){$("html").attr("data-visibility",SL.current_deck.get("visibility")),!0!==t.silent&&(e.deck.visibility===SL.models.Deck.VISIBILITY_SELF?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_SELF")):e.deck.visibility===SL.models.Deck.VISIBILITY_TEAM?SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_TEAM")):e.deck.visibility===SL.models.Deck.VISIBILITY_ALL&&SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ALL"))),this.sidebar.updatePublishButton(),SLConfig.deck.data_updated_at=e.deck.data_updated_at}).fail(function(){this.sidebar.updatePublishButton(),SL.notify(SL.locale.get("DECK_VISIBILITY_CHANGED_ERROR"),"negative")})},navigateToSlide:function(t){if(t){var e=Reveal.getIndices(t);setTimeout(function(){Reveal.slide(e.h,e.v)},1)}},enableEditing:function(){this.state.editing=!0,$("html").addClass("is-editing")},disableEditing:function(){this.state.editing=!1,$("html").removeClass("is-editing")},redirect:function(t,e){!0===e&&(this.state.unsaved=!1),window.location=t},syncPageBackground:function(){$("html, body").css("background-color",SL.util.deck.getBackgroundColor())},syncOverlayButtons:function(){setTimeout(function(){this.duplicateHorizontalSlideButton.toggleClass("show",SL.editor.controllers.AutoAnimate.isEnabled(Reveal.getCurrentSlide()))}.bind(this),1)},enableRecordingMode:function(t){t=$.extend({sidebar:!0},t),this.addHorizontalSlideButton.hide(),this.addVerticalSlideButton.hide(),this.slideMenu.domElement.hide(),this.collaboration.domElement.hide(),!1===t.sidebar&&(this.sidebar.sidebarElement.hide(),this.toolbars.domElement.hide(),$(".page-wrapper").css("padding-left",0)),this.layout()},showFirstSlideSelector:function(){this.templates.show({anchor:this.addHorizontalSlideButton,alignment:SLConfig.deck.rtl?"l":"r",context:SL.components.Templates.CONTEXT_SELECT_FIRST_SLIDE,callback:function(t){SL.editor.controllers.Markup.replaceCurrentSlide(t)}})},setCSSVariables:function(){var t=Reveal.getConfig();document.documentElement.style.setProperty("--slide-width",t.width+"px"),document.documentElement.style.setProperty("--slide-height",t.height+"px")},restartAutoSaveInterval:function(){clearInterval(this.saveInterval),this.saveInterval=setInterval(this.checkAutoSave.bind(this),this.getAutoSaveInterval())},getAutoSaveInterval:function(){var t=SLConfig.deck.data?SLConfig.deck.data.length:0,e=0;return t>3e6?e=1e4:t>2e6?e=5e3:t>1e6&&(e=2e3),SL.config.AUTOSAVE_INTERVAL+e},getCurrentTheme:function(){var t=SL.current_user.getThemes().getByProperties({id:SLConfig.deck.theme_id});return t||(t=SL.models.Theme.fromDeck(SLConfig.deck)),t},getSlideSize:function(t){var e=Reveal.getConfig(),i=1;return t&&t.scaled&&(i=Reveal.getScale()),{width:e.width*i,height:e.height*i}},getSidebarWidth:function(){return 70+170},getRevealKeyboardConfig:function(){return{27:null,70:null,80:null}},isDeveloperMode:function(){return SL.current_user.settings.get("developer_mode")&&!SL.editor.controllers.Capabilities.isTouchEditor()},isEditing:function(){return this.state.editing},isSaving:function(){return this.state.saving},isNewDeck:function(){return this.state.newDeck},hasUnsavedChanges:function(){return this.state.unsaved},onThemeChanged:function(){this.toolbars.sync(),this.slideMenu.syncCustomClasses(),this.syncPageBackground(),SL.editor.controllers.Blocks.invalidateBlockMeasurements(),SL.editor.controllers.Blocks.repaintBlocks()},onDuplicateHorizontalSlideClicked:function(t){t.preventDefault(),SL.editor.controllers.Markup.addHorizontalSlide(SL.data.templates.templatize(Reveal.getCurrentSlide())),SL.notify(SL.locale.get("SLIDE_DUPLICATED"))},onAddHorizontalSlideClicked:function(t){t.preventDefault(),t.shiftKey?SL.editor.controllers.Markup.addHorizontalSlide():t.ctrlKey||t.metaKey?SL.editor.controllers.Markup.addHorizontalSlide(SL.data.templates.templatize(Reveal.getCurrentSlide())):this.templates.show({anchor:this.addHorizontalSlideButton,alignment:SLConfig.deck.rtl?"l":"r",callback:function(t){SL.editor.controllers.Markup.addHorizontalSlide(t)}})},onAddVerticalSlideClicked:function(t){t.preventDefault(),t.shiftKey?SL.editor.controllers.Markup.addVerticalSlide():t.ctrlKey||t.metaKey?SL.editor.controllers.Markup.addVerticalSlide(SL.data.templates.templatize(Reveal.getCurrentSlide())):this.templates.show({anchor:this.addVerticalSlideButton,alignment:"b",callback:function(t){SL.editor.controllers.Markup.addVerticalSlide(t)}})},onEnterPreviewClicked:function(){SL.editor.controllers.Mode.change("preview")},onExitPreviewClicked:function(t){t.preventDefault(),SL.editor.controllers.Mode.clear()},onWindowKeyUp:function(){this.restartAutoSaveInterval()},onDocumentKeyDown:function(t){var e=SL.editor.controllers.Mode.get(),i=e&&e.isActive()&&"css"===e.getID(),n=!!e,o=$(Reveal.getCurrentSlide());if(27===t.keyCode){var r=$("input:focus, textarea:focus, [contenteditable]:focus");if(i)return!1;if(SL.popup.isOpen())return!1;r&&r.length?r.blur():this.sidebar.isExpanded()?this.sidebar.close():this.colorpicker.isVisible()?this.colorpicker.hide():this.slideMenu.hasOpenPanel()?this.slideMenu.collapse():this.toolbars.hasOpenPanel()?this.toolbars.collapse():SL.editor.controllers.Blocks.getFocusedBlocks().length?SL.editor.controllers.Blocks.blur():e&&e.isActive()&&/(fragment|preview|draw)/gi.test(e.getID())?e.deactivate():SL.editor.controllers.Mode.toggle("arrange")}else{if(SL.util.isTypingEvent(t)||i||SL.popup.isOpen()||SL.prompt.isOpen())return!0;var s=this.sidebar.isExpanded(),a=t.metaKey||t.ctrlKey;8===t.keyCode?(t.preventDefault(),s||n||!a||this.slideMenu.triggerRemoveSlide()):a&&83===t.keyCode?(this.hasUnsavedChanges()&&this.save(),t.preventDefault()):!s&&a&&89===t.keyCode?(SL.editor.controllers.History.redo(),t.preventDefault()):!s&&a&&t.shiftKey&&90===t.keyCode?(SL.editor.controllers.History.redo(),t.preventDefault()):!s&&a&&90===t.keyCode?(SL.editor.controllers.History.undo(),t.preventDefault()):s||!a||t.shiftKey||"e"!==t.key?s||!a||t.shiftKey||70!==t.keyCode?s||!a||t.shiftKey||72!==t.keyCode?!s&&t.shiftKey&&t.altKey&&70===t.keyCode?(SL.editor.controllers.Mode.toggle("fragment"),t.preventDefault()):s||a||t.shiftKey||80!==t.keyCode?!s&&t.shiftKey&&t.altKey&&78===t.keyCode?(this.slideMenu.triggerNotes(),t.preventDefault()):!s&&t.shiftKey&&t.altKey&&72===t.keyCode?(this.slideMenu.triggerHTML(),t.preventDefault()):!s&&t.shiftKey&&t.altKey&&83===t.keyCode?(this.slideMenu.triggerSettings(),t.preventDefault()):!s&&t.shiftKey&&t.altKey&&65===t.keyCode&&(this.slideMenu.triggerAutoAnimate(),t.preventDefault()):(SL.editor.controllers.Mode.toggle("draw"),t.preventDefault()):(SL.editor.controllers.Markup.toggleSlideHidden(o.get(0)),t.preventDefault()):(SL.editor.controllers.Mode.toggle("preview"),t.preventDefault()):(this.redirect(SL.routes.DECK_LIVE(SLConfig.deck.user.username,SLConfig.deck.slug)+"?context=editing"),t.preventDefault())}return!0},onWindowBeforeUnload:function(){if(this.hasUnsavedChanges())return SL.locale.get("LEAVE_UNSAVED_DECK")},onWindowResize:function(){setTimeout(this.layout,1)},onUndoOrRedo:function(t){SL.util.skipCSSTransitions($("html"),100);var e=SL.editor.controllers.Mode.isActive("draw")&&"draw"===t.mode,i=SL.editor.controllers.Mode.isActive("arrange")&&"arrange"===t.mode,n=SL.editor.controllers.Mode.isActive("fragment")&&"fragment"===t.mode;if(i||n||e)this.onUndoOrRedoInMode(t);else{SL.editor.controllers.Mode.clear(),SL.editor.controllers.Blocks.blur(),SL.editor.controllers.Markup.replaceHTML(t.data,{state:{indexh:t.indices.h,indexv:t.indices.v},skipHistory:!0}),this.slideMenu.collapse();var o=SL.editor.controllers.Mode.get(t.mode);o&&"css"!==t.mode?(o.activate(),t.modeState&&o.restoreState(t.modeState)):t.focusedBlocks&&t.focusedBlocks.length&&SL.editor.controllers.Blocks.getCurrentBlocks().forEach(function(e){t.focusedBlocks.forEach(function(t){e.getID()===t&&SL.editor.controllers.Blocks.focus(e,!0)})})}},onUndoOrRedoInMode:function(t){var e=SL.editor.controllers.Mode.get(t.mode);e.saveState(),SL.editor.controllers.Markup.replaceHTML(t.data,{state:{indexh:t.indices.h,indexv:t.indices.v},skipHistory:!0}),e.reactivate(),e.restoreState(t.modeState)}}),SL.editor.Editor.VERSION=2,SL("editor.modes").Base=Class.extend({init:function(t,e){this.id=e,this.editor=t,this.active=!1,this.activated=new signals.Signal,this.deactivated=new signals.Signal,this.hideEditorUI="boolean"!=typeof this.hideEditorUI||this.hideEditorUI,this.deactivateOnSlideChange="boolean"==typeof this.deactivateOnSlideChange&&this.deactivateOnSlideChange,this.onSlideChanged=this.onSlideChanged.bind(this),this.render(),this.bind()},bind:function(){},render:function(){},activate:function(){this.active=!0,$("html").attr("data-mode",this.id),this.hideEditorUI&&$("html").addClass("hide-projector-overlays"),this.deactivateOnSlideChange&&Reveal.addEventListener("slidechanged",this.onSlideChanged),this.activated.dispatch()},deactivate:function(){this.active=!1,$("html").removeAttr("data-mode"),this.hideEditorUI&&$("html").removeClass("hide-projector-overlays"),this.deactivateOnSlideChange&&Reveal.removeEventListener("slidechanged",this.onSlideChanged),this.deactivated.dispatch()},reactivate:function(){},toggle:function(){this.isActive()?this.deactivate():this.activate()},isActive:function(){return this.active},getID:function(){return this.id},getState:function(){},saveState:function(){},restoreState:function(){},onSlideChanged:function(){this.deactivate()}}),SL("editor.modes").Arrange=SL.editor.modes.Base.extend({init:function(t){this._super(t,"arrange"),this.debugMode=SL.util.getQuery().debug,this.controlsHTMLTemplate=['<div class="arrange-controls editing-ui">','<div class="arrange-control view-slide" data-tooltip="Go to slide"><span class="icon i-curved-arrow"></span></div>','<div class="arrange-control visibility" data-tooltip="Toggle visibility"><span class="icon i-visibility_on on"></span><span class="icon i-visibility_off off"></span></div>','<div class="arrange-control remove-slide" data-tooltip="Remove slide"><span class="icon i-trash"></span></div>','<div class="arrange-control select-stack" data-tooltip="Drag stack"><span class="icon i-move"></span></div>','<div class="arrange-control checkmark" data-tooltip="Click to deselect"><span class="icon i-checkmark"></span></div>',"</div>"].join("")},bind:function(){this.onSlideMouseDown=this.onSlideMouseDown.bind(this),this.onSlideMouseMove=this.onSlideMouseMove.bind(this),this.onSlideMouseUp=this.onSlideMouseUp.bind(this),this.onCheckmarkClicked=this.onCheckmarkClicked.bind(this),this.onRemoveSlideClicked=this.onRemoveSlideClicked.bind(this),this.onVisibilityClicked=this.onVisibilityClicked.bind(this),this.onSelectStackClicked=this.onSelectStackClicked.bind(this),this.onViewSlideClicked=this.onViewSlideClicked.bind(this),this.onDocumentKeydown=this.onDocumentKeydown.bind(this),this.onScroll=$.throttle(this.onScroll.bind(this),200),this.onResize=$.throttle(this.onResize.bind(this),200),this.layoutSlides=this.layoutSlides.bind(this),this.loadVisibleSlides=this.loadVisibleSlides.bind(this),this.showKeyboardFocus=this.showKeyboardFocus.bind(this),this.hideKeyboardFocus=this.hideKeyboardFocus.bind(this)},activate:function(){var t=Reveal.getConfig();this.slideWidth=t.width,this.slideHeight=t.height,this.slideScale=.3,this.slideMargin=50,this.scaledSlideWidth=this.slideWidth*this.slideScale,this.scaledSlideHeight=this.slideHeight*this.slideScale,this.lastSelection=null,this.focusedSlide=$(Reveal.getCurrentSlide()),this.active=!0,this.editor.disableEditing(),this.editor.sidebar.updateArrangeButton("arranging"),Reveal.configure({keyboard:!1,slideNumber:!1}),this.arrangeWrapper=$(".reveal .slides-viewport"),this.arrangeWrapper.addClass("arrange-mode sl-scrollable"),this.arrangeWrapper.on("scroll",this.onScroll),$(window).on("resize",this.onResize),this.arrangePadding=$('<div class="arrange-mode-padding"></div>').appendTo(this.arrangeWrapper),this.renderTray(),this._super(),this.formatDeck(),this.layoutSlides(),this.updateSlideCount(),this.scrollIntoView($(Reveal.getCurrentSlide())),this.loadVisibleSlides(!0),SL.editor.controllers.History.pushLatest({includeModeChanges:!0}),this.originalDeckHTML=SL.editor.controllers.History.getLatestState()?SL.editor.controllers.History.getLatestState().data:SL.editor.controllers.Serialize.getDeckAsString(),SL.keyboard.keydown(this.onDocumentKeydown),this.focusedSlide.find(".arrange-controls").addClass("flash "),SL.analytics.trackEditor("arrange_mode")},reactivate:function(){this.formatDeck(),this.layoutSlides(),this.updateSlideCount(),this.scrollIntoView($(Reveal.getCurrentSlide())),this.loadVisibleSlides(!0)},formatDeck:function(){$(".reveal .slides section:not(.stack)").append(this.controlsHTMLTemplate),$(".reveal .slides section:not(.stack)").each(function(t,e){$(e.slideBackgroundElement).addClass("editing-ui").prependTo(e)}),$(".reveal .slides section:not(.stack)").addClass("present"),$(".reveal .slides section .visibility").on("vclick",this.onVisibilityClicked),$(".reveal .slides section .remove-slide").on("vclick",this.onRemoveSlideClicked),$(".reveal .slides section .select-stack").on("vclick",this.onSelectStackClicked),$(".reveal .slides section .view-slide").on("vclick",this.onViewSlideClicked),$(".reveal .slides section .checkmark").on("vclick",this.onCheckmarkClicked),$(".reveal .slides").get(0).addEventListener("touchstart",this.onSlideMouseDown,{passive:!1}),$(".reveal .slides").get(0).addEventListener("mousedown",this.onSlideMouseDown)},renderTray:function(){this.tray=new SL.components.ModeTray({type:"sl-mode-tray-arrange",html:['<div class="idle-state">','<p class="description">Drag slides to arrange. Click to select multiple.</p><button class="button done">Done</button><button class="button grey discard hidden" data-tooltip="Undo all changes made in the arrange mode." data-tooltip-alignment="b" data-tooltip-oy="6">Discard changes</button></div>','<div class="active-state">','<p class="description"></p><button class="button grey clear-selection">Clear selection</button><button class="button negative delete-selection">Delete</button></div>'].join("")}),this.tray.show(),this.tray.find(".clear-selection").on("vclick",this.deselectAll.bind(this)),this.tray.find(".delete-selection").on("vclick",this.removeSlides.bind(this)),this.tray.find(".done").on("vclick",this.deactivate.bind(this,undefined)),this.tray.find(".discard").on("vclick",this.discardChanges.bind(this))},deactivate:function(t){this.active=!1,this.editor.enableEditing(),this.editor.sidebar.updateArrangeButton(),$(".reveal .slides section").removeClass("selected focused drag-target in-view").css("transform",""),$(".reveal .slides section .arrange-controls").remove(),$(".reveal .slides .slide-background").remove(),$(".reveal .slides .drag-ghost").remove(),$(".reveal .slides").get(0).removeEventListener("touchstart",this.onSlideMouseDown,{passive:!1}),$(".reveal .slides").get(0).removeEventListener("mousedown",this.onSlideMouseDown),this.tray.destroy(),this.arrangePadding.remove(),$(window).off("resize",this.onResize),this.arrangeWrapper.off("scroll",this.onScroll),this.arrangeWrapper.removeClass("arrange-mode sl-scrollable"),this.hideKeyboardFocus(),SL.util.skipCSSTransitions($(".reveal .slides")),this.originalDeckHTML=null,SL.keyboard.release(this.onDocumentKeydown),SL.tooltip.hide(),this._super(),SL.util.deck.navigateToSlide(t||this.focusedSlide.get(0))},discardChanges:function(){this.saveState(),SL.editor.controllers.Markup.replaceHTML(this.originalDeckHTML),this.tray.find(".discard").addClass("hidden"),this.reactivate(),this.restoreState()},scrollIntoView:function(t,e){var i=t.data("arrange-x")*this.slideScale,n=t.data("arrange-y")*this.slideScale;i-=this.viewportWidth/2,i+=this.scaledSlideWidth/2,n-=this.viewportHeight/2,n+=this.scaledSlideHeight/2,e?this.scrollSmoothlyTo(i,n):this.arrangeWrapper.prop("scrollLeft",i).prop("scrollTop",n)},layoutSlides:function(){this.viewportWidth=this.arrangeWrapper.width(),this.viewportHeight=this.arrangeWrapper.height();var t=$(".reveal .slides > section:not(.editing-ui)"),e=100,i=Math.round(.5*(this.viewportHeight/this.slideScale-this.slideHeight)),n=t.length*(this.slideWidth+this.slideMargin);n*this.slideScale<this.viewportWidth&&(e=Math.round(.5*(this.viewportWidth/this.slideScale-n)));var o=0,r=i+this.slideHeight;!0===SL.current_deck.get("rtl")&&(t=$(t.get().reverse())),t.each(function(t,n){var s=Math.round(e+t*(this.slideWidth+this.slideMargin)),a=Math.round(i);n.style.transform="translate3d("+s+"px, "+a+"px, 0)",o=Math.max(o,s+this.slideWidth),$(n).data({"arrange-x":s,"arrange-y":a}),n.classList.contains("stack")&&$(n).find("section:not(.editing-ui)").each(function(t,e){a=Math.round(t*(this.slideHeight+this.slideMargin)),e.style.transform="translate3d(0, "+a+"px, 0)",a+=i,r=Math.max(r,a+this.slideHeight),$(e).data({"arrange-x":s,"arrange-y":a})}.bind(this))}.bind(this)),this.arrangeWrapper.data({"scroll-width":o,"scroll-height":r});var s=0,a=0;o*this.slideScale>this.viewportWidth-20&&(s=(o+this.slideWidth)*this.slideScale),r*this.slideScale>this.viewportHeight-20&&(a=(r+this.slideHeight)*this.slideScale),this.arrangePadding.css({left:Math.round(s),top:Math.round(a)})},loadVisibleSlides:function(t){var e=this.arrangeWrapper.prop("scrollLeft"),i=this.arrangeWrapper.prop("scrollTop"),n=4*this.scaledSlideWidth;$(".reveal .slides section:not(.stack, .editing-ui)").each(function(o,r){var s=$(r),a=s.data("arrange-x")*this.slideScale,l=s.data("arrange-y")*this.slideScale,c=e<a+n&&e+this.viewportWidth>a-n&&i<l+n&&i+this.viewportHeight>l-n,h=!0!==t&&s.hasClass("in-view");c&&!h?(Reveal.loadSlide(r,{excludeIframes:!0}),s.addClass("in-view")):!c&&h&&s.removeClass("in-view")}.bind(this))},getSlideClosestToCenter:function(){var t,e=this.arrangeWrapper.prop("scrollLeft"),i=this.arrangeWrapper.prop("scrollTop"),n={x:e+this.viewportWidth/2,y:i+this.viewportHeight/2},o=Number.MAX_VALUE;return $(".reveal .slides section.in-view").toArray().forEach(function(e){var i=$(e),r=SL.util.trig.distanceBetween({x:i.data("arrange-x")*this.slideScale,y:i.data("arrange-y")*this.slideScale},n);o>r&&(o=r,t=i)},this),t},toggleSelection:function(t,e){if(t.toggleClass("selected"),this.lastSelection&&!0===e){var i=Reveal.getIndices(this.lastSelection.get(0)),n=Reveal.getIndices(t.get(0));n.h>i.h||n.h===i.h&&n.v>i.v?this.toggleSelectionBetween(this.lastSelection,t,t.hasClass("selected")):(n.h<i.h||n.h===i.h&&n.v<i.v)&&this.toggleSelectionBetween(t,this.lastSelection,t.hasClass("selected"))}this.lastSelection=t,this.syncSelection()},toggleSelectionBetween:function(t,e,i){for(var n=0,o=t;o.length&&!o.is(e)&&n++<500;){o.toggleClass("selected",i);var r=o.next();(o=0===r.length?o.closest(".stack").next():r).hasClass("stack")&&(o=o.find("section").first())}},deselectAll:function(){this.getSelectedSlides().removeClass("selected"),this.syncSelection()},syncSelection:function(){var t=this.getSelectedSlides().length;t>0&&$(".reveal .slides section:not(.stack)").length>1?(this.tray.find(".active-state .description").text(t+" "+SL.util.string.pluralize("slide","s",t>1)+" selected"),this.tray.setState("active")):(this.tray.setState("data-state",""),this.lastSelection=null)},removeSlides:function(t){if(t&&t.length||(t=this.getSelectedSlides()),t.length)if(Reveal.getTotalSlides()>t.length){t.remove(),this.afterSlidesChanged(),this.undoNotification&&this.undoNotification.destroy();var e=t.length>1?"Slides were removed":"Slide was removed";this.undoNotification=new SL.components.Notification(e,{buttonsLayout:"inline",buttons:[{label:"Undo",callback:function(){SL.editor.controllers.History.undo()}}]})}else SL.notify(SL.locale.get("ARRANGE_CANT_DELETE_ALL_SLIDES"))},removeSelectedOrFocusedSlides:function(){this.removeSlides(this.getSelectedOrFocusedSlides())},getSelectedSlides:function(){return $(".reveal .slides section.selected")},getSelectedOrFocusedSlides:function(){var t=this.getSelectedSlides();return 0===t.length&&(t=$(".reveal .slides section.focused")),t},startDrag:function(){if(this.debugMode&&(this.debugStartIDs=$(".reveal .slides section:not(.stack)").map(function(){return this.getAttribute("data-id")}).toArray(),console.log("Arrange: startDrag",{Horizontal:$(".reveal .slides>section:not(.stack)").length,Vertical:$(".reveal .slides>section.stack section").length,Stacks:$(".reveal .slides>section.stack").length})),this.arrangeWrapper.addClass("dragging"),this.dragTargetMoved=!0,this.dragTargetIsStack=!1,this.dragTarget.is(".selected")){this.dragTarget=this.getSelectedSlides();var t=this.dragTarget.first().closest(".stack");if(t.length>0)this.dragTarget.toArray().every(function(e){return $(e).closest(".stack").is(t)})&&(this.dragTargetIsStack=!0)}else $(this.mouseDownTarget).closest(".arrange-control.select-stack").length>0?(this.dragTargetIsStack=!0,this.dragTarget=this.dragTarget.siblings().addBack()):this.deselectAll();this.dragGhost=this.dragTarget.first().clone(),this.dragGhost.find("iframe").removeAttr("src"),this.dragGhost.appendTo(".reveal .slides").removeClass("selected").addClass("drag-ghost editing-ui"),this.dragGhost.toggleClass("multi-drag",this.dragTarget.length>1),this.dragGhost.toggleClass("stack-drag",this.dragTargetIsStack),this.dragTarget.addClass("drag-target"),this.insertMarker=$('<div class="insert-marker">')},stopDrag:function(t){this.arrangeWrapper.removeClass("dragging");var e=this.dragTargetMoved;if(this.dragTargetMoved=!1,this.insertTarget&&!t&&this.insertSlide(this.insertTarget,this.insertDirection),this.dragTarget.removeClass("drag-target"),this.dragTarget=null,this.insertMarker&&(this.insertMarker.remove(),this.insertMarker=null),$(".reveal .slides .drag-ghost").remove(),this.stopScroll(),this.insertTarget&&(this.insertTarget=null,this.insertDirection=null,t||this.afterSlidesChanged()),document.removeEventListener("touchmove",this.onSlideMouseMove),document.removeEventListener("touchend",this.onSlideMouseUp),document.removeEventListener("mousemove",this.onSlideMouseMove),document.removeEventListener("mouseup",this.onSlideMouseUp),this.debugMode&&e){var i=$(".reveal .slides section:not(.stack)").map(function(){return this.getAttribute("data-id")}).toArray();console.log("Arrange: stopDrag",{Horizontal:$(".reveal .slides>section:not(.stack)").length,Vertical:$(".reveal .slides>section.stack section").length,Stacks:$(".reveal .slides>section.stack").length,Reordered:this.debugStartIDs.join("")!==i.join(""),"Same IDs exist":this.debugStartIDs.every(function(t){return $('.reveal .slides section[data-id="'+t+'"]').length>0})})}},isDragging:function(){return!!this.dragTarget},refreshDrag:function(t,e){"number"==typeof t&&(this.clientX=t),"number"==typeof e&&(this.clientY=e);var i=this.getSlideBounds(this.dragGhost||this.dragTarget),n=!1;$(".reveal .slides section.in-view:not(.stack, .drag-ghost, .drag-target)").toArray().some(function(t){t=$(t);var e=this.getSlideBounds(t);if(SL.util.trig.intersects(i,e,.3,.15)){var o=t.closest(".stack").length>0,r={x:i.mx,y:i.my},s={id:"top",distance:SL.util.trig.distanceBetween(r,{x:e.mx,y:e.y})},a={id:"right",distance:SL.util.trig.distanceBetween(r,{x:e.right,y:e.my})},l={id:"bottom",distance:SL.util.trig.distanceBetween(r,{x:e.mx,y:e.bottom})},c=[s,a,l,{id:"left",distance:SL.util.trig.distanceBetween(r,{x:e.x,y:e.my})}];o&&!t.is(":first-of-type")?c=[s,l]:(s.distance=3*s.distance,l.distance=3*l.distance),c.sort(function(t,e){return t.distance<e.distance?-1:1}),this.debugMode&&console.log("Closest sides: "+c.map(function(t){return t.id.charAt(0).toUpperCase()}).join(" > "));var h=c.shift();return this.showInsertMarker(t,h.id),n=!0,!0}}.bind(this)),!1===n&&this.hideInsertMarker();var o=this.slidesContainer.getBoundingClientRect(),r=(this.clientX-o.left)/this.slideScale-this.dragOffsetX,s=(this.clientY-o.top)/this.slideScale-this.dragOffsetY;r=Math.min(r,this.arrangeWrapper.data("scroll-width")+this.slideMargin),s=Math.min(s,this.arrangeWrapper.data("scroll-height")+this.slideMargin),this.dragGhost.css("transform","translate3d("+r+"px,"+s+"px,0)")},refreshScroll:function(t,e){var i=this.arrangeWrapper.get(0).getBoundingClientRect(),n=75,o=.15,r=i.width*o,s=i.height*o,a=Math.max(i.top+s-e,0)/s,l=Math.max(t-(i.right-r),0)/r,c=Math.max(e-(i.bottom-s),0)/s,h=Math.max(i.left+r-t,0)/r;a>0?this.startScroll(0,-n*a):l>0?this.startScroll(n*l):c>0?this.startScroll(0,n*c):h>0?this.startScroll(-n*h):this.stopScroll()},startScroll:function(t,e){this.scrollX=t,this.scrollY=e,this.scrollInterval||(clearInterval(this.scrollInterval),this.arrangeWrapper.stop(!0),this.scrollInterval=setInterval(function(){"number"==typeof this.scrollX&&0!==this.scrollX&&(this.arrangeWrapper.get(0).scrollLeft+=this.scrollX),"number"==typeof this.scrollY&&0!==this.scrollY&&(this.arrangeWrapper.get(0).scrollTop+=this.scrollY),this.refreshDrag()}.bind(this),1e3/60))},stopScroll:function(){clearInterval(this.scrollInterval),this.scrollInterval=0,this.arrangeWrapper.stop(!0)},scrollSmoothlyTo:function(t,e){clearInterval(this.scrollInterval);var i={};"number"==typeof t&&(i.scrollLeft=t),"number"==typeof e&&(i.scrollTop=e),this.arrangeWrapper.stop(!0).animate(i,600,"easeOutQuint")},insertSlide:function(t,e){
var i=t.closest(".stack"),n=i.length>0,o=this.dragTarget;!0===SL.current_deck.get("rtl")&&("left"===e?e="right":"right"===e&&(e="left")),"left"===e?(this.dragTargetIsStack&&(o=$('<section class="stack">').append(this.dragTarget)),o.insertBefore(n?i:t)):"right"===e?(this.dragTargetIsStack&&(o=$('<section class="stack">').append(this.dragTarget)),o.insertAfter(n?i:t)):"top"!==e&&"bottom"!==e||(n||t.wrap('<section class="stack">'),"top"===e?this.dragTarget.insertBefore(t):"bottom"===e&&this.dragTarget.insertAfter(t)),this.layoutSlides()},showInsertMarker:function(t,e){var i=100,n="left"===e||"right"===e;if(!this.insertTarget||this.insertTarget.get(0)!==t.get(0)||this.insertDirection!==e){var o=t.data("arrange-x"),r=t.data("arrange-y");"top"===e?r-=this.slideMargin/2:"right"===e?o+=this.slideWidth+this.slideMargin/2:"bottom"===e?r+=this.slideHeight+this.slideMargin/2:"left"===e&&(o-=this.slideMargin/2),n?(this.insertMarker.attr("data-orientation","vertical"),this.insertMarker.css({left:o,top:r-i/2,width:"",height:this.slideHeight+i})):(this.insertMarker.attr("data-orientation","horizontal"),this.insertMarker.css({left:o-i/2,top:r,width:this.slideWidth+i,height:""})),this.insertMarker.appendTo(".reveal .slides")}this.insertTarget=t,this.insertDirection=e},hideInsertMarker:function(){this.insertTarget=null,this.insertDirection=null,this.insertMarker.remove()},moveKeyboardFocus:function(t){if(this.focusedSlide&&0===this.focusedSlide.parent().length&&(this.focusedSlide=this.getSlideClosestToCenter()),this.focusedSlide){var e,i=this.focusedSlide.closest(".stack").length>0;"left"===t?e=i?this.focusedSlide.parent().prev():this.focusedSlide.prev():"right"===t&&(e=i?this.focusedSlide.parent().next():this.focusedSlide.next()),i&&("up"===t?e=this.focusedSlide.prev():"down"===t&&(e=this.focusedSlide.next())),e&&e.hasClass("stack")&&(e=e.find("section").first()),e&&e.length&&e!==this.focusedSlide&&(this.focusedSlide=e,this.focusedSlide.focus(),this.scrollIntoView(this.focusedSlide,!0)),this.showKeyboardFocus()}},showKeyboardFocus:function(){$(".reveal section.focused").removeClass("focused"),this.focusedSlide.addClass("focused"),this.isShowingKeyboardFocus||$(document).one("vmousemove",this.hideKeyboardFocus),this.isShowingKeyboardFocus=!0},hideKeyboardFocus:function(){$(".reveal section.focused").removeClass("focused"),$(document).off("vmousemove",this.hideKeyboardFocus),this.isShowingKeyboardFocus=!1},saveState:function(){this.savedScrollX=this.arrangeWrapper.prop("scrollLeft"),this.savedScrollY=this.arrangeWrapper.prop("scrollTop"),this.savedSelection=this.getSelectedSlides().toArray().map(function(t){return t.getAttribute("data-id")})},restoreState:function(){"number"==typeof this.savedScrollX&&"number"==typeof this.savedScrollY&&(this.arrangeWrapper.prop("scrollLeft",this.savedScrollX),this.arrangeWrapper.prop("scrollTop",this.savedcrollY),this.savedSelection.length>0&&(this.savedSelection.forEach(function(t){$('.reveal .slides section[data-id="'+t+'"]').addClass("selected")}),this.syncSelection()))},afterSlidesChanged:function(){SL.editor.controllers.Markup.unwrapEmptyStacks(),SL.editor.controllers.Markup.afterSlidesChanged(),this.tray.find(".discard").removeClass("hidden"),this.syncSelection(),this.layoutSlides(),this.loadVisibleSlides(),this.updateSlideCount()},updateSlideCount:function(){this.arrangeWrapper.attr("data-slide-count",Reveal.getTotalSlides())},getSlideBounds:function(t){var e=t.get(0).getBoundingClientRect(),i={x:e.left,y:e.top,width:this.slideWidth*this.slideScale,height:this.slideHeight*this.slideScale};return i.right=i.x+i.width,i.bottom=i.y+i.height,i.mx=i.x+i.width/2,i.my=i.y+i.height/2,i},onSlideMouseDown:function(t){var e=$(t.target).closest("section");if(e&&e.length){"touchstart"===t.type&&(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY),this.slidesContainer=document.querySelector(".reveal .slides");var i=this.getSlideBounds(e);this.dragTarget=e,this.mouseDownTarget=t.target,this.mouseDownX=t.clientX,this.mouseDownY=t.clientY,this.dragOffsetX=(t.clientX-i.x)/this.slideScale,this.dragOffsetY=(t.clientY-i.y)/this.slideScale,document.addEventListener("touchmove",this.onSlideMouseMove,{passive:!1}),document.addEventListener("touchend",this.onSlideMouseUp,{passive:!1}),document.addEventListener("mousemove",this.onSlideMouseMove),document.addEventListener("mouseup",this.onSlideMouseUp),t.preventDefault()}},onSlideMouseMove:function(t){"touchmove"===t.type&&(t.clientX=t.touches[0].clientX,t.clientY=t.touches[0].clientY),(SL.util.trig.distanceBetween({x:this.mouseDownX,y:this.mouseDownY},{x:t.clientX,y:t.clientY})>10||this.dragTargetMoved)&&(this.dragTargetMoved||this.startDrag(),this.refreshDrag(t.clientX,t.clientY),this.refreshScroll(t.clientX,t.clientY)),t.preventDefault()},onSlideMouseUp:function(t){this.dragTargetMoved?(t.stopPropagation(),t.preventDefault()):0===$(t.target).closest(".arrange-control").length&&this.toggleSelection(this.dragTarget,t.shiftKey),this.stopDrag()},onScroll:function(){this.loadVisibleSlides()},onResize:function(){this.layoutSlides(),this.loadVisibleSlides()},onDocumentKeydown:function(t){return 27===t.keyCode&&this.isDragging()?(this.stopDrag(!0),!1):8===t.keyCode?(this.removeSelectedOrFocusedSlides(),!1):13===t.keyCode?(this.deactivate(),!1):32===t.keyCode?(this.toggleSelection($(".reveal section.focused"),t.shiftKey),!1):72===t.keyCode?(this.getSelectedOrFocusedSlides().toArray().forEach(function(t){SL.editor.controllers.Markup.toggleSlideHidden(t,!1)}),!1):37===t.keyCode?(this.moveKeyboardFocus("left"),!1):39===t.keyCode?(this.moveKeyboardFocus("right"),!1):38===t.keyCode?(this.moveKeyboardFocus("up"),!1):40!==t.keyCode||(this.moveKeyboardFocus("down"),!1)},onRemoveSlideClicked:function(t){var e=$(t.target).parents("section").first();e.length&&this.removeSlides(e)},onVisibilityClicked:function(t){var e=$(t.target).parents("section").first();e.length&&SL.editor.controllers.Markup.toggleSlideHidden(e.get(0),!1)},onViewSlideClicked:function(t){var e=$(t.target).parents("section").first();e.length&&this.deactivate(e.get(0))},onSelectStackClicked:function(t){var e=$(t.target).parents(".stack").first();e.length&&(e.find(">section").toggleClass("selected",!e.find(">section").first().hasClass("selected")),this.syncSelection())},onCheckmarkClicked:function(t){var e=$(t.target).parents("section").first();e&&1===e.length&&this.toggleSelection(e,t.shiftKey)}}),SL("editor.modes").CSS=SL.editor.modes.Base.extend({EXPAND_DOCS_LABEL:'More info & examples <span class="icon i-chevron-down"></span>',COLLAPSE_DOCS_LABEL:'Back to CSS editor <span class="icon i-chevron-up"></span>',init:function(t){this.userCSSInput=$("#user-css-input"),this.userCSSOutput=$("#user-css-output"),this.parseTimeout=-1,this.userCSSInput.length&&(SLConfig.deck.css_input=this.userCSSInput.html()||undefined),this.userCSSOutput.length&&(SLConfig.deck.css_output=this.userCSSOutput.html()||undefined),this._super(t,"css")},render:function(){this.domElement=$('<div class="css-editor">').appendTo(document.body),this.headerElement=$("<header>").appendTo(this.domElement),this.headerElement.append("<p>Enter custom styles using LESS or plain CSS. All selectors are automatically prefixed with .reveal on save.</p>"),this.headerButtons=$(['<div class="header-buttons">','<button class="button light-grey documentation-link"></button>','<button class="button light-grey float-right insert-image" data-tooltip="Insert image URL"><span class="icon i-picture"></span></button>','<button class="button light-grey float-right custom-fonts" data-tooltip="Load custom fonts"><span class="icon i-type"></span></button>','<div class="button blue float-right slide-classes" style="display: none;"></div>',"</div>",'<div class="documentation">',$("#css-documentation").html(),"</div>"].join("")).appendTo(this.headerElement),this.customFontsButton=this.headerElement.find(".custom-fonts"),this.insertImageButton=this.headerElement.find(".insert-image"),this.slideClassesButton=this.headerElement.find(".slide-classes"),this.documentationLinkButton=this.headerElement.find(".documentation-link"),this.contentsElement=$('<div class="contents">').appendTo(this.domElement),this.errorElement=$('<div class="error">').appendTo(this.contentsElement),this.footerElement=$("<footer>").appendTo(this.domElement),this.cancelButton=$('<button class="button cancel white xl">Cancel</button>').appendTo(this.footerElement),this.saveButton=$('<button class="button save positive xl">Save'+SL.util.getKeyboardShortcutName("Enter",{meta:!0,casesensitive:!0,span:!0})+"</button>").appendTo(this.footerElement),this.resizer=$('<div class="resizer"></div>').appendTo(this.domElement);const t=()=>{this.documentationLinkButton.html(this.headerElement.hasClass("expanded")?this.COLLAPSE_DOCS_LABEL:this.EXPAND_DOCS_LABEL)};let e=!1;this.documentationLinkButton.on("click",i=>{if(i.preventDefault(),this.headerElement.toggleClass("expanded"),!e&&Reveal.hasPlugin("highlight")){const t=Reveal.getPlugin("highlight").hljs;e=!0,this.headerElement.find(".documentation pre code").each((e,i)=>{t.highlightBlock(i)})}t()}),t()},renderEditor:function(){if(!this.cssEditor){try{this.cssEditor=SL.util.createCodeEditor(this.contentsElement.get(0),{mode:"text/x-less"})}catch(t){console.log("An error occurred while initializing the code editor.")}this.cssEditor.on("change",this.onInputChange.bind(this))}},bind:function(){this.insertImageButton.on("click",this.onInsertImageClicked.bind(this)),this.customFontsButton.on("click",this.onCustomFontsClicked.bind(this)),this.cancelButton.on("click",this.onCancelClicked.bind(this)),this.saveButton.on("click",this.onSaveClicked.bind(this)),this.resizer.on("vmousedown",this.onResizerMouseDown.bind(this)),this.onResizerMouseMove=this.onResizerMouseMove.bind(this),this.onResizerMouseUp=this.onResizerMouseUp.bind(this),this.onDocumentKeydown=this.onDocumentKeydown.bind(this)},activate:function(){SL.view.isNewDeck()&&SL.view.save(),this.editor.disableEditing(),SL.keyboard.keydown(this.onDocumentKeydown),this.domElement.addClass("visible"),this.savedCSSInput=SLConfig.deck.css_input,this.savedCSSOutput=SLConfig.deck.css_output,this.currentCSSInput=SLConfig.deck.css_input,this.errorElement.text("").removeClass("visible"),this.renderEditor(),this.cssEditor.setValue(SLConfig.deck.css_input||""),this.cssEditor.focus(),Reveal.configure({minScale:.1}),this.setWidth(SL.settings.getValue(SL.settings.EDITOR_CSS_WIDTH)),this.syncCustomClasses(),setTimeout(function(){Reveal.layout()},1),this._super()},deactivate:function(){this.editor.enableEditing(),SL.keyboard.release(this.onDocumentKeydown),this.domElement.removeClass("visible"),$(".page-wrapper").css("padding-left",""),this._super()},saveAndClose:function(){this.compile(function(t){SLConfig.deck.css_input=this.cssEditor.getValue(),SLConfig.deck.css_output=t,SLConfig.deck.dirty=!0,SL.editor.controllers.Thumbnail.invalidate(),SL.view.onThemeChanged(),this.deactivate()}.bind(this),function(){SL.notify("Please fix all errors before saving.","negative")}.bind(this))},compile:function(t,e){var i=this.cssEditor.getValue();less.render(".reveal { "+i+" }").then(function(e){this.errorElement.removeClass("visible"),e=SL.util.string.moveCSSImportsToBeginning(e.css),this.userCSSOutput.html(e),t&&t.call(null,e)}.bind(this),function(t){this.errorElement.addClass("visible"),this.errorElement.html((t.line?'<span class="line">Line '+t.line+": </span>":"")+t.message),e&&e.call(null,t)}.bind(this)),this.currentCSSInput=i,this.syncCustomClasses()},syncCustomClasses:function(){var t=SL.util.string.getCustomClassesFromLESS(this.cssEditor.getValue());if(t.length){var e="Custom slide classes:<br>- "+t.join("<br>- ");this.slideClassesButton.text(t.length+" "+SL.util.string.pluralize("class","es",t.length>1)).attr("data-tooltip",e).show()}else this.slideClassesButton.attr("data-tooltip","").hide()},discard:function(){SLConfig.deck.css_input=this.savedCSSInput,SLConfig.deck.css_output=this.savedCSSOutput,this.userCSSOutput.html(SLConfig.deck.css_output||"")},setWidth:function(t,e){("number"!=typeof t||isNaN(t))&&(t=600),t=Math.max(t,450),t=Math.min(t,window.innerWidth),$(".page-wrapper").css("padding-left",t),this.domElement.css("width",t),Reveal.layout(),e&&SL.settings.setValue(SL.settings.EDITOR_CSS_WIDTH,t)},onInsertImageClicked:function(){SL.popup.open(SL.components.medialibrary.MediaLibrary,{select:SL.models.Media.IMAGE}).selected.addOnce(function(t){t.isUploaded()?this.cssEditor.replaceSelection(t.get("url")):t.uploadCompleted.add(function(){this.cssEditor.replaceSelection(t.get("url"))}.bind(this))}.bind(this))},onCustomFontsClicked:function(){SL.popup.openOne(SL.components.popup.CustomFonts,{deck:SL.current_deck})},onInputChange:function(){clearTimeout(this.parseTimeout),this.parseTimeout=setTimeout(this.compile.bind(this),500)},onResizerMouseDown:function(t){t.preventDefault(),$(document).on("vmousemove",this.onResizerMouseMove),$(document).on("vmouseup",this.onResizerMouseUp),this.setWidth(t.pageX,!0)},onResizerMouseMove:function(t){t.preventDefault(),this.setWidth(t.pageX,!0)},onResizerMouseUp:function(){$(document).off("vmousemove",this.onResizerMouseMove),$(document).off("vmouseup",this.onResizerMouseUp)},onCancelClicked:function(t){this.currentCSSInput!==this.savedCSSInput?SL.prompt({anchor:$(t.currentTarget),title:"You will lose all unsaved changes.",alignment:"t",type:"select",data:[{html:"<h3>Cancel</h3>"},{html:"<h3>Continue</h3>",className:"negative",callback:function(){this.discard(),this.deactivate()}.bind(this)}]}):(this.discard(),this.deactivate())},onSaveClicked:function(){this.saveAndClose()},onDocumentKeydown:function(t){return(t.metaKey||t.ctrlKey)&&13===t.keyCode&&this.saveAndClose(),!0}}),SL("editor.modes").Draw=SL.editor.modes.Base.extend({init:function(t){this.hideEditorUI=!1,this.onBlockFocusChanged=this.onBlockFocusChanged.bind(this),this._super(t,"draw")},render:function(){this.annotator=new SL.components.Annotator({insertMethod:this.insertDrawingAsBlock.bind(this),clearMethod:this.clearInsertedBlocks.bind(this)}),this.annotator.closed.add(this.deactivate.bind(this))},activate:function(){this.isActive()||(this._super(),this.hasSavedInitialState=!1,this.annotator.show(),SL.editor.controllers.Blocks.focusChanged.add(this.onBlockFocusChanged))},deactivate:function(){if(this.isActive()){SL.editor.controllers.Blocks.focusChanged.remove(this.onBlockFocusChanged);var t=this.getInsertedBlockInstances(),e=t.some(function(t){return t.isGrouped()});t.length>1&&!e?SL.editor.controllers.Blocks.groupBlocks(t):1===t.length&&SL.editor.controllers.Blocks.focus(t[0]),this.annotator.isVisible()&&this.annotator.hide(),this._super()}},reactivate:function(){this.annotator.updateClearButton()},getState:function(){return{insertedDrawings:this.annotator.getInsertedDrawings()}},restoreState:function(t){t&&t.insertedDrawings instanceof Array&&this.annotator.setInsertedDrawings(t.insertedDrawings)},getInsertedBlockInstances:function(){var t=[];return this.annotator.getInsertedDrawings().forEach(function(e){var i=SL.editor.controllers.Blocks.getBlockByID(e.blockId);i&&t.push(i)}),t},insertDrawingAsBlock:function(t){this.hasSavedInitialState||(this.hasSavedInitialState=!0,SL.editor.controllers.History.pushLatest({includeModeChanges:!0}));var e=SL.editor.controllers.Blocks.add({type:"drawing",silent:!0,skipIntro:!0,x:t.bbox.x,y:t.bbox.y,blockOptions:{data:{svg:t.svg,bbox:t.bbox,points:t.points,timestamp:Date.now()}}});return setTimeout(()=>SL.editor.controllers.History.pushLatest(),1),e.getID()},clearInsertedBlocks:function(){var t=this.getInsertedBlockInstances();t.length&&SL.editor.controllers.Blocks.removeBlocks(t)},onBlockFocusChanged:function(){this.deactivate()}}),SL("editor.modes").Fragment=SL.editor.modes.Base.extend({init:function(t){this.deactivateOnSlideChange=!0,this.overlayTemplate=['<div class="editing-ui fragment-overlay-item">','<div class="inner">','<div class="controls-item change-style icon i-menu" data-tooltip="'+SL.locale.get("FRAGMENT_TOOLTIP_STYLE")+'" data-tooltip-alignment="l" data-tooltip-delay="500" data-tooltip-maxwidth="230"></div>','<div class="controls-item index" data-tooltip="'+SL.locale.get("FRAGMENT_TOOLTIP_INDEX")+'" data-tooltip-alignment="t" data-tooltip-delay="500" data-tooltip-maxwidth="230"><span class="index-value"></span></div>','<div class="controls-item remove icon i-close" data-tooltip="'+SL.locale.get("FRAGMENT_TOOLTIP_REMOVE")+'" data-tooltip-alignment="r" data-tooltip-delay="500" data-tooltip-maxwidth="230"></div>','<div class="controls-item index-down icon i-chevron-down"></div>','<div class="controls-item index-up icon i-chevron-up"></div>',"</div>","</div>"].join(""),this.listItemTemplate=['<div class="toolbar-fragment-option">','<span class="label"></span>','<div class="index">','<div class="index-up icon i-chevron-up"></div>','<div class="index-value" data-tooltip="'+SL.locale.get("FRAGMENT_TOOLTIP_INDEX")+'" data-tooltip-alignment="r" data-tooltip-delay="500" data-tooltip-maxwidth="230"></div>','<div class="index-down icon i-chevron-down"></div>',"</div>",'<div class="toolbar-fragment-controls">','<span class="change-style" data-tooltip="'+SL.locale.get("FRAGMENT_TOOLTIP_STYLE")+'" data-tooltip-alignment="b" data-tooltip-delay="500" data-tooltip-maxwidth="230">Edit style</span>',"</div>","</div>"].join(""),this.onFragmentChange=this.onFragmentChange.bind(this),this.onFragmentMouseOver=this.onFragmentMouseOver.bind(this),this.onFragmentMouseOut=this.onFragmentMouseOut.bind(this),this.onFragmentMouseDown=this.onFragmentMouseDown.bind(this),this.onFragmentListElementMouseOver=this.onFragmentListElementMouseOver.bind(this),this.onFragmentListElementMouseOut=this.onFragmentListElementMouseOut.bind(this),this.onFragmentListElementClick=this.onFragmentListElementClick.bind(this),this._super(t,"fragment")},render:function(){this._super(),this.renderTray()},renderTray:function(){var t="Fragments are invisible until stepped through when you present. Preview to see them in action. The number that appear on top of each fragment indicate the order they will appear in.";this.tray=new SL.components.ModeTray({type:"sl-mode-tray-fragment",html:['<div class="buttons">','<button class="button done">Done</button>','<button class="button grey reset hidden">Clear fragments</button>',"</div>",'<div class="idle-state">','<p class="description">Click on elements to turn them into <u style="margin-left: 5px;" data-tooltip="'+t,'" data-tooltip-alignment="b" data-tooltip-maxwidth="355">fragments</u>.</p>',"</div>",'<div class="active-state">','<div class="preview">','<div class="preview-label">Preview</div>','<div class="preview-bar"></div>','<div class="preview-prev icon i-chevron-left"></div>','<div class="preview-next icon i-chevron-right"></div>',"</div>","</div>"].join("")}),this.preview=this.tray.find(".preview"),this.preview.on("mouseenter",this.startPreview.bind(this)),this.preview.on("mouseleave",this.stopPreview.bind(this)),this.preview.find(".preview-prev").on("vclick",this.onPreviewPrevClicked.bind(this)),this.preview.find(".preview-next").on("vclick",this.onPreviewNextClicked.bind(this)),this.previewBar=this.tray.find(".preview-bar"),this.previewBar.on("vclick",".segment",this.onPreviewSegmentMouseOver.bind(this)),this.previewProgress=$('<div class="preview-progress"></div>')},bind:function(){this._super(),this.tray.find(".done").on("vclick",this.deactivate.bind(this)),this.tray.find(".reset").on("vclick",this.removeAllFragments.bind(this))},activate:function(){this.isActive()||(this._super(),this.previewIndex=-1,this.tray.show(),this.toolbar=new SL.editor.components.toolbars.Fragment,this.toolbarList=this.toolbar.getListElement(),this.toolbarList.on("vclick",".toolbar-fragment-option",this.onFragmentListElementClick),this.toolbarList.on("mouseover",".toolbar-fragment-option:not(.is-fixed)",this.onFragmentListElementMouseOver),this.toolbarList.on("mouseout",".toolbar-fragment-option:not(.is-fixed)",this.onFragmentListElementMouseOut),this.editor.disableEditing(),this.editor.slideMenu.collapse(),this.editor.toolbars.push(this.toolbar),SL.editor.controllers.Blocks.repaintBlocks(),Reveal.syncFragments(Reveal.getCurrentSlide()),this.renderFragments(),this.syncFragments(),SL.analytics.trackEditor("fragment_mode"))},reactivate:function(){this.isActive()&&($(".fragment-overlay .fragment-overlay-item").off(),$(".fragment-overlay").off().remove(),this.overlays=null,this.stopPreview(),this.renderFragments(),this.syncFragments())},deactivate:function(){this.isActive()&&(this.stopPreview(),$(".fragment-overlay .fragment-overlay-item").off(),$(".fragment-overlay").off().remove(),this.overlays=null,this.editor.enableEditing(),this.editor.toolbars.clear(),this.tray.hide(),this._super(),SL.editor.controllers.Blocks.repaintBlocks())},renderFragments:function(){SL.util.skipCSSTransitions(this.toolbarList,1);var t=$(Reveal.getCurrentSlide());this.overlays=$('<div class="fragment-overlay editing-ui">').appendTo(t),this.overlays.on("mouseover",".fragment-overlay-item",this.onFragmentMouseOver),this.overlays.on("mouseout",".fragment-overlay-item",this.onFragmentMouseOut),this.overlays.on("vclick",".fragment-overlay-item",this.onFragmentMouseDown),this.toolbarList.empty(),SL.editor.controllers.Blocks.sortByOrderOfAppearance(null,{recursive:!0}).forEach(function(t){this.renderFragmentOverlay(t.getContentElement(),!0);var e=t.getContentElement().find(">ul li, >ol li");e.length>0&&e.toArray().forEach(this.renderFragmentOverlay,this);var i=t.getContentElement().find(".hljs.fragment[data-line-numbers]");if(i.length>0){var n=this.renderToolbarListItem(i.first(),t);n.find(".label").text("Code highlights"),n.addClass("is-fixed is-selected code-highlights");var o=$(this.overlayTemplate).css("display","none").data({"list-element":n,"target-element":i.first(),"highlight-steps":i.length}).appendTo(this.overlays);n.data("overlay-element",o)}}.bind(this))},renderFragmentOverlay:function(t,e){t=$(t);var i=$(this.overlayTemplate),n=t.closest(".sl-block").data("block-instance");n&&n.hasTransform()&&i.css("transform",n.getCSSTransform()),SL.editor.controllers.Capabilities.isTouchEditor()&&i.addClass("show-without-hover"),this.overlays.append(i);var o=this.renderToolbarListItem(t,n);i.data("target-element",t),i.data("list-element",o),!0===e&&i.data("target-block",n),o.data("overlay-element",i)},renderToolbarListItem:function(t,e){var i,n="",o=null,r=12,s=!1;if(e&&t.is(".sl-block-content")){var a=e.getType();n=SL.editor.controllers.Blocks.getBlockDefinitionByType(a).label.toUpperCase(),"function"==typeof e.createThumbnail?i=e.createThumbnail({width:90,height:20}):"function"==typeof e.getLabel&&("text"===a?o=e.getLabel():(o=e.getLabel(),s=!0)),r+=5*e.domElement.parents(".sl-block-group").length}var l=$(this.listItemTemplate),c=l.find(".label");return n||(n=t.prop("tagName"),/^li$/i.test(n)&&t.length&&(n="LIST ITEM",o=this.getElementLabel(t)),r+=5*t.parents("li, .sl-block-content").length),"string"==typeof o&&/\w{1,}/gi.test(o)?(s&&"string"==typeof n&&c.text(n+" \u2013 "),c.append($("<i></i>").text(o))):i?c.addClass("has-thumb").append(i):c.text(n),l.css("padding-left",r),l.appendTo(this.toolbarList),l},getElementLabel:function(t){return t&&t.length?t.prop("innerText").slice(0,50).trim().split("\n")[0]:""},startPreview:function(){this.previewing||(this.previewing=!0,$("html").addClass("previewing-fragments"),SL.editor.controllers.Capabilities.isTouchEditor()||this.overlays.addClass("hidden"),this.preview.addClass("active"),Reveal.addEventListener("fragmentshown",this.onFragmentChange),Reveal.addEventListener("fragmenthidden",this.onFragmentChange),Reveal.configure({fragments:!0}),Reveal.navigateFragment("number"==typeof this.previewIndex?this.previewIndex:-1))},stopPreview:function(){this.previewing&&(this.previewing=!1,$("html").removeClass("previewing-fragments"),this.overlays&&this.overlays.removeClass("hidden"),this.preview.removeClass("active"),this.previewBar.find(".segment.highlight").removeClass("highlight"),Reveal.removeEventListener("fragmentshown",this.onFragmentChange),Reveal.removeEventListener("fragmenthidden",this.onFragmentChange),Reveal.configure({fragments:!1}))},isPreviewing:function(){return this.previewing},syncFragments:function(){this.overlays.find(".fragment-overlay-item").each(function(t,e){var i,n=$(e),o=n.data("target-element"),r=o.css("z-index"),s=n.data("list-element"),a=o.parents(".sl-block-content").first();a.length&&(r=a.css("z-index"));var l=n.data("target-block");if(l)i=l.measure();else{var c=SL.util.getRevealElementOffset(o,!0);i={x:c.x,y:c.y,width:o.outerWidth(!0),height:o.outerHeight(!0)}}n.css({left:i.x,top:i.y,width:i.width,height:i.height,zIndex:r});var h=o.hasClass("fragment"),u=o.parents(".fragment").length>0;n.toggleClass("is-selected",h),s.toggleClass("is-selected",h),n.toggleClass("is-nested",u),s.toggleClass("is-nested",u);var d=n.find(".index-value").add(s.find(".index-value")),p=parseInt(o.attr("data-fragment-index"),10);d.length&&"number"==typeof p&&!isNaN(p)&&(s.hasClass("code-highlights")?(n.data("highlight-steps")>1?d.html(p+1+"-"+(p+n.data("highlight-steps"))):d.html(p+1),o.parents(".sl-block-content").find(">pre code[data-line-numbers]").attr("data-fragment-index",p),o.nextAll(".hljs.fragment").toArray().forEach(function(t,e){t.setAttribute("data-fragment-index",p+e+1)})):d.html(p+1));if(h){var f=SL.config.FRAGMENT_STYLES[0].title;SL.config.FRAGMENT_STYLES.some(function(t){if(t.id&&o.hasClass(t.id))return f=t.title,!0}),s.find(".change-style").text(f)}});var t=$(Reveal.getCurrentSlide()).find(".fragment").length;this.overlays.attr("data-fragments-total",t),this.toolbarList.attr("data-fragments-total",t),t>0?(this.tray.setState("active"),this.tray.find(".reset").removeClass("hidden")):(this.tray.setState(""),this.tray.find(".reset").addClass("hidden")),this.syncFragmentCount()},getFragmentCount:function(){var t=$(Reveal.getCurrentSlide()).find(".fragment");return{total:t.length,unique:t.toArray().map(function(t){return t.getAttribute("data-fragment-index")}).filter(function(t,e,i){return i.indexOf(t)===e}).length}},syncFragmentCount:function(){var t=this.getFragmentCount();if(this.overlays.attr("data-fragments-total",t.total),this.toolbarList.attr("data-fragments-total",t.total),t.total>1?(this.tray.setState("active"),this.tray.find(".reset").removeClass("hidden")):(this.tray.setState(""),this.tray.find(".reset").addClass("hidden")),t.unique!==this.uniqueFragmentCount){var e="number"==typeof this.uniqueFragmentCount&&this.uniqueFragmentCount<t.unique?this.uniqueFragmentCount:0;for(0===e&&this.previewBar.html('<div class="segment" data-fragment-index="-1"></div>');e<t.unique;e++)this.previewBar.append('<div class="segment" data-fragment-index="'+e+'"></div>')}this.uniqueFragmentCount=t.unique,this.previewProgress.prependTo(this.previewBar)},toggleFragment:function(t){if(t.hasClass("fragment"))this.removeFragment(t);else{var e=t.closest(".sl-block").data("block-instance");if(e&&e.isset("attribute.data-animation-type")&&e.unset(["attribute.data-animation-type","style.transition-duration","style.transition-delay"]),t.addClass("fragment visible"),"code"===e.getType()){var i=e.contentElement.find(".hljs[data-line-numbers][data-fragment-index]").first().attr("data-fragment-index");i&&t.attr("data-fragment-index",i)}Reveal.syncFragments(Reveal.getCurrentSlide())}this.syncFragments(),SL.editor.controllers.History.pushLatest()},removeFragment:function(t,e){t.removeClass("fragment").removeAttr("data-fragment-index"),t.removeClass(SL.config.FRAGMENT_STYLES.map(function(t){return t.id}).join(" ")),Reveal.syncFragments(Reveal.getCurrentSlide()),!0!==e&&(this.syncFragments(),SL.editor.controllers.History.pushLatest())},removeAllFragments:function(){$(Reveal.getCurrentSlide()).find(".fragment:not(.hljs)").toArray().forEach(function(t){this.removeFragment($(t),!0)},this),this.syncFragments(),SL.editor.controllers.History.pushLatest()},changeFragmentIndex:function(t,e){var i=parseInt(t.attr("data-fragment-index"),10);i=isNaN(i)?0:i,i+=e,i=Math.max(Math.min(i,this.getFragmentCount().unique),0),t.attr("data-fragment-index",i),Reveal.syncFragments(Reveal.getCurrentSlide()),this.syncFragments()},changeFragmentStyle:function(t,e,i){if(!this.fragmentStylePrompt){var n=SL.config.FRAGMENT_STYLES.map(function(e){return{title:e.title,value:e.id,selected:e.id&&t.hasClass(e.id)}});n.some(function(t){return t.selected})||(n[0].selected=!0),this.fragmentStylePrompt=SL.prompt({anchor:e,alignment:i||"l",title:"Fragment style",type:"list",data:n,optional:!0}),this.fragmentStylePrompt.confirmed.add(function(e){t.removeClass(SL.config.FRAGMENT_STYLES.map(function(t){return t.id}).join(" ")),t.addClass(e),this.syncFragments()}.bind(this)),this.fragmentStylePrompt.destroyed.add(function(){this.fragmentStylePrompt=null}.bind(this))}},formatFragmentIndices:function(){var t=this.overlays.find(".fragment-overlay-item");t.sort(function(t,e){var i=parseInt(t.getAttribute("data-fragment-index"),10),n=parseInt(e.getAttribute("data-fragment-index"),10);return(i=isNaN(i)?-1:i)-(n=isNaN(n)?-1:n)}),t.each(function(t,e){$(e).data("target-element").attr("data-fragment-index",t)}.bind(this))},onFragmentMouseOver:function(t){$(t.currentTarget).data("list-element").addClass("highlight")},onFragmentMouseOut:function(t){$(t.currentTarget).data("list-element").removeClass("highlight")},onFragmentMouseDown:function(t){var e=$(t.currentTarget).data("target-element");return $(t.target).closest(".index-up").length?this.changeFragmentIndex(e,1):$(t.target).closest(".index-down").length?this.changeFragmentIndex(e,-1):$(t.target).closest(".change-style").length?this.changeFragmentStyle(e,t.target):e&&e.length&&this.toggleFragment(e),!1},onFragmentListElementMouseOver:function(t){$(t.currentTarget).data("overlay-element").addClass("highlight")},onFragmentListElementMouseOut:function(t){$(t.currentTarget).data("overlay-element").removeClass("highlight")},onFragmentListElementClick:function(t){var e=$(t.currentTarget),i=e.data("overlay-element").data("target-element");return $(t.target).closest(".index-up").length?this.changeFragmentIndex(i,1):$(t.target).closest(".index-down").length?this.changeFragmentIndex(i,-1):$(t.target).closest(".change-style").length?this.changeFragmentStyle(i,e,"r"):i&&i.length&&!e.hasClass("is-fixed")&&this.toggleFragment(i),!1},onFragmentChange:function(){this.previewIndex=Reveal.getIndices().f;var t=this.previewBar.find('.segment[data-fragment-index="'+this.previewIndex+'"]');t.length&&(t.addClass("highlight").siblings(".highlight").removeClass("highlight"),this.previewProgress.css("width",Math.round(t.position().left+t.width())))},onPreviewPrevClicked:function(t){this.isPreviewing()||this.startPreview(),Reveal.prevFragment(),t.preventDefault()},onPreviewNextClicked:function(t){this.isPreviewing()||this.startPreview(),Reveal.nextFragment(),t.preventDefault()},onPreviewSegmentMouseOver:function(t){this.isPreviewing()||this.startPreview();var e=parseInt($(t.currentTarget).attr("data-fragment-index"),10);"number"==typeof e&&Reveal.navigateFragment(e)}}),SL("editor.modes").Preview=SL.editor.modes.Base.extend({init:function(t){this._super(t,"preview"),$(".preview-controls-deck-view").on("vclick",this.onDeckViewClicked.bind(this)),this.syncSlideVisibilityButton=this.syncSlideVisibilityButton.bind(this)},activate:function(){Reveal.isOverview()&&Reveal.toggleOverview(!1),this.editor.disableEditing(),SL.util.openLinksInTabs($(".reveal .slides")),SL.analytics.trackEditor("preview_mode"),this._super(),Reveal.configure({progress:!0,touch:!0,center:!1,fragments:!0,autoAnimate:!0,autoSlide:SLConfig.deck.auto_slide_interval||0,autoPlayMedia:null,maxScale:!1===SLConfig.deck.upsizing_enabled?SL.config.EDITOR_MAX_SCALE:SL.config.PRESENT_UPSIZING_MAX_SCALE});var t=Reveal.getIndices();Reveal.slide(t.h,t.v,-1),SL.deck.Controller.setMode(SL.deck.Controller.MODE_VIEWING),$(document.activeElement).blur(),$(".preview-controls-hidden-slides").on("vmousedown",this.syncSlideVisibilityButton),this.syncSlideVisibilityButton()},deactivate:function(){Reveal.configure({progress:!1,touch:!1,center:!1,fragments:!1,autoAnimate:!1,autoSlide:!1,autoPlayMedia:!1,maxScale:SL.config.EDITOR_MAX_SCALE}),this.editor.syncPageBackground(),this.editor.enableEditing(),SL.deck.Controller.setMode(SL.deck.Controller.MODE_EDITING),$(".reveal .slides .fragment.disabled").removeClass("disabled"),$(".preview-controls-hidden-slides").off("vmousedown",this.syncSlideVisibilityButton),this._super()},syncSlideVisibilityButton:function(){if("string"==typeof SLConfig.deck.slug&&SLConfig.deck.slug.length>0&&SL.editor.controllers.Markup.hasHiddenSlides()){
var t=SL.routes.DECK_FULLSCREEN(SLConfig.deck.user.username,SLConfig.deck.slug),e=Reveal.getCurrentSlide().getAttribute("data-id");e&&(t+="?jumpToSlideID="+e),$(".preview-controls-hidden-slides").show().attr("href",t)}else $(".preview-controls-hidden-slides").hide()},onDeckViewClicked:function(t){new SL.components.prompts.DeckView({anchor:$(t.currentTarget),alignment:"b",editorURL:null,presentURL:SL.editor.controllers.URL.getLivePresentURL()}).show()}}),SL("editor").Tests={run:function(){var t=this.testOnboarding(),e=this.testBlocks();t&&e&&$("html").addClass("editor-tested-successfully")},testOnboarding:function(){for(;SL.editor.controllers.Onboarding.tutorial.hasNextStep();)SL.editor.controllers.Onboarding.tutorial.next();return SL.editor.controllers.Onboarding.tutorial.next(),!0},testBlocks:function(){SL.editor.controllers.Blocks.add({type:"text"}).destroy(),SL.editor.controllers.Blocks.add({type:"image"}).destroy();var t=SL.editor.controllers.Blocks.add({type:"shape"});return t.move({x:100,y:100}),t.resize({width:100,height:100}),t.destroy(),!0}},SL("editor.util").SVG={NAMESPACE:"http://www.w3.org/2000/svg",SYMBOLS:{happy:'<path d="M16 32c8.837 0 16-7.163 16-16s-7.163-16-16-16-16 7.163-16 16 7.163 16 16 16zM16 3c7.18 0 13 5.82 13 13s-5.82 13-13 13-13-5.82-13-13 5.82-13 13-13zM16 18.711c3.623 0 7.070-0.963 10-2.654-0.455 5.576-4.785 9.942-10 9.942-5.215 0-9.544-4.371-10-9.947 2.93 1.691 6.377 2.658 10 2.658zM8 11c0-1.657 0.895-3 2-3s2 1.343 2 3c0 1.657-0.895 3-2 3-1.105 0-2-1.343-2-3zM20 11c0-1.657 0.895-3 2-3s2 1.343 2 3c0 1.657-0.895 3-2 3-1.105 0-2-1.343-2-3z"></path>',smiley:'<path d="M16 32c8.837 0 16-7.163 16-16s-7.163-16-16-16-16 7.163-16 16 7.163 16 16 16zM16 3c7.18 0 13 5.82 13 13s-5.82 13-13 13-13-5.82-13-13 5.82-13 13-13zM8 10c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM20 10c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM22.003 19.602l2.573 1.544c-1.749 2.908-4.935 4.855-8.576 4.855s-6.827-1.946-8.576-4.855l2.573-1.544c1.224 2.036 3.454 3.398 6.003 3.398s4.779-1.362 6.003-3.398z"></path>',wondering:'<path d="M16 32c8.837 0 16-7.163 16-16s-7.163-16-16-16-16 7.163-16 16 7.163 16 16 16zM16 3c7.18 0 13 5.82 13 13s-5.82 13-13 13-13-5.82-13-13 5.82-13 13-13zM23.304 18.801l0.703 2.399-13.656 4-0.703-2.399zM8 10c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM20 10c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2z"></path>',sad:'<path d="M16 32c8.837 0 16-7.163 16-16s-7.163-16-16-16-16 7.163-16 16 7.163 16 16 16zM16 3c7.18 0 13 5.82 13 13s-5.82 13-13 13-13-5.82-13-13 5.82-13 13-13zM8 10c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM20 10c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM9.997 24.398l-2.573-1.544c1.749-2.908 4.935-4.855 8.576-4.855 3.641 0 6.827 1.946 8.576 4.855l-2.573 1.544c-1.224-2.036-3.454-3.398-6.003-3.398-2.549 0-4.779 1.362-6.003 3.398z"></path>',"checkmark-circle":'<path d="M16 0c-8.836 0-16 7.164-16 16s7.164 16 16 16 16-7.164 16-16-7.164-16-16-16zM13.52 23.383l-7.362-7.363 2.828-2.828 4.533 4.535 9.617-9.617 2.828 2.828-12.444 12.445z"></path>',"plus-circle":'<path d="M16 0c-8.836 0-16 7.164-16 16s7.164 16 16 16 16-7.164 16-16-7.164-16-16-16zM24 18h-6v6h-4v-6h-6v-4h6v-6h4v6h6v4z"></path>',"minus-circle":'<path d="M16 0c-8.836 0-16 7.164-16 16s7.164 16 16 16 16-7.164 16-16-7.164-16-16-16zM24 18h-16v-4h16v4z"></path>',"x-circle":'<path d="M16 0c-8.836 0-16 7.164-16 16s7.164 16 16 16 16-7.164 16-16-7.164-16-16-16zM23.914 21.086l-2.828 2.828-5.086-5.086-5.086 5.086-2.828-2.828 5.086-5.086-5.086-5.086 2.828-2.828 5.086 5.086 5.086-5.086 2.828 2.828-5.086 5.086 5.086 5.086z"></path>',denied:'<path d="M16 0c-8.836 0-16 7.164-16 16s7.164 16 16 16 16-7.164 16-16-7.164-16-16-16zM16 4c2.59 0 4.973 0.844 6.934 2.242l-16.696 16.688c-1.398-1.961-2.238-4.344-2.238-6.93 0-6.617 5.383-12 12-12zM16 28c-2.59 0-4.973-0.844-6.934-2.242l16.696-16.688c1.398 1.961 2.238 4.344 2.238 6.93 0 6.617-5.383 12-12 12z"></path>',clock:'<path d="M16 4c6.617 0 12 5.383 12 12s-5.383 12-12 12-12-5.383-12-12 5.383-12 12-12zM16 0c-8.836 0-16 7.164-16 16s7.164 16 16 16 16-7.164 16-16-7.164-16-16-16v0zM21.422 18.578l-3.422-3.426v-7.152h-4.023v7.992c0 0.602 0.277 1.121 0.695 1.492l3.922 3.922 2.828-2.828z"></path>',"heart-stroke":'<path d="M23.113 6c2.457 0 4.492 1.82 4.836 4.188l-11.945 13.718-11.953-13.718c0.344-2.368 2.379-4.188 4.836-4.188 2.016 0 3.855 2.164 3.855 2.164l3.258 3.461 3.258-3.461c0 0 1.84-2.164 3.855-2.164zM23.113 2c-2.984 0-5.5 1.578-7.113 3.844-1.613-2.266-4.129-3.844-7.113-3.844-4.903 0-8.887 3.992-8.887 8.891v0.734l16.008 18.375 15.992-18.375v-0.734c0-4.899-3.984-8.891-8.887-8.891v0z"></path>',"heart-fill":'<path d="M16 5.844c-1.613-2.266-4.129-3.844-7.113-3.844-4.903 0-8.887 3.992-8.887 8.891v0.734l16.008 18.375 15.992-18.375v-0.734c0-4.899-3.984-8.891-8.887-8.891-2.984 0-5.5 1.578-7.113 3.844z"></path>',home:'<path d="M16 0l-16 16h4v16h24v-16h4l-16-16zM24 28h-6v-6h-4v6h-6v-14.344l8-5.656 8 5.656v14.344z"></path>',pin:'<path d="M17.070 2.93c-3.906-3.906-10.234-3.906-14.141 0-3.906 3.904-3.906 10.238 0 14.14 0.001 0 7.071 6.93 7.071 14.93 0-8 7.070-14.93 7.070-14.93 3.907-3.902 3.907-10.236 0-14.14zM10 14c-2.211 0-4-1.789-4-4s1.789-4 4-4 4 1.789 4 4-1.789 4-4 4z"></path>',user:'<path d="M12 16c-6.625 0-12 5.375-12 12 0 2.211 1.789 4 4 4h16c2.211 0 4-1.789 4-4 0-6.625-5.375-12-12-12zM6 6c0-3.314 2.686-6 6-6s6 2.686 6 6c0 3.314-2.686 6-6 6-3.314 0-6-2.686-6-6z"></path>',mail:'<path d="M15.996 15.457l16.004-7.539v-3.918h-32v3.906zM16.004 19.879l-16.004-7.559v15.68h32v-15.656z"></path>',star:'<path d="M22.137 19.625l9.863-7.625h-12l-4-12-4 12h-12l9.875 7.594-3.875 12.406 10.016-7.68 9.992 7.68z"></path>',bolt:'<path d="M32 0l-24 16 6 4-14 12 24-12-6-4z"></path>',sun:'<path d="M16.001 8c-4.418 0-8 3.582-8 8s3.582 8 8 8c4.418 0 7.999-3.582 7.999-8s-3.581-8-7.999-8v0zM14 2c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM4 6c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM2 14c1.105 0 2 0.895 2 2 0 1.107-0.895 2-2 2s-2-0.893-2-2c0-1.105 0.895-2 2-2zM4 26c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM14 30c0-1.109 0.895-2 2-2 1.108 0 2 0.891 2 2 0 1.102-0.892 2-2 2-1.105 0-2-0.898-2-2zM24 26c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2zM30 18c-1.104 0-2-0.896-2-2 0-1.107 0.896-2 2-2s2 0.893 2 2c0 1.104-0.896 2-2 2zM24 6c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2-1.105 0-2-0.895-2-2z"></path>',moon:'<path d="M24.633 22.184c-8.188 0-14.82-6.637-14.82-14.82 0-2.695 0.773-5.188 2.031-7.363-6.824 1.968-11.844 8.187-11.844 15.644 0 9.031 7.32 16.355 16.352 16.355 7.457 0 13.68-5.023 15.648-11.844-2.18 1.254-4.672 2.028-7.367 2.028z"></path>',cloud:'<path d="M24 10c-0.379 0-0.738 0.061-1.102 0.111-1.394-2.465-3.972-4.111-6.898-4.111-2.988 0-5.566 1.666-6.941 4.1-0.352-0.047-0.704-0.1-1.059-0.1-4.41 0-8 3.588-8 8 0 4.414 3.59 8 8 8h16c4.41 0 8-3.586 8-8 0-4.412-3.59-8-8-8zM24 22h-16c-2.207 0-4-1.797-4-4 0-2.193 1.941-3.885 4.004-3.945 0.008 0.943 0.172 1.869 0.5 2.744l3.746-1.402c-0.168-0.444-0.25-0.915-0.25-1.397 0-2.205 1.793-4 4-4 1.293 0 2.465 0.641 3.199 1.639-1.929 1.461-3.199 3.756-3.199 6.361h4c0-2.205 1.793-4 4-4s4 1.795 4 4c0 2.203-1.793 4-4 4z"></path>',rain:'<path d="M23.998 6c-0.375 0-0.733 0.061-1.103 0.111-1.389-2.465-3.969-4.111-6.895-4.111-2.987 0-5.565 1.666-6.94 4.1-0.353-0.047-0.705-0.1-1.060-0.1-4.41 0-8 3.588-8 8s3.59 8 8 8h15.998c4.414 0 8-3.588 8-8s-3.586-8-8-8zM23.998 18h-15.998c-2.207 0-4-1.795-4-4 0-2.193 1.941-3.885 4.004-3.945 0.009 0.943 0.172 1.869 0.5 2.744l3.746-1.402c-0.168-0.444-0.25-0.915-0.25-1.397 0-2.205 1.793-4 4-4 1.293 0 2.465 0.641 3.199 1.639-1.928 1.461-3.199 3.756-3.199 6.361h4c0-2.205 1.795-4 3.998-4 2.211 0 4 1.795 4 4s-1.789 4-4 4zM3.281 29.438c-0.75 0.75-1.969 0.75-2.719 0s-0.75-1.969 0-2.719 5.438-2.719 5.438-2.719-1.969 4.688-2.719 5.438zM11.285 29.438c-0.75 0.75-1.965 0.75-2.719 0-0.75-0.75-0.75-1.969 0-2.719 0.754-0.75 5.438-2.719 5.438-2.719s-1.965 4.688-2.719 5.438zM19.28 29.438c-0.75 0.75-1.969 0.75-2.719 0s-0.75-1.969 0-2.719 5.437-2.719 5.437-2.719-1.968 4.688-2.718 5.438z"></path>',umbrella:'<path d="M16 0c-8.82 0-16 7.178-16 16h4c0-0.826 0.676-1.5 1.5-1.5 0.828 0 1.5 0.674 1.5 1.5h4c0-0.826 0.676-1.5 1.5-1.5 0.828 0 1.5 0.674 1.5 1.5v10c0 1.102-0.895 2-2 2-1.102 0-2-0.898-2-2h-4c0 3.309 2.695 6 6 6 3.312 0 6-2.691 6-6v-10c0-0.826 0.676-1.5 1.5-1.5 0.828 0 1.498 0.674 1.498 1.5h4c0-0.826 0.68-1.5 1.5-1.5 0.828 0 1.5 0.674 1.5 1.5h4c0-8.822-7.172-16-15.998-16z"></path>',eye:'<path d="M16 4c-8.836 0-16 11.844-16 11.844s7.164 12.156 16 12.156 16-12.156 16-12.156-7.164-11.844-16-11.844zM16 24c-4.418 0-8-3.582-8-8s3.582-8 8-8 8 3.582 8 8-3.582 8-8 8zM12 16c0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.209-1.791 4-4 4-2.209 0-4-1.791-4-4z"></path>',ribbon:'<path d="M8 20c-1.41 0-2.742-0.289-4-0.736v12.736l4-4 4 4v-12.736c-1.258 0.447-2.59 0.736-4 0.736zM0 8c0-4.418 3.582-8 8-8s8 3.582 8 8c0 4.418-3.582 8-8 8-4.418 0-8-3.582-8-8z"></path>',iphone:'<path d="M16 0h-8c-4.418 0-8 3.582-8 8v16c0 4.418 3.582 8 8 8h8c4.418 0 8-3.582 8-8v-16c0-4.418-3.582-8-8-8zM12 30.062c-1.139 0-2.062-0.922-2.062-2.062s0.924-2.062 2.062-2.062 2.062 0.922 2.062 2.062-0.923 2.062-2.062 2.062zM20 24h-16v-16c0-2.203 1.795-4 4-4h8c2.203 0 4 1.797 4 4v16z"></path>',camera:'<path d="M16 20c0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.209-1.791 4-4 4-2.209 0-4-1.791-4-4zM28 8l-3.289-6.643c-0.27-0.789-1.016-1.357-1.899-1.357h-5.492c-0.893 0-1.646 0.582-1.904 1.385l-3.412 6.615h-8.004c-2.209 0-4 1.791-4 4v20h32v-20c0-2.209-1.789-4-4-4zM6 16c-1.105 0-2-0.895-2-2s0.895-2 2-2 2 0.895 2 2-0.895 2-2 2zM20 28c-4.418 0-8-3.582-8-8s3.582-8 8-8 8 3.582 8 8-3.582 8-8 8z"></path>',cog:'<path d="M32 17.969v-4l-4.781-1.992c-0.133-0.375-0.273-0.738-0.445-1.094l1.93-4.805-2.829-2.828-4.762 1.961c-0.363-0.176-0.734-0.324-1.117-0.461l-2.027-4.75h-4l-1.977 4.734c-0.398 0.141-0.781 0.289-1.16 0.469l-4.754-1.91-2.828 2.828 1.938 4.711c-0.188 0.387-0.34 0.781-0.485 1.188l-4.703 2.011v4l4.707 1.961c0.145 0.406 0.301 0.801 0.488 1.188l-1.902 4.742 2.828 2.828 4.723-1.945c0.379 0.18 0.766 0.324 1.164 0.461l2.023 4.734h4l1.98-4.758c0.379-0.141 0.754-0.289 1.113-0.461l4.797 1.922 2.828-2.828-1.969-4.773c0.168-0.359 0.305-0.723 0.438-1.094l4.782-2.039zM15.969 22c-3.312 0-6-2.688-6-6s2.688-6 6-6 6 2.688 6 6-2.688 6-6 6z"></path>',lock:'<path d="M14 0c-5.508 0-9.996 4.484-9.996 10v2h-4.004v14c0 3.309 2.691 6 6 6h12c3.309 0 6-2.691 6-6v-16c0-5.516-4.488-10-10-10zM11.996 24c-1.101 0-1.996-0.895-1.996-2s0.895-2 1.996-2c1.105 0 2 0.895 2 2s-0.894 2-2 2zM20 12h-11.996v-2c0-3.309 2.691-6 5.996-6 3.309 0 6 2.691 6 6v2z"></path>',unlock:'<path d="M14.004 0c-5.516 0-9.996 4.484-9.996 10h3.996c0-3.309 2.688-6 6-6 3.305 0 5.996 2.691 5.996 6v2h-20v14c0 3.309 2.695 6 6 6h12c3.305 0 6-2.691 6-6v-16c0-5.516-4.488-10-9.996-10zM12 24c-1.102 0-2-0.895-2-2s0.898-2 2-2c1.109 0 2 0.895 2 2s-0.891 2-2 2z"></path>',fork:'<path d="M20 0v3.875c0 1.602-0.625 3.109-1.754 4.238l-11.316 11.254c-1.789 1.785-2.774 4.129-2.883 6.633h-4.047l6 6 6-6h-3.957c0.105-1.438 0.684-2.773 1.711-3.805l11.316-11.25c1.891-1.89 2.93-4.398 2.93-7.070v-3.875h-4zM23.953 26c-0.109-2.504-1.098-4.848-2.887-6.641l-2.23-2.215-2.836 2.821 2.242 2.23c1.031 1.027 1.609 2.367 1.715 3.805h-3.957l6 6 6-6h-4.047z"></path>',paperclip:'<path d="M17.293 15.292l-2.829-2.829-4 4c-1.953 1.953-1.953 5.119 0 7.071 1.953 1.953 5.118 1.953 7.071 0l10.122-9.879c3.123-3.124 3.123-8.188 0-11.313-3.125-3.124-8.19-3.124-11.313 0l-11.121 10.88c-4.296 4.295-4.296 11.26 0 15.557 4.296 4.296 11.261 4.296 15.556 0l6-6-2.829-2.829-5.999 6c-2.733 2.732-7.166 2.732-9.9 0-2.733-2.732-2.733-7.166 0-9.899l11.121-10.881c1.562-1.562 4.095-1.562 5.656 0 1.563 1.563 1.563 4.097 0 5.657l-10.121 9.879c-0.391 0.391-1.023 0.391-1.414 0s-0.391-1.023 0-1.414l4-4z"></path>',facebook:'<path d="M17.996 32h-5.996v-16h-4v-5.514l4-0.002-0.007-3.248c0-4.498 1.22-7.236 6.519-7.236h4.412v5.515h-2.757c-2.064 0-2.163 0.771-2.163 2.209l-0.008 2.76h4.959l-0.584 5.514-4.37 0.002-0.004 16z"></path>',twitter:'<path d="M32 6.076c-1.177 0.522-2.443 0.875-3.771 1.034 1.355-0.813 2.396-2.099 2.887-3.632-1.269 0.752-2.674 1.299-4.169 1.593-1.198-1.276-2.904-2.073-4.792-2.073-3.626 0-6.565 2.939-6.565 6.565 0 0.515 0.058 1.016 0.17 1.496-5.456-0.274-10.294-2.888-13.532-6.86-0.565 0.97-0.889 2.097-0.889 3.301 0 2.278 1.159 4.287 2.921 5.465-1.076-0.034-2.088-0.329-2.974-0.821-0.001 0.027-0.001 0.055-0.001 0.083 0 3.181 2.263 5.834 5.266 6.437-0.551 0.15-1.131 0.23-1.73 0.23-0.423 0-0.834-0.041-1.235-0.118 0.835 2.608 3.26 4.506 6.133 4.559-2.247 1.761-5.078 2.81-8.154 2.81-0.53 0-1.052-0.031-1.566-0.092 2.905 1.863 6.356 2.95 10.064 2.95 12.076 0 18.679-10.004 18.679-18.68 0-0.285-0.006-0.568-0.019-0.849 1.283-0.926 2.396-2.082 3.276-3.398z"></path>',earth:'<path d="M27.314 4.686c3.022 3.022 4.686 7.040 4.686 11.314s-1.664 8.292-4.686 11.314c-3.022 3.022-7.040 4.686-11.314 4.686s-8.292-1.664-11.314-4.686c-3.022-3.022-4.686-7.040-4.686-11.314s1.664-8.292 4.686-11.314c3.022-3.022 7.040-4.686 11.314-4.686s8.292 1.664 11.314 4.686zM25.899 25.9c1.971-1.971 3.281-4.425 3.821-7.096-0.421 0.62-0.824 0.85-1.073-0.538-0.257-2.262-2.335-0.817-3.641-1.621-1.375 0.927-4.466-1.802-3.941 1.276 0.81 1.388 4.375-1.858 2.598 1.079-1.134 2.050-4.145 6.592-3.753 8.946 0.049 3.43-3.504 0.715-4.729-0.422-0.824-2.279-0.281-6.262-2.434-7.378-2.338-0.102-4.344-0.314-5.25-2.927-0.545-1.87 0.58-4.653 2.584-5.083 2.933-1.843 3.98 2.158 6.731 2.232 0.854-0.894 3.182-1.178 3.375-2.18-1.805-0.318 2.29-1.517-0.173-2.199-1.358 0.16-2.234 1.409-1.512 2.467-2.632 0.614-2.717-3.809-5.247-2.414-0.064 2.206-4.132 0.715-1.407 0.268 0.936-0.409-1.527-1.594-0.196-1.379 0.654-0.036 2.854-0.807 2.259-1.325 1.225-0.761 2.255 1.822 3.454-0.059 0.866-1.446-0.363-1.713-1.448-0.98-0.612-0.685 1.080-2.165 2.573-2.804 0.497-0.213 0.973-0.329 1.336-0.296 0.752 0.868 2.142 1.019 2.215-0.104-1.862-0.892-3.915-1.363-6.040-1.363-3.051 0-5.952 0.969-8.353 2.762 0.645 0.296 1.012 0.664 0.39 1.134-0.483 1.439-2.443 3.371-4.163 3.098-0.893 1.54-1.482 3.238-1.733 5.017 1.441 0.477 1.773 1.42 1.464 1.736-0.734 0.64-1.185 1.548-1.418 2.541 0.469 2.87 1.818 5.515 3.915 7.612 2.644 2.644 6.16 4.1 9.899 4.1s7.255-1.456 9.899-4.1z"></path>',globe:'<path d="M15 2c-8.284 0-15 6.716-15 15s6.716 15 15 15c8.284 0 15-6.716 15-15s-6.716-15-15-15zM23.487 22c0.268-1.264 0.437-2.606 0.492-4h3.983c-0.104 1.381-0.426 2.722-0.959 4h-3.516zM6.513 12c-0.268 1.264-0.437 2.606-0.492 4h-3.983c0.104-1.381 0.426-2.722 0.959-4h3.516zM21.439 12c0.3 1.28 0.481 2.62 0.54 4h-5.979v-4h5.439zM16 10v-5.854c0.456 0.133 0.908 0.355 1.351 0.668 0.831 0.586 1.625 1.488 2.298 2.609 0.465 0.775 0.867 1.638 1.203 2.578h-4.852zM10.351 7.422c0.673-1.121 1.467-2.023 2.298-2.609 0.443-0.313 0.895-0.535 1.351-0.668v5.854h-4.852c0.336-0.94 0.738-1.803 1.203-2.578zM14 12v4h-5.979c0.059-1.38 0.24-2.72 0.54-4h5.439zM2.997 22c-0.533-1.278-0.854-2.619-0.959-4h3.983c0.055 1.394 0.224 2.736 0.492 4h-3.516zM8.021 18h5.979v4h-5.439c-0.3-1.28-0.481-2.62-0.54-4zM14 24v5.854c-0.456-0.133-0.908-0.355-1.351-0.668-0.831-0.586-1.625-1.488-2.298-2.609-0.465-0.775-0.867-1.638-1.203-2.578h4.852zM19.649 26.578c-0.673 1.121-1.467 2.023-2.298 2.609-0.443 0.312-0.895 0.535-1.351 0.668v-5.854h4.852c-0.336 0.94-0.738 1.802-1.203 2.578zM16 22v-4h5.979c-0.059 1.38-0.24 2.72-0.54 4h-5.439zM23.98 16c-0.055-1.394-0.224-2.736-0.492-4h3.516c0.533 1.278 0.855 2.619 0.959 4h-3.983zM25.958 10h-2.997c-0.582-1.836-1.387-3.447-2.354-4.732 1.329 0.636 2.533 1.488 3.585 2.54 0.671 0.671 1.261 1.404 1.766 2.192zM5.808 7.808c1.052-1.052 2.256-1.904 3.585-2.54-0.967 1.285-1.771 2.896-2.354 4.732h-2.997c0.504-0.788 1.094-1.521 1.766-2.192zM4.042 24h2.997c0.583 1.836 1.387 3.447 2.354 4.732-1.329-0.636-2.533-1.488-3.585-2.54-0.671-0.671-1.261-1.404-1.766-2.192zM24.192 26.192c-1.052 1.052-2.256 1.904-3.585 2.54 0.967-1.285 1.771-2.896 2.354-4.732h2.997c-0.504 0.788-1.094 1.521-1.766 2.192z"></path>',"thin-arrow-up":'<path d="M27.414 12.586l-10-10c-0.781-0.781-2.047-0.781-2.828 0l-10 10c-0.781 0.781-0.781 2.047 0 2.828s2.047 0.781 2.828 0l6.586-6.586v19.172c0 1.105 0.895 2 2 2s2-0.895 2-2v-19.172l6.586 6.586c0.39 0.39 0.902 0.586 1.414 0.586s1.024-0.195 1.414-0.586c0.781-0.781 0.781-2.047 0-2.828z"></path>',"thin-arrow-down":'<path d="M4.586 19.414l10 10c0.781 0.781 2.047 0.781 2.828 0l10-10c0.781-0.781 0.781-2.047 0-2.828s-2.047-0.781-2.828 0l-6.586 6.586v-19.172c0-1.105-0.895-2-2-2s-2 0.895-2 2v19.172l-6.586-6.586c-0.391-0.39-0.902-0.586-1.414-0.586s-1.024 0.195-1.414 0.586c-0.781 0.781-0.781 2.047 0 2.828z"></path>',"thin-arrow-up-left":'<path d="M4 18c0 1.105 0.895 2 2 2s2-0.895 2-2v-7.172l16.586 16.586c0.781 0.781 2.047 0.781 2.828 0 0.391-0.391 0.586-0.902 0.586-1.414s-0.195-1.024-0.586-1.414l-16.586-16.586h7.172c1.105 0 2-0.895 2-2s-0.895-2-2-2h-14v14z"></path>',"thin-arrow-up-right":'<path d="M26.001 4c-0 0-0.001 0-0.001 0h-11.999c-1.105 0-2 0.895-2 2s0.895 2 2 2h7.172l-16.586 16.586c-0.781 0.781-0.781 2.047 0 2.828 0.391 0.391 0.902 0.586 1.414 0.586s1.024-0.195 1.414-0.586l16.586-16.586v7.172c0 1.105 0.895 2 2 2s2-0.895 2-2v-14h-1.999z"></path>',"thin-arrow-left":'<path d="M12.586 4.586l-10 10c-0.781 0.781-0.781 2.047 0 2.828l10 10c0.781 0.781 2.047 0.781 2.828 0s0.781-2.047 0-2.828l-6.586-6.586h19.172c1.105 0 2-0.895 2-2s-0.895-2-2-2h-19.172l6.586-6.586c0.39-0.391 0.586-0.902 0.586-1.414s-0.195-1.024-0.586-1.414c-0.781-0.781-2.047-0.781-2.828 0z"></path>',"thin-arrow-right":'<path d="M19.414 27.414l10-10c0.781-0.781 0.781-2.047 0-2.828l-10-10c-0.781-0.781-2.047-0.781-2.828 0s-0.781 2.047 0 2.828l6.586 6.586h-19.172c-1.105 0-2 0.895-2 2s0.895 2 2 2h19.172l-6.586 6.586c-0.39 0.39-0.586 0.902-0.586 1.414s0.195 1.024 0.586 1.414c0.781 0.781 2.047 0.781 2.828 0z"></path>',"thin-arrow-down-left":'<path d="M18 28c1.105 0 2-0.895 2-2s-0.895-2-2-2h-7.172l16.586-16.586c0.781-0.781 0.781-2.047 0-2.828-0.391-0.391-0.902-0.586-1.414-0.586s-1.024 0.195-1.414 0.586l-16.586 16.586v-7.172c0-1.105-0.895-2-2-2s-2 0.895-2 2v14h14z"></path>',"thin-arrow-down-right":'<path d="M28 14c0-1.105-0.895-2-2-2s-2 0.895-2 2v7.172l-16.586-16.586c-0.781-0.781-2.047-0.781-2.828 0-0.391 0.391-0.586 0.902-0.586 1.414s0.195 1.024 0.586 1.414l16.586 16.586h-7.172c-1.105 0-2 0.895-2 2s0.895 2 2 2h14v-14z"></path>'},boundingBox:function(t){var e;try{e=document.body.contains(t)?t.getBBox():null}catch(o){console.warn("Failed to read SVG bounding box: "+o)}if(!e||0===e.x&&0===e.y&&0===e.width&&0===e.height){var i=t.parentNode,n=document.createElementNS(SL.editor.util.SVG.NAMESPACE,"svg");n.setAttribute("width","0"),n.setAttribute("height","0"),n.setAttribute("style","visibility: hidden; position: absolute; left: 0; top: 0;"),n.appendChild(t),document.body.appendChild(n),e=t.getBBox(),i?i.appendChild(t):n.removeChild(t),document.body.removeChild(n)}return e},pointsToPolygon:function(t){for(var e=[];t.length>=2;)e.push(t.shift()+","+t.shift());return e.join(" ")},createOrReuseShape:function(t,e){return e&&e.nodeName===t?(e.removeAttribute("data-viewbox"),e):(e&&e.parentNode&&e.parentNode.removeChild(e),document.createElementNS(SL.editor.util.SVG.NAMESPACE,t))},rect:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("rect",i)).setAttribute("width",t),i.setAttribute("height",e),i},ellipse:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("ellipse",i)).setAttribute("rx",t/2),i.setAttribute("ry",e/2),i.setAttribute("cx",t/2),i.setAttribute("cy",e/2),i},triangleUp:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([t/2,0,t,e,0,e])),i},triangleDown:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([0,0,t,0,t/2,e])),i},triangleLeft:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([0,e/2,t,0,t,e])),i},triangleRight:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([t,e/2,0,e,0,0])),i},arrowUp:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([.5*t,0,t,.5*e,.7*t,.5*e,.7*t,e,.3*t,e,.3*t,.5*e,0,.5*e,.5*t,0])),i},arrowDown:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([.5*t,e,t,.5*e,.7*t,.5*e,.7*t,0,.3*t,0,.3*t,.5*e,0,.5*e,.5*t,e])),i},arrowLeft:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([t,.3*e,.5*t,.3*e,.5*t,0,0,.5*e,.5*t,e,.5*t,.7*e,t,.7*e,t,.3*e])),i},arrowRight:function(t,e,i){return(i=SL.editor.util.SVG.createOrReuseShape("polygon",i)).setAttribute("points",SL.editor.util.SVG.pointsToPolygon([0,.3*e,.5*t,.3*e,.5*t,0,t,.5*e,.5*t,e,.5*t,.7*e,0,.7*e])),i},polygon:function(t,e,i,n){n=SL.editor.util.SVG.createOrReuseShape("polygon",n);var o=[];if(3===i)o=[t/2,0,t,e,0,e];else if(i>3)for(var r=t/2,s=e/2,a=0;a<i;a++){var l=r+r*Math.cos(2*Math.PI*a/i),c=s+s*Math.sin(2*Math.PI*a/i);l=Math.round(10*l)/10,c=Math.round(10*c)/10,o.push(l),o.push(c)}return n.setAttribute("points",SL.editor.util.SVG.pointsToPolygon(o)),n},symbol:function(t,e){return e=SL.editor.util.SVG.createOrReuseShape("g",e),SL.editor.util.SVG.SYMBOLS[t]&&(e.innerSVG=SL.editor.util.SVG.SYMBOLS[t]),e}};